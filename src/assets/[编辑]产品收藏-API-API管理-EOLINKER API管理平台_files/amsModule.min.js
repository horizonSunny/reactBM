"use strict";!function(){angular.module("eolinker.ams",[])}();
"use strict";!function(){angular.module("eolinker.constant").constant("PUBLIC_RESOURCE_DB_TYPE_ARR",["Mysql","Oracle"]).constant("API_DEV_PROJECT_TYPE_ARR",["Web","App","PC","硬件/物联网","其他"]).constant("NOTICE_MEMBER_OBJ",{API:[{key:"变更API",value:0},{key:"删除API",value:1},{key:"API状态变为已发布",value:2},{key:"API状态变为维护",value:3},{key:"API状态变为异常",value:4},{key:"API状态变为待定",value:5},{key:"API状态变为设计",value:6},{key:"API状态变为开发",value:7},{key:"API状态变为测试",value:8},{key:"API状态变为对接",value:9},{key:"API状态变为废弃",value:10},{key:"API状态变为已完成",value:11}],DOC:[{key:"编辑文档",value:0},{key:"删除文档",value:1}]})}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function Ams_GenerateApiModalCtrl(e,t,a){e.input=a,e.fun={},e.fun.closeModal=function(e){t.close(e||!1)}}function Ams_PullApiSettingModalCtrl(e,t,a,o){e.output={baseInfo:{apiName:1,requestType:1,apiURI:1,apiProtocol:1},requestParam:{header:1,body:1,urlParam:1,restParam:1,authInfo:1,pretreatment:1,advancedSetting:1},responseParam:{header:1,body:1},deleteRedundantParam:0},e.input=o,e.fun={},e.component={basicInfoTabSelect:{setting:{ulClass:"minus_margin"},list:[{type:"checkbox",key:"apiName",name:"API名称"},{type:"checkbox",key:"apiProtocol",name:"请求协议"},{type:"checkbox",key:"requestType",name:"请求方式"},{type:"checkbox",key:"apiURI",name:"URL"}]},requestInfoTabSelect:{setting:{ulClass:"minus_margin"},list:[{type:"checkbox",key:"header",name:"Header"},{type:"checkbox",key:"body",name:"Body"},{type:"checkbox",key:"urlParam",name:"GET / URL 参数"},{type:"checkbox",key:"restParam",name:"REST 参数"},{type:"checkbox",key:"authInfo",name:"权限校验"},{type:"checkbox",key:"pretreatment",name:"预处理"},{type:"checkbox",key:"advancedSetting","class":"mt10",name:"高级设置"}]},responseInfoTabSelect:{setting:{ulClass:"minus_margin"},list:[{type:"checkbox",key:"header",name:"Header"},{type:"checkbox",key:"body",name:"Body"}]},settingTabSelect:{setting:{ulClass:"minus_margin"},list:[{type:"checkbox","class":"danger_checkbox_tscc",key:"deleteRedundantParam",name:"删除测试用例中无法与API文档对应的参数"}]}},e.fun.confirm=function(){a.close(e.output)},e.fun.cancel=function(){a.close(!1)}}function Ams_ResponseDemoModalCtrl(e,t,a,o,n,s){e.CONST={demoMaxLen:t,STATUS_CODE_QUERY:[{key:"200",value:"200"},{key:"302",value:"302"},{key:"404",value:"404"},{key:"500",value:"500"},{key:"502",value:"502"},{key:"自定义",value:"0"}],CONTENT_TYPE_ARR:a.CONTENT_TYPE_ARR},e.fun={},e.data={},e.output=s,e.fun.confirm=function(){return e.data.submitted=!0,e.ConfirmForm.$invalid?void o.InfoModal("请检查信息是否填写正确","error"):void n.close(e.output)},e.fun.cancel=function(){n.close(!1)}}function Ams_TestPlanModalCtrl(e,t,a,o,n,s,i,r){e.fun={},e.data={submitted:!1,selectedPlanID:r.selectedPlanID||"",planName:r.selectedPlanName||"",pagination:{maxSize:10,pageSize:30,page:1,msgCount:0}},e.service={authority:o},e.component={menuObject:{},listDefaultCommonObject:{}},e.ajaxResponse={query:null},e.CONST={TITLE_OBJ:{save:"保存为测试方案",manage:"管理测试方案",query:"测试方案"}},e.input={type:r.type};var c={spaceKey:r.ajaxRequest.spaceKey,projectHashKey:r.ajaxRequest.projectHashKey,keyword:""},p={},l={isChangeName:!1,isDelete:!1,selectedPlanName:"",listOrderBy:JSON.parse(window.localStorage.MODAL_TEST_TEMPLATE_SORT||'{"orderBy": 0,"asc": 0}'),isQuerying:!1};p.search=function(t){c.keyword=t.item.keyword,e.$broadcast("$Init_LoadingPartCommonComponent",{type:"reset"})},p.sort=function(t){l.listOrderBy=t.listOrderBy,e.$broadcast("$Init_LoadingPartCommonComponent",{type:"reset"})},p.scrollLoading=function(){var t={hasItem:e.ajaxResponse.query&&0!==e.ajaxResponse.query.length,hasNextPage:e.data.pagination.page<e.data.pagination.msgCount/e.data.pagination.pageSize,isQuerying:l.isQuerying};t.hasItem&&t.hasNextPage&&!t.isQuerying&&e.fun.init({type:"preload"})},e.fun.planNameChange=function(){e.data.planName!==l.selectedPlanName&&(e.data.selectedPlanID="")},p.save=function(o){var u={spaceKey:c.spaceKey,projectHashKey:c.projectHashKey,planName:o.item.planName};o.item.planInfo&&(u.planInfo=JSON.stringify(o.item.planInfo));var m=null,d="";o.item.planID?(m=a.TestPlan.Edit,u.planID=o.item.planID,d="编辑测试方案"):(m=a.TestPlan.Add,d="新增测试方案"),"editPlanName"===o.type&&(d="编辑测试方案名称"),m(u).$promise.then(function(a){switch(a.statusCode){case s.COMMON.SUCCESS:switch(o.type){case"editPlanName":o.item.planID===e.data.selectedPlanID&&(l.isChangeName=!0,l.selectedPlanName=o.item.planName),e.ajaxResponse.query[o.$index].planName=o.item.planName;break;default:i.close({planID:u.planID||a.planID,planName:o.item.planName})}t.InfoModal(d+"成功","success");break;case"402408":t.EnsureModal("温馨提示",!1,"测试方案："+o.item.planName+" 已存在，是否需要覆盖？",{btnMessage:"确定",btnType:1},function(e){if(e){var t={item:{planID:a.planID,planName:o.item.planName,planInfo:r.planInfo}};p.save(t)}});break;default:t.InfoModal(d+"失败，"+n.FAILURE,"error")}})},p.editPlanName=function(e){var a={title:"修改测试方案名称",textArray:[{type:"input",title:"修改测试方案名称",key:"planName",value:e.item.planName,required:!0}]};t.MixInputModal(a,function(t){t&&p.save({type:"editPlanName",item:{planName:t.planName,planID:e.item.planID},$index:e.$index})})},p.deletePlan=function(o){t.EnsureModal("删除测试方案",!0,"确认删除测试方案："+o.item.planName+" ？",{},function(i){if(i){var r={spaceKey:c.spaceKey,projectHashKey:c.projectHashKey,planID:"["+o.item.planID+"]"};a.TestPlan.Delete(r).$promise.then(function(a){switch(a.statusCode){case s.COMMON.SUCCESS:o.item.planID===e.data.selectedPlanID&&(l.isDelete=!0),e.$broadcast("$Init_LoadingPartCommonComponent",{type:"reset"}),t.InfoModal("删除测试方案成功","success");break;default:t.InfoModal("删除测试方案失败，"+n.FAILURE,"error")}})}})},p.selectePlan=function(e){e.item.planID?i.close(e.item):t.InfoModal("请选择需要载入的测试方案","error")},p.initComponent=function(){e.component.menuObject={list:[{type:"search","class":"pull-left",keyword:c.keyword,fun:p.search}],setting:{}},e.component.listDefaultCommonObject.mainObject={item:{primaryKey:"apiID","default":[{key:"测试方案名称",html:"{{item.planName}}",sort:!0,sortOrderByVal:0},{key:"最后更新者",html:"{{item.updater}}"},{key:"更新时间",html:"{{item.updateTime}}",isUnneccessary:!0,sort:!0,sortOrderByVal:1}],operate:{funArr:[{key:"载入",fun:p.selectePlan},{key:"编辑名称",authority:"edit",fun:p.editPlanName},{key:"删除",authority:"edit",fun:p.deletePlan}],"class":"w_180"}},setting:{trNgClass:"manage"!==r.type?"'selected_tr':$ctrl.otherObject.selectedPlanID===item.planID":"",page:!0,autoSort:!0,sortStorageKey:"MODAL_TEST_TEMPLATE_SORT",sortDefaultVal:{storageVal:{orderBy:1,asc:1},sortOrder:"asc"},scroll:!0,scrollRemainRatio:7,warning:"暂无测试方案"},baseFun:{click:function(t){e.data.planName=l.selectedPlanName=t.item.planName,e.data.selectedPlanID=t.item.planID},autoSortFun:p.sort,scrollLoading:p.scrollLoading}}},p.initComponent(),e.fun.confirm=function(){if(e.data.submitted=!0,!e.ConfirmForm.$invalid){var t={item:{planID:e.data.selectedPlanID,planName:e.data.planName}};switch(r.type){case"query":p.selectePlan(t);break;case"save":t.item.planInfo=r.planInfo,p.save(t)}}},e.fun.init=function(t){t=t||{};var o=null,n=null,i={spaceKey:c.spaceKey,projectHashKey:c.projectHashKey,pageSize:e.data.pagination.pageSize,orderBy:l.listOrderBy.orderBy,keyword:c.keyword,asc:l.listOrderBy.asc};switch(l.isQuerying=!0,"reset"===t.type&&(e.ajaxResponse.query=null,e.data.pagination.page=1),t.type){case"preload":if(l.isQuerying=!1,i.page=e.data.pagination.page+1,l.preloadData&&i.page===l.preloadData.dataPage)return;l.preloadData={dataPage:i.page},n=function(t){switch(t.statusCode){case s.COMMON.SUCCESS:l.preloadData.itemNum=t.itemNum,l.preloadData.itemList=t.testPlanList,e.data.pagination.msgCount=l.preloadData.itemNum,e.ajaxResponse.query=e.ajaxResponse.query.concat(l.preloadData.itemList||[]),e.data.pagination.page++,l.preloadData=null}};break;default:l.isQuerying=!1,i.page=e.data.pagination.page||1,n=function(t){switch(t.statusCode){case s.COMMON.SUCCESS:var a=document.getElementsByClassName("tbody_container_ldcc");a&&a[0]&&(a[0].scrollTop=0),e.data.pagination.msgCount=t.itemNum,e.ajaxResponse.query=t.testPlanList||[],l.preloadData=null}}}return o=c.keyword?a.TestPlan.Search(i).$promise:a.TestPlan.Query(i).$promise,o.then(n),o},e.fun.cancel=function(){if("manage"===r.type){var e={type:"change",isDelete:l.isDelete};l.isChangeName&&(e.planName=l.selectedPlanName),i.close(e)}else i.close(!1)}}function Ams_Plug_TipsModalCtrl(e,t,a,o){e.fun={},e.data={hideTips:!1},e.input=o,e.output={},e.fun.hideTip=function(){e.data.hideTips=!e.data.hideTips,window.localStorage.setItem("EO_PLUG_TIPS_HIDE",e.data.hideTips)},e.fun.confirm=function(e){switch(e.excutor){case"plug":a.close("plug");break;case"server":a.close("server");break;case"pc":a.close(!1),t.Common_DownLoad_PCModal()}},e.fun.cancel=function(){a.close(!1)}}function Ams_InsertSqlCodeModalCtrl(e,t,a,o,n){function s(){e.output.dbID=n.dbList[0].dbID}e.fun={},e.data={},e.input=n,e.output={},e.component={dbSelectObj:{CONST:{DB_TYPE_ARR:t},setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5">{{$ctrl.mainObject.CONST.DB_TYPE_ARR[item.dbType]}}</span>'}}},e.fun.insert=function(){if(e.ConfirmForm.$invalid||!e.output.sqlCode||!e.output.dbID)return e.data.submitted=!0,void a.InfoModal("请检查信息是否填写完整","error");for(var t in n.dbList){var s=n.dbList[t];if(s.dbID===e.output.dbID){e.output.dbType=s.dbType;break}}o.close(e.output)},e.fun.cancel=function(){o.close(!1)},s()}function Ams_SqlUseTipModalCtrl(e,t){e.fun={},e.fun.cancel=function(){t.close(!1)}}function AMS_ShowDbFieldModalCtrl(e,t,a){function o(){n.initValueTable()}e.input=a,e.fun={};var n={};e.component={blockListObject:{}},n.initValueTable=function(){e.component.blockListObject.value={tdList:[{thKey:"值",type:"text",modelKey:"value"},{thKey:"描述",type:"text",modelKey:"desc"}]}},e.fun.close=function(){t.close(!1)},o()}function AMS_SelectDbFieldModalCtrl(e,t,a,o,n){function s(){if(l.initBlockList(),n.dbCache&&n.dbCache.dbList)e.component.blockListObject.db.tdList[0].selectQuery=n.dbCache.dbList;else{var t=Object.assign({},n.ajaxRequest,{targetType:"database"});i.GetDbObj(t).$promise.then(function(t){p.dbList=e.component.blockListObject.db.tdList[0].selectQuery=t.targetList||[]})}}var i={GetDbObj:a.Api.GetDBObjectQuery};e.component={blockListObject:{db:null}},e.ajaxRequest={dbArr:[{}]},e.data={},e.fun={},e.ajaxResponse={query:[]};var r={fieldID:null},c={},p=angular.copy(n.dbCache)||{dbList:null,tableObj:{},fieldObj:{}},l={};e.fun.confirm=function(){e.data.submitted=!0;var a=e.ajaxRequest.dbArr[0];if(a.fieldID){var n=[a.databaseID,a.tableID,a.fieldID];if(r.fieldID===n[2])o.close(Object.assign({},c.fieldInfo,{dbArr:n,dbCache:p}));else{var s=l.showField();s["finally"](function(){o.close(Object.assign({},c.fieldInfo,{dbArr:n,dbCache:p}))})}}else t.InfoModal("请先选择数据库字段","error")},e.fun.close=function(){o.close({dbCache:p,isClose:!0})},l.showField=function(o){r.fieldID=e.ajaxRequest.dbArr[0].fieldID;var s=a.Api.GetField(Object.assign({},n.ajaxRequest,{fieldID:r.fieldID})).$promise;return s.then(function(e){c.fieldInfo=e.fieldInfo||{},o&&t.AMS_ShowDbFieldModal(c.fieldInfo)}),s},l.changeFunDbSelect=function(t,a){var o=null,s=null;switch(t){case"db":if(!a.databaseID)return;if(s=function(t){delete a.tableID,delete a.fieldID,p.tableObj[a.databaseID]=e.component.blockListObject.db.tdList[1].selectQuery=t.targetList||[],e.component.blockListObject.db.tdList[2].selectQuery=[]},p.tableObj[a.databaseID])return void s({targetList:p.tableObj[a.databaseID]});o=Object.assign({},n.ajaxRequest,{targetType:"table",targetID:a.databaseID});break;case"table":if(s=function(t){delete a.fieldID,p.fieldObj[a.tableID]=e.component.blockListObject.db.tdList[2].selectQuery=t.targetList||[]},p.fieldObj[a.tableID])return void s({targetList:p.fieldObj[a.tableID]});o=Object.assign({},n.ajaxRequest,{targetType:"field",targetID:a.tableID})}var r=i.GetDbObj(o).$promise;return r.then(s),r},l.initBlockList=function(){e.component.blockListObject.db={setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"数据库",type:"select",key:"name",value:"id",selectQuery:[],modelKey:"databaseID","class":"pl15",fun:function(e){l.changeFunDbSelect("db",e.item)},itemExpression:"ng-class=\"{'eo-had-input-error':$ctrl.otherObject.submitted&&!item.databaseID}\""},{thKey:"表",type:"select",key:"name",value:"id",modelKey:"tableID",selectQuery:[],fun:function(e){l.changeFunDbSelect("table",e.item)},itemExpression:"ng-class=\"{'eo-had-input-error':$ctrl.otherObject.submitted&&!item.tableID}\""},{thKey:"字段",type:"select",key:"name",value:"id",modelKey:"fieldID",selectQuery:[],itemExpression:"ng-class=\"{'eo-had-input-error':$ctrl.otherObject.submitted&&!item.fieldID}\""},{thKey:"&nbsp;",type:"btn","class":"w_80",btnList:[{key:"预览字段",fun:l.showField,itemExpression:'ng-disabled="!item.fieldID"'}]}]}},s()}function AMS_GlobalSearchModalCtrl(e,t,a,o,n,s,i,r,c){function p(){switch(c.mark){case"automatic":e.CONST.SEARCH_SIDEBAR_ITEM=i.SEARCH_AUTOMATIC_SIDEBAR_ITEM;break;default:e.CONST.SEARCH_SIDEBAR_ITEM=i.SEARCH_API_SIDEBAR_ITEM}}var l={},u={MODULE_MUI:{api:1,project:2,code:3,doc:4,amsCase:1}};e.fun={},e.CONST={API_STATUS_QUERY:i.API_STATUS_QUERY},e.data={searchType:u.MODULE_MUI[c.module],keyword:c.keyword||""},e.component={blockListObject:{}},e.ajaxResponse={},e.fun.close=function(){n.close(!1)},l.getTargetIndex=function(e,t){var a=e.getAttribute(t||"eo-attr-index");return a?a:l.getTargetIndex(e.parentNode,t)},e.fun.clickResult=function(o){var n={point:""};if(n.index=l.getTargetIndex(o.$event.target,"eo-attr-index"),null!==n.index){if(n.item=e.ajaxResponse.searchResult[c.moduleMUIObj[o.module][0]][n.index],"read"!=c.role&&"write"!=c.role&&!c.permissionObject[n.item.projectHashKey][o.module])return void t.InfoModal("您没有此"+c.moduleMUIObj[o.module][1]+"的访问权限！","error");switch(o.module){case"amsCase":switch(n.item=e.ajaxResponse.searchResult.caseList[n.index],n.item.caseType){case 0:window.open(a.href("home.ams.automatic.inside.scene.api",{groupID:-1,caseID:n.item.caseID,projectHashKey:n.item.projectHashKey}),"_blank")}break;case"api":n.item=e.ajaxResponse.searchResult.apiList[n.index],window.open(a.href("home.ams.project.inside.api.detail",{groupID:-1,apiID:n.item.apiID,projectHashKey:n.item.projectHashKey}),"_blank");break;case"project":n.item=e.ajaxResponse.searchResult.projectList[n.index],window.open(a.href("home.ams."+("automatic"===c.mark?"automatic":"project")+".inside.overview",{projectHashKey:n.item.projectHashKey}),"_blank");break;case"code":n.item=e.ajaxResponse.searchResult.statusCodeList[n.index],window.sessionStorage.setItem("COMMON_SEARCH_TIP",n.item.code),window.open(a.href("home.ams.project.inside.code.list",{groupID:-1,projectHashKey:n.item.projectHashKey}),"_blank");break;case"doc":n.item=e.ajaxResponse.searchResult.documentList[n.index],window.open(a.href("home.ams.project.inside.doc.detail",{groupID:-1,pageID:n.item.pageID,projectHashKey:n.item.projectHashKey}),"_blank")}}},e.fun.clickSidebar=function(t){if(e.data.submitted=!0,e.data.keyword){var a={point:""};e.ajaxResponse.searchResult=null,a.index=l.getTargetIndex(t.$event.target,"eo-attr-index"),a.index=Number(a.index),e.data.searchType=a.index||-1,e.$broadcast("$Init_LoadingPartCommonComponent"),e.data.submitted=!0}},e.fun.search=function(){var a=null;if(e.data.submitted=!0,e.data.keyword)return a=c.resource.Project.GlobalSearch({spaceKey:c.spaceKey,keyword:e.data.keyword,type:e.data.searchType}).$promise,a.then(function(a){switch(a.statusCode){case s.COMMON.SUCCESS:switch(e.data.submitted=!1,c.mark){case"automatic":e.ajaxResponse.searchResult={caseList:o("highLightFilter")(a.searchResult.caseList||[],e.data.keyword,{fitKey:["caseName","caseTag"],maxLen:40}),projectList:o("highLightFilter")(a.searchResult.projectList||[],e.data.keyword,{fitKey:["projectName"]})};break;default:e.ajaxResponse.searchResult={apiList:o("highLightFilter")(a.searchResult.apiList||[],e.data.keyword,{fitKey:["apiName","apiURI"],maxLen:40}),projectList:o("highLightFilter")(a.searchResult.projectList||[],e.data.keyword,{fitKey:["projectName"]}),statusCodeList:o("highLightFilter")(a.searchResult.statusCodeList||[],e.data.keyword,{fitKey:["code","codeDescription"]}),documentList:o("highLightFilter")(a.searchResult.documentList||[],e.data.keyword,{fitKey:["title"]})}}for(var n in a.searchResult)if((a.searchResult[n]||[]).length>0)return void(e.data.isEmpty=!1);break;default:t.InfoModal(+r.FAILURE,"error")}e.data.isEmpty=!0}),a},p()}function AMS_MockPreviewModalCtrl(e,t,a,o,n,s,i){e.fun={},e.component={blockListObject:{}},e.ajaxResponse={},e.input={},e.CONST={MOCK_POSITION_MENU:[{key:"请求头部",value:"headerParam"},{key:"请求参数",value:"bodyParam"},{key:"URL参数",value:"urlParam"}],BODY_PARAM_MENU:{0:"Form-data",1:"JSON",2:"JSON Path"}};var r={};e.fun.close=function(){n.close(!1)},r.generateTouchCondictionTable=function(){var e={tdList:[{thKey:"参数名",type:"text",modelKey:"paramKey","class":"w_300"},{thKey:"参数值",type:"text",modelKey:"paramValue"}]};return e},r.generateResponseHeaderTable=function(){var e={itemStructure:{headerName:"",headerValue:""},tdList:[{thKey:"返回头部",type:"text",modelKey:"headerName","class":"w_300"},{thKey:"值",type:"text",modelKey:"headerValue"}]};return e},r.generateJsonTriggerCondition=function(){var e={outputConfig:null};return e.outputConfig={tdList:[{thKey:"参数名",type:"depthHtml",html:"{{item.paramKey}}","class":"pl20"},{thKey:"类型",type:"html",html:"{{$ctrl.mainObject.MATCH_PARAM_TYPE[item.paramType]}}",itemExpression:'ng-if="$ctrl.otherObject.bodyParamType!=2"',"class":"w_50"},{thKey:"循环校验",type:"html",html:'{{item.isLoop==1?"是":"否"}}',itemExpression:'ng-if="$ctrl.otherObject.bodyParamType!=2"',"class":"w_80"},{thKey:"内容校验",type:"html",html:"{{$ctrl.mainObject.MATCH_RULE_TYPE[item.matchRule.toString()]}}","class":"w_150"},{thKey:"预期结果",type:"text",modelKey:"paramValue"}],MATCH_RULE_TYPE:a.MATCH_RULE_TYPE,MATCH_PARAM_TYPE:{0:"string",8:"bool",12:"array",13:"object",14:"number"}},e.outputConfig},e.fun.goToTestPreviewMockData=function(){if("2"!==e.ajaxResponse.triggerCondition.bodyParamType){var a=[];(e.ajaxResponse.triggerCondition.headerParam||[]).map(function(e){a.push({headerName:e.paramKey,headerValue:e.paramValue})}),window.localStorage.setItem("MOCK_PREVIEW_TO_TEST_DATA",JSON.stringify(Object.assign({},{requestHeader:a,requestBody:e.ajaxResponse.triggerCondition.bodyParam||[],apiRequestParamJsonType:e.ajaxResponse.triggerCondition.bodyParamJsonType,requestParamType:"1"===e.ajaxResponse.triggerCondition.bodyParamType?"2":"0",urlParam:e.ajaxResponse.triggerCondition.urlParam||[]},i.extralData))),window.open(t.href("home.ams.project.inside.api.test",Object.assign({},t.params,{from:"mock"})))}},r.init=function(){e.component.blockListObject.responseHeader=r.generateResponseHeaderTable(),e.component.blockListObject.triggerCondition=r.generateTouchCondictionTable(),e.component.blockListObject.jsonTriggerCondition=r.generateJsonTriggerCondition()}(),e.fun.init=function(){e.input.authority=i.authority;var t=s.MockExpectation.Info(i.ajaxRequest).$promise;return t.then(function(t){e.ajaxResponse=t.expectationInfo,"0"!==e.ajaxResponse.triggerCondition.bodyParamType&&(e.ajaxResponse.triggerCondition.jsonBodyParam=o.initReadonlyTableList(e.ajaxResponse.triggerCondition.bodyParam||[]))}),t}}function AMS_MockSettingModalCtrl($scope,AUTOMATE_TEST_CONSTANT,RESPONSE_TEXT,$uibModalInstance,CODE,$filter,ApiManagementResource,COMMON_PARAM_TYPE_ARR,ListBlock_CommonComponentService,HTTP_CONSTANT,$rootScope,input){$scope.fun={},$scope.CONST={MOCK_TYPE_ARR:[{key:"JSON 编辑器",value:0},{key:"Raw",value:1},{key:"Javascript",value:2}],MOCK_JSON_TYPE_ARR:[{key:"Object",value:"object"},{key:"Array",value:"array"}],MOCK_POSITION_MENU:[{key:"请求头部",value:"headerParam"},{key:"请求体",value:"bodyParam"},{key:"URL参数",value:"urlParam"}],matchRule:AUTOMATE_TEST_CONSTANT.MOCK_MATCH_RULE,BODY_PARAM_MENU:[{key:"Form-data",value:"0"},{key:"JSON",value:"1"}],jsonTypeQuery:AUTOMATE_TEST_CONSTANT.JSON_ROOT_TYPE_ARR,JSON_MATCH_POSITION_TYPE_ARR:AUTOMATE_TEST_CONSTANT.JSON_MATCH_POSITION_TYPE_ARR},$scope.data=Object.assign({},input.setting,{isMore:!1,menuType:"bodyParam",positionType:0}),$scope.component={blockListObject:{}},$scope.ajaxResponse={};var privateFun={},CONST={COMMON_PARAM_TYPE_ARR:COMMON_PARAM_TYPE_ARR,REQUEST_HEADER:HTTP_CONSTANT.REQUEST_HEADER,JSON_PARAMTYPE_AEE:[{name:"string",value:"0"},{name:"bool",value:"8"},{name:"array",value:"12"},{name:"object",value:"13"},{name:"number",value:"14"}],onlyYesAndNoTypeList:[{name:"否",value:"0"},{name:"是",value:"1"}]},cache={mockRuleObj:{},bodyParam:{}},data={};$scope.fun.changeMockRuleType=function(e,t){switch(cache.mockRuleObj[$scope.ajaxResponse.responseBodySettingType]=angular.copy($scope.ajaxResponse.mockRule),$scope.ajaxResponse.responseBodySettingType=e,e){case 0:var a=Object.assign({},angular.copy($scope.component.blockListObject.mockRule.itemStructure),{listDepth:0});$scope.ajaxResponse.mockRule=angular.copy(t||cache.mockRuleObj[e]||[a]);break;default:$scope.ajaxResponse.mockRule=angular.copy(t||cache.mockRuleObj[e]||"")}},$scope.fun.changeBodyType=function(e,t){cache.bodyParam[$scope.ajaxResponse.triggerCondition.bodyParamType]=angular.copy($scope.ajaxResponse.triggerCondition.bodyParam),$scope.ajaxResponse.triggerCondition.bodyParamType=e,"1"!==e?(cache.positionType=$scope.data.positionType,$scope.data.positionType=0):(cache.hasOwnProperty("positionType")&&($scope.data.positionType=cache.positionType),$scope.fun.changeJsonMatchPositionType(!0,$scope.data.positionType,!0));var a={};switch(e){case"0":a={paramKey:"",paramValue:""};break;case"1":a=0===$scope.data.positionType?{paramKey:"",paramValue:"",paramType:"0",matchRule:"1",isLoop:"0",listDepth:0}:{paramKey:"",paramValue:"",matchRule:"10"}}$scope.ajaxResponse.triggerCondition.bodyParam=angular.copy(t&&t.length>0?t:cache.bodyParam[e]&&cache.bodyParam[e].length>0?cache.bodyParam[e]:[a])},$scope.fun.changeJsonMatchPositionType=function(e,t,a){var o=a?t:$scope.data.positionType;switch(o){case 0:$scope.component.blockListObject.jsonTriggerCondition.setting.isLevel=!0,$scope.component.blockListObject.jsonTriggerCondition.itemStructure={paramKey:"",paramValue:"",paramType:"0",matchRule:"1",isLoop:"0"};break;case 1:$scope.component.blockListObject.jsonTriggerCondition.setting.isLevel=!1,$scope.component.blockListObject.jsonTriggerCondition.itemStructure={paramKey:"",paramValue:"",matchRule:"10"}}e||($scope.ajaxResponse.triggerCondition.bodyParam=[Object.assign({},$scope.component.blockListObject.jsonTriggerCondition.itemStructure,{listDepth:0})])},$scope.fun.previewMockData=function(){var e=[];e=0===$scope.ajaxResponse.responseBodySettingType?ListBlock_CommonComponentService.formatNestList($scope.ajaxResponse.mockRule):$scope.ajaxResponse.mockRule,$scope.ajaxResponse.mockResult=privateFun.generateMockData($scope.ajaxResponse.responseBodySettingType,e,$scope.ajaxResponse.mockConfig),null!==$scope.ajaxResponse.mockResult&&$rootScope.Product_CodePreviewModal({title:"Mock API预览",code:$scope.ajaxResponse.mockResult})},privateFun.generateMockData=function(inputMockType,inputData,inputConfig){switch(inputMockType){case 0:return $filter("mockFilter")(inputData,inputConfig);case 1:return inputData||"";case 2:try{var tmpOutput=eval("(function(){"+(inputData||"")+"})()");switch("undefined"==typeof tmpOutput?"undefined":_typeof(tmpOutput)){case"object":return JSON.stringify(tmpOutput,null,4);default:return tmpOutput}}catch(JAVASCRIPT_ERR){return $rootScope.InfoModal("构造失败，javascript语法有误","error"),null}}},privateFun.setBodyParamData=function(){switch(data.apiParamData.apiRequestParamType){case 2:$scope.ajaxResponse.triggerCondition.bodyParamJsonType=data.apiParamData.apiRequestParamJsonType;case 0:$scope.fun.changeBodyType(0===data.apiParamData.apiRequestParamType?"0":"1",ListBlock_CommonComponentService.initEditTableList(data.apiParamData.requestInfo||[],{isLoop:!0,lastFilterKey:"paramKey",itemStructure:$scope.component.blockListObject.jsonTriggerCondition.itemStructure,fun:function(e,t){return privateFun.parseStructData(e,t,function(e){switch(e.paramType){case"1":case"6":case"7":case"9":e.paramType="0";break;case"3":case"4":case"5":case"10":case"11":e.paramType="14";break;case"2":e.paramType="13";break;case"0":case"8":case"12":case"13":case"14":break;default:e.paramType="0"}})}}));break;default:$scope.ajaxResponse.triggerCondition.bodyParam=[angular.copy($scope.component.blockListObject.jsonTriggerCondition.itemStructure)]}},privateFun.parseStructData=function(e,t,a){if(e.structureID){var o=[],n=angular.copy(data.apiParamData.dataStructureList)[e.structureID].structureData;for(var s in n){var i=n[s],r=e.updateData[i.paramID];if(!r||!r.structureIsHide){i=Object.assign({},i,r),i.listDepth=t+(i.listDepth||0);var c=parseInt(i.paramType||0);a?a(i):(c>20||!c)&&(i.paramType="0"),o.push(i)}}return o}var p=parseInt(e.paramType||0);a?a(e):(p>20||!p)&&(e.paramType="0")},privateFun.getParamData=function(){data.GetParamData_Api=ApiManagementResource.Api.GetParamData(input.ajaxRequest).$promise,data.GetParamData_Api.then(function(e){switch(data.apiParamData=e,data.apiParamData.resultParamType){case 0:data.apiParamData.resultInfo=ListBlock_CommonComponentService.initEditTableList(data.apiParamData.resultInfo||[],{isLoop:!0,itemStructure:$scope.component.blockListObject.mockRule.itemStructure,fun:function(e,t){return privateFun.parseStructData(e,t)}})}"add"===input.setting.operateName&&($scope.fun.syncApiDoc(!0),privateFun.setBodyParamData())})},$scope.fun.syncApiDoc=function(e){data.GetParamData_Api["finally"](function(){switch(data.apiParamData.resultParamType){case 0:$scope.ajaxResponse.mockConfig={type:0===data.apiParamData.resultParamJsonType?"object":"array"},$scope.ajaxResponse.mockRule=angular.copy(data.apiParamData.resultInfo);break;default:if(e)return;var t="{@html_1}当前Mock API没有匹配的返回数据，可能由于以下两种情况导致：{@html_2}1.当前API没有设置Mock API；{@html_2}2.当前的Mock API没有匹配的触发条件，请检查Mock API的设置！{@html_3}",a={html_1:'<p class="fwb">',html_2:"</p><p>",html_3:"</p>"};$rootScope.MessageModal("温馨提示",$filter("JsConstructHtml_CommonFilter")(t,a))}})},privateFun.compileFormData=function(){var e={expectationName:$scope.ajaxResponse.expectationName,responseHttpCode:$scope.ajaxResponse.responseHttpCode,responseDelay:$scope.ajaxResponse.responseDelay,responseBodySettingType:$scope.ajaxResponse.responseBodySettingType,responseHeader:[],triggerCondition:{headerParam:[],bodyParam:[],urlParam:[],bodyParamJsonType:$scope.ajaxResponse.triggerCondition.bodyParamJsonType,bodyParamType:$scope.ajaxResponse.triggerCondition.bodyParamType}},t=!1,a=!0,o=!1,n=void 0;try{for(var s,i=$scope.ajaxResponse.responseHeader[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var r=s.value;if(!r.headerName&&r.headerValue||r.headerName&&!r.headerValue)return null;r.headerName&&e.responseHeader.push(r)}}catch(c){o=!0,n=c}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw n}}var p=!0,l=!1,u=void 0;try{for(var m,d=$scope.CONST.MOCK_POSITION_MENU[Symbol.iterator]();!(p=(m=d.next()).done);p=!0){var y=m.value,f=$scope.ajaxResponse.triggerCondition[y.value].length;if("bodyParam"===y.value&&"1"===$scope.ajaxResponse.triggerCondition.bodyParamType)for(var h=0;h<f;h++){var b=$scope.ajaxResponse.triggerCondition[y.value][h],g=!(h!==f-1&&b.listDepth<$scope.ajaxResponse.triggerCondition[y.value][h+1].listDepth);if(g&&(!b.paramKey&&b.paramValue||b.paramKey&&!b.paramValue))return null;b.paramKey&&e.triggerCondition[y.value].push(b)}else for(var T=0;T<f;T++){var C=$scope.ajaxResponse.triggerCondition[y.value][T];if(!C.paramKey&&C.paramValue||C.paramKey&&!C.paramValue)return null;C.paramKey&&e.triggerCondition[y.value].push(C)}}}catch(c){l=!0,u=c}finally{try{!p&&d["return"]&&d["return"]()}finally{if(l)throw u}}switch("1"===$scope.ajaxResponse.triggerCondition.bodyParamType&&(0===$scope.data.positionType?e.triggerCondition.bodyParam=ListBlock_CommonComponentService.formatNestList(e.triggerCondition.bodyParam):e.triggerCondition.bodyParamType="2"),e.responseBodySettingType){case 0:if(e.mockConfig=JSON.stringify($scope.ajaxResponse.mockConfig),e.mockRule=ListBlock_CommonComponentService.formatNestList($scope.ajaxResponse.mockRule,{fun:function(e){return e.paramKey||!e.rule&&!e.value?e.paramKey?void 0:null:(t=!0,!1)}}),t)return null;break;default:e.mockRule=$scope.ajaxResponse.mockRule}if(e.mockResult=privateFun.generateMockData(e.responseBodySettingType,e.mockRule,$scope.ajaxResponse.mockConfig),null===e.mockResult)return!1;if(!e.mockResult)return 2===e.responseBodySettingType?$rootScope.InfoModal("javascript没有return任何数据","error"):$rootScope.InfoModal("请填写预期返回数据","error"),!1;var S=function(e,t){if(!/(dbArr)|(\$\$hashKey)|(listDepth)|(isHide)|(isShrink)|(templateChildList)/.test(e))return t};return e.responseHeader=JSON.stringify(e.responseHeader,S),e.triggerCondition=JSON.stringify(e.triggerCondition,S),0===e.responseBodySettingType&&(e.mockRule=JSON.stringify(e.mockRule,S)),e},$scope.fun.submitForm=function(){if($scope.data.submitted=!0,$scope.ConfirmForm.$invalid)$rootScope.InfoModal("请检查信息是否填写完整","error");else{var e=privateFun.compileFormData(),t="edit"===input.setting.operateName?"Edit":"Add";if(null===e)return void $rootScope.InfoModal("请检查信息是否填写完整","error");if(!e)return;var a=ApiManagementResource.MockExpectation[t](Object.assign({},input.ajaxRequest,e)).$promise;a.then(function(e){switch(e.statusCode){case CODE.COMMON.SUCCESS:$uibModalInstance.close(!0);break;case CODE.COMMON.HAD_WARNING:break;case"402102":$rootScope.InfoModal("已经存在相同触发条件的Mock API："+e.expectationName,"error");break;default:$rootScope.InfoModal("操作失败，"+RESPONSE_TEXT.FAILURE,"error")}})}},$scope.fun.close=function(){$uibModalInstance.close(!1)},privateFun.changeVarType=function(e){var t=e.item;switch(t.paramType.toString()){case"2":case"12":case"13":if(!t.templateChildList)return;$scope.ajaxResponse.mockRule=$scope.ajaxResponse.mockRule.slice(0,e.$index+1).concat(t.templateChildList||[]).concat($scope.ajaxResponse.mockRule.slice(e.$index+1,$scope.ajaxResponse.mockRule.length)),t.templateChildList=null;break;default:if(t.templateChildList)return;for(var a=e.$index+1;a<$scope.ajaxResponse.mockRule.length&&!($scope.ajaxResponse.mockRule[a].listDepth<=$scope.ajaxResponse.mockRule[e.$index].listDepth);)a++;t.templateChildList=$scope.ajaxResponse.mockRule.splice(e.$index+1,a-e.$index-1)}},privateFun.reduceItemWhenIsOprDepth=function(e){switch(e.paramType){case"2":case"12":case"13":break;default:e.paramType="13"}return!0},privateFun.generateMockRuleTable=function(){var e={itemStructure:{paramKey:"",paramType:"0",rule:"",value:""},baseFun:{reduceItemWhenAddChildItem:privateFun.reduceItemWhenIsOprDepth},tdList:[{thKey:"参数名",type:"depthInput",modelKey:"paramKey",placeholder:"参数名","class":"w_300",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&(item.value||item.rule)}\""},{thKey:"类型",type:"select",selectQuery:CONST.COMMON_PARAM_TYPE_ARR,initialData:"item.paramType",modelKey:"paramType","class":"w_200",key:"name",fun:privateFun.changeVarType},{thKey:"生成规则",type:"input",modelKey:"rule",placeholder:"请输入Mock生成规则"},{thKey:"属性值",type:"input",modelKey:"value",placeholder:"请输入Mock的属性值，如true"},{type:"btn","class":"w_150",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'ng-if="item.listDepth<4"'},{key:"删除",operateName:"delete"}]}]};return e},privateFun.generateTouchCondictionTable=function(){var e={itemStructure:{paramKey:"",paramValue:""},tdList:[{thKey:"参数名",type:"input",modelKey:"paramKey",placeholder:"参数名","class":"w_300",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramValue}\""},{thKey:"参数值",type:"input",modelKey:"paramValue",placeholder:"参数值",itemExpression:"ng-class=\"{'eo-input-error':$ctrl.otherObject.submitted&&item.paramKey&&!item.paramValue}\""},{type:"btn","class":"w_150 ",btnList:[{key:"删除",operateName:"delete"}]}]};return e},privateFun.generateResponseHeaderTable=function(){var e={itemStructure:{headerName:"",headerValue:""},tdList:[{thKey:"标签",type:"autoComplete",selectQuery:HTTP_CONSTANT.REQUEST_HEADER,modelKey:"headerName",placeholder:"头部标签","class":"w_300",itemExpression:"ng-class=\"{'eo-had-input-error':item.headerValue&&!item.headerName}\""},{thKey:"内容",type:"input",modelKey:"headerValue",placeholder:"头部内容",itemExpression:"ng-class=\"{'eo-input-error':!item.headerValue&&item.headerName}\""},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete"}]}]};return e},privateFun.generateJsonTriggerCondition=function(){var e={baseFun:{reduceItemWhenAddChildItem:function(e){var t=["12","13"];
t.indexOf(e.paramType)===-1&&(e.paramType="13"),e.paramValue=""}},setting:{isLevel:!0},itemStructure:{paramKey:"",paramValue:"",matchRule:"1",paramType:"0",isLoop:"0"},tdList:[{thKey:'{{$ctrl.otherObject.positionType===1?"Json Path":"参数名"}}',type:"depthInput",modelKey:"paramKey",placeholder:"{{$ctrl.otherObject.positionType===1?'Json Path':'参数名'}}","class":"w_300",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramValue}\""},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType||'0'",selectQuery:CONST.JSON_PARAMTYPE_AEE,modelKey:"paramType","class":"w_100",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'}]};return e.tdList=e.tdList.concat([{thKey:"循环校验",type:"select",key:"name",value:"value",initialData:"item.isLoop||'0'",selectQuery:CONST.onlyYesAndNoTypeList,modelKey:"isLoop","class":"w_100",disabled:"item.paramType!='12'",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"内容校验",type:"select",key:"key",value:"value",disabled:"$ctrl.list[$index+1].listDepth>item.listDepth",initialData:"item.matchRule||'1'",selectQueryExpression:"$ctrl.otherObject.positionType===0?$ctrl.otherObject.matchRule[item.paramType]:$ctrl.otherObject.matchRule['jsonPath']",modelKey:"matchRule","class":"w_150"},{thKey:"预期结果",type:"input",modelKey:"paramValue",itemExpression:'ng-disabled="$ctrl.list[$index+1].listDepth>item.listDepth" ng-class="{\'eo-input-error\':!($ctrl.list[$index+1].listDepth>item.listDepth)&&$ctrl.otherObject.submitted&&item.paramKey&&!item.paramValue}"',placeholder:"预期结果"},{type:"btn","class":"w_150",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'ng-if="item.listDepth<4&&$ctrl.mainObject.setting.isLevel"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]),e},privateFun.init=function(){privateFun.getParamData(),$scope.component.blockListObject.mockRule=privateFun.generateMockRuleTable(),$scope.component.blockListObject.responseHeader=privateFun.generateResponseHeaderTable(),$scope.component.blockListObject.triggerCondition=privateFun.generateTouchCondictionTable(),$scope.component.blockListObject.jsonTriggerCondition=privateFun.generateJsonTriggerCondition(),$scope.CONST.INSERT_TYPE_ARR=[{expression:'set-to-params="paramKey" item=\''+JSON.stringify($scope.component.blockListObject.mockRule.itemStructure)+'\' reset-result="item" set-value="paramInfo" level-status="nest"'},{key:"导入文档的JSON返回内容"}]}(),$scope.fun.init=function(){switch(input.setting.operateName){case"copy":case"edit":var e={copy:"副本-",edit:""},t=ApiManagementResource.MockExpectation.Info(input.ajaxRequest).$promise;return t.then(function(t){t.expectationInfo.expectationName=e[input.setting.operateName]+t.expectationInfo.expectationName,$scope.ajaxResponse=t.expectationInfo,$scope.ajaxResponse.mockConfig=$scope.ajaxResponse.mockConfig||{type:"object"},$scope.ajaxResponse.triggerCondition=$scope.ajaxResponse.triggerCondition||{headerParam:[],urlParam:[],bodyParam:[],bodyParamType:"0"};var a=!0,o=!1,n=void 0;try{for(var s,i=$scope.CONST.MOCK_POSITION_MENU[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var r=s.value;"bodyParam"===r.value&&"0"!==$scope.ajaxResponse.triggerCondition.bodyParamType?("2"===$scope.ajaxResponse.triggerCondition.bodyParamType&&($scope.data.positionType=1,$scope.ajaxResponse.triggerCondition.bodyParamType="1",$scope.fun.changeJsonMatchPositionType(!0,1,!0)),$scope.fun.changeBodyType("1",ListBlock_CommonComponentService.initEditTableList($scope.ajaxResponse.triggerCondition.bodyParam||[],{isLoop:!0,lastFilterKey:"paramKey",itemStructure:$scope.component.blockListObject.jsonTriggerCondition.itemStructure}))):$scope.ajaxResponse.triggerCondition[r.value].push(angular.copy($scope.component.blockListObject.triggerCondition.itemStructure))}}catch(c){o=!0,n=c}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw n}}switch($scope.ajaxResponse.responseHeader.push(angular.copy($scope.component.blockListObject.responseHeader.itemStructure)),$scope.ajaxResponse.responseBodySettingType){case 0:$scope.ajaxResponse.mockRule=ListBlock_CommonComponentService.initEditTableList($scope.ajaxResponse.mockRule||[],{isLoop:!0,itemStructure:$scope.component.blockListObject.mockRule.itemStructure})}}),t;default:return $scope.ajaxResponse={responseDelay:0,responseHttpCode:"200",responseBodySettingType:0,mockRule:[{paramKey:"",paramType:"0",rule:"",value:"",listDepth:0}],triggerCondition:{headerParam:[{paramKey:"",paramValue:""}],urlParam:[{paramKey:"",paramValue:""}],bodyParam:[],bodyParamType:"0",bodyParamJsonType:"0"},responseHeader:[{headerName:"",headerValue:""}],mockConfig:{type:"object"}},data.GetParamData_Api}}}function AMS_ChartAndTableModalCtrl(e,t,a){e.data={pagination:{maxSize:10,pageSize:7,page:1,msgCount:a.query.length||0,jumpPage:""}},e.fun={},e.input=a;var o={};e.data.pagination.fun=function(){e.data.query=e.input.query.slice(e.data.pagination.pageSize*(e.data.pagination.page-1),e.data.pagination.page*e.data.pagination.pageSize)},o.initComponent=function(){e.component={chart:{tooltip:{trigger:"axis",position:function(e){return[e[0],"10%"]}},grid:{left:0,right:0,top:0,bottom:0},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{show:!1,data:a.xData},yAxis:{show:!1},series:[{type:"line",smooth:!0,sampling:"average",itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])},data:a.yData}]},blockListObject:a.blockListObject}},o.initComponent(),e.data.pagination.fun(),e.fun.close=function(){t.close(!1)}}function AMS_PlugApiStatusModalCtrl(e,t,a,o){e.fun={},e.input=o,e.component={},e.data={pagination:{pages:"",maxSize:10,pageSize:5,page:1,msgCount:0,jumpPage:""}},e.interaction={response:{}},e.component.blockListObject={mainObject:{setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"名称",type:"html",html:"<span>{{item.apiName}}</span>"},{thKey:"URL",type:"html",html:"<span>{{item.apiURI}}</span>"},{type:"btn",btnList:[{key:"新标签打开",fun:function(e){window.open(t.href("home.ams.project.inside.api.detail",{apiID:e.item.apiID}),"_blank")}}],"class":"w_100"}]}},e.fun.changeApiStatus=function(t){e.data.pagination.page=1,e.input.item=t.item,e.interaction.response.query=null,e.$broadcast("$Init_LoadingPartCommonComponent")},e.fun.init=function(){var t={request:o.request};return t.request.apiStatus=e.input.item.value,t.request.pageSize=e.data.pagination.pageSize,t.request.page=e.data.pagination.page,t.promise=o.resource(o.request).$promise,t.promise.then(function(t){e.interaction.response.query=t.apiList,e.data.pagination.msgCount=t.itemCount}),t.promise},e.data.pagination.fun=function(){e.fun.init()},e.fun.init(),e.fun.close=function(){a.close(!1)}}function AMS_ExportModalCtrl(e,t,a,o,n,s){e.info={projectHashKey:s.params.projectHashKey},e.data={exportType:0,envID:n.envList&&n.envList.length>0?n.envList[0].envID:null,type:0},e.fun={},e.input=n,e.component={openApiExportFormatObj:[{key:"json",value:0},{key:"yaml",value:1}]};var i={};e.fun.noticeUpgrade=function(){o.Common_UpgradeNoticeModal({mark:"AMS",module:"ams_export"})},i.response=function(n){switch(n.response.statusCode){case a.COMMON.SUCCESS:e.$broadcast("$DumpDirective_Click_"+n["switch"].toString(),{response:n.response,fileName:e.input.fileName}),t.close(!0);break;default:o.InfoModal("导出失败","error")}},i.init=function(){switch(n.mark){case"common":break;default:e.input.envList=[{envName:"未选择任何环境",envID:null}].concat(e.input.envList)}}(),e.fun.dumpDirective=function(t){var a={promise:null,request:{spaceKey:e.input.spaceKey,projectHashKey:e.info.projectHashKey,envID:e.data.envID}};if(e.input.request)for(var o in e.input.request)a.request[o]=e.input.request[o];switch(t["switch"].toString()){case"0":case"5":switch(e.input.mark){case"eolinkerAndExcel":a.request.exportFormat="0"==t["switch"].toString()?0:1}a.promise=n.resource.Export(a.request).$promise;break;case"1":a.promise=n.resource.Html(a.request).$promise;break;case"2":a.promise=n.resource.Pdf(a.request).$promise;break;case"3":a.promise=n.resource.Word(a.request).$promise;break;case"4":a.promise=n.resource.Markdown(a.request).$promise;break;case"openApi":a.request.type=e.data.type,a.promise=n.resource.OpenApi(a.request).$promise}return a.promise.then(function(e){i.response({response:e,"switch":"export-by-one-key"})}),a.promise},e.fun.cancel=function(){t.close(!1)}}function AMS_AutomatedTest_EditCaseModalCtrl(e,t,a){e.input=a,e.fun={},e.output={groupID:a.group.groupID},e["const"]={caseTypeQuery:[{key:"UI模式",value:"0"},{key:"脚本模式 [Javascript]",value:1}]},e.component={selectMultistageCommonComponentObject:{"new":{},original:{}}};var o={};e.fun.confirm=function(){var o={output:{caseName:e.input.caseInfo.caseName,groupID:e.component.selectMultistageCommonComponentObject["new"].value,caseTag:e.input.caseInfo.caseTag}};switch(a.status){case"add":o.output.caseType=e.input.caseInfo.caseType||"0"}e.ConfirmForm.$valid&&t.close(o.output)},e.fun.cancel=function(){t.close(!1)},o.init=function(){a.caseInfo.caseType=(a.caseInfo.caseType||0).toString()}()}function AMS_ApiSearchModalCtrl(e,t,a,o,n){e.fun={},e.data={submitted:!1},e.output=angular.copy(n.request),e["const"]={apiStatusQuery:[{key:"所有",value:-1}].concat(o.API_STATUS_SHOW_QUERY),requestMethodQuery:[{key:"所有",value:-1}].concat(o.REQUEST_METHOD_QUERY),apiStarStatusQuery:[{key:"无",value:0},{key:"星标",value:1},{key:"所有",value:-1}]},e.component={selectPersonCommonComponentObject:{updater:{},creator:{}}};var s={},i={cache:a};e.fun.confirm=function(){var a={output:{keyword:e.output.keyword,apiRequestType:e.output.requestMethod,apiStatus:e.output.apiStatus,apiTag:JSON.stringify(e.output.apiTag),updaterID:"["+(e.component.selectPersonCommonComponentObject.updater.value||"")+"]",creatorID:"["+(e.component.selectPersonCommonComponentObject.creator.value||"")+"]",starred:e.output.apiStarStatus}};e.ConfirmForm.$valid?t.close(a.output):e.data.submitted=!0},e.fun.cancel=function(){t.close(!1)},s.init=function(){n.resource.getSearchConditionList(n.resourceParams).$promise.then(function(t){e.data.memberQuery=t.memberList||[],i.cache.set(t.memberList,"API_PROJECT_MEMBERLIST"),e.data.apiTagQuery=t.tagList||[]})}()}function AMS_CodeModalCtrl(e,t,a,o,n,s,i,r){e.title=s,e.info={spaceKey:i.spaceKey,projectHashKey:i.projectHashKey,groupID:parseInt(i.groupID),code:"",codeDesc:"",isAdd:!0},e.interaction={request:{statusCode:[{code:"",codeDesc:""}]}},e.fun={},e.query=[],e.component={blockListObject:{},selectMultistageCommonComponentObject:{"new":{},original:{}}};var c={};e.keep=function(){var t={request:{spaceKey:e.info.spaceKey,projectHashKey:e.info.projectHashKey,groupID:e.component.selectMultistageCommonComponentObject["new"].value,statusCode:"[]"},isCheck:!1,promise:null};return t.request.statusCode=JSON.stringify(e.interaction.request.statusCode.slice(0,e.interaction.request.statusCode.length-1),function(e,a){if("[object Object]"!=Object.prototype.toString.call(a)||a.code&&a.codeDesc||(t.isCheck=!0),"object"==("undefined"==typeof a?"undefined":_typeof(a))||/(code)|(codeDesc)/.test(e))return a}),t.isCheck||"[]"==t.request.statusCode?void(e.submitted=!0):(e.ConfirmForm.$valid?(t.promise=a.Code.Add(t.request).$promise,t.promise.then(function(t){switch(t.statusCode){case n.COMMON.SUCCESS:o.InfoModal("新建成功！","success"),e.submitted=!1,e.interaction.request.statusCode=[{codeDesc:"",code:""}],e.$broadcast("$ResetInitial_SelectMultistageCommonComponent");break;case n.STATUS_CODE.ERROR:o.InfoModal("新建失败，当前状态码已存在！","error");break;default:e.submitted=!0}})):e.submitted=!0,t.promise)},e.fun.operate=function(t,a){switch(t){case"last":if(!a.$last)return;e.interaction.request.statusCode.push({code:"",codeDesc:""});break;case"delete":e.interaction.request.statusCode.splice(a.$index,1)}},e.ok=function(){var s={request:{spaceKey:e.info.spaceKey,projectHashKey:e.info.projectHashKey,groupID:e.component.selectMultistageCommonComponentObject["new"].value},promise:null,isCheck:!1};if(e.ConfirmForm.$valid)if(e.info.isAdd){if(s.request.statusCode=JSON.stringify(e.interaction.request.statusCode.slice(0,e.interaction.request.statusCode.length-1),function(e,t){if("[object Object]"!=Object.prototype.toString.call(t)||t.code&&t.codeDesc||(s.isCheck=!0),"object"==("undefined"==typeof t?"undefined":_typeof(t))||/(code)|(codeDesc)/.test(e))return t}),s.isCheck||"[]"==s.request.statusCode)return void(e.submitted=!0);s.promise=a.Code.Add(s.request).$promise,s.promise.then(function(a){switch(a.statusCode){case n.COMMON.SUCCESS:t.close(!0);break;case n.STATUS_CODE.ERROR:o.InfoModal("新建失败，当前状态码已存在！","error");break;default:e.submitted=!0}})}else s.request.codeID=e.info.codeID,s.request.codeDesc=e.interaction.request.statusCode[0].codeDesc,s.request.code=e.interaction.request.statusCode[0].code,s.promise=a.Code.Edit(s.request).$promise,s.promise.then(function(a){switch(a.statusCode){case n.COMMON.SUCCESS:case n.STATUS_CODE.ERROR:t.close(!0);break;case"400705":o.InfoModal("编辑失败，当前状态码已存在！","error");break;default:e.submitted=!0}});else e.submitted=!0;return s.promise},e.cancel=function(){t.close(!1)},c.initQueryTable=function(){e.component.blockListObject.query={mainObject:{setting:{munalAddRow:!e.info.isAdd},itemStructure:{code:"",codeDesc:""},tdList:[{thKey:"状态码",type:"input",modelKey:"code",placeholder:"状态码",itemExpression:'maxlength="32" ng-class="{ \'eo-input-error\':($ctrl.otherObject.submitted&&!item.code'+(e.info.isAdd?"&&!$last":"")+')}"'},{thKey:"描述",type:"input",modelKey:"codeDesc",placeholder:"描述",itemExpression:'maxlength="255" ng-class="{ \'eo-input-error\':($ctrl.otherObject.submitted&&!item.codeDesc'+(e.info.isAdd?"&&!$last":"")+')}"'}].concat(e.info.isAdd?[{type:"btn","class":"w_80",btnList:[{key:"删除",operateName:"delete"}]}]:[])}}},c.init=function(){i.codeID&&(e.interaction.request.statusCode=[{code:i.code,codeDesc:i.codeDescription}],e.info={spaceKey:i.spaceKey,projectHashKey:i.projectHashKey,codeID:i.codeID,isAdd:!1},e.info.groupID=i.groupID),e.query=r.get(),c.initQueryTable()}()}function AMS_ShareProjectModalCtrl(e,t,a,o,n,s,i){function r(){p=l.cache.get("projectInfo"),p&&(e.info={link:c+p.projectShareCode,isShared:p.isShared,isShareLocked:p.isShareLocked,projectSharePassword:"1"==p.isShareLocked?p.projectSharePassword:""},e.data.env={envList:[{envID:-2,envName:"不可切换环境"},{envID:-1,envName:"显示所有环境"}].concat(p.envList||[]),templateEnvID:p.envID?0==p.envID.length?-2:1==p.envSettingType?-1:p.envID[0]:-2},e.data.shareContentQuery=[{key:"查看 API 文档",checkbox:!!p.viewSetting.apiView},{key:"发起 API 测试",checkbox:!!p.viewSetting.apiTestView},{key:"查看状态码文档",checkbox:!!p.viewSetting.statusCodeView},{key:"查看项目文档",checkbox:!!p.viewSetting.projectPageView}]),1==e.info.isShared?(e.isShare=!0,"1"==e.info.isShareLocked?e.islock=!0:e.islock=!1):e.isShare=!1}e.info={};var c=eoSystemObj.INHERIT_HOST+"#/share/index?shareCode=";e.isCopy=!1;var p={};e.data={showMore:!1,env:null,shareContentQuery:[{key:"查看 API 文档"},{key:"发起 API 测试"},{key:"查看状态码文档"},{key:"查看项目文档"}]},e.input=i;var l={cache:n};e.fun={},e.isShare=!1,e.component={envSelectObj:{setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5" ng-if="item.isGlobal">全局</span>'}}},r(),e.fun={},e.fun.changeShareContent=function(t){e.data.isUnCheck=!1,1==t.$index&&t.item.checkbox?e.data.shareContentQuery[0].checkbox=!0:0==t.$index&&e.data.shareContentQuery[1].checkbox&&(e.data.shareContentQuery[0].checkbox=!0)},e.lock=function(){e.isShare?(e.islock?e.info.isShareLocked="0":e.info.isShareLocked="1",e.islock=!e.islock):(e.isShare=!0,e.info.isShared=1,e.info.isShareLocked="1",e.islock=!0)},e.share=function(){e.isShare?(e.info.isShared=0,e.islock=!1,e.info.isShareLocked="0"):e.info.isShared=1,e.isShare=!e.isShare,e.data.isUnCheck=!1},e.ok=function(){var n={request:{spaceKey:e.input.request.spaceKey,projectHashKey:e.input.request.projectHashKey,shareStatus:e.info.isShared,isLocked:e.info.isShareLocked,sharePassword:e.info.projectSharePassword,envID:[],viewSetting:{apiView:e.data.shareContentQuery[0].checkbox?1:0,apiTestView:e.data.shareContentQuery[1].checkbox?1:0,statusCodeView:e.data.shareContentQuery[2].checkbox?1:0,projectPageView:e.data.shareContentQuery[3].checkbox?1:0}},promise:null};if(e.data.isUnCheck=!(n.request.viewSetting.apiView||n.request.viewSetting.apiTestView||n.request.viewSetting.statusCodeView||n.request.viewSetting.projectPageView),e.data.isUnCheck&&e.info.isShared)return void t.InfoModal("分享内容不能为空，请勾选分享内容","error");if(n.request.viewSetting=JSON.stringify(n.request.viewSetting),e.editForm.$valid||!e.islock){switch(e.data.env.templateEnvID){case-2:n.request.envSettingType=0;break;case-1:n.request.envSettingType=1,e.data.env.envList.map(function(e,t){e.envID>0&&n.request.envID.push(e.envID)});break;default:n.request.envSettingType=2,n.request.envID.push(e.data.env.templateEnvID)}e.info.envSettingType=n.request.envSettingType,e.info.viewSetting=JSON.parse(n.request.viewSetting),e.info.envID=n.request.envID,n.request.envID=JSON.stringify(n.request.envID),n.promise=o.Project.Share(n.request).$promise,n.promise.then(function(t){switch(t.statusCode){case s.COMMON.SUCCESS:case s.PROJECT.ERROR:e.islock||(e.info.projectSharePassword=""),angular.extend(p,e.info),e.isCopy=!0,a.close(!0)}})}else e.submitted=!0},e.cancel=function(){e.isCopy=!0,a.close(!1)}}function AMS_AutomatedTest_BeforeCaseModalCtrl(e,t,a,o,n,s){t.interaction={response:{caseList:s.caseList}},t.data={current:null,title:"add-before"==s.status?"前":"后"},t.fun={},t.fun.confirm=function(){var i={promise:null};return t.data.current?(s.request.commonCaseID=t.data.current.caseID,i.promise=s.resource.AutomatedTestCase.AddCommonCase(s.request).$promise,i.promise.then(function(s){switch(s.statusCode){case a.COMMON.SUCCESS:o.InfoModal("插入"+t.data.title+"置用例成功！","success"),t.data.current.connID=s.connID,t.data.current.tempID=s.tempID,n.close(t.data.current);break;case"401306":o.InfoModal("插入失败，当前已存在此"+t.data.title+"置用例","error");break;default:o.InfoModal("插入失败，"+e.FAILURE,"error")}}),i.promise):void o.InfoModal("请选择"+t.data.title+"置用例再单击确定","error")},t.fun.click=function(e){t.data.current&&(t.data.current.isClick=!1),e.item.isClick=!0,t.data.current=e.item},t.fun.cancel=function(){n.close(!1)}}function AMS_ReportModalCtrl(e,t,a,o,n,s){s.config=s.config||{},t.interaction={response:{query:null}},t.data={authority:s.authority,status:s.config.status},t.fun={};var i={},r={};t.component={blockListObject:{}},r.initComponent=function(){t.component.blockListObject={mainObject:{tdList:[{thKey:"测试完成时间",type:"html",html:"{{item.testTime}}"},{thKey:"正确率",type:"html",html:"<span  ng-class=\"{'cg':item.successRate=='100.00','cr':item.successRate!='100.00','c9':item.successRate=='-'}\">{{item.successRate=='-'?item.successRate:(item.successRate+\"%\")}}</span>"},{type:"btn","class":"w_250",btnList:[{key:"下载所有记录",fun:t.fun.downloadInit,param:"'all',{item:inputArg.item}"},{key:"仅下载错误记录",fun:t.fun.downloadInit,param:"'failed',{item:inputArg.item}"}]}],setting:{trClass:"hover-tr-lbcc",trNgClass:"ng-class=\"{'eo_theme_lct_tra':$ctrl.activeObject.indexAddress[item.key]}\""}}},"task"!=t.data.status&&t.component.blockListObject.mainObject.tdList.splice(2,0,{thKey:"操作人",type:"html",html:"{{item.operator}}"})},t.fun.download=function(n){var i={promise:null};switch(n.status){case"failed":i.promise=s.resource.ExportFailedLog(s.request).$promise;break;default:i.promise=s.resource.Export(s.request).$promise}i.promise.then(function(n){switch(n.statusCode){case a.COMMON.SUCCESS:t.$broadcast("$DumpDirective_Click_TestWordFile",{response:{fileName:n.fileName}});break;default:o.InfoModal("下载失败，"+e.FAILURE,"error")}})},t.fun.downloadInit=function(e,a){switch(s.config.status){case"task":s.request.logID=a.item.logID;break;default:s.request.testID=a.item.testID}t.fun.download({status:e})},r.initComponent(),t.fun.clear=function(){return 0==t.interaction.response.query.length?void o.InfoModal("暂无任何测试记录","error"):void o.EnsureModal("清空测试报告",!1,"此操作无法恢复，确认清空？",{},function(n){n&&s.resource.Clear(s.request).$promise.then(function(n){switch(n.statusCode){case a.COMMON.SUCCESS:t.interaction.response.query=[];break;default:o.InfoModal("清空失败，"+e.FAILURE,"error")}})})},t.fun.cancel=function(){n.close(!1)},i.init=function(){s.resource.Query(s.request).$promise.then(function(e){t.interaction.response.query=e[s.config.listKey||"historyList"]||[]})}()}function AMS_TestExampleModalCtrl(e,t,a,o,n,s,i,r,c,p,l,u,m){s.data={isEdit:!1,menuType:"body",isAjaxQuerying:!1,submitted:!1,allObject:{header:!1,body:!1,url:!1,restful:!1}},s.input={},s.CONST={JSON_MATCH_POSITION_TYPE_ARR:r.JSON_MATCH_POSITION_TYPE_ARR,REQUEST_DATA_MENU_ARR:e.REQUEST_DATA_ARR,MATCH_TYPE_ARR:[{key:"不校验",value:"2"},{key:"校验状态码",value:"5"},{key:"校验 JSON",value:"3"},{key:"校验 XML",value:"4"},{key:"全文匹配",value:"0"},{key:"正则表达式匹配",value:"1"}],requestHeader:t.REQUEST_HEADER,matchRule:r.MATCH_RULE,scriptTypeQuery:[{key:"请求预处理",value:"0"},{key:"响应预处理",value:"1"}],requestTypeQuery:[{key:"Form-data",value:"0"},{key:"JSON",value:"2"},{key:"XML",value:"3"},{key:"Raw",value:"1"}],jsonToParamObject:{headerItem:{headerName:"",headerValue:"",checkbox:!0},requestItem:{checkbox:!0,paramKey:"",paramType:"0",paramInfo:"",childList:[]}},requestMethodQuery:a.METHOD_SELECT_QUERY,requestProtocolQuery:[{key:"HTTP",value:"0"},{key:"HTTPS",value:"1"}],matchLoopQuery:[{key:"仅校验第一个元素",value:"0"},{key:"校验所有元素",value:"1"}],jsonTypeQuery:[{key:"Object",value:"0"},{key:"Array",value:"1"}],statusCodeQuery:[{key:"200",value:"200"},{key:"302",value:"302"},{key:"404",value:"404"},{key:"500",value:"500"},{key:"502",value:"502"},{key:"自定义",value:"0"}]},s.component={blockListObject:{}},s.fun={};var d={ams:p},y={bodyParamObject:{},responseMatchRule:{}},f={manualChangeUrl:!1},h={},b={onlyYesAndNoTypeList:[{name:"否",value:"0"},{name:"是",value:"1"}],responseParamTypeList:[{name:"string",value:"0"},{name:"int",value:"1"},{name:"bool",value:"2"},{name:"float",value:"3"},{name:"array",value:"4"},{name:"object",value:"5"},{name:"null",value:"6"},{name:"number",value:"7"}]};s.fun.changeJsonMatchPositionType=function(e,t,a){var o=a?t:s.input.caseInfo.jsonResultVerification.positionType;switch(o){case 0:s.component.blockListObject.responseCheck.setting.isLevel=!0,s.component.blockListObject.responseCheck.itemStructure={paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0"};break;case 1:s.component.blockListObject.responseCheck.setting.isLevel=!1,s.component.blockListObject.responseCheck.itemStructure={paramKey:"",paramInfo:"",matchRule:"0"}}e||(s.input.caseInfo.matchRule=[Object.assign({},s.component.blockListObject.responseCheck.itemStructure,{listDepth:0})])},s.fun.formToOtherType=function(e){switch(e){case"body":try{s.input.caseInfo.caseData.restfulParam.map(function(e,t){e.paramType="0"})}catch(t){}s.fun.changeBodyType("0",angular.copy(s.input.caseInfo.caseData.restfulParam)),s.data.menuType="body";break;default:var a={paramType:"3",paramObject:n("paramLevelFilter")(s.input.caseInfo.caseData.params,{munalFilter:!0,munalReplaceKey:!0})};switch(e){case"json":a.paramType="2";break;case"xml":a.paramObject=[a.paramObject[0]]}s.fun.changeBodyType(a.paramType,a.paramObject)}},h.changeVarType=function(e){var t=e.item;if("0"!=s.input.caseInfo.caseData.requestType)switch(t.paramType.toString()){case"12":case"13":if(!t.templateChildList)return;s.input.caseInfo.caseData.params=s.input.caseInfo.caseData.params.slice(0,e.$index+1).concat(t.templateChildList||[]).concat(s.input.caseInfo.caseData.params.slice(e.$index+1,s.input.caseInfo.caseData.params.length)),t.templateChildList=null;break;default:if(t.templateChildList)return;for(var a=e.$index+1;a<s.input.caseInfo.caseData.params.length&&!(s.input.caseInfo.caseData.params[a].listDepth<=s.input.caseInfo.caseData.params[e.$index].listDepth);)a++;t.templateChildList=s.input.caseInfo.caseData.params.splice(e.$index+1,a-e.$index-1)}},s.fun.changeResponseMatchType=function(e,t){y.responseMatchRule[s.input.caseInfo.matchType]=angular.copy(s.input.caseInfo.matchRule),s.input.caseInfo.matchType=e;var a=(e||0).toString();switch("3"!==a?(y.positionType=s.input.caseInfo.jsonResultVerification.positionType,s.input.caseInfo.jsonResultVerification.positionType=0,s.fun.changeJsonMatchPositionType(!0,0,!0)):(y.hasOwnProperty("positionType")&&(s.input.caseInfo.jsonResultVerification.positionType=y.positionType),s.fun.changeJsonMatchPositionType(!0,y.positionType,!0)),a){case"3":case"4":s.component.blockListObject.responseCheck.setting.munalHideOperateColumn="4"==e,s.input.caseInfo.matchRule=angular.copy(t||y.responseMatchRule[e]||[{paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0",listDepth:0}]),"4"===e&&(s.input.caseInfo.matchRule[0].paramType="5");break;default:s.input.caseInfo.matchRule=y.responseMatchRule[e]||""}},s.fun.changeBodyType=function(e,t){switch(y.bodyParamObject[s.input.caseInfo.caseData.requestType]=angular.copy(s.input.caseInfo.caseData.params),e){case"0":case"2":case"3":"0"===e?s.component.blockListObject.body.mainObject.tdList[2].selectQuery=[{name:"[text]",value:"0"}]:s.component.blockListObject.body.mainObject.tdList[2].selectQuery=[{name:"[string]",value:"0"},{name:"[boolean]",value:"8"},{name:"[array]",value:"12"},{name:"[object]",value:"13"},{name:"[number]",value:"14"},{name:"[null]",value:"15"}],s.component.blockListObject.body.mainObject.setting.munalHideOperateColumn="3"==e,s.input.caseInfo.caseData.params=angular.copy(t||y.bodyParamObject[e]||[{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,listDepth:0}]),"3"===e?(s.input.caseInfo.caseData.params[0].paramType="13",s.component.blockListObject.body.mainObject.setting.isStaticFirstIndex=!0):delete s.component.blockListObject.body.mainObject.setting.isStaticFirstIndex;break;case"4":e="1"}s.input.caseInfo.caseData.requestType=e},s.fun.changeParamType=function(e){switch(e.item.paramType.toString()){case"4":break;case"6":e.item.paramInfo="",e.item.isLoop="0";break;default:e.item.isLoop="0"}e.item.matchRule="0"},s.fun.edit=function(e,t){switch(e){case"addChild":t.item.childList.push({paramKey:"",paramInfo:"",childList:[],matchRule:"0",parent:t.item.parent+t.item.paramKey+"."})}},s.fun.changeType=function(){/0|2/.test(s.input.caseInfo.caseData.apiRequestType)||(s.input.caseInfo.caseData.requestType="1"==s.input.caseInfo.caseData.requestType?"0":s.input.caseInfo.caseData.requestType)},s.fun.confirm=function(){if(s.baseForm.$invalid)return s.data.submitted=!0,void i.InfoModal("保存失败，请检查信息是否填写完整！","error");var e=null,t={spaceKey:s.input.baseInfo.spaceKey,projectHashKey:s.input.baseInfo.projectHashKey,apiID:s.input.baseInfo.apiID,caseName:s.input.caseInfo.caseName,caseData:angular.copy(s.input.caseInfo.caseData),statusCode:"",jsonResultVerification:"3"==s.input.caseInfo.matchType?JSON.stringify(s.input.caseInfo.jsonResultVerification):null,matchType:s.input.caseInfo.matchType,caseID:s.input.caseInfo.caseID,advancedSetting:JSON.stringify(s.input.caseInfo.advancedSetting)};switch(t.caseData.auth.status){case"1":t.caseData.auth={status:"1",basicAuth:t.caseData.auth.basicAuth};break;case"2":t.caseData.auth={status:"2",jwtAuth:t.caseData.auth.jwtAuth};break;default:t.caseData.auth={status:"0"}}switch(t.matchType.toString()){case"3":case"4":e=o.formatNestList(s.input.caseInfo.matchRule,{fun:function(e){if(!e.paramKey)return null}}),t.matchRule=JSON.stringify(e,function(e,t){return e&&isNaN(e)&&!/(paramKey)|(paramType)|(paramInfo)|(childList)|(matchRule)|(checkExist)|(checkParamType)|(isLoop)/.test(e)?void 0:t});break;case"0":case"1":e=t.matchRule=s.input.caseInfo.matchRule}switch(t.caseData.params=o.formatNestList(t.caseData.params,{fun:function(e){if(!e.paramKey)return null}}),t.caseData=JSON.stringify(t.caseData,function(e,t){if(!/(dbArr)|(\$index)|(default)|(paramNote)|(\$\$hashKey)|(isFocus)|(headerID)|(paramID)|(paramName)|(paramLimit)|(paramValue)|(paramNotNull)|(paramNotNull)|(_expressionBuilderObject)|(templateChildList)|(paramValueList)|(listDepth)/.test(e))return t}),s.input.status){case"add":case"copy":t.statusCode="0"!=s.input.caseInfo.statusCode?s.input.caseInfo.statusCode:s.input.caseInfo.code,c.TestCase.Add(t).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:i.InfoModal("新建测试用例成功！","success"),u.close({caseName:t.caseName,creator:e.creator,caseID:e.caseID})}});break;case"edit":t.statusCode=s.input.caseInfo.code,c.TestCase.Edit(t).$promise.then(function(a){switch(a.statusCode){case l.COMMON.SUCCESS:t.matchRule=e,t.advancedSetting=JSON.parse(t.advancedSetting),t.caseData=JSON.parse(t.caseData),i.InfoModal("编辑测试用例成功！","success"),u.close({output:t})}})}},s.fun.cancel=function(){u.close(!1)},s.fun.changeUri=function(){f.manualChangeUrl=!0,s.input.caseInfo.caseData.urlParam=d.ams.urlParamObject.fun.reset(s.input.caseInfo.caseData.URL,s.input.caseInfo.caseData.urlParam).concat({paramKey:"",paramInfo:"",checkbox:!0})},h.construct=function(e,t){var a={mark:"testcase"};t.item[e+"_expressionBuilderObject"]=t.item[e+"_expressionBuilderObject"]||{request:{},response:{}},a.request=t.item[e+"_expressionBuilderObject"].request,a.request.constant=t.item[e],a.response=t.item[e+"_expressionBuilderObject"].response,i.ExpressionBuilderModal(a,function(a){t.item[e]=a.response.result||t.item[e],t.item[e+"_expressionBuilderObject"]=a,t.callback&&t.callback({$index:t.$index,item:t.item})})},h.reduceItemWhenIsOprDepth=function(e,t,a){return e.indexOf(a.paramType)===-1&&(a.paramType=t),!0},h.initBodyTable=function(){s.component.blockListObject.body={mainObject:{baseFun:{reduceItemWhenAddChildItem:function(e){h.reduceItemWhenIsOprDepth(["2","12","13"],"13",e)}},setting:{},itemStructure:{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox",itemDisabledExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?'':'input-checkbox'"},{thKey:"参数名",type:"depthInput",modelKey:"paramKey",btnList:[{key:"构造器",fun:h.construct,param:'"paramKey",inputArg'}],placeholder:"参数名","class":"w_300"},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType",selectQuery:[],modelKey:"paramType","class":"w_150",fun:h.changeVarType,selectQueryExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?[{name:'object',value:'13'}]:$ctrl.mainObject.tdList[2].selectQuery"},{thKey:"参数值",type:"input",modelKey:"paramInfo",placeholder:"参数值",btnList:[{key:"构造器",fun:h.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_200",btnList:[{key:"添加子字段",operateName:"addChild","class":"po_re",itemExpression:"ng-if=\"item.listDepth<4&&$ctrl.otherObject.bodyParamType!=='0'\""},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]}}},h.initCommonParamTable=function(){return{mainObject:{itemStructure:{paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox"},{thKey:"参数名",type:"input",modelKey:"paramKey",placeholder:"参数名","class":"w_300",btnList:[{key:"构造器",fun:h.construct,param:'"paramKey",inputArg'}]},{thKey:"参数值",type:"input",modelKey:"paramInfo",placeholder:"参数值",btnList:[{key:"构造器",fun:h.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete"}]}]}}},h.initHeaderTable=function(){return{mainObject:{itemStructure:{headerName:"",headerValue:"",checkbox:!0},tdList:[{type:"checkbox",modelKey:"checkbox"},{thKey:"标签",type:"autoComplete",selectQuery:t.REQUEST_HEADER,modelKey:"headerName","class":"w_300",placeholder:"头部标签",btnList:[{key:"构造器",fun:h.construct,param:'"headerName",inputArg'}]},{thKey:"内容",type:"input",modelKey:"headerValue",placeholder:"头部内容",btnList:[{key:"构造器",fun:h.construct,param:'"headerValue",inputArg'}]},{type:"btn","class":"w_150",
btnList:[{key:"删除",operateName:"delete"}]}]}}},h.initResponseCheckTable=function(){var e={baseFun:{reduceItemWhenAddChildItem:function(e){h.reduceItemWhenIsOprDepth(["4","5"],"5",e)}},setting:{isLevel:!0},itemStructure:{paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0"},tdList:[{thKey:'{{$ctrl.otherObject.positionType===1?"Json Path":"参数名"}}',type:"depthInput",modelKey:"paramKey",placeholder:"{{$ctrl.otherObject.positionType===1?'Json Path':'参数名'}}",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramInfo}\""},{thKey:"存在性校验",type:"select",key:"name",value:"value",initialData:"item.checkExist||'1'",selectQuery:b.onlyYesAndNoTypeList,modelKey:"checkExist","class":"w_100",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"类型校验",type:"select",key:"name",value:"value",initialData:"item.checkParamType||'0'",selectQuery:b.onlyYesAndNoTypeList,modelKey:"checkParamType","class":"w_100",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType||'0'",selectQuery:b.responseParamTypeList,modelKey:"paramType","class":"w_100",selectQueryExpression:"$first&&$ctrl.otherObject.matchType===4?[{name:'object',value:'5'}]:$ctrl.mainObject.tdList[3].selectQuery",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'}]};return e.tdList=e.tdList.concat([{thKey:"循环校验",type:"select",key:"name",value:"value",initialData:"item.isLoop||'0'",selectQuery:b.onlyYesAndNoTypeList,modelKey:"isLoop","class":"w_100",disabled:"item.paramType!='4'",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"内容校验",type:"select",key:"key",value:"value",initialData:"item.matchRule||'0'",selectQueryExpression:"$ctrl.otherObject.positionType===0?$ctrl.otherObject.matchRule[item.paramType]:$ctrl.otherObject.matchRule['jsonPath']",modelKey:"matchRule","class":"w_150"},{thKey:"预期结果",type:"input",modelKey:"paramInfo",placeholder:"预期结果",btnList:[{key:"构造器",fun:h.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_150",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'ng-if="item.listDepth<4&&$ctrl.mainObject.setting.isLevel"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]),e},h.initCaseInfo=function(){m.caseInfo=m.caseInfo||{caseData:{auth:{status:"0"},headers:[],URL:"",params:[],httpHeader:"0",requestType:"0",apiRequestType:"0",script:{before:"",after:"",script:"0"}},statusCode:"200",matchType:2,jsonResultVerification:{resultType:"0",matchRule:"0"},advancedSetting:{requestRedirect:1}},m.caseInfo.jsonResultVerification=m.caseInfo.jsonResultVerification||{resultType:"0",matchRule:"0"},m.caseInfo.advancedSetting=m.caseInfo.advancedSetting||{requestRedirect:1};try{m.caseInfo.matchType=m.caseInfo.matchType.toString()}catch(e){}angular.copy(m,s.input);try{if("test"===m.from)s.input.caseInfo.caseData=s.input.caseData,s.fun.changeBodyType(s.input.caseInfo.caseData.requestType,s.input.caseInfo.caseData.params);else{var t=function(e){e.paramValueQuery=[],angular.forEach(e.paramValueList,function(t,a){e.paramValueQuery.push(t.value)}),e.paramInfo=e.paramInfo||e.paramValue||e.paramValueQuery[e["default"]],e.checkbox=e.checkbox||"0"==e.paramNotNull};s.input.caseInfo.caseData.headers=o.initEditTableList(s.input.caseInfo.caseData.headers||[],{itemStructure:s.component.blockListObject.requestHeader.mainObject.itemStructure,lastFilterKey:"headerName",fun:"add"===m.status?function(e){e.hasOwnProperty("checkbox")||(e.checkbox=!parseInt(e.paramNotNull||"0"))}:null}),s.input.caseInfo.caseData.restfulParam=o.initEditTableList(s.input.caseInfo.caseData.restfulParam||[],{fun:t,itemStructure:s.component.blockListObject.restful.mainObject.itemStructure,lastFilterKey:"paramKey"}),s.input.caseInfo.caseData.urlParam=o.initEditTableList(s.input.caseInfo.caseData.urlParam||[],{fun:t,itemStructure:s.component.blockListObject.queryParam.mainObject.itemStructure,lastFilterKey:"paramKey"}),"3"==s.input.caseInfo.caseData.requestType&&s.input.caseInfo.caseData.params.length>1&&s.input.caseInfo.caseData.params.splice(s.input.caseInfo.caseData.params.length-1,1);var a=null;switch((s.input.caseInfo.caseData.requestType||0).toString()){case"0":a=function(e){e.paramType="0"};break;default:a=function(e){switch(e.paramType){case"1":case"6":case"7":case"9":e.paramType="0";break;case"3":case"4":case"5":case"10":case"11":e.paramType="14";break;case"2":e.paramType="13";break;case"0":case"8":case"12":case"13":case"14":case"15":break;default:e.paramType="0"}}}var n=null,r=null;switch(m.status){case"add":var c=function(e){try{e.paramInfo=e.paramValue||e.paramValueList[e["default"]].value||""}catch(t){}switch(e.paramNotNull.toString()){case"0":e.checkbox=!0;break;default:e.checkbox=!1}return a(e),e},p=function(e,t,a){if(e.structureID){var o=[],n=angular.copy(m.dataStructureList)[e.structureID].structureData;for(var s in n){var i=n[s],r=e.updateData[i.paramID];r&&r.structureIsHide||(i.listDepth=t+(i.listDepth||0),o.push(a(Object.assign({},i,r))))}return o}a(e)},l=function(e){switch("0"===e.paramNotNull?e.checkExist="1":e.checkExist="0",e.paramType){case"0":case"1":case"6":case"7":case"9":e.paramType="0";break;case"3":e.paramType="1";break;case"4":e.paramType="3";break;case"5":case"10":case"11":case"14":e.paramType="7";break;case"2":case"13":e.paramType="5";break;case"8":e.paramType="2";break;case"12":e.paramType="4";break;case"15":e.paramType="6";break;default:e.paramType="0"}return e};r=function(e,t){return p(e,t,l)},n=function(e,t){return p(e,t,c)};break;default:n=a,r=function(e){e.checkExist||("0"===e.paramNotNull?e.checkExist="1":e.checkExist="0")}}s.fun.changeBodyType(s.input.caseInfo.caseData.requestType,o.initEditTableList(s.input.caseInfo.caseData.params||[],{isLoop:!0,munalHideOperateColumn:"3"==s.input.caseInfo.caseData.requestType&&0!==s.input.caseInfo.caseData.params.length,lastFilterKey:"paramKey",itemStructure:s.component.blockListObject.body.mainObject.itemStructure,fun:n})),s.fun.changeJsonMatchPositionType(!0),s.input.caseInfo.jsonResultVerification.positionType=s.input.caseInfo.jsonResultVerification.positionType||0,/(3)|(4)/.test(s.input.caseInfo.matchType)&&("4"==s.input.caseInfo.matchType&&s.input.caseInfo.matchRule.length>1&&s.input.caseInfo.matchRule.splice(s.input.caseInfo.matchRule.length-1,1),s.fun.changeResponseMatchType(s.input.caseInfo.matchType,o.initEditTableList(s.input.caseInfo.matchRule||[],{munalHideOperateColumn:4==s.input.caseInfo.matchType,lastFilterKey:"paramKey",itemStructure:s.component.blockListObject.responseCheck.itemStructure,fun:r})))}s.input.caseInfo.caseData.script=s.input.caseInfo.caseData.script||{before:"",after:""},s.input.caseInfo.caseData.script.type="0"}catch(u){s.input.caseInfo.caseData={auth:{status:"0"},headers:[],URL:"",params:[],restfulParam:[],httpHeader:"0",requestType:"0",apiRequestType:"0",script:{before:"",after:"",script:"0"}}}s.input.caseInfo.caseData.urlParam=d.ams.urlParamObject.fun.reset(s.input.caseInfo.caseData.URL,s.input.caseInfo.caseData.urlParam,!0).concat({paramKey:"",paramInfo:"",checkbox:!0}),s.input.caseInfo.caseData.URL=d.ams.urlParamObject.fun.$watch({params:s.input.caseInfo.caseData.urlParam||[],url:s.input.caseInfo.caseData.URL}),i.global.$watch.push(s.$watch("input.caseInfo.caseData.urlParam",function(){if(f.manualChangeUrl)return void(f.manualChangeUrl=!1);try{s.input.caseInfo.caseData.URL=d.ams.urlParamObject.fun.$watch({params:s.input.caseInfo.caseData.urlParam||[],url:s.input.caseInfo.caseData.URL})}catch(e){}},!0)),"test"!==m.from&&("add"!==m.status&&(s.input.caseInfo.code=s.input.caseInfo.statusCode),"edit"===m.status&&(s.data.isEdit=!0))},s.fun.pullApi=function(){i.Ams_PullApiSettingModal({type:"apiCase"},function(e){if(e){var t={spaceKey:m.baseInfo.spaceKey,projectHashKey:m.baseInfo.projectHashKey,caseID:m.baseInfo.caseID,apiID:m.baseInfo.apiID,synchronizeSetting:JSON.stringify(e)};c.TestCase.GetSynchronizeData(t).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:var a={baseInfo:{apiName:["caseName"]},requestParam:{advancedSetting:["advancedSetting"]}};for(var o in a)for(var n in a[o])0!==e[o][n]&&a[o][n].forEach(function(e){m.caseInfo[e]=t.caseInfo[e]});m.caseInfo.caseData=t.caseInfo.caseData,m.caseInfo.caseData.script.type=m.caseInfo.caseData.script.type||"0",s.$broadcast("$Maunal_AceEditorAms_Code_Ace_Editor_Js",m.caseInfo.caseData.script.before),h.initCaseInfo(),i.InfoModal("同步结果已显示在界面中","success");break;default:i.InfoModal("操作失败，"+RESPONSE_TEXT.FAILURE,"error")}})}})},h.init=function(){h.initBodyTable(),s.component.blockListObject.requestHeader=h.initHeaderTable("requestHeader"),s.component.blockListObject.queryParam=h.initCommonParamTable(),s.component.blockListObject.restful=h.initCommonParamTable(),s.component.blockListObject.responseCheck=h.initResponseCheckTable(),m.caseInfo?h.initCaseInfo():(s.data.isAjaxQuerying=!0,c.TestCase.Detail({spaceKey:m.baseInfo.spaceKey,projectHashKey:m.baseInfo.projectHashKey,caseID:m.baseInfo.caseID}).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:s.data.isAjaxQuerying=!1,m.caseInfo=e.caseInfo,h.initCaseInfo()}}));var e=JSON.stringify(s.CONST.jsonToParamObject.requestItem);s.CONST.INSERT_TYPE_ARR=[{expression:'ng-show="$ctrl.otherObj.requestType ==2" set-to-params="paramKey" item=\''+e+'\' reset-result="$ctrl.otherObj.params" set-value="paramInfo" level-status="nest"'},{expression:' ng-show="$ctrl.otherObj.requestType ==3" import-method="3" set-to-params="paramKey" item=\''+e+'\' reset-result="$ctrl.otherObj.params" set-value="paramInfo" level-status="nest"'}]}()}angular.module("eolinker.modal").controller("Ams_PullApiSettingModalCtrl",Ams_PullApiSettingModalCtrl).controller("AMS_ShowDbFieldModalCtrl",AMS_ShowDbFieldModalCtrl).controller("AMS_GlobalSearchModalCtrl",AMS_GlobalSearchModalCtrl).controller("AMS_ChartAndTableModalCtrl",AMS_ChartAndTableModalCtrl).controller("AMS_MockPreviewModalCtrl",AMS_MockPreviewModalCtrl).controller("AMS_MockSettingModalCtrl",AMS_MockSettingModalCtrl).controller("AMS_PlugApiStatusModalCtrl",AMS_PlugApiStatusModalCtrl).controller("AMS_AutomatedTest_BeforeCaseModalCtrl",AMS_AutomatedTest_BeforeCaseModalCtrl).controller("AMS_ReportModalCtrl",AMS_ReportModalCtrl).controller("AMS_TestExampleModalCtrl",AMS_TestExampleModalCtrl).controller("AMS_ShareProjectModalCtrl",AMS_ShareProjectModalCtrl).controller("AMS_CodeModalCtrl",AMS_CodeModalCtrl).controller("AMS_ApiSearchModalCtrl",AMS_ApiSearchModalCtrl).controller("AMS_AutomatedTest_EditCaseModalCtrl",AMS_AutomatedTest_EditCaseModalCtrl).controller("AMS_ExportModalCtrl",AMS_ExportModalCtrl).controller("AMS_SelectDbFieldModalCtrl",AMS_SelectDbFieldModalCtrl).controller("Ams_SqlUseTipModalCtrl",Ams_SqlUseTipModalCtrl).controller("Ams_InsertSqlCodeModalCtrl",Ams_InsertSqlCodeModalCtrl).controller("Ams_Plug_TipsModalCtrl",Ams_Plug_TipsModalCtrl).controller("Ams_TestPlanModalCtrl",Ams_TestPlanModalCtrl).controller("Ams_ResponseDemoModalCtrl",Ams_ResponseDemoModalCtrl).controller("Ams_GenerateApiModalCtrl",Ams_GenerateApiModalCtrl),Ams_GenerateApiModalCtrl.$inject=["$scope","$uibModalInstance","input"],Ams_PullApiSettingModalCtrl.$inject=["$scope","$rootScope","$uibModalInstance","input"],Ams_ResponseDemoModalCtrl.$inject=["$scope","AMS_MAX_API_DEMO_SIZE","HTTP_CONSTANT","$rootScope","$uibModalInstance","input"],Ams_TestPlanModalCtrl.$inject=["$scope","$rootScope","AutomatedTestResource","Authority_CommonService","RESPONSE_TEXT","CODE","$uibModalInstance","input"],Ams_Plug_TipsModalCtrl.$inject=["$scope","$rootScope","$uibModalInstance","input"],Ams_InsertSqlCodeModalCtrl.$inject=["$scope","PUBLIC_RESOURCE_DB_TYPE_ARR","$rootScope","$uibModalInstance","input"],Ams_SqlUseTipModalCtrl.$inject=["$scope","$uibModalInstance"],AMS_ShowDbFieldModalCtrl.$inject=["$scope","$uibModalInstance","input"],AMS_SelectDbFieldModalCtrl.$inject=["$scope","$rootScope","ApiManagementResource","$uibModalInstance","input"],AMS_GlobalSearchModalCtrl.$inject=["$scope","$rootScope","$state","$filter","$uibModalInstance","CODE","API_AMS_CONSTANT","RESPONSE_TEXT","input"],AMS_MockPreviewModalCtrl.$inject=["$scope","$state","AUTOMATE_TEST_CONSTANT","ListBlock_CommonComponentService","$uibModalInstance","ApiManagementResource","input"],AMS_MockSettingModalCtrl.$inject=["$scope","AUTOMATE_TEST_CONSTANT","RESPONSE_TEXT","$uibModalInstance","CODE","$filter","ApiManagementResource","COMMON_PARAM_TYPE_ARR","ListBlock_CommonComponentService","HTTP_CONSTANT","$rootScope","input"],AMS_ChartAndTableModalCtrl.$inject=["$scope","$uibModalInstance","input"],AMS_PlugApiStatusModalCtrl.$inject=["$scope","$state","$uibModalInstance","input"],AMS_ExportModalCtrl.$inject=["$scope","$uibModalInstance","CODE","$rootScope","input","$state"],AMS_AutomatedTest_EditCaseModalCtrl.$inject=["$scope","$uibModalInstance","input"],AMS_ApiSearchModalCtrl.$inject=["$scope","$uibModalInstance","Cache_CommonService","API_AMS_CONSTANT","input"],AMS_CodeModalCtrl.$inject=["$scope","$uibModalInstance","ApiManagementResource","$rootScope","CODE","title","info","GroupService"],AMS_ShareProjectModalCtrl.$inject=["$scope","$rootScope","$uibModalInstance","ApiManagementResource","Cache_CommonService","CODE","input"],AMS_AutomatedTest_BeforeCaseModalCtrl.$inject=["RESPONSE_TEXT","$scope","CODE","$rootScope","$uibModalInstance","input"],AMS_ReportModalCtrl.$inject=["RESPONSE_TEXT","$scope","CODE","$rootScope","$uibModalInstance","input"],AMS_TestExampleModalCtrl.$inject=["API_DATA_CONST","HTTP_CONSTANT","API_AMS_CONSTANT","ListBlock_CommonComponentService","$filter","$scope","$rootScope","AUTOMATE_TEST_CONSTANT","ApiManagementResource","Operate_CommonService","CODE","$uibModalInstance","input"]}();
"use strict";!function(){function e(e,t){t.Ams_GenerateApiModal=function(t,o){var n=e.open({animation:!0,templateUrl:"Ams_GenerateApiModal",controller:"Ams_GenerateApiModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_PullApiSettingModal=function(t,o){var n=e.open({animation:!0,templateUrl:"Ams_PullApiSettingModal",controller:"Ams_PullApiSettingModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_ResponseDemoModal=function(t,o){var n=e.open({animation:!0,keyboard:!1,templateUrl:"Ams_ResponseDemoModal",controller:"Ams_ResponseDemoModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_TestPlanModal=function(t,o){var n=e.open({animation:!0,templateUrl:"Ams_TestPlanModal",controller:"Ams_TestPlanModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_Plug_TipsModal=function(t,o){var n=e.open({animation:!0,templateUrl:"Ams_Plug_TipsModal",controller:"Ams_Plug_TipsModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_InsertSqlCodeModal=function(t,o){var n=e.open({animation:!0,keyboard:!1,templateUrl:"Ams_InsertSqlCodeModal",controller:"Ams_InsertSqlCodeModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.Ams_SqlUseTipModal=function(t){var o=e.open({animation:!0,templateUrl:"Ams_SqlUseTipModal",controller:"Ams_SqlUseTipModalCtrl"});o.result.then(t)},t.AMS_ShowDbFieldModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ShowDbFieldModal",controller:"AMS_ShowDbFieldModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_SelectDbFieldModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_SelectDbFieldModal",controller:"AMS_SelectDbFieldModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_GlobalSearchModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_GlobalSearchModal",controller:"AMS_GlobalSearchModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_MockPreviewModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_MockPreviewModal",controller:"AMS_MockPreviewModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_MockSettingModal=function(t,o){var n=e.open({animation:!0,keyboard:!1,templateUrl:"AMS_MockSettingModal",controller:"AMS_MockSettingModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_ChartAndTableModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ChartAndTableModal",controller:"AMS_ChartAndTableModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_PlugApiStatusModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_PlugApiStatusModal",controller:"AMS_PlugApiStatusModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_ExportModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ExportModal",controller:"AMS_ExportModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_AutomatedTest_EditCaseModal=function(t,o){var n=e.open({animation:!0,keyboard:!1,templateUrl:"AMS_AutomatedTest_EditCaseModal",controller:"AMS_AutomatedTest_EditCaseModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_ApiSearchModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ApiSearchModal",controller:"AMS_ApiSearchModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_CodeModal=function(t,o,n){var l=e.open({animation:!0,templateUrl:"AMS_CodeModal",controller:"AMS_CodeModalCtrl",resolve:{title:function(){return t},info:function(){return o}}});l.result.then(n)},t.AMS_ShareProjectModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ShareProjectModal",controller:"AMS_ShareProjectModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_AutomatedTest_BeforeCaseModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_AutomatedTest_BeforeCaseModal",controller:"AMS_AutomatedTest_BeforeCaseModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_ReportModal=function(t,o){var n=e.open({animation:!0,templateUrl:"AMS_ReportModal",controller:"AMS_ReportModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)},t.AMS_TestExampleModal=function(t,o){var n=e.open({animation:!0,keyboard:!1,templateUrl:"AMS_TestExampleModal",controller:"AMS_TestExampleModalCtrl",resolve:{input:function(){return t}}});n.result.then(o)}}angular.module("eolinker.modal").component("eoAmsModal",{controller:e}),e.$inject=["$uibModal","$rootScope"]}();
"use strict";!function(){function e(e,a){var t={method:"POST"},o=[];return o.Comment=e(a+"apiManagementPro/ApiComment/:operate",{},{Query:{params:{operate:"getCommentList"},method:t.method,cancellable:!0},Add:{params:{operate:"addComment"},method:t.method},Edit:{params:{operate:"editComment"},method:t.method},Delete:{params:{operate:"deleteComment"},method:t.method}}),o.Package=e(a+"apiManagementPro/FileManagement/:operate",{},{Upload:{params:{operate:"uploadFileToDoc"},method:t.method,cancellable:!0,transformRequest:angular.identity,selfUploadEventHandler:!0,headers:{"Content-Type":void 0}}}),o.MockExpectation=e(a+"apiManagementPro/MockExpectation/:operate",{},{Query:{params:{operate:"getExpectationList"},method:t.method,cancellable:!0},Add:{params:{operate:"addExpectation"},method:t.method,cancellable:!0},Edit:{params:{operate:"editExpectation"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteExpectation"},method:t.method,cancellable:!0},Info:{params:{operate:"getExpectationInfo"},method:t.method,cancellable:!0}}),o.TestCase=e(a+"apiManagementPro/TestCase/:operate",{},{GetSynchronizeData:{params:{operate:"getSynchronizeData"},method:t.method,cancellable:!0},SynchronizeData:{params:{operate:"synchronizeData"},method:t.method,cancellable:!0},CaseData:{params:{operate:"getTestCaseData"},method:t.method,cancellable:!0},BatchQuery:{params:{operate:"batchGetTestCaseList"},method:t.method,cancellable:!0},Detail:{params:{operate:"getTestCaseInfo"},method:t.method,cancellable:!0},Query:{params:{operate:"getTestCaseList"},method:t.method,cancellable:!0},QueryPartA:{params:{operate:"getApiListByCondition"},method:t.method,cancellable:!0},QueryApiID:{params:{operate:"getApiIDByCondition"},method:t.method,cancellable:!0},Add:{params:{operate:"addTestCase"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyTestCase"},method:t.method,cancellable:!0},InfoReport:{params:{operate:"getTestCaseReportInfo"},method:t.method,cancellable:!0},Edit:{params:{operate:"editTestCase"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteTestCase"},method:t.method,cancellable:!0}}),o.Import=e(a+"apiManagementPro/Import/:operate",{},{Eoapi:{params:{operate:"importEoapi"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Postman:{params:{operate:"importPostMan"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Dhc:{params:{operate:"importDHC"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Rap:{params:{operate:"importRAP"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Swagger:{params:{operate:"importSwagger"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Yapi:{params:{operate:"importYapi"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}}}),o.Project=e(a+"apiManagementPro/Project/:operate",{},{SetConfig:{params:{operate:"updateProjectSetting"},method:t.method,cancellable:!0},ConfirmProjectSetting:{params:{operate:"confirmProjectSetting"},method:t.method,cancellable:!0},ChangeGroup:{params:{operate:"changeGroup"},method:t.method,cancellable:!0},GlobalSearch:{params:{operate:"globalSearch"},method:t.method,cancellable:!0},All:{params:{operate:"getAllProject"},method:t.method,cancellable:!0},Query:{params:{operate:"getProjectList"},method:t.method,cancellable:!0},Edit:{params:{operate:"editProject"},method:t.method,cancellable:!0},Add:{params:{operate:"addProject"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteProject"},method:t.method,cancellable:!0},BatchDelete:{params:{operate:"batchDeleteProject"},method:t.method,cancellable:!0},Detail:{params:{operate:"getProject"},method:t.method,cancellable:!0},Share:{params:{operate:"editProjectShare"},method:t.method,cancellable:!0},setShareStatus:{params:{operate:"setProjectShareStatus"},method:t.method,cancellable:!0},Code:{params:{operate:"getNewShareCode"},method:t.method,cancellable:!0},Dump:{params:{operate:"dumpProject"},method:t.method,cancellable:!0},GetProjectLogList:{params:{operate:"getProjectLogList"},method:t.method,cancellable:!0},BatchFile:{params:{operate:"batchEditArchiveStatus"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyProject"},method:t.method,cancellable:!0},Search:{params:{operate:"quickSearch"},method:t.method,cancellable:!0}}),o.Export=e(a+"apiManagementPro/Export/:operate",{},{Html:{params:{operate:"exportProjectHTML"},method:t.method,cancellable:!0},Export:{params:{operate:"exportProjectData"},method:t.method,cancellable:!0},Pdf:{params:{operate:"exportProjectPDF"},method:t.method,cancellable:!0},Word:{params:{operate:"exportProjectWord"},method:t.method,cancellable:!0},Markdown:{params:{operate:"exportProjectMarkdown"},method:t.method,cancellable:!0},OpenApi:{params:{operate:"exportOpenApi"},method:t.method,cancellable:!0}}),o.Annotation=e(a+"apiManagementPro/Annotation/:operate",{},{Edit:{params:{operate:"saveSetting"},method:t.method,cancellable:!0},Synchronize:{params:{operate:"synchronizeApiData"},method:t.method,cancellable:!0}}),o.Iteration=e(a+"apiManagementPro/IterationPlan/:operate",{},{Add:{params:{operate:"addIterationPlan"},method:t.method,cancellable:!0},QueryApiID:{params:{operate:"getAllFliterApiID"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteIterationPlan"},method:t.method,cancellable:!0},Query:{params:{operate:"getAllPlanList"},method:t.method,cancellable:!0},QueryDetailed:{params:{operate:"getIterationPlanList"},method:t.method,cancellable:!0},Detail:{params:{operate:"getPlanInfo"},method:t.method,cancellable:!0},Edit:{params:{operate:"editIterationPlan"},method:t.method,cancellable:!0},AddAndBind:{params:{operate:"createPlanAndAddApi"},method:t.method,cancellable:!0},BatchBindApi:{params:{operate:"batchAddApiToPlan"},method:t.method,cancellable:!0},BatchUntiedApi:{params:{operate:"batchDeleteApiInPlan"},method:t.method,cancellable:!0}}),o.Notification=e(a+"apiManagementPro/Notification/:operate",{},{GetUnJoinedNoticeMember:{params:{operate:"getProjectMemberList"},method:t.method,cancellable:!0},UpdateNoticeSetting:{params:{operate:"updateNoticeSetting"},method:t.method},DeleteNoticeMember:{params:{operate:"deleteNoticeMember"},method:t.method,cancellable:!0},EditNoticeEvent:{params:{operate:"updateMemberNoticeEvent"},method:t.method,cancellable:!0},GetNoticeMember:{params:{operate:"getNoticeMemberList"},method:t.method,cancellable:!0},NoticeMember:{params:{operate:"noticeMember"},method:t.method,cancellable:!0},AddNoticeMember:{params:{operate:"addNoticeMember"},method:t.method,cancellable:!0}}),o.Api=e(a+"apiManagementPro/Api/:operate",{},{GetField:{params:{operate:"getFieldInfo"},method:t.method,cancellable:!0},GetDBObjectQuery:{params:{operate:"getDatabaseObjectList"},method:t.method,cancellable:!0},GetParamData:{params:{operate:"getApiParamData"},method:t.method,cancellable:!0},SelectApiList:{params:{operate:"getApiList"},method:t.method,cancellable:!0},getSearchConditionList:{params:{operate:"getSearchConditionList"},method:t.method,cancellable:!0},AddMock:{params:{operate:"saveSimpleMock"},method:t.method,cancellable:!0},Query:{params:{operate:"getApiListByCondition"},method:t.method,cancellable:!0},QueryApiID:{params:{operate:"getApiIDByCondition"},method:t.method,cancellable:!0},Add:{params:{operate:"addApi"},method:t.method,cancellable:!0},Delete:{params:{operate:"removeApi"},method:t.method,cancellable:!0},Edit:{params:{operate:"editApi"},method:t.method,cancellable:!0},Detail:{params:{operate:"getApi"},method:t.method,cancellable:!0},HistoryDetail:{params:{operate:"getHistoryInfo"},method:t.method,cancellable:!0},HistoryList:{params:{operate:"getApiHistoryList"},method:t.method,cancellable:!0},DeleteHistory:{params:{operate:"deleteApiHistory"},method:t.method,cancellable:!0},toggleHistory:{params:{operate:"toggleApiHistory"},method:t.method,cancellable:!0},Mock:{params:{operate:"getApiMockData"},method:t.method,cancellable:!0},RefreshMock:{params:{operate:"editApiMockData"},method:t.method,cancellable:!0},Check:{params:{operate:"checkApiExist"},method:t.method,cancellable:!0},Import:{params:{operate:"importApi"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportApi"},method:t.method,cancellable:!0},Move:{params:{operate:"changeApiGroup"},method:t.method,cancellable:!0},Markdown:{params:{operate:"exportMarkdown"},method:t.method,cancellable:!0},Pdf:{params:{operate:"exportPDF"},method:t.method,cancellable:!0},Word:{params:{operate:"exportWord"},method:t.method,cancellable:!0},ChangeStar:{params:{operate:"updateApiStar"},method:t.method,cancellable:!0},ChangeStatus:{params:{operate:"updateApiStatus"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyApi"},method:t.method,cancellable:!0}}),o.Trash=e(a+"apiManagementPro/Api/:operate",{},{Query:{params:{operate:"getRecyclingStationApiList"},method:t.method,cancellable:!0},Clean:{params:{operate:"cleanRecyclingStation"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteApi"},method:t.method,cancellable:!0},Recover:{params:{operate:"recoverApi"},method:t.method,cancellable:!0}}),o.QuickTest=e(a+"apiManagementPro/QuickTest/:operate",{},{DeleteHistory:{params:{operate:"deleteTestHistory"},method:t.method,cancellable:!0},DeleteAllHistory:{params:{operate:"deleteAllTestHistory"},method:t.method,cancellable:!0},TestHistoryList:{params:{operate:"getTestHistoryList"},method:t.method,cancellable:!0},AddHistory:{params:{operate:"addTestHistory"},method:t.method,cancellable:!0}}),o.Test=e(a+"apiManagementPro/Test/:operate",{},{GroupQuery:{params:{operate:"getTestSidebar"},method:t.method,cancellable:!0},TestHistoryList:{params:{operate:"getTestHistoryList"},method:t.method,cancellable:!0},DeleteHistory:{params:{operate:"deleteTestHistory"},method:t.method,cancellable:!0},DeleteAllHistory:{params:{operate:"deleteAllTestHistory"},method:t.method,cancellable:!0},AddHistory:{params:{operate:"addTestHistory"},method:t.method,cancellable:!0}}),o.Star=e(a+"apiManagementPro/Api/:operate",{},{Add:{params:{operate:"addStar"},method:t.method,cancellable:!0},Delete:{params:{operate:"removeStar"},method:t.method,cancellable:!0}}),o.Code=e(a+"apiManagementPro/StatusCode/:operate",{},{Query:{params:{operate:"getCodeList"},method:t.method,cancellable:!0},All:{params:{operate:"getAllCodeList"},method:t.method,cancellable:!0},Add:{params:{operate:"addCode"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteCode"},method:t.method,cancellable:!0},Edit:{params:{operate:"editCode"},method:t.method,cancellable:!0},Search:{params:{operate:"searchStatusCode"},method:t.method,cancellable:!0},Import:{params:{operate:"addStatusCodeByExcel"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportStatusCode"},method:t.method,cancellable:!0},SearchIDQuery:{params:{operate:"getAllSearchStatusCodeID"},method:t.method,cancellable:!0},IDQuery:{params:{operate:"getAllStatusCodeID"},method:t.method,cancellable:!0}}),o.ApiGroup=e(a+"apiManagementPro/ApiGroup/:operate",{},{QueryData:{params:{operate:"getApiGroupData"},method:t.method,cancellable:!0},Query:{params:{operate:"getGroupList"},method:t.method,cancellable:!0},Add:{params:{operate:"addGroup"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteGroup"},method:t.method,cancellable:!0},Edit:{params:{operate:"editGroup"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0},Import:{params:{operate:"importGroup"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportGroup"},method:t.method,cancellable:!0},Markdown:{params:{operate:"exportMarkdown"},method:t.method,cancellable:!0},Pdf:{params:{operate:"exportPDF"},method:t.method,cancellable:!0},Word:{params:{operate:"exportWord"},method:t.method,cancellable:!0}}),o.Doc=e(a+"apiManagementPro/Page/:operate",{},{Query:{params:{operate:"getPageList"},method:t.method,cancellable:!0},Move:{params:{operate:"changePageGroup"},method:t.method,cancellable:!0},Add:{params:{operate:"addPage"},method:t.method,cancellable:!0},Delete:{params:{operate:"deletePage"},method:t.method,cancellable:!0},Edit:{params:{operate:"editPage"},method:t.method,cancellable:!0},Detail:{params:{operate:"getPage"},method:t.method,cancellable:!0},Search:{params:{operate:"searchPage"},method:t.method,cancellable:!0},HistoryList:{params:{operate:"getPageHistoryList"},method:t.method,cancellable:!0},DeleteHistory:{params:{operate:"deletePageHistory"},method:t.method,cancellable:!0},toggleHistory:{params:{operate:"togglePageHistory"},method:t.method,cancellable:!0},DeleteNoticeMember:{params:{operate:"deleteNoticeMember"},method:t.method,cancellable:!0},EditNoticeEvent:{params:{operate:"updateMemberNoticeEvent"},method:t.method,cancellable:!0},GetNoticeMember:{params:{operate:"getNoticeMemberList"},method:t.method,cancellable:!0},NoticeMember:{params:{operate:"noticeMember"},method:t.method,cancellable:!0},AddNoticeMember:{params:{operate:"addNoticeMember"},method:t.method,cancellable:!0},GetUnJoinedNoticeMember:{params:{operate:"getProjectMemberList"},method:t.method,cancellable:!0},SearchIDQuery:{params:{operate:"getAllSearchPageID"},method:t.method,cancellable:!0},IDQuery:{params:{operate:"getAllPageID"},method:t.method,cancellable:!0}}),o.DocGroup=e(a+"apiManagementPro/PageGroup/:operate",{},{Query:{params:{operate:"getGroupList"},method:t.method,cancellable:!0},Add:{params:{operate:"addGroup"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteGroup"},method:t.method,cancellable:!0},Edit:{params:{operate:"editGroup"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0},Import:{params:{operate:"importGroup"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportGroup"},method:t.method,cancellable:!0}}),o.CodeGroup=e(a+"apiManagementPro/StatusCodeGroup/:operate",{},{Query:{params:{operate:"getGroupList"},method:t.method,cancellable:!0},Add:{params:{operate:"addGroup"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteGroup"},method:t.method,cancellable:!0},Edit:{params:{operate:"editGroup"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0},Import:{params:{operate:"importGroup"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportGroup"},method:t.method,cancellable:!0}}),o}angular.module("eolinker.resource").factory("ApiManagementResource",e),e.$inject=["$resource","serverUrl"]}();
"use strict";!function(){function e(e,a){var t={method:"POST"},o=[];return o.CaseTestReport=e(a+"automatedTest/CaseTestReport/:operate",{},{Query:{params:{operate:"getReportList"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteReport"},method:t.method,cancellable:!0},Detail:{params:{operate:"getReport"},method:t.method,cancellable:!0}}),o.DataCollection=e(a+"automatedTest/DataCollection/:operate",{},{SimpleQuery:{params:{operate:"getDataCollectionDataList"},method:t.method,cancellable:!0},Query:{params:{operate:"getDataCollectionList"},method:t.method,cancellable:!0},Save:{params:{operate:"saveDataCollection"},method:t.method}}),o.TestPlan=e(a+"automatedTest/TestPlan/:operate",{},{Query:{params:{operate:"getTestPlanList"},method:t.method,cancellable:!0},Search:{params:{operate:"searchTestPlan"},method:t.method,cancellable:!0},Add:{params:{operate:"addTestPlan"},method:t.method,cancellable:!0},Edit:{params:{operate:"editTestPlan"},method:t.method,cancellable:!0},Detail:{params:{operate:"getTestPlan"},method:t.method,cancellable:!0},Delete:{params:{operate:"batchDeleteTestPlan"},method:t.method,cancellable:!0}}),o.DatabaseOperation=e(a+"automatedTest/DatabaseOperation/:operate",{},{Add:{params:{operate:"addStep"},method:t.method,cancellable:!0},Edit:{params:{operate:"editStep"},method:t.method,cancellable:!0},Detail:{params:{operate:"getStep"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyStep"},method:t.method,cancellable:!0}}),o.TestFile=e(a+"automatedTest/TestFile/:operate",{},{Query:{params:{operate:"getFileList"},method:t.method,cancellable:!0}}),o.AutomatedTestTaskGroup=e(a+"automatedTest/AutomatedTestTaskGroup/:operate",{},{Query:{params:{operate:"getGroupList"},method:t.method,cancellable:!0},Add:{params:{operate:"addGroup"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteGroup"},method:t.method,cancellable:!0},Edit:{params:{operate:"editGroup"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0}}),o.AutomatedTestHistory=e(a+"automatedTest/AutomatedTestHistory/:operate",{},{TestReport:{params:{operate:"getLatestTestHistory"},method:t.method,cancellable:!0},ExportReport:{params:{operate:"exportTestReport"},method:t.method,cancellable:!0},CaseQuery:{params:{operate:"getCaseList"},method:t.method,cancellable:!0},DeleteReport:{params:{operate:"deleteTestReport"},method:t.method,cancellable:!0},ReportQuery:{params:{operate:"getTestReportList"},method:t.method,cancellable:!0},Query:{params:{operate:"getTestHistoryList"},method:t.method,cancellable:!0},Clear:{params:{operate:"removeAllTestHistory"},method:t.method,cancellable:!0},Export:{params:{operate:"exportTestHistory"},method:t.method,cancellable:!0},ExportFailedLog:{params:{operate:"exportFailedTestHistory"},method:t.method,cancellable:!0}}),o.AutomatedTestCaseSingle=e(a+"automatedTest/AutomatedTestCaseSingle/:operate",{},{SynchronizeData:{params:{operate:"synchronizeData"},method:t.method,cancellable:!0},GetSynchronizeData:{params:{operate:"GetSynchronizeData"},method:t.method,cancellable:!0},BindApi:{params:{operate:"bindApi"},method:t.method,cancellable:!0},ChangeLock:{params:{operate:"changeLockStatus"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0},Query:{params:{operate:"getSimpleSingleCaseList"},method:t.method,cancellable:!0},Add:{params:{operate:"addSingleCase"},method:t.method,cancellable:!0},BatchAdd:{params:{operate:"batchAddSingleCase"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteTestCase"},method:t.method,cancellable:!0},Edit:{params:{operate:"editSingleCase"},method:t.method,cancellable:!0},Copy:{params:{operate:"copySingleCase"},method:t.method,cancellable:!0},Info:{params:{operate:"getSingleCaseInfo"},method:t.method,cancellable:!0},ApiList:{params:{operate:"getApiList"},method:t.method,cancellable:!0},GetFrontExampleList:{params:{operate:"getAssociatedData"},method:t.method,cancellable:!0},ProjectQuery:{params:{operate:"getProjectList"},method:t.method,cancellable:!0}}),o.AutomatedTestTask=e(a+"automatedTest/AutomatedTestTask/:operate",{},{Query:{params:{operate:"getTaskList"},method:t.method,cancellable:!0},BatchQuery:{params:{operate:"getTestCaseInfoByID"},method:t.method,cancellable:!0},Search:{params:{operate:"searchTask"},method:t.method,cancellable:!0},QueryReportByDay:{params:{operate:"getLogListByDate"},method:t.method,cancellable:!0},Add:{params:{operate:"addTask"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteTask"},method:t.method,cancellable:!0},Edit:{params:{operate:"editTask"},method:t.method,cancellable:!0},Detail:{params:{operate:"getTaskInfo"},method:t.method,cancellable:!0},Test:{params:{operate:"testTask"},method:t.method,cancellable:!0},ChangeStatus:{params:{operate:"changeTaskStatus"},method:t.method,cancellable:!0},SearchIDQuery:{params:{operate:"getAllSearchTaskID"},method:t.method,cancellable:!0},IDQuery:{params:{operate:"getAllTaskID"},method:t.method,cancellable:!0}}),o.AutomatedTestCase=e(a+"automatedTest/AutomatedTestCase/:operate",{},{DereferenceCaseTemplate:{params:{operate:"dereferenceCaseTemplate"},method:t.method,cancellable:!0},getSearchConditionList:{params:{operate:"getSearchConditionList"},method:t.method,cancellable:!0},ChangeToCommonCase:{params:{operate:"convertToCommonCase"},method:t.method,cancellable:!0},AddCommonCase:{params:{operate:"addCommonCase"},method:t.method,cancellable:!0},Move:{params:{operate:"batchChangeGroup"},method:t.method,cancellable:!0},DeleteBeforeCase:{params:{operate:"deleteBeforeCase"},method:t.method,cancellable:!0},BatchQuery:{params:{operate:"batchGetTestCaseList"},method:t.method,cancellable:!0},Query:{params:{operate:"getTestCaseList"},method:t.method,cancellable:!0},QueryOmitAll:{params:{operate:"getAllTestCase"},method:t.method,cancellable:!0},Search:{params:{operate:"searchTestCase"},method:t.method,cancellable:!0},Add:{params:{operate:"addTestCase"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyTestCase"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteTestCase"},method:t.method,cancellable:!0},Edit:{params:{operate:"editTestCase"},method:t.method,cancellable:!0},Code:{params:{operate:"getTestCaseCode"},method:t.method,cancellable:!0},EditCode:{params:{operate:"editTestCaseCode"},method:t.method,cancellable:!0},SearchIDQuery:{params:{operate:"getAllSearchCaseID"},method:t.method,cancellable:!0},IDQuery:{params:{operate:"getAllCaseID"},method:t.method,cancellable:!0}}),o.AutomatedTestEnv=e(a+"automatedTest/AutomatedTestEnv/:operate",{},{Query:{params:{operate:"getTestCaseList"},method:t.method,cancellable:!0},Search:{params:{operate:"searchTestCase"},method:t.method,cancellable:!0},Add:{params:{operate:"addTestCase"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyTestCase"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteTestCase"},method:t.method,cancellable:!0},Edit:{params:{operate:"editTestCase"},method:t.method,cancellable:!0},Code:{params:{operate:"getTestCaseCode"},method:t.method,cancellable:!0},EditCode:{params:{operate:"editTestCaseCode"},method:t.method,cancellable:!0},SearchIDQuery:{params:{operate:"getAllSearchCaseID"},method:t.method,cancellable:!0},IDQuery:{params:{operate:"getAllCaseID"},method:t.method,cancellable:!0}}),o.AutomatedTaskHistory=e(a+"automatedTest/AutomatedTestTaskLog/:operate",{},{Query:{params:{operate:"getTestLogList"},method:t.method,cancellable:!0},Clear:{params:{operate:"removeAllTestLog"},method:t.method,cancellable:!0},Export:{params:{operate:"exportTestLog"},method:t.method,cancellable:!0},ExportFailedLog:{params:{operate:"exportFailedTestLog"},method:t.method,cancellable:!0}}),o.AutomatedTestGroup=e(a+"automatedTest/AutomatedTestCaseGroup/:operate",{},{Query:{params:{operate:"getGroupList"},method:t.method,cancellable:!0},Add:{params:{operate:"addGroup"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteGroup"},method:t.method,cancellable:!0},Edit:{params:{operate:"editGroup"},method:t.method,cancellable:!0},Sort:{params:{operate:"sortOrder"},method:t.method,cancellable:!0},Import:{params:{operate:"importGroup"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportGroup"},method:t.method,cancellable:!0}}),o.ProjectGroup=e(a+"automatedTest/ProjectGroup/:operate",{},{QueryAll:{params:{operate:"getAllProjectGroup"},method:t.method},Add:{params:{operate:"addProjectGroup"},method:t.method},Delete:{params:{operate:"deleteProjectGroup"},method:t.method},Edit:{params:{operate:"editProjectGroup"},method:t.method}}),o.Project=e(a+"automatedTest/Project/:operate",{},{GlobalSearch:{params:{operate:"globalSearch"},method:t.method,cancellable:!0},QueryTimeOut:{params:{operate:"getProjectTimeOutSetting"},method:t.method,cancellable:!0},EditTimeOut:{params:{operate:"editProjectTimeOutSetting"},method:t.method,cancellable:!0},ChangeGroup:{params:{operate:"changeGroup"},method:t.method,cancellable:!0},All:{params:{operate:"getAllProject"},method:t.method,cancellable:!0},QueryFailCase:{params:{operate:"getFailCaseList"},method:t.method,cancellable:!0},Query:{params:{operate:"getProjectList"},method:t.method,cancellable:!0},Edit:{params:{operate:"editProject"},method:t.method,cancellable:!0},Add:{params:{operate:"addProject"},method:t.method,cancellable:!0},Delete:{params:{operate:"deleteProject"},method:t.method,cancellable:!0},BatchDelete:{params:{operate:"batchDeleteProject"},method:t.method,cancellable:!0},Detail:{params:{operate:"getProject"},method:t.method,cancellable:!0},GetProjectLogList:{params:{operate:"getProjectLogList"},method:t.method,cancellable:!0},SetQuotedProject:{params:{operate:"setQuotedProject"},method:t.method,cancellable:!0},GetQuotedProject:{params:{operate:"getQuotedProject"},method:t.method,cancellable:!0},GetApiProjectList:{params:{operate:"getApiProjectList"},method:t.method,cancellable:!0},Import:{params:{operate:"importProject"},method:t.method,cancellable:!0,transformRequest:angular.identity,headers:{"Content-Type":void 0}},Export:{params:{operate:"exportProject"},method:t.method,cancellable:!0},Copy:{params:{operate:"copyProject"},method:t.method,cancellable:!0}}),o}angular.module("eolinker.resource").factory("AutomatedTestResource",e),e.$inject=["$resource","serverUrl"]}();
"use strict";!function(){function e(e,a,r){var t={fun:{}};return t.fun.bindApi=function(t,o){e.Product_ImportCrossProjectModal({title:"选择需要绑定的API",mainObject:{type:"bindApi",setting:{resultType:["groupPath","item","projectHashKey"],itemInitQuery:[t.apiID]},listComponent:{item:{primaryKey:"apiID","default":[{key:"接口名称",html:'<label class="iconfont icon-circle eo-status-{{$ctrl.otherObject.API_STATUS_QUERY[item.apiStatus].class}}"></label> {{item.apiName}}',draggableCacheMark:"name",sort:!0,sortOrderByVal:0},{key:"URL",html:'<span class="eo-method-label eo-color-{{$ctrl.otherObject.METHOD_SHOW_QUERY[item.apiRequestType].class}}">{{$ctrl.otherObject.METHOD_SHOW_QUERY[item.apiRequestType].key}}</span> {{item.apiURI}}',draggableCacheMark:"url",sort:!0,sortOrderByVal:1}]},setting:{draggable:!0,dragCacheVar:"MODAL_IMPORT_CROSS_API_LIST_VAR",dragCacheObj:{name:"250px",url:"250px"},radio:!0,batchInitStatus:"open",page:!0,autoSort:!0,isFixedHeight:!0,sortStorageKey:"MODAL_IMPORT_CROSS_API_LIST",sortDefaultVal:{storageVal:{orderBy:1,asc:1},sortOrder:"asc"},scroll:!0,scrollRemainRatio:7,warning:"暂无可以被引用的接口"}},otherObject:{API_STATUS_QUERY:a.API_STATUS_QUERY,METHOD_SHOW_QUERY:a.METHOD_SHOW_QUERY},baseParams:{spaceKey:t.ajaxRequest.spaceKey,projectHashKey:t.ajaxRequest.projectHashKey},impProjectInfo:{resourceName:r.CrossProject.QueryProject,extraParams:{module:1}},impGroupInfo:{resourceName:r.CrossProject.QueryGroup,extraParams:{groupModule:2,module:1}},impItemInfo:{queryResouceName:r.CrossProject.QueryApi,searchResouceName:r.CrossProject.SearchApi,queryIDResouceName:r.CrossProject.QueryAllID,queryResponseKey:"apiList",extraParams:{module:1}},baseFun:{}}},function(e){if(e){var a=e[1][0],r=e[0][0]+" / "+a.apiName;o({apiID:a.apiID,apiPath:r,apiProjectHashKey:e[2]})}})},t}angular.module("eolinker.ams").factory("Bind_Api_Service",e),e.$inject=["$rootScope","API_AMS_CONSTANT","GeneralFunResource"]}();
"use strict";!function(){function i(i,o,e){var t=this;t.service={authority:e},o.global.$watch.push(i.$watch("$ctrl.service.authority.productUsingPermission.ams.isOnTrial",function(){t.service.authority.productUsingPermission.ams.isOnTrial&&t.service.authority.productUsingPermission.ams.disabled&&o.Common_UpgradeNoticeModal({module:"trial_finish",hideCloseOperation:!0,mark:"AMS"},function(i){})}))}angular.module("eolinker.ams").component("homeAms",{templateUrl:"module/ams/ui/index.html",controller:i}),i.$inject=["$scope","$rootScope","Authority_CommonService"]}();
"use strict";!function(){function e(){var e=this;e.data={},e.$onInit=function(){"teardown"===e.type?e.data.caseName="后置测试用例":e.data.caseName="前置测试用例"}}angular.module("eolinker.ams").component("beforeAfterCaseReport",{templateUrl:"module/ams/component/beforeAfterCaseReport/index.html",controller:e,bindings:{model:"<",type:"@"}}),e.$inject=[]}();
"use strict";!function(){function e(e,a,t,s,o,n,r,p){var i=this;i.data={apiName:"",pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},i.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID,caseID:o.params.caseID,module:o.current.name.indexOf("commonCase")>-1?1:0},i.ajaxResponse={query:null},i.fun={},i.service={authority:p},i.component={blockListObject:{},listPageCommonObject:null,proInsideVersionComparisonObject:{show:!1}};var c=({proInsideVersionComparisonObject:{request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID,caseID:o.params.caseID},apiInfo:null},historyInfo:null},{});i.data.pagination.fun=function(){e.$broadcast("$Init_LoadingPartCommonComponent")},i.fun.init=function(){return r.global.ajax.Query_CaseTestReport=s.CaseTestReport.Query({spaceKey:i.ajaxRequest.spaceKey,projectHashKey:i.ajaxRequest.projectHashKey,caseID:i.ajaxRequest.caseID,module:i.ajaxRequest.module,page:i.data.pagination.page,pageSize:i.data.pagination.pageSize}),r.global.ajax.Query_CaseTestReport.$promise.then(function(e){i.ajaxResponse.query=e.reportList||[]}),r.global.ajax.Query_CaseTestReport.$promise},i.fun.changePage=function(){i.fun.init()},c.deleteHistory=function(e){r.EnsureModal("删除报告",!1,t.DELETE,{},function(a){a&&s.CaseTestReport.Delete({spaceKey:i.ajaxRequest.spaceKey,projectHashKey:i.ajaxRequest.projectHashKey,reportID:JSON.stringify([e.item.reportID]),caseID:i.ajaxRequest.caseID,module:i.ajaxRequest.module}).$promise.then(function(a){switch(a.statusCode){case n.COMMON.SUCCESS:i.ajaxResponse.query.splice(e.$index,1),r.InfoModal("报告删除成功","success");break;default:r.InfoModal("删除失败，此为当前版本或当前版本已被删除！","error")}})})},c.showReport=function(e){return r.global.ajax.Detail_CaseTestReport&&r.global.ajax.Detail_CaseTestReport.$cancelRequest(),r.global.ajax.Detail_CaseTestReport=s.CaseTestReport.Detail({spaceKey:i.ajaxRequest.spaceKey,projectHashKey:i.ajaxRequest.projectHashKey,caseID:i.ajaxRequest.caseID,module:i.ajaxRequest.module,reportID:e.item.reportID}),r.global.ajax.Detail_CaseTestReport.$promise.then(function(e){i.showReport({arg:e.result})}),r.global.ajax.Detail_CaseTestReport.$promise},c.initTable=function(){i.component.blockListObject.query={mainObject:{tdList:[{thKey:"状态",type:"html",html:'<span class="eo-color-success current-icon" ng-if="item.testStatus==1">通过</span><span class="eo-color-danger current-icon" ng-if="item.testStatus==0">未通过</span>',"class":"tac w_50 "},{thKey:"测试时间",type:"text",modelKey:"testTime"},{thKey:"测试数据集数量",type:"text",modelKey:"dataCollectionCount","class":"w_150"},{thKey:"测试人员",type:"text",modelKey:"tester"},{type:"btn","class":"w_100",btnList:[{key:"详情",fun:c.showReport},{key:"删除",fun:c.deleteHistory}]}]}}},i.$onInit=function(){c.initTable()}}angular.module("eolinker.ams").component("amsAutomaticCaseInsideReport",{templateUrl:"module/ams/component/caseReport/index.html",controller:e,bindings:{showReport:"&"}}),e.$inject=["$scope","$filter","ENSURE_WARNIMG","AutomatedTestResource","$state","CODE","$rootScope","Authority_CommonService"]}();
"use strict";!function(){function e(e,a,t,o,s,n,r,i,c){var u=this;u.component={menuObject:{list:[]},listDefaultCommonObject:null,blockListObject:{},dbSelectObj:{CONST:{DB_TYPE_ARR:i},setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5">{{$ctrl.mainObject.CONST.DB_TYPE_ARR[item.dbType]}}</span>'}},courseCollapseObj:{iconNameObj:{close:"icon-xuanzeqizhankai",open:"icon-xuanzeqishouqi"},animation:!1}},u.data={},u.fun={},u.ajaxResponse={stepInfo:{delayTime:"0",caseCode:"",resultParam:[],caseData:{keepGoing:1}}},u.CONST={SHORTCUT_ARR:t.DEFAULT_OPERATE_QUERY,RESPONSE_MATCH_ARR:[{key:"校验全部语句执行成功",value:0},{key:"不校验",value:1},{key:"自定义校验规则",value:2}],RESPONSE_MATCH_MSG_OBJ:{0:"当语句均执行成功，校验判断为正确",1:"不校验返回结果，任意结果均判断为正确"}};var l={},p={responseArr:[],bodyArr:[]},m={stepArr:[]},d={};u.fun.showSqlUseTip=function(){c.Ams_SqlUseTipModal()},l.jsonStringFilter=function(e,a){if(!/(\$\$hashKey)|(oldParamKey)|(listDepth)/.test(e))return a},l.importFile=function(e,a){a=a||{multi:!0};var t={title:"添加测试文件",multi:a.multi,request:{params:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:d.module},responseKey:"fileList",resource:r.TestFile.Query}};c.Vspex_SelectPublicFileModal(t,function(a){a&&e(a)})},l.importApiData=function(){c.Product_ImportCrossProjectModal({mainObject:{type:"pro",apiNum:p.apiNum,baseParams:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey},impProjectInfo:{resourceName:s.CrossProject.QueryProject,extraParams:{module:1}},impGroupInfo:{resourceName:s.CrossProject.QueryGroup,extraParams:{groupModule:2,module:1}},impItemInfo:{queryResouceName:s.CrossProject.QueryApi,searchResouceName:s.CrossProject.SearchApi,queryIDResouceName:s.CrossProject.QueryAllID,queryResponseKey:"apiList",extraParams:{module:1}},batchQueryResouce:{resource:s.CrossProject.QueryDetail,extraParams:{module:1}},baseFun:{}}},function(a){if(a){var t={cache:o.get("TEST_IMPORT_PRO_CODE_CACHE")};t.cache&&e.$broadcast("$InsertText_AceEditorAms",o.get("TEST_IMPORT_PRO_CODE_CACHE"))}})},l.modalSqlInsert=function(e){c.Ams_InsertSqlCodeModal({dbList:m.dbList},function(a){if(a){var t=void 0;switch(a.dbType){case 0:var o=(u.ajaxResponse.stepInfo.caseCode.match(/eo\.mysql\(/g)||[]).length+1;t="var result_mysql_"+o+"=eo.mysql({\n"+('    "dbID":"'+a.dbID+'",\n')+('    "name":"'+a.name+'"\n')+("},`"+a.sqlCode+"`)");break;case 1:var s=(u.ajaxResponse.stepInfo.caseCode.match(/eo\.oracle\(/g)||[]).length+1;t="var result_oracle_"+s+"=eo.oracle({\n"+('    "dbID":"'+a.dbID+'",\n')+('    "name":"'+a.name+'"\n')+("},`"+a.sqlCode+"`)")}e(t)}})},l.insertSql=function(e){m.dbList?l.modalSqlInsert(e):s.Database.SimpleQuery({spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:1}).$promise.then(function(a){(a.dbList||[]).length>0?(m.dbList=a.dbList||[],l.modalSqlInsert(e)):c.InfoModal("目前暂未创建数据库连接，请先前往公共资源管理中创建数据库连接","error")})},l.getCommonFun=function(){var e={request:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:d.productModule},cache:o.get("Common_Function_List")};e.cache?p.funList=e.cache:(c.global.ajax.Detail_Function=s.CommonFunction.QueryData(e.request),c.global.ajax.Detail_Function.$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:o.set(e.functionList,"Common_Function_List"),p.funList=e.functionList;break;default:p.funList=[]}}))},u.fun.quickSetExpression=function(a,t){var o={javascript:"",callback:null};switch(a){case"import_bind_param":u.fun.insertCodeByBindParam();break;case"add-old-api":case"add-new-api":try{p.apiNum=u.ajaxResponse.stepInfo.caseCode.match(/eo\.execute\(/g).length+1}catch(s){p.apiNum=1}}switch(a){case"add-old-api":l.importApiData();break;case"add-new-api":o.javascript="var api_"+p.apiNum+'={\n    "url":"",\n    "method":"POST",\n    "headers":{},\n    "bodyType":"form-data",\n    "body":{},\n    "timelimit":"follow" \n};\nvar result_api_'+p.apiNum+"=eo.execute(api_"+p.apiNum++ +");\n\n";break;case"add-common-fun":c.Product_AddFunctionModal(p.funList,function(a){if(a){var t=[];angular.forEach(a.functionParam,function(e,a){e.paramKey&&t.push(e.paramKey)}),o.javascript="eo."+(a.isGlobal?"globalFunction":"userFunction")+"."+a.functionKey+"("+t.join(",")+")/*"+a.functionName+"*/",e.$broadcast("$InsertText_AceEditorAms",o.javascript)}});break;case"add-sql":return void l.insertSql(function(a){e.$broadcast("$InsertText_AceEditorAms",a)});case"judge-if":o.javascript="if(){\n    //结果为true执行代码\n}else{\n    //判断结果为false执行代码\n}\n\n";break;case"judge-switch":o.javascript='switch(){\n    case "对应内容":{\n        break;\n    }\n    default:{\n        break;\n    }\n}\n\n';break;case"stop":o.javascript='eo.stop("停止回调信息");\n';break;case"info":o.javascript='eo.info("输出信息"); \n';break;case"md5":o.javascript="eo.md5()";break;case"sha1":o.javascript="eo.sha1()";break;case"sha256":o.javascript="eo.sha256()";break;case"jpg":case"png":case"gif":o.javascript='eo.img("'+a+'")';break;case"none":case"txt":case"doc":case"docx":case"pdf":o.javascript='eo.file("'+a+'")';break;case"filePath":l.importFile(function(a){e.$broadcast("$InsertText_AceEditorAms",'eo.filePath("'+a.files[0].uuid+'")')},{radio:!0})}["add-old-api","add-common-fun","filePath"].indexOf(a)===-1&&e.$broadcast("$InsertText_AceEditorAms",o.javascript)},l.save=function(){if(e.ConfirmForm.$invalid||!u.ajaxResponse.stepInfo.caseCode)return u.data.submitted=!0,void c.InfoModal("保存失败，请检查信息是否填写完整！","error");var t,o={stepType:1,spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:d.module,connID:u.ajaxResponse.stepInfo.connID,caseID:d.caseID,caseCode:u.ajaxResponse.stepInfo.caseCode,apiName:u.ajaxResponse.stepInfo.apiName,delayTime:u.ajaxResponse.stepInfo.delayTime||0,caseData:JSON.stringify(u.ajaxResponse.stepInfo.caseData),resultParam:JSON.stringify(u.ajaxResponse.stepInfo.resultParam,l.jsonStringFilter)},s={};switch(a.params.opr){case"edit":s.opr="Edit",s.text="编辑脚本操作";break;default:s.opr="Add",s.text="新建脚本操作"}return t=r.AutomatedTestCaseSingle[s.opr](o).$promise,t.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:c.InfoModal(s.text,"success"),l.back()}}),t},l.focusTextInput=function(e){e.oldParamKey=e.paramKey||""},l.initBlockListConf=function(){return{tdList:[{type:"text",thKey:"参数名（在代码中使用$code_param_变量名定义，如$code_param_token）",modelKey:"paramKey"},{thKey:"参数说明",type:"input",modelKey:"paramInfo",placeholder:"参数说明"}],setting:{munalAddRow:!0}}},l.preBindParse=function(){var e={query:[]};if(m.stepArr.length<=0)return void c.InfoModal("尚无前置API","error");for(var a in m.stepArr){var t=m.stepArr[a];switch((t.resultParamType||0).toString()){case"2":t.resultParam=[{paramKey:"raw",parent:"."}];break;default:t.resultParam&&t.resultParam.length>0&&!t.resultParam[t.resultParam.length-1].paramKey&&t.resultParam.splice(t.resultParam.length-1,1)}e.query.push(t)}return e.query},l.modalBind=function(e,a){var t={query:l.preBindParse(),primaryKey:"tempID"},o="";t.query&&c.Product_AutomatedTest_BindModal(t,function(t){if(t){/^\./.test(t.bind)&&(t.bind=t.bind.slice(1,t.bind.length)),/^\["/.test(t.bind)||(o=".");var s=t.mark+'["'+t.tempID+'"]'+(0==t.dataType?"":"[0]")+o+t.bind;"responseMatch"!==e&&(a.item[e]=(a.item[e]||"")+"<"+s+">."),a.callback&&a.callback(s)}})},u.fun.insertCodeByBindParam=function(){l.bind("responseMatch",{callback:function(a){e.$broadcast("$InsertText_AceEditorAms",a)}})},l.bind=function(e,a){if(c.global.ajax.Query_AutomatedTestCaseSingle)l.modalBind(e,a);else{var t=l.getFrontExampleList();t["finally"](function(){l.modalBind(e,a)})}},l.back=function(){a.go(u.mainObject.setting.backUrl,{caseID:d.caseID})},l.getParamFromCode=function(e,a){var t=e.match(/\$code_param_([A-Za-z_$][A-Za-z0-9_$]*)/g)||[],o=[],s=[];return t.map(function(e){e=e.replace("$code_param_",""),s.indexOf(e)===-1&&s.push(e)}),a.map(function(e){var a=s.indexOf(e.paramKey);a!==-1&&(s.splice(a,1),o.push(e))}),s.map(function(e){o.push({paramKey:e})}),o},l.watchSqlChange=function(){c.global.$watch.push(e.$watch("$ctrl.ajaxResponse.stepInfo.caseCode",function(){p.timer&&clearTimeout(p.timer),p.timer=setTimeout(function(){u.ajaxResponse.stepInfo.resultParam=l.getParamFromCode(" "+(u.ajaxResponse.stepInfo.caseCode||""),u.ajaxResponse.stepInfo.resultParam)},1e3)}))},l.getInfo=function(){c.global.ajax.Detail_Step=r.AutomatedTestCaseSingle.Info({spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:d.module,caseID:d.caseID,connID:d.connID}),c.global.ajax.Detail_Step.$promise.then(function(e){u.ajaxResponse.stepInfo=e.singleCaseInfo||{}})},l.getFrontExampleList=function(){return c.global.ajax.Query_AutomatedTestCaseSingle=r.AutomatedTestCaseSingle.GetFrontExampleList({spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,module:d.module,caseID:d.caseID,orderNumber:u.ajaxResponse.stepInfo.orderNumber}),c.global.ajax.Query_AutomatedTestCaseSingle.$promise.then(function(e){m.stepArr=e.singleCaseList||[]}),c.global.ajax.Query_AutomatedTestCaseSingle.$promise},u.fun.initAceEditor=function(){c.global.ajax.Detail_Step?c.global.ajax.Detail_Step.$promise["finally"](function(){e.$broadcast("$Maunal_AceEditorAms",u.ajaxResponse.stepInfo.caseCode)}):(u.ajaxResponse.stepInfo.caseCode=t.DEFAULT_CODE,e.$broadcast("$Maunal_AceEditorAms",u.ajaxResponse.stepInfo.caseCode))},u.$onInit=function(){d=u.mainObject.setting.ajaxBasicRequest,u.component.blockListObj=l.initBlockListConf(),l.watchSqlChange(),l.getCommonFun(),"edit"===a.params.opr&&l.getInfo(),u.component.menuObject={list:[{type:"btn","class":"btn-group-li  pull-left",btnList:[{name:"返回",icon:"chexiao",fun:{"default":l.back}},{name:"保存","class":"eo_theme_btn_success block-btn",fun:{"default":l.save}}]}],setting:{"class":"common-menu-fixed-seperate inside_page_menu_mcc"}}},u.$onDestroy=function(){p.timer&&clearTimeout(p.timer)}}angular.module("eolinker.ams").component("eoComponentCodeStepOpr",{templateUrl:"module/ams/component/codeStepOpr/index.html",controller:e,bindings:{mainObject:"<"}}),e.$inject=["$scope","$state","AUTOMATE_TEST_CONSTANT","Cache_CommonService","GeneralFunResource","CODE","AutomatedTestResource","PUBLIC_RESOURCE_DB_TYPE_ARR","$rootScope"]}();
"use strict";!function(){function e(e,t,s,n){var a=this;a.data={activeObj:{},stepArr:[{key:"选择需要执行的测试数据集",value:"step1"},{key:"执行测试并得到报告",value:"step2",preArr:["step1"]}],current:{preArr:[],value:"step1"}},a.fun={},a.component={tipComponentObject:{type:"html",status:"info",icon:"icon-guanyu",html:"<p><b>该用例可以执行多次测试</b></p><p>请选择需要执行的测试数据集，如果选择了多个数据集，系统将会多次执行测试用例来分别获得每个数据集的测试报告。</p>"}},a.ajaxResponse={query:[],testObjList:[]};var o={};o.saveConf=function(){if(e.ConfirmForm.$invalid)return void s.InfoModal("请检查信息是否填写完整","error");var o=angular.copy(a.ajaxRequest);/^\//.test(o.prefix)||(o.prefix="/"+o.prefix);var i=n.Project.Add(o).$promise;return i.then(function(e){switch(e.statusCode){case t.COMMON.SUCCESS:s.InfoModal("新建成功","success"),a.bindFun({arg:!0})}}),i},o.ajaxQuery=function(){n.DataCollection.Query(a.mainObj.ajaxRequest).$promise.then(function(e){a.ajaxResponse.query=e.dataCollectionList||[]})},o.sendTestMsg=function(){if(a.testObj.basicData={},a.testObj.status[a.mainObj.testingVar||"isTesting"]||(a.data.ddtQuery=[],a.data.activeObj.query.map(function(e){a.data.ddtQuery.push({collectionName:e}),a.testObj.report[e]={responseType:"testing"}})),a.from="code"){var e=[];a.ajaxResponse.query.map(function(t){a.data.activeObj.query.indexOf(t.collectionName)!==-1&&e.push(t)}),a.mainObj.sendTestMsg(e)}else a.mainObj.sendTestMsg(a.data.activeObj.query)},a.fun.opr=function(e,t,n){switch(e){case"next":if(a.data.activeObj.query.length<=0)return void s.InfoModal("请选择数据集","error");a.data.current=a.data.stepArr[1],o.sendTestMsg();break;case"pre":a.data.current=a.data.stepArr[0];break;case"test":o.sendTestMsg();break;case"cancel":a.testObj&&a.testObj.status[a.mainObj.testingVar||"isTesting"]&&a.mainObj.sendTestMsg(),a.bindFun();break;case"showReport":a.testObj.status[a.mainObj.testingVar||"isTesting"]||"testing"===t.responseType&&t.responseType||a.mainObj.showReport(t);break;case"showHistoryReport":a.testObj&&a.testObj.status[a.mainObj.testingVar||"isTesting"]||a.mainObj.showReport(t,"history",n)}},o.initTable=function(){a.component.blockListObject={tdList:[{type:"checkbox",activeKey:"collectionName",isWantedToExposeObject:!0,checkboxClickAffectTotalItem:!0},{thKey:"测试数据集名称",type:"text",modelKey:"collectionName"}]}},a.$onInit=function(){a.mainObj.isReport||(o.initTable(),o.ajaxQuery())}}angular.module("eolinker.ams").component("ddtTestAmsComponent",{templateUrl:"module/ams/component/ddtTest/index.html",bindings:{bindFun:"&",mainObj:"<",testObj:"=",reportObj:"<",from:"<"},controller:e}),e.$inject=["$scope","CODE","$rootScope","AutomatedTestResource"]}();
"use strict";!function(){function e(e,t,a,n,r){var i=this;i.CONST={LANG_ARR:[{key:"php",value:"0"},{key:"java",value:"1"}],UPDATE_TYPE_ARR:[{key:"增量更新",value:"0"},{key:"全量更新",value:"1"},{key:"仅添加新的API",value:"2"}],API_STATUS_ARR:r.API_STATUS_SHOW_QUERY,ANNOTATION_TYPE_ARR:[{key:"Swagger 2.0",value:"0"}]},i.data={stepArr:[{key:"选择 API 信息来源",value:"step1"},{key:"完善配置",value:"step2",preArr:["step1"]},{key:"完成",value:"step3",preArr:["step1","step2"]}],current:{preArr:[],value:"step1"}},i.fun={},i.ajaxResponse={sourceQuery:[{logo:"assets/images/generate_api/swagger.png",title:"[推荐] 通过 Swagger URL",name:3},{logo:"assets/images/generate_api/git.png",title:"通过代码仓库：Github",name:1},{logo:"assets/images/generate_api/git.png",title:"通过代码仓库：Gitlab",name:0},{logo:"assets/images/generate_api/git.png",title:"通过代码仓库：码云",name:2}]};var o={},s={};o.saveConf=function(){if(i.data.submitted=!0,e.ConfirmForm.$invalid)return void a.InfoModal("请检查信息是否填写完整","error");var r=angular.copy(i.input),o=n.Annotation.Edit(r).$promise;return o.then(function(e){switch(e.statusCode){case t.COMMON.SUCCESS:i.data.current=i.data.stepArr[2]}}),o},i.fun.opr=function(e){switch(e){case"next":s.repositoryType!==i.input.repositoryType&&(i.input=Object.assign({},i.input,{url:null,projectID:null,privateToken:null,ref:null,language:"0",annotationType:"0",updateType:"0",synchronizeSetting:null,repoName:null,owner:null,apiDirPath:null,modelDirPath:null,apiStatus:0})),i.data.current=i.data.stepArr[1];break;case"pre":i.data.submitted=!1,s.repositoryType=i.input.repositoryType,i.data.current=i.data.stepArr[0];break;case"syncDoc":i.bindFun({arg:!0});break;case"save":return o.saveConf();case"cancel":i.bindFun()}},i.$onInit=function(){2===i.input.step&&(i.data.current=i.data.stepArr[1])}}angular.module("eolinker.ams").component("generateApiDocComponent",{templateUrl:"module/ams/component/generateApiDoc/index.html",bindings:{input:"=",bindFun:"&"},controller:e}),e.$inject=["$scope","CODE","$rootScope","ApiManagementResource","API_AMS_CONSTANT"]}();
"use strict";!function(){function t(t,e){var n=this;n.component={reportObject:{object:{input:{}},show:!1},ddtModal:{}},n.fun={},n.triggleB={},n.triggleA={},e.testCommonFun.downloadPcModal(),n.fun.watchUiAction=function(t){switch(t){case"closeDdtModal":n.component.ddtModal.showDdtModal=!1}}}angular.module("eolinker.ams").component("sceneBatchTestAmsComponent",{templateUrl:"module/ams/component/sceneBatchTest/index.html",controller:t,bindings:{envStatus:"=",inheritEnvObject:"=",bindTipStatus:"="}}),t.$inject=["$scope","Operate_CommonService"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}!function(){function e(e,a,t,s,n,o,r){var i=this;i.component={menuObject:{list:[]},listDefaultCommonObject:null,blockListObject:{},dbSelectObj:{CONST:{DB_TYPE_ARR:o},setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5">{{$ctrl.mainObject.CONST.DB_TYPE_ARR[item.dbType]}}</span>'}}},i.data={},i.fun={},i.ajaxResponse={dataSourceArr:[],stepInfo:{delayTime:"0",matchType:0,matchRule:"",caseData:{params:[],keepGoing:1},resultParam:[{paramKey:"",paramInfo:""}]}},i.CONST={RESPONSE_MATCH_ARR:[{key:"校验全部语句执行成功",value:0},{key:"不校验",value:1},{key:"自定义校验规则",value:2}],RESPONSE_MATCH_MSG_OBJ:{0:"当语句均执行成功，校验判断为正确",1:"不校验返回结果，任意结果均判断为正确"}};var c={},p={responseArr:[],bodyArr:[],tableObj:{}},l={responseArr:[],bodyArr:[]},u={stepArr:[]};i.fun.showSqlUseTip=function(){r.Ams_SqlUseTipModal()},c.jsonStringFilter=function(e,a){if(!/(\$\$hashKey)|(oldParamKey)|(listDepth)/.test(e))return a},c.save=function(){var t=function(){i.data.submitted=!0,r.InfoModal("请检查信息是否填写完整","error")};if(e.ConfirmForm.$invalid||!i.ajaxResponse.stepInfo.caseData.sqlCode||!i.ajaxResponse.stepInfo.dbID||2===i.ajaxResponse.stepInfo.matchType&&!i.ajaxResponse.stepInfo.matchRule)return void t();var n={},o=[];switch(a.params.opr){case"edit":n.opr="Edit",n.text="编辑数据库操作";break;default:n.opr="Add",n.text="新建数据库操作"}var p=!0,l=!1,u=void 0;try{for(var m,d=i.ajaxResponse.stepInfo.resultParam[Symbol.iterator]();!(p=(m=d.next()).done);p=!0){var b=m.value;b.paramKey&&(/([A-Za-z_$][A-Za-z0-9_$]*$)/.test(b.paramKey)?o.push(b):r.InfoModal("请检查信息是否填写完整","error"))}}catch(f){l=!0,u=f}finally{try{!p&&d["return"]&&d["return"]()}finally{if(l)throw u}}var y=Object.assign({},angular.copy(i.ajaxResponse.stepInfo),{spaceKey:i.mainObject.setting.ajaxBasicRequest.spaceKey,projectHashKey:i.mainObject.setting.ajaxBasicRequest.projectHashKey,module:i.mainObject.setting.ajaxBasicRequest.module,caseID:i.mainObject.setting.ajaxBasicRequest.caseID,connID:i.mainObject.setting.ajaxBasicRequest.connID});2!==y.matchType&&delete y.matchRule,y.caseData=JSON.stringify(y.caseData,c.jsonStringFilter),y.resultParam=JSON.stringify(o,c.jsonStringFilter),i.mainObject.Resource[n.opr](y).$promise.then(function(e){switch(e.statusCode){case s.COMMON.SUCCESS:r.InfoModal(n.text+"成功","success"),c.back()}})},c.focusTextInput=function(e){e.oldParamKey=e.paramKey||""},c.initBodyListBlockConfig=function(){return{tdList:[{type:"text",thKey:"参数名",modelKey:"paramKey","class":"w_30percent"},{thKey:"参数值",type:"input",modelKey:"paramInfo",placeholder:"参数值",btnList:[{key:"绑定",fun:c.bind,param:'"paramInfo",inputArg'}]}],setting:{munalAddRow:!0}}},c.insertResponseCode=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a.paramKey)if(a.oldParamKey&&new RegExp("\\$db_param_"+a.oldParamKey+"(?![A-Za-z_$][A-Za-z0-9_$]*)","g").test(i.ajaxResponse.stepInfo.generateResponseCode)){var s=t.replaceAll(new RegExp("\\$db_param_"+a.oldParamKey+"(?![A-Za-z_$][A-Za-z0-9_$]*)","g"),"$db_param_"+a.paramKey,i.ajaxResponse.stepInfo.generateResponseCode,!0);e.$broadcast("$Maunal_AceEditorAms_Setting_Response_Js",s)}else e.$broadcast("$InsertText_AceEditorAms_Setting_Response_Js","$db_param_"+a.paramKey+' = "eo_default_value";\n',0,!0)},c.initResponseListBlockConfig=function(){return{itemStructure:Object.assign({},{paramKey:"",paramInfo:""}),baseFun:{insertCode:c.insertResponseCode,focusTextInput:c.focusTextInput},tdList:[{type:"input",thKey:"参数名",modelKey:"paramKey",placeholder:"英文、数字、下划线的组合，并且首字符不能是数字","class":"w_30percent",itemExpression:'ng-focus="$ctrl.mainObject.baseFun.focusTextInput(item)" ng-blur="$ctrl.mainObject.baseFun.insertCode(item)" ng-pattern="/^[A-Za-z_$][A-Za-z0-9_$]*$/"'},{thKey:"参数说明",type:"input",modelKey:"paramInfo",placeholder:"参数说明"},{type:"btn","class":"w_150",btnList:[{operateName:"delete",key:"删除"}]}]}},c.preBindParse=function(){var e={query:[]};if(u.stepArr.length<=0)return void r.InfoModal("尚无前置API","error");for(var a in u.stepArr){var t=u.stepArr[a];switch((t.resultParamType||0).toString()){case"2":t.resultParam=[{paramKey:"raw",parent:"."}];break;default:t.resultParam&&t.resultParam.length>0&&!t.resultParam[t.resultParam.length-1].paramKey&&t.resultParam.splice(t.resultParam.length-1,1)}e.query.push(t)}return e.query},c.modalBind=function(e,a){var t={query:c.preBindParse(),primaryKey:"tempID"},s="";t.query&&r.Product_AutomatedTest_BindModal(t,function(t){if(t){/^\./.test(t.bind)&&(t.bind=t.bind.slice(1,t.bind.length)),/^\["/.test(t.bind)||(s=".");var n=t.mark+'["'+t.tempID+'"]'+(0==t.dataType?"":"[0]")+s+t.bind;"responseMatch"!==e&&(a.item[e]=(a.item[e]||"")+"<"+n+">."),a.callback&&a.callback(n)}})},i.fun.insertCodeByBindParam=function(){c.bind("responseMatch",{callback:function(a){e.$broadcast("$InsertText_AceEditorAms_Pre_Response_Js",a)}})},c.bind=function(e,a){if(r.global.ajax.Query_AutomatedTestCaseSingle)c.modalBind(e,a);else{var t=c.getFrontExampleList();t["finally"](function(){c.modalBind(e,a)})}},c.back=function(){a.go(i.mainObject.setting.backUrl,{caseID:i.mainObject.setting.ajaxBasicRequest.caseID})},c.filterIllegalMark=function(e,a){for(;a.test(e);)e=e.replace(a,"");return e},c.getBodyArr=function(e,a){var t=e.match(/(?!\\).\$\{((?!(\})).)*\}/g),s=[],n=[];return t?(t.map(function(e){var t=e.replace(/^(.)\${/,"").replace(/}$/,"");if(t&&n.indexOf(t)===-1){n.push(t);var o=p.bodyArr.indexOf(t);o>-1?s.push(a[o]):s.push({paramKey:t,paramNotNull:"0"})}}),p.bodyArr=n,s):(p.bodyArr=[],[])},c.parseSql=function(a){a=a||{};var t="select {@response} \nfrom {@table} \n",s="where {@body} ;",n=[],o=[],r=["=","<>",">","<",">=","<=","like"],c=a.params||i.ajaxResponse.stepInfo.caseData.params;c.map(function(e){e.fieldName&&o.push(e.fieldName+" "+r[e.opSymbol]+" ${"+(e.anotherName||e.fieldName)+"}")}),o.length>0&&(t+=s.replace("{@body}",o.join(" and "))),t=t.replace("{@table}",i.ajaxResponse.stepInfo.operationTable||"").replace("{@response}",n.join(" , ")),e.$broadcast("$Maunal_AceEditorAms",t)},c.watchSqlChange=function(){r.global.$watch.push(e.$watch("$ctrl.ajaxResponse.stepInfo.caseData.sqlCode",function(){i.ajaxResponse.stepInfo.caseData.params=c.getBodyArr(" "+(i.ajaxResponse.stepInfo.caseData.sqlCode||""),i.ajaxResponse.stepInfo.caseData.params)}))},c.getInfo=function(){r.global.ajax.Detail_Step=i.mainObject.Resource.Detail({spaceKey:i.mainObject.setting.ajaxBasicRequest.spaceKey,projectHashKey:i.mainObject.setting.ajaxBasicRequest.projectHashKey,module:i.mainObject.setting.ajaxBasicRequest.module,caseID:i.mainObject.setting.ajaxBasicRequest.caseID,connID:i.mainObject.setting.ajaxBasicRequest.connID}),r.global.ajax.Detail_Step.$promise.then(function(e){e.stepInfo.caseData.params.map(function(e){p.bodyArr.push(e.paramKey)}),e.stepInfo.caseData.params=e.stepInfo.caseData.params.concat(l.bodyArr),e.stepInfo.delayTime=e.stepInfo.delayTime.toString(),e.stepInfo.resultParam=[].concat(_toConsumableArray(e.stepInfo.resultParam||[]),[angular.copy(i.component.blockListObject.response.itemStructure)]),i.ajaxResponse.stepInfo=e.stepInfo})},c.getDataResource=function(){i.mainObject.dbCache?(i.ajaxResponse.dbList=i.mainObject.dbCache,i.ajaxResponse.stepInfo.dbID=i.ajaxResponse.dbList[0].dbID):i.mainObject.DbResource.SimpleQuery({spaceKey:i.mainObject.setting.ajaxBasicRequest.spaceKey,projectHashKey:i.mainObject.setting.ajaxBasicRequest.projectHashKey,module:i.mainObject.setting.ajaxBasicRequest.productModule}).$promise.then(function(e){i.ajaxResponse.dbList=e.dbList||[],r.global.ajax.Detail_Step||(i.ajaxResponse.stepInfo.dbID=i.ajaxResponse.dbList[0].dbID)})},c.getFrontExampleList=function(){return r.global.ajax.Query_AutomatedTestCaseSingle=n.AutomatedTestCaseSingle.GetFrontExampleList({spaceKey:i.mainObject.setting.ajaxBasicRequest.spaceKey,projectHashKey:i.mainObject.setting.ajaxBasicRequest.projectHashKey,module:i.mainObject.setting.ajaxBasicRequest.module,caseID:i.mainObject.setting.ajaxBasicRequest.caseID,orderNumber:i.ajaxResponse.stepInfo.orderNumber}),r.global.ajax.Query_AutomatedTestCaseSingle.$promise.then(function(e){u.stepArr=e.singleCaseList||[]}),r.global.ajax.Query_AutomatedTestCaseSingle.$promise},i.fun.initAceEditor=function(){var a='//数据库返回结果校验脚本示例\n//数据库操作结果示例请查看帮助中心教程\n//数据库执行的返回结果储存在变量db_result中\nif(db_result["status"]=="success"){\n\t//数据库语句整体执行成功\n\t//每一条数据库语句的执行结果储存在db_result["query"][...]数组中\n\t//可以通过如db_result["query"][0]["result"]取出第一条语句执行的返回结果\n\t//可以通过如db_result["query"][0]["info"]["status"]取出第一条语句执行的状态\n\t//可以通过如db_result["query"][0]["info"]["time"]取出第一条语句执行的时间\n}\nelse{\n\t//执行失败\n\teo.stop("数据库语句执行失败");\n}';r.global.ajax.Detail_Step?r.global.ajax.Detail_Step.$promise["finally"](function(){e.$broadcast("$Maunal_AceEditorAms",i.ajaxResponse.stepInfo.caseData.sqlCode),i.ajaxResponse.stepInfo.matchRule=i.ajaxResponse.stepInfo.matchRule||a,e.$broadcast("$Maunal_AceEditorAms_Pre_Response_Js",i.ajaxResponse.stepInfo.matchRule),e.$broadcast("$Maunal_AceEditorAms_Setting_Response_Js",i.ajaxResponse.stepInfo.generateResponseCode)}):(i.ajaxResponse.stepInfo.matchRule=a,e.$broadcast("$Maunal_AceEditorAms_Pre_Response_Js",a))},i.$onInit=function(){c.getDataResource(),i.component.blockListObject.body=c.initBodyListBlockConfig(),i.component.blockListObject.response=c.initResponseListBlockConfig(),c.watchSqlChange(),"edit"===a.params.opr?c.getInfo():i.ajaxResponse.stepInfo.caseData.params=i.ajaxResponse.stepInfo.caseData.params.concat(l.bodyArr),i.component.menuObject={list:[{type:"btn","class":"btn-group-li  pull-left",btnList:[{name:"返回",icon:"chexiao",fun:{"default":c.back}},{name:"保存","class":"eo_theme_btn_success block-btn",fun:{"default":c.save}}]}],setting:{"class":"common-menu-fixed-seperate inside_page_menu_mcc"}}}}angular.module("eolinker.ams").component("eoComponentSqlStepOpr",{templateUrl:"module/ams/component/sqlStepOpr/index.html",controller:e,bindings:{mainObject:"<"}}),e.$inject=["$scope","$state","Operate_CommonService","CODE","AutomatedTestResource","PUBLIC_RESOURCE_DB_TYPE_ARR","$rootScope"]}();
"use strict";!function(){function t(t,e,a){var n=this;n.data={text:""},n.fun={};var r={};r.setTagQuery=function(){var t={text:n.data.text};n.tagQuery.indexOf(t.text)==-1&&t.text.length>0&&(n.tagQuery.push(t.text),n.data.text="")},n.fun.commonClick=function(t){t.stopPropagation();var e={};try{e.point=t.target.classList[0]}catch(r){e.point="default"}switch(e.point){case"btn-delete":e.tag=t.target.getAttribute("eo-attr-tag"),n.tagQuery.splice(n.tagQuery.indexOf(e.tag),1);break;case"pdt-div":a[0].getElementsByTagName("input")[0].focus()}},n.fun.change=function(t){n.data.text=n.data.text.replace(",","").replace("，","").replace(" ","")},n.fun.keydown=function(t){switch(t.stopPropagation(),(t.keyCode||0).toString()){case"32":t.target.value.length!==n.data.text.length&&(t.target.value=n.data.text);case"188":case"13":r.setTagQuery();break;case"8":if(n.data.text)return;n.tagQuery.pop();break;case"229":"Comma"==t.code&&"Process"==t.key&&r.setTagQuery()}},n.fun.inputBlur=r.setTagQuery,t.global.$watch.push(e.$watch("$ctrl.tagString + $ctrl.tagFlag",function(){n.tagString?n.tagQuery=n.tagString.split(","):(n.data.text="",n.tagQuery=[])}))}angular.module("eolinker.ams").component("tagAmsComponent",{templateUrl:"module/ams/component/tag/index.html",controller:t,bindings:{tagString:"<",tagQuery:"=",tagFlag:"<"}}),t.$inject=["$rootScope","$scope","$element"]}();
"use strict";!function(){function t(){var t=this;t.data={}}angular.module("eolinker.ams").component("plugApiStatusStatistics",{templateUrl:"module/ams/component/plug/apiStatusStatistics/index.html",controller:t,bindings:{input:"<"}}),t.$inject=[]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,a,t,n,r,i,s,o,u,d,c){var p=this;p.data={constant:{headerArray:o.REQUEST_HEADER},info:{$index:0,pre:{},current:{planName:"",$index:"0",envObject:{frontURI:"",headerList:[{headerName:"",headerValue:""}],paramList:[{paramKey:"",paramValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}},groupInfo:[]},reset:{planName:"",planID:-1,$index:"0",envObject:{frontURI:"",headerList:[{headerName:"",headerValue:""}],paramList:[{paramKey:"",paramValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}},groupInfo:[]}},interaction:{request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,planID:parseInt(r.params.planID),uriID:-1,frontURI:"",headerName:"",headerValue:"",paramKey:"",paramValue:""},response:{envList:null,query:null}},fun:{cancle:null,init:null,click:null,add:null,edit:null,build:null,"delete":{sidebar:null,headerList:null,paramList:null,additionalParamList:null}},assistantFun:{init:null,getPlanInfo:null}},p.service={"default":u,authority:c},p.component={tipComponentObject:{type:"text",status:"error",text:"实验功能：SDK生成功能将于2019年7月1日下线维护，重新上线时间待定。请您在此前妥善保管好相关的数据，由此而给您带来的不便敬请谅解。"}};var l={groupCommon:a};p.data.fun.build=function(){var e={request:{spaceKey:p.data.interaction.request.spaceKey,projectHashKey:p.data.interaction.request.projectHashKey,planID:p.data.interaction.request.planID},modal:{title:"请选择目标语言",query:[{value:"0",name:"php"},{value:"1",name:"javascript"}]}};s.SingleSelectModal(e.modal,function(a){a&&(e.request.type=a.$index,d.Sdk.Build(e.request).$promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:n.$broadcast("$DumpDirective_Click_",{response:{fileName:e.url}})}}))})},p.data.fun.click=function(e){p.data.interaction.request.planID=e.item.planID,e.item.planID==-1?p.data.info.current=p.service["default"].sdkPlanObject.planInfo:e.item.planID==r.params.planID?p.data.info.current=p.data.info.pre:r.go("home.ams.project.inside.plug.sdk",{planID:e.item.planID}),p.data.info.$index=e.$index},p.data.fun["delete"].headerList=function(e){p.data.info.current.headerList.splice(e.$index,1)},p.data.fun["delete"].paramList=function(e){p.data.info.current.paramList.splice(e.$index,1)},p.data.fun["delete"].additionalParamList=function(e){p.data.info.current.additionalParamList.splice(e.$index,1)},p.data.fun["delete"].sidebar=function(e){e.$event.stopPropagation();var a={modal:{title:"删除方案",message:"请问是否删除该方案？"}};s.EnsureModal(a.modal.title,!1,a.modal.message,{},function(a){a&&d.Sdk.Delete({spaceKey:p.data.interaction.request.spaceKey,projectHashKey:p.data.interaction.request.projectHashKey,planID:e.item.planID}).$promise.then(function(a){switch(a.statusCode){case i.COMMON.SUCCESS:p.data.interaction.response.query.splice(e.$index,1),s.InfoModal("方案删除成功","success"),p.data.interaction.request.planID==e.item.planID&&(p.data.interaction.response.query.length>0?p.data.fun.click({item:p.data.interaction.response.query[0]}):(p.data.interaction.request.planID=null,r.go("home.ams.project.inside.plug.sdk",{planID:null})))}})})},p.data.fun.change=function(e){e.item=e.item||p.data.info.current.envObject;var a={reset:{},length:{header:e.item.headerList.length?e.item.headerList.length-1:0}};if(e.$last)switch(e["switch"]){case 0:e.item.headerList.push({headerName:"",headerValue:""});break;case 1:e.item.paramList.push({paramKey:"",paramValue:""});break;case 2:e.item.additionalParamList.push({paramKey:"",paramValue:""});break;default:if(!p.service.authority.permission.project.otherFunction.sdk)return;(!e.item.headerList[a.length.header]||e.item.headerList[a.length.header].headerName||e.item.headerList[a.length.header].headerValue)&&(e.item.headerList.push({headerName:"",headerValue:""}),e.item.paramList.push({paramKey:"",paramValue:""}),e.item.additionalParamList.push({paramKey:"",paramValue:""}))}},p.data.fun.cancle=function(){p.data.interaction.response.query.splice(p.data.interaction.response.query.length-1,1),p.data.info.current=p.data.info.pre,p.data.interaction.request.planID=p.data.info.current.planID},p.data.fun.add=function(){if(p.data.interaction.response.query&&(!p.data.interaction.response.query[p.data.interaction.response.query.length-1]||p.data.interaction.response.query[p.data.interaction.response.query.length-1].planID!=-1)){var e={object:{}};p.data.interaction.request.planID=-1,p.data.info.pre=p.data.info.current,p.data.info.current={},angular.copy(p.data.info.reset,p.data.info.current),angular.copy(p.data.info.reset,e.object),e.object.planName="新方案",p.data.interaction.response.query.push(e.object),p.service["default"].sdkPlanObject.planInfo=p.data.info.current}},p.data.fun.confirm=function(a){if(!n.ConfirmForm.$invalid){a=a||{};for(var t={request:{spaceKey:p.data.interaction.request.spaceKey,projectHashKey:p.data.interaction.request.projectHashKey,planName:p.data.info.current.planName,isInherit:p.data.info.current.isInherit?1:0,frontURI:p.data.info.current.envObject.frontURI,headers:[],params:[],additionalParamList:[],envAuth:"1"==p.data.info.current.envObject.envAuth.status?JSON.stringify(p.data.info.current.envObject.envAuth):'{"status":"0"}',planID:p.data.info.current.planID>-1?p.data.info.current.planID:null,groupInfo:JSON.stringify(p.data.info.current.groupInfo,function(e,a){if("groupID"===e||"groupName"===e||"className"===e||"groupDepth"===e||"object"==("undefined"==typeof a?"undefined":_typeof(a)))return a})},object:{},promise:null},r=0;r<p.data.info.current.envObject.headerList.length;r++){var o=p.data.info.current.envObject.headerList[r];if(o.headerValue&&!o.headerName)return;o.headerName&&t.request.headers.push({headerName:o.headerName,headerValue:o.headerValue})}for(var r=0;r<p.data.info.current.envObject.paramList.length;r++){var o=p.data.info.current.envObject.paramList[r];if(o.paramValue&&!o.paramKey)return;o.paramKey&&t.request.params.push({paramKey:o.paramKey,paramValue:o.paramValue})}for(var r=0;r<p.data.info.current.envObject.additionalParamList.length;r++){var o=p.data.info.current.envObject.additionalParamList[r];if(o.paramValue&&!o.paramKey)return;o.paramKey&&t.request.additionalParamList.push({paramKey:o.paramKey,paramValue:o.paramValue})}return t.request.headers=JSON.stringify(t.request.headers),t.request.params=JSON.stringify(t.request.params),t.request.additionalParamList=JSON.stringify(t.request.additionalParamList),t.request.planID?(t.promise=d.Sdk.Edit(t.request).$promise,t.promise.then(function(a){switch(a.statusCode){case i.COMMON.SUCCESS:case"401100":p.data.interaction.response.query[p.data.info.$index].planName=p.data.info.current.planName,s.InfoModal("编辑方案变量成功！","success");break;default:s.InfoModal("编辑方案变量失败，"+e.FAILURE,"error")}})):(t.promise=d.Sdk.Add(t.request).$promise,t.promise.then(function(n){switch(n.statusCode){case i.COMMON.SUCCESS:switch(s.InfoModal("新建方案变量成功！","success"),p.data.info.current.planID=n.planID,p.data.interaction.response.query.splice(p.data.interaction.response.query.length-1,1,p.data.info.current),a["switch"]){case 1:p.data.info.current=angular.copy(p.data.info.reset),angular.copy(p.data.info.reset,t.object),t.object.planName="新方案",p.service["default"].sdkPlanObject.planInfo=p.data.info.current,p.data.interaction.response.query.push(t.object);break;default:p.data.info.current=p.data.info.pre,p.data.interaction.request.planID=p.data.info.current.planID}break;default:s.InfoModal("新建方案变量失败，"+e.FAILURE,"error")}})),t.promise}},p.data.assistantFun.getPlanInfo=function(){var e={request:{spaceKey:p.data.interaction.request.spaceKey,projectHashKey:p.data.interaction.request.projectHashKey,planID:p.data.interaction.request.planID}};e.request.planID>0&&d.Sdk.Info(e.request).$promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:e.planInfo.envObject={frontURI:e.planInfo.frontURI,headerList:e.planInfo.headerList,paramList:e.planInfo.paramList,additionalParamList:e.planInfo.additionalParamList||[],envAuth:e.planInfo.envAuth||{status:"0"}},p.data.info.pre=p.data.info.current=e.planInfo,p.data.fun.change({"switch":-1,$last:1})}})},p.data.assistantFun.init=function(){var e={cache:{env:p.service["default"].sdkPlanObject.envObject.query},request:{spaceKey:p.data.interaction.request.spaceKey,projectHashKey:p.data.interaction.request.projectHashKey,module:0}};e.cache.env?(p.data.interaction.response.envList=e.cache.env,angular.copy(p.data.interaction.response.envList[0],p.data.info.reset.envObject)):t.Env.Query(e.request).$promise.then(function(e){p.data.interaction.response.envList=(e.envList||[]).concat([{envID:-1,envName:"自定义方案变量",frontURI:"",headerList:[{headerName:"",headerValue:""}],paramList:[{paramKey:"",paramValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}}])})["finally"](function(){p.service["default"].sdkPlanObject.envObject.query=p.data.interaction.response.envList,angular.copy(p.data.interaction.response.envList[0],p.data.info.reset.envObject)})},p.data.fun.init=function(){var e={cache:{group:p.service["default"].sdkPlanObject.groupObject.query,sdk:p.service["default"].sdkPlanObject.query},request:{spaceKey:p.data.interaction.request.spaceKey,module:2,projectHashKey:p.data.interaction.request.projectHashKey}};n.$emit("$WindowTitleSet",{list:["SDK生成","API管理"]}),e.cache.sdk?p.data.interaction.response.query=e.cache.sdk:d.Sdk.Query(e.request).$promise.then(function(e){p.data.interaction.response.query=e.planList||[]})["finally"](function(){p.service["default"].sdkPlanObject.query=p.data.interaction.response.query}),e.cache.group?(p.data.interaction.response.groupList=e.cache.group,p.data.info.reset.groupInfo=p.data.interaction.response.groupList):t.Group.Query(e.request).$promise.then(function(a){e.sortResponse=l.groupCommon.sort.init(a),p.service["default"].sdkPlanObject.groupObject.query=p.data.interaction.response.groupList=e.sortResponse.groupList,p.data.info.reset.groupInfo=p.data.interaction.response.groupList}),p.data.assistantFun.init(),p.data.assistantFun.getPlanInfo()}(),n.$on("$stateChangeStart",function(e,a){/home.ams.project.inside.plug.sdk/.test(a.name)||p.service["default"].sdkPlanObject.fun.clear()})}angular.module("eolinker.ams").component("plugSdk",{templateUrl:"module/ams/component/plug/sdk/index.html",controller:e}),e.$inject=["RESPONSE_TEXT","Group_MultistageService","GeneralFunResource","$scope","$state","CODE","$rootScope","HTTP_CONSTANT","EoPlugSdk_Service","ApiPluginSdkResource","Authority_CommonService"]}();
"use strict";!function(){function e(e,o){var a={info:{api:[],method:"POST"}};return a.info.api.Sdk=e(o+"apiManagementPro/SDK/:operate",{},{Info:{params:{operate:"getPlanInfo"},method:a.info.method},Query:{params:{operate:"getPlanList"},method:a.info.method},Add:{params:{operate:"addPlan"},method:a.info.method},Edit:{params:{operate:"editPlan"},method:a.info.method},Delete:{params:{operate:"deletePlan"},method:a.info.method},Build:{params:{operate:"produceSDK"},method:a.info.method}}),a.info.api}angular.module("eolinker.resource").factory("ApiPluginSdkResource",e),e.$inject=["$resource","serverUrl"]}();
"use strict";!function(){function n(n){var l={sdkPlanObject:{query:null,envObject:{query:null},groupObject:{query:null},planInfo:{},fun:{clear:null}}};return l.sdkPlanObject.fun.clear=function(){l.sdkPlanObject.query=null,l.sdkPlanObject.envObject.query=null,l.sdkPlanObject.groupObject.query=null,l.sdkPlanObject.planInfo=null},l}angular.module("eolinker.ams").factory("EoPlugSdk_Service",n),n.$inject=["$rootScope"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}!function(){function e(e,a,t,r,s,o,n,i,c,d,l,u,p){var m=this;m.data={executor:window.localStorage.getItem("EOLINKER_AUTOMATIC_TEST_USE_EXECUTOR_TYPE")||"parallel",pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},batch:{},batchMenu:{isOperating:!1},batchList:{isOperating:!0,selectAll:!1,query:[],indexAddress:{}},loadStorageQuery:{query:[],indexAddress:{}},listOrderBy:JSON.parse(window.localStorage.AUTOMATED_CASE_SORTTYPE||'{"orderBy": 1,"asc": 0}'),filterObject:{},plugObject:{needVersion:!0},testSeverType:window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE")||"plugin",validToSwitchTestMethod:eoSystemObj.validToSwitchTestMethod},m.fun={},m.ajaxResponse={query:null},m.service={group:c,home:u,authority:p},m.component={groupCommonObject:{},menuObject:{},listDefaultCommonObject:{}};var g={COMPONENT_MODULE:n.current.name.indexOf("commonCase")>-1?"commonCase":"sceneCase",DEFAULT_CODE:l.DEFAULT_CODE},h={caseCount:0,isQuerying:!0,resource:i.AutomatedTestCase},y={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey,caseID:[],groupID:n.params.groupID||-1,searchCondition:window.sessionStorage.getItem("COMMON_SEARCH_TIP"),orderBy:1,asc:1,connID:null,caseTag:null,projectModule:1,groupModule:"commonCase"===g.COMPONENT_MODULE?10:5,module:"commonCase"===g.COMPONENT_MODULE?1:0},f={};f.resetBatchInfo=function(){m.data.batchMenu.isOperating=!1,m.data.batch.query=m.data.batchList.query,m.data.batch.indexAddress=m.data.batchList.indexAddress,m.data.batch.selectAll=m.data.batchList.selectAll},f.batchMoveGroup=function(){var e={list:angular.copy(c.get()),title:"批量编辑API分组",current:y},a={spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module,caseID:JSON.stringify(m.data.batch.query),groupID:""};return e.list&&0!=e.list.length?void o.SelectVisualGroupModal(e,function(e){e&&(a.groupID=e.groupID,i.AutomatedTestCase.Move(a).$promise.then(function(e){switch(e.statusCode){case d.COMMON.SUCCESS:f.filterQuery(),o.InfoModal("Api批量编辑分组成功","success");break;default:o.InfoModal("操作失败"+s.FAILURE,"error")}}))}):void o.InfoModal("暂无分组，请先建立分组再操作！","error")},f.scrollLoading=function(){var e={hasItem:m.ajaxResponse.query&&0!==m.ajaxResponse.query.length,hasNextPage:m.data.pagination.page<m.data.pagination.msgCount/m.data.pagination.pageSize,isQuerying:h.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&(h.isQuerying=!0,f.getQuery("preload",m.data.pagination.page+1))},f.filterQuery=function(){e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"}),f.resetBatchInfo()},f.isMaxItemNum=function(){var e={commonCase:"commonCase",sceneCase:"testCase"},a=m.service.authority.productUsingPermission.automaticTest[e[g.COMPONENT_MODULE]],t=m.service.authority.productUsingPermissionTips.automaticTest[e[g.COMPONENT_MODULE]],r=m.service.authority.product.ams;if(a!=-1&&h.caseCount>=a)switch(r){case"free":return o.Common_UpgradeNoticeModal({mark:"AMS",module:"scene_case"}),!0;default:return o.InfoModal(t,"error"),!0}return!1},f.sort=function(a){m.data.listOrderBy=a.listOrderBy,e.$broadcast("$Init_LoadingCommonComponent")},f.test=function(e,a){switch(e){case"single":a.item.testing===!0?m.triggle={action:"stopSingleTest",param:{caseID:a.item.caseID}}:m.triggle={action:"singleTest",param:{caseID:a.item.caseID,caseType:a.item.caseType}},m.data.testing=!m.data.testing,a.item.testing=!a.item.testing;break;default:m.triggle={action:"batchTest",param:{isAsync:"parallel"===m.data.executor}}}},f.selectAll=function(e){var a=[];switch(e){case"selectAll":if(m.data.allQueryID.map(function(e,t){m.data.batch.indexAddress[e]||(m.data.batch.query.push(e),a.push(e),m.data.batch.indexAddress[e]=1)}),m.data.batchMenu.isOperating)return void(m.data.batch.selectAll=!0);a.length&&(m.triggle={action:"add",param:a},m.data.batch.selectAll=!0);break;case"selectView":var t=[],r=angular.copy(m.data.batch.query);if(m.data.batchMenu.isOperating)m.data.batch.query=[],m.data.batch.indexAddress={},m.ajaxResponse.query.map(function(e,a){m.data.batch.query.push(e.caseID),m.data.batch.indexAddress[e.caseID]=1}),m.data.batch.selectAll=!0;else{m.ajaxResponse.query.map(function(e,r){m.data.batch.indexAddress[e.caseID]||(a.push(e.caseID),m.data.batch.query.push(e.caseID),m.data.batch.indexAddress[e.caseID]=1),t.push(e.caseID)}),a.length&&(m.triggle={action:"add",param:a},m.data.batch.selectAll=!0);var s=t.concat(r).filter(function(e){return(!t.includes(e)||!r.includes(e))&&m.data.loadStorageQuery.indexAddress[e]});s.length&&(angular.forEach(s,function(e,a){m.data.loadStorageQuery.indexAddress[e]&&(m.data.batch.query.splice(m.data.batch.query.indexOf(e),1),delete m.data.batch.indexAddress[e],m.data.loadStorageQuery.query.splice(m.data.loadStorageQuery.query.indexOf(e),1),delete m.data.loadStorageQuery.indexAddress[e])}),m.triggle={action:"remove",param:s})}break;case"cancelAll":m.data.batchMenu.isOperating?(m.data.batch.query=[],m.data.batch.indexAddress={},m.data.batch.selectAll=!1):(m.data.allQueryID.map(function(e,t){m.data.loadStorageQuery.indexAddress[e]&&(a.push(e),m.data.batch.query.splice(m.data.batch.query.indexOf(e),1),delete m.data.batch.indexAddress[e],m.data.loadStorageQuery.query.splice(m.data.loadStorageQuery.query.indexOf(e),1),delete m.data.loadStorageQuery.indexAddress[e])}),a.length&&(m.triggle={action:"remove",param:a},m.data.batch.selectAll=!1))}},f.click=function(e,a){if(m.data.batchMenu.isOperating)return void a(e);var t={};try{t.point=e.$event.target.classList[0]}catch(r){t.point="default"}switch(t.point){case"select_checkbox":case"eo-checkbox":m.data.batch.indexAddress[e.item.caseID]?m.triggle={action:"remove",param:[e.item.caseID]}:m.triggle={action:"add",param:[e.item.caseID]},a(e);break;default:var s={caseID:e.item.caseID,groupID:y.groupID},o={commonCase:{uri:["home.ams.automatic.inside.commonCase.api"]},sceneCase:{uri:["home.ams.automatic.inside.scene.api"]}};n.go(o[g.COMPONENT_MODULE].uri[e.item.caseType],s)}},f["delete"]=function(e){var a=[];e?a.push(e.item.caseID):a=m.data.batch.query;var t={spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module,caseID:JSON.stringify(a)};o.EnsureModal("删除用例",!1,r.DELETE,{},function(e){e&&h.resource.Delete(t).$promise.then(function(e){switch(e.statusCode){case d.COMMON.SUCCESS:f.filterQuery(),a=f.deleteSelectedItem(a),a.length&&(m.triggle={action:"remove",param:a}),o.InfoModal("用例删除成功","success");break;default:o.InfoModal("删除失败，"+s.FAILURE,"error")}})})},f.editCase=function(a,t){t=t||{item:{}};var r={spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module,caseID:t.item?t.item.caseID:null},n={caseInfo:Object.assign({},t.item,"copy"===a?{caseName:"副本-"+t.item.caseName}:{}),group:{groupID:t.item.groupID||y.groupID||-1,parent:m.service.group.get()},status:a};return n.group.parent&&0!=n.group.parent?void("edit"!==a&&f.isMaxItemNum()||o.AMS_AutomatedTest_EditCaseModal(n,function(n){if(n)switch(angular.merge(r,n),a){case"copy":r.caseID=t.item.caseID,h.resource.Copy(r).$promise.then(function(a){switch(a.statusCode){case d.COMMON.SUCCESS:o.InfoModal("复制测试用例成功","success"),e.$broadcast("$Init_LoadingCommonComponent");break;default:o.InfoModal("操作失败，"+s.FAILURE,"error")}});break;case"add":1===r.caseType&&(r.caseCode=g.DEFAULT_CODE),h.resource.Add(r).$promise.then(function(a){switch(a.statusCode){case d.COMMON.SUCCESS:o.InfoModal("新建测试用例成功","success"),e.$broadcast("$Init_LoadingCommonComponent");break;default:o.InfoModal("操作失败，"+s.FAILURE,"error")}});break;case"edit":h.resource.Edit(r).$promise.then(function(a){switch(a.statusCode){case d.COMMON.SUCCESS:o.InfoModal("编辑测试用例成功","success"),e.$broadcast("$Init_LoadingCommonComponent");break;default:o.InfoModal("操作失败，"+s.FAILURE,"error")}})}})):void o.InfoModal("请先建立分组！","error")},f.isSelectAll=function(e){if(e.isOperating){e.selectAll=!1;for(var a=!1,t=0;t<m.ajaxResponse.query.length;t++)if(e.query.indexOf(m.ajaxResponse.query[t].caseID)===-1){a=!0;break}m.ajaxResponse.query.length&&!a&&(e.selectAll=!0)}},f.getQuery=function(e,a){var t={spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module,groupID:y.groupID>0?y.groupID:null,orderBy:m.data.listOrderBy.orderBy,asc:m.data.listOrderBy.asc,pageSize:m.data.pagination.pageSize},r=null;switch(h.isQuerying=!0,e){case"reset":t.page=1,r=function(e){h.isQuerying=!1,document.getElementsByClassName("tbody_container_ldcc")[0]&&(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0),h.caseCount=e.caseCount,m.data.pagination.msgCount=e.itemNum,m.ajaxResponse.query=e.caseList||[],f.isSelectAll(m.data.batch),h.preloadData=null},f.queryAllQueryID();break;case"refresh":t.pageSize=m.data.pagination.pageSize*m.data.pagination.page,t.page=1,r=function(e){h.isQuerying=!1,m.ajaxResponse.query=e.caseList||[]};break;case"preload":if(t.page=m.data.pagination.page+1,h.preloadData&&t.page===h.preloadData.dataPage)return;h.preloadData={dataPage:t.page},r=function(e){h.isQuerying=!1,h.preloadData.itemNum=e.itemNum,h.preloadData.caseList=e.caseList,m.data.batch.selectAll&&m.data.allQueryID&&m.data.batch.query.length!==m.data.allQueryID.length&&(m.data.batch.selectAll=!1),h.caseCount=e.caseCount,m.data.pagination.msgCount=h.preloadData.itemNum,m.ajaxResponse.query=m.ajaxResponse.query.concat(h.preloadData.caseList||[]),m.data.pagination.page++,h.preloadData=null}}if(y.searchCondition&&'{"keyword":""}'!=y.searchCondition){try{angular.merge(t,JSON.parse(y.searchCondition))}catch(s){}o.global.ajax.Query_AutomatedTestCase=h.resource.Search(t)}else o.global.ajax.Query_AutomatedTestCase=h.resource.Query(t);return o.global.ajax.Query_AutomatedTestCase.$promise.then(r),o.global.ajax.Query_AutomatedTestCase.$promise},f.queryAllQueryID=function(){var e={spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module,groupID:y.groupID>0?y.groupID:null,orderBy:m.data.listOrderBy.orderBy,asc:m.data.listOrderBy.asc},a=null;if(y.searchCondition&&'{"keyword":""}'!=y.searchCondition){try{angular.merge(e,JSON.parse(y.searchCondition))}catch(t){}a=h.resource.SearchIDQuery(e).$promise}else a=h.resource.IDQuery(e).$promise;a.then(function(e){m.data.allQueryID=e.caseIDList||[]})},f.initColumnFilter=function(){try{m.data.filterObject.indexAddress=JSON.parse(window.localStorage.AMS_AUTOMATIC_COLOUMN_FILTER_OBJECT)}catch(e){m.data.filterObject.indexAddress={tag:1,type:1,testResult:1,creator:1,updateTime:1}}for(var a in m.data.filterObject.indexAddress)0===m.data.filterObject.indexAddress[a]&&delete m.data.filterObject.indexAddress[a]},f.deleteSelectedItem=function(e){var a=[];return a=e.filter(function(e,a){var t=m.data.batch.query.indexOf(e);if(t!==-1)return e})},f.clickGroup=function(a,t){y.groupID=a.item.groupID,t(),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},f.search=function(a){if(y.searchCondition||a.item.keyword){var t=y.searchCondition?JSON.parse(y.searchCondition):{};t.keyword=a.item.keyword||"",y.searchCondition=JSON.stringify(t),window.sessionStorage.setItem("COMMON_SEARCH_TIP",y.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})}},f.exportGroup=function(e){var a={mark:"common",title:"导出分组",spaceKey:y.spaceKey,request:{groupID:e.item.groupID},resource:i.AutomatedTestGroup};o.AMS_ExportModal(a,function(e){})},f.importGroup=function(){var e={title:"导入分组",version:1,status:1,request:{spaceKey:y.spaceKey,projectHashKey:y.projectHashKey},resource:i.AutomatedTestGroup};o.Product_ImportModal(e,function(e){if(e)switch(m.component.groupCommonObject.mainObject.baseInfo.resetFlag=!m.component.groupCommonObject.mainObject.baseInfo.resetFlag,y.groupID){case-1:case"-1":n.go("home.ams.automatic.inside.scene.default",{groupID:n.params.groupID?null:-1})}})},f.changeExcuteInfo=function(e){switch(e){case"changeExecuteType":m.data.executor="serial"===m.data.executor?"parallel":"serial",m.triggle={action:"changeExecuteType",param:{type:m.data.executor}};break;default:m.triggle={action:"changeExecutor"}}},f.selectTestPlan=function(){m.triggle={action:"selectTestPlan"}},f.clear=function(){var e=angular.copy(m.data.batchList.query);angular.forEach(e,function(e,a){if(m.data.loadStorageQuery.indexAddress[e]){var t={indexA:m.data.batchList.query.indexOf(e),indexB:m.data.loadStorageQuery.query.indexOf(e)};m.data.batchList.query.splice(t.indexA,1),delete m.data.batchList.indexAddress[e],m.data.loadStorageQuery.query.splice(t.indexB,1),delete m.data.loadStorageQuery.indexAddress[e]}}),m.data.batchList.selectAll=!1},f.ajaxSearchCondition=function(e,a){i.AutomatedTestCase.getSearchConditionList({spaceKey:y.spaceKey,projectHashKey:y.projectHashKey,module:y.module}).$promise.then(function(t){e.sortAndFilterConf.filterArr=[{caseTag:""}].concat(_toConsumableArray(t.tagList||[])),a.sortAndFilterConf.filterArr=t.memberList||[]})},f.setFilter=function(a,t){var r=void 0;try{r=JSON.parse(y.searchCondition)||{keyword:""}}catch(s){r={keyword:""}}t.selectAll?delete r[a]:r[a]=JSON.stringify(t.query),y.searchCondition=JSON.stringify(r),window.sessionStorage.setItem("COMMON_SEARCH_TIP",y.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},m.fun.init=function(e){switch(e=e||{},e.status){case"refresh":return f.getQuery("refresh");default:return f.getQuery("reset")}},f.parseFilterIndexAddress=function(){var e={},a={},t=["caseTag","latestTestResult","creatorID","caseType"];try{e=JSON.parse(y.searchCondition)||{}}catch(r){}return e&&t.map(function(t){if(e[t]){a[t]={};var r=JSON.parse(e[t]),s=!0,o=!1,n=void 0;try{for(var i,c=r[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var d=i.value;a[t][d]=1}}catch(l){o=!0,n=l}finally{try{!s&&c["return"]&&c["return"]()}finally{if(o)throw n}}}}),a.keyword=e.keyword,a},m.$onInit=function(){m.data.batch=m.data.batchList;var r={btnGroupList:[],exportGroup:[]},s=f.parseFilterIndexAddress();switch(g.COMPONENT_MODULE){case"commonCase":r.btnGroupList=[{authority:"edit",name:"新建分组","class":"eo_theme_btn_success block-btn",icon:"jiahao",funName:"edit"}];break;default:r.exportGroup=[{fun:f.exportGroup,key:"导出分组",authority:"export"}],r.btnGroupList=[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建分组","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{funName:"edit",key:"新建分组"},{key:"导入",fun:f.importGroup}]}]}m.component.groupCommonObject={requestObject:{resource:t.Group,baseRequest:{module:y.groupModule,spaceKey:y.spaceKey,projectHashKey:y.projectHashKey}},funObject:{btnGroupList:r.btnGroupList,baseFun:{click:f.clickGroup},callback:{querySuccess:function(e){c.set(e)}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:y},staticQuery:[{groupID:-1,groupName:"所有用例",icon:"caidan"}],itemFun:[{funName:"edit",key:"新建子分组",authority:"edit",params:'"add-child",arg',isStrong:1}].concat(_toConsumableArray(r.exportGroup),[{funName:"edit",key:"编辑",authority:"edit",params:'"edit",arg'},{funName:"delete",authority:"edit",params:{callback:function(a,t,r){t.caseID=t.caseID||[];var s=t.caseID;s=f.deleteSelectedItem(s),s.length&&(m.triggle={action:"remove",param:s}),y.groupID.toString()===a.item.groupID.toString()?(y.groupID=a.item.parentGroupID||-1,e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})):"child"===r.nowGroupWithDelteItemRelation?(y.groupID=-1,e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})):"father"===r.nowGroupWithDelteItemRelation&&t.caseID.length&&e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},modal:{title:"删除分组",message:"删除分组后，分组内的用例也会一并删除，确认删除该分组及分组内的测试用例？"}},key:"删除"}])}},f.initColumnFilter();var o=a.get("module/ams/component/sceneBatchTest/partA/index.tmp.html");m.component.menuObject={list:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"新建用例",icon:"jiahao","class":"eo_theme_btn_success block-btn",fun:{"default":f.editCase,params:'"add"',from:"case"}}]},{type:"customized-html","class":"pull-left menu-ml15",fun:f.test,otherFun:f.changeExcuteInfo,html:o.match(/<eo-divide-testall>((?!(<\/eo-divide-testall>)).)*/)[0].replace("<eo-divide-testall>","")},"commonCase"!==g.COMPONENT_MODULE?{type:"btn","class":"pull-left",btnList:[{name:"测试方案",icon:"zhangdan-wancheng",attrPlaceholder:"test_plan_btn",fun:{"default":f.selectTestPlan}}]}:"",{type:"tab_block_list","class":"pull-right ml15",name:"列表项",icon:"shebeisousuo",blockName:"listItem",query:[{key:"tag",value:"tag"},{key:"最近测试结果",value:"testResult"},{key:"创建者",value:"creator"},{key:"更新时间",value:"updateTime"}]},{type:"customized-html","class":" fun-list-li  pull-right ml0",html:'<div style="width:180px;height:30px"></div>'},{type:"search","class":"pull-right",keyword:s.keyword,fun:f.search}],baseFun:{batchDefault:function(){m.data.batchList=angular.copy(m.data.batch),m.data.batchMenu.isOperating=!0,m.data.batch.indexAddress={},m.data.batch.query=[],m.data.batch.selectAll=!1}},batchList:[{type:"btn","class":"pull-left",btnList:[{name:"迁移分组",fun:{"default":f.batchMoveGroup}},{name:"删除",icon:"shanchu",fun:{"default":f["delete"],params:""}}]}],setting:{listItemStorageName:"AMS_AUTOMATIC_COLOUMN_FILTER_OBJECT",title:"流程测试用例",batch:!0,batchInitFun:f.resetBatchInfo}};var n={showPoint:"columnFilterObject",showVariable:"tag",show:1,key:"Tag",html:"{{item.caseTag}}",draggableCacheMark:"tag",sortAndFilterConf:{canFilterValue:"caseTag",canFilter:!0,filterArr:[],"class":"w_200",filterHtml:'<span ng-class="{\'c999\':item.caseTag===\'\'}">{{item.caseTag===""?"空白标签":item.caseTag}}</span>',checkboxKeyIsNum:!1,filterIndexAddress:s.caseTag},filterFun:function(e){f.setFilter("caseTag",e)}},i={showPoint:"columnFilterObject",showVariable:"creator",show:1,key:"创建者",html:"<span>{{item.creator}}</span>",draggableCacheMark:"creator",sortAndFilterConf:{canFilterValue:"connID",canFilter:!0,filterArr:[],"class":"w_250",filterHtml:'{{item.memberNickName||item.partnerNickName||item.userNickName}}<span class="eo-status-tips fs12">（{{item.inviteCall}}）</span>',filterIndexAddress:s.creatorID},filterFun:function(e){f.setFilter("creatorID",e)}};m.component.listDefaultCommonObject={item:{primaryKey:"caseID",batchItemExpression:"ng-disabled='!$ctrl.otherObject.batchMenu.isOperating&&$ctrl.otherObject.batch.indexAddress[item.caseID]&&!$ctrl.otherObject.loadStorageQuery.indexAddress[item.caseID]'","default":[{key:"用例名称",sort:!0,sortOrderByVal:0,html:"{{item.caseName}}",draggableCacheMark:"name",sortAndFilterConf:{canSort:!0}},n,{key:"最近测试结果",showPoint:"columnFilterObject",showVariable:"testResult",show:1,html:o.match(/<eo-divide-testresult>((?!(<\/eo-divide-testresult>)).)*/)[0].replace("<eo-divide-testresult>",""),draggableCacheMark:"testResult",sortAndFilterConf:{canFilter:!0,filterHtml:"{{item.key}}","class":"w_200",filterArr:[{key:"测试成功",value:0},{key:"测试失败",value:1},{key:"未测试",value:2}],filterIndexAddress:s.latestTestResult},filterFun:function(e){f.setFilter("latestTestResult",e)}},i,{showPoint:"columnFilterObject",showVariable:"updateTime",show:1,sort:!0,sortOrderByVal:1,key:"更新时间",html:"{{item.updateTime}}",isUnneccessary:!0,draggableCacheMark:"updateTime",sortAndFilterConf:{canSort:!0,"class":"eo_to_right_0"}}],operate:{listExpression:'ng-hide="$ctrl.otherObject.batchMenu.isOperating"',funArr:[{type:"html",html:o.match(/<eo-divide-testsingle>((?!(<\/eo-divide-testsingle>)).)*/)[0].replace("<eo-divide-testsingle>",""),fun:f.test,params:'"single",arg'},{key:"复制",authority:"edit",disabledHtml:"$ctrl.otherObject.status",fun:f.editCase,params:'"copy",arg'},{key:"编辑",authority:"edit",disabledHtml:"$ctrl.otherObject.status",fun:f.editCase,params:'"edit",arg'},{key:"删除",authority:"edit",disabledHtml:"$ctrl.otherObject.status",fun:f["delete"]}],"class":"w_200"}},setting:{page:!0,scroll:!0,scrollRemainRatio:7,draggable:!0,dragCacheVar:"AMS_AUTOMATIC_CASE_LIST_DRAG_VAR",dragCacheObj:{name:"400px",type:"80px",tag:"100px",testResult:"150px",creator:"100px",updateTime:"150px"},colspan:4,warning:"尚未新建任何用例",isFixedHeight:!0,batch:!0,batchInitStatus:"open",selfControllClickBatch:!0,autoSort:!0,sortStorageKey:"AUTOMATED_CASE_SORTTYPE",sortDefaultVal:{storageVal:{orderBy:1,asc:0},sortOrder:"asc"}},baseFun:{scrollLoading:f.scrollLoading,selectAll:f.selectAll,click:f.click,autoSortFun:f.sort}},f.ajaxSearchCondition(n,i),e.$emit("$TransferStation",{state:"$EnvInitReady"})},e.$on("$stateChangeStart",function(e,a,t){if(!h.sureJump&&m.data.batchList.query.length){e.preventDefault();var r="确认离开当前页面?";switch(a.name){case"home.ams.automatic.inside.report":r="跳转到测试报告下载页面";break;case"home.ams.automatic.inside.commonCase.default":r="确认前往测试模板库?"}o.EnsureModal(r,!1,"当前测试控制台有测试用例，离开当前页面会清空测试控制台，请问是否继续？",{btnMessage:"确定",btnType:2},function(e){e&&(h.sureJump=!0,n.go(a,t))})}}),o.global.$watch.push(e.$watch("$ctrl.data.batchMenu.isOperating",function(){m.envStatus=m.data.batchMenu.isOperating?"hide":"show"})),o.global.$watch.push(e.$watch("$ctrl.accept",function(){if(m.accept&&m.accept.action&&m.accept)switch(m.accept.action){case"refresh":e.$broadcast("$Init_LoadingCommonComponent",{status:"refresh"});break;case"remove":var a={indexA:m.data.batchList.query.indexOf(m.accept.param),indexB:m.data.loadStorageQuery.query.indexOf(m.accept.param)};a.indexB!==-1&&(m.data.batchList.query.splice(a.indexA,1),delete m.data.batchList.indexAddress[m.accept.param],m.data.loadStorageQuery.query.splice(a.indexB,1),delete m.data.loadStorageQuery.indexAddress[m.accept.param]),m.data.batchList.selectAll=!1;break;case"clear":var t=angular.copy(m.data.batchList.query);angular.forEach(t,function(e,a){if(m.data.loadStorageQuery.indexAddress[e]){var t={indexA:m.data.batchList.query.indexOf(e),indexB:m.data.loadStorageQuery.query.indexOf(e)};m.data.batchList.query.splice(t.indexA,1),delete m.data.batchList.indexAddress[e],m.data.loadStorageQuery.query.splice(t.indexB,1),delete m.data.loadStorageQuery.indexAddress[e]}}),m.data.batchList.selectAll=!1;break;case"ajaxEnd":angular.forEach(m.accept.param,function(e,a){m.data.batchList.indexAddress[e]&&(m.data.loadStorageQuery.indexAddress[e]=1,m.data.loadStorageQuery.query.push(e))});break;case"singleTestEnd":for(var r=0;r<m.ajaxResponse.query.length;r++){var s=m.ajaxResponse.query[r];if(s.caseID===m.accept.param.caseID){s.testing=!1,s.latestTestResult=m.accept.param.latestTestResult||s.latestTestResult;break}}m.data.testing=!1;break;case"changeExecutorEnd":m.data.testSeverType="nodejs"===m.data.testSeverType?"plugin":"nodejs";break;case"changeExecuteType":m.data.executor=m.accept.param.type;break;case"selectTestPlan":m.data.batchList.query=[],m.data.batchList.indexAddress={},m.data.loadStorageQuery.query=[],m.data.loadStorageQuery.indexAddress={},angular.forEach(m.accept.param,function(e,a){m.data.batchList.query.push(e),m.data.loadStorageQuery.query.push(e),m.data.batchList.indexAddress[e]=m.data.loadStorageQuery.indexAddress[e]=1}),f.isSelectAll(m.data.batchList)}}))}angular.module("eolinker.ams").component("sceneBatchTestAmsPartA",{templateUrl:"module/ams/component/sceneBatchTest/partA/index.html",controller:e,bindings:{triggle:"=",accept:"<",envStatus:"=",bindTipStatus:"="}}),e.$inject=["$scope","$templateCache","GeneralFunResource","ENSURE_WARNIMG","RESPONSE_TEXT","$rootScope","$state","AutomatedTestResource","GroupService","CODE","AUTOMATE_TEST_CONSTANT","Operate_CommonService","Authority_CommonService"]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,s,a,o,n,c,i,r,l,u,d){var p=this;p.data={planBtnHtml:n.get("module/ams/component/sceneBatchTest/partB/testplan.tmp.html"),executor:window.localStorage.getItem("EOLINKER_AUTOMATIC_TEST_USE_EXECUTOR_TYPE")||"parallel",isSpreedConsole:!1,plugObject:{needVersion:!0,matchVersion:593},selectedPlanName:"",isTesting:!1,testSeverType:window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE")||"plugin",testHistory:{},selectCaseNum:0,ajaxQueryNum:0,batch:{selectAll:!0,indexAddress:{},query:[]},isInheritCookie:"true"===window.localStorage.getItem("EO_AUTOMATIC_SCENE_CASE_IS_COOKIE_INHERIT"),plugTransferToLocal:eoSystemObj.plugTransferToLocal},p.service={authority:i,home:s},p.component={blockListObject:{},dragChangeHeightCommonDirectiveObj:{setting:{clientY:51,minHeight:30,object:"height"},baseFun:{mouseDown:function(e){e[0].className=e[0].className.replace("transition_hpicpb","")}}}},p.CONST={COMPONENT_MODULE:l.current.name.indexOf("commonCase")>-1?"commonCase":"sceneCase"},p.ajaxResponse={query:[]},p.fun={},p.testStatusObj={isTesting:!1,testMethod:null,singleTestEndCallback:function(){p.triggle={action:"singleTestEnd",param:{caseID:h.caseTestHistoryObj.caseID,latestTestResult:p.data.testHistory[h.caseTestHistoryObj.caseID].responseType}},m.showTestHistory("success",h.caseTestHistoryObj),h.caseTestHistoryObj={}}};var m={},T={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:l.params.projectHashKey,module:"commonCase"===p.CONST.COMPONENT_MODULE?1:0},y={cache:a},b={acceptIndexArr:[],testPointArr:[]},h={ws:null,selectedPlanID:"",wsLocalUrl:"ws://"+eoSystemObj.WS_TARGET_PREFIX_URL,wsServerUrl:(eoSystemObj.HOST.indexOf("https")>-1?"wss://":"ws://")+(eoSystemObj.PLATFORM.indexOf("sass")!==-1?eoSystemObj.WS_TARGET_PREFIX_URL:eoSystemObj.HOST.replace(/(http)(()|(s))(:\/\/)/,"")),wsUrl:"",caseTestHistoryObj:{}};p.fun.setInheritCookieStatus=function(){p.data.isInheritCookie=!p.data.isInheritCookie,window.localStorage.setItem("EO_AUTOMATIC_SCENE_CASE_IS_COOKIE_INHERIT",p.data.isInheritCookie)},p.fun.test=function(e,t){p.testStatusObj.testMethod=e;var s=p.data.plugObject.useStatus&&"nodejs"!==p.data.testSeverType,a=[],o=function(){switch(h.ws&&("plugin"===p.data.testSeverType&&h.wsUrl.indexOf(h.wsLocalUrl)===-1||"nodejs"===p.data.testSeverType&&h.wsUrl.indexOf(h.wsServerUrl)===-1)&&(h.ws.close(),h.ws=null),"singleTest"!==e&&(p.data.isOperate=!0),e){case"all":p.testStatusObj.isTesting=!p.testStatusObj.isTesting,p.testStatusObj.isTesting&&(a=[],p.ajaxResponse.query.map(function(e){p.data.batch.indexAddress[e.caseID]&&(a.push(e.caseID),p.data.testHistory[e.caseID]&&(p.data.testHistory[e.caseID].responseType="testing"))}));break;case"single":p.testStatusObj.isTesting=p.data.testHistory[t.item.caseID].testing=!p.data.testHistory[t.item.caseID].testing,p.testStatusObj.isTesting&&(a=[t.item.caseID],p.data.testHistory[t.item.caseID]&&(p.data.testHistory[t.item.caseID].responseType="testing"));break;case"singleTest":p.testStatusObj.isTesting=!p.testStatusObj.isTesting,a=[t.item.caseID]}p.testStatusObj.isTesting?(b.testPointArr=a,h.ws?h.ws.send(JSON.stringify({status:"ajax",env:p.service.home.envObject.object.total,query:a,cookieInheritStatus:"serial"===p.data.executor&&p.data.isInheritCookie,executor:p.data.executor})):m.bindWs(JSON.stringify({status:"ajax",env:p.service.home.envObject.object.total,query:a,cookieInheritStatus:"serial"===p.data.executor&&p.data.isInheritCookie,executor:p.data.executor}),!0)):(b.testPointArr.map(function(e){p.data.testHistory[e]&&("testing"===p.data.testHistory[e].responseType?delete p.data.testHistory[e].responseType:"")}),h.ws&&h.ws.send(JSON.stringify({status:"abort"})))},n=function(){switch("singleTest"!==e&&(p.data.isOperate=!0),e){case"all":p.testStatusObj.isTesting=!p.testStatusObj.isTesting,p.testStatusObj.isTesting&&(a=[],p.ajaxResponse.query.map(function(e){p.data.batch.indexAddress[e.caseID]&&(a.push(e.caseID),p.data.testHistory[e.caseID]&&(p.data.testHistory[e.caseID].responseType="testing"))}));break;case"single":p.testStatusObj.isTesting=p.data.testHistory[t.item.caseID].testing=!p.data.testHistory[t.item.caseID].testing,p.testStatusObj.isTesting&&(a=[t.item.caseID],p.data.testHistory[t.item.caseID]&&(p.data.testHistory[t.item.caseID].responseType="testing"));break;case"singleTest":p.testStatusObj.isTesting=!p.testStatusObj.isTesting,a=[t.item.caseID]}p.testStatusObj.isTesting?(b.testPointArr=a,h.ws&&(h.ws.close(),h.ws=null),window.sessionStorage.setItem("plug-batchTest-info",JSON.stringify({executor:p.data.executor,env:p.service.home.envObject.object.total,caseID:a,timeoutLimit:h.timeoutLimit,timeoutLimitType:h.timeoutLimitType}))):(b.testPointArr.map(function(e){p.data.testHistory[e]&&("testing"===p.data.testHistory[e].responseType?delete p.data.testHistory[e].responseType:"")}),!s&&h.ws&&h.ws.send(JSON.stringify({status:"abort"})))};!eoSystemObj.plugTransferToLocal&&s?p.testStatusObj.isTesting?n():(h.ws&&(h.ws.close(),h.ws=null),p.data.hideTips=window.localStorage.getItem("EO_PLUG_TIPS_HIDE"),"true"===p.data.hideTips?n():("singleTestEnd"===e&&(p.triggle={action:"singleTestEnd",param:{caseID:t.item.caseID}}),d.Ams_Plug_TipsModal({excuteType:p.data.executor},function(e){e&&("server"===e?(p.fun.changeTestSeverType(),o()):n())}))):o()},p.fun.downloadReport=function(){var t=null,s={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,module:T.module,reportType:0,logID:p.testStatusObj.logID,condition:0};return t=r.AutomatedTestHistory.ExportReport(s).$promise,t.then(function(t){switch(t.statusCode){case u.COMMON.SUCCESS:e.$broadcast("$DumpDirective_Click_TestWordFile",{response:{fileName:t.fileName}});break;default:d.InfoModal("下载失败，请稍候再试或提交工单反馈","error")}}),t},m.bindWs=function(s){h.ws||(h.wsUrl="vspex_pc"===eoSystemObj.PLATFORM?"nodejs"===p.data.testSeverType?h.wsServerUrl:h.wsLocalUrl:h.wsServerUrl,h.ws=new WebSocket(h.wsUrl+"/nodeWebsocketServer/sceneCaseTest"),h.ws.onopen=function(){eoCookie.getCookieStrByUrl(t,function(e){if(h.ws.send(JSON.stringify({spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,timeoutLimit:h.timeoutLimit,timeoutLimitType:h.timeoutLimitType,cookie:e,module:T.module,status:"init",lang:window.eoLang})),s)switch("undefined"==typeof s?"undefined":_typeof(s)){case"string":h.ws.send(s);break;case"object":s.map(function(e,t){h.ws.send(e)})}})},h.ws.onmessage=function(t){var s=JSON.parse(t.data);switch(s.statusCode){case u.COMMON.SUCCESS:"all"===p.testStatusObj.testMethod&&s.logID?(p.testStatusObj.logID=s.logID,p.testStatusObj.isWaitToDownload=!1):s.logID||("singleTest"===p.testStatusObj.testMethod?(p.triggle={action:"singleTestEnd",param:{caseID:h.caseTestHistoryObj.caseID,latestTestResult:p.data.testHistory[h.caseTestHistoryObj.caseID].responseType}},m.showTestHistory("success",h.caseTestHistoryObj),h.caseTestHistoryObj={}):"all"===p.testStatusObj.testMethod&&(p.testStatusObj.isWaitToDownload=!0),p.testStatusObj.isTesting=!1);break;case"140000":p.testStatusObj.isTesting=!1;break;default:if(!p.testStatusObj.isTesting)return;for(var a in s){var o=s[a];switch(o.caseType){case 0:o.responseType=o.reportStatus;break;case 1:o.responseType=o.status}o.testTime=c("currentTimeFilter")(),p.data.testHistory[a]=o}}e.$root&&e.$root.$$phase||e.$apply()},h.ws.onclose=function(e){h.ws=null},h.ws.onerror=function(e){h.ws=null})},p.fun.changeTestExecutorType=function(e){e?p.data.executor=e:(p.data.executor="parallel"===p.data.executor?"serial":"parallel",p.triggle={action:"changeExecuteType",param:{type:p.data.executor}}),"parallel"===p.data.executor?window.localStorage.removeItem("EO_AUTOMATIC_SCENE_CASE_IS_COOKIE_INHERIT"):window.localStorage.setItem("EO_AUTOMATIC_SCENE_CASE_IS_COOKIE_INHERIT",p.data.isInheritCookie),window.localStorage.setItem("EOLINKER_AUTOMATIC_TEST_USE_EXECUTOR_TYPE",p.data.executor)},p.fun.changeTestSeverType=function(){if(p.data.plugObject.useStatus){switch(p.data.testSeverType){case"nodejs":p.data.testSeverType="plugin";break;default:p.data.testSeverType="nodejs"}p.triggle={action:"changeExecutorEnd"}}else{var e={html_1:"<div class='lh_30'><p>",html_2:"<a href='https://www.eolinker.com/#/plug/introduce' target='_blank' class='eo-status-warning' ><b>",html_3:"</b>",html_4:"</a>",html_5:"</p></div>",operate:window.plug&&"application/eolinker"===window.plug.type?"更新":"安装"},t="";t="更新"===e.operate?"{@html_1}测试增强插件已经提供新版本V5.9.3，请您先升级安装新版本插件{@html_2}[点此获取]{@html_3}{@html_4}。</br>升级插件版本后将会支持新的功能以及特性，由此带来不便之处，敬请谅解。{@html_5}":"{@html_1}如需切换使用插件测试，请先安装我们为您免费提供的 {@html_2}测试增强插件{@html_3} [点击获取]{@html_4}！{@html_5}",d.MessageModal("温馨提示",c("JsConstructHtml_CommonFilter")(t,e),{button:{sure:{content:"下载插件离线安装包",fun:function(){window.open(eoSystemObj.ADDRESS_PLUG)}}}}),p.data.testSeverType="nodejs"}window.localStorage.setItem("EOLINKER_TEST_USE_SOFTWARE_TYPE",p.data.testSeverType)},m.clear=function(){p.ajaxResponse.query=[],b.acceptIndexArr=[],p.data.selectCaseNum=0,p.data.testHistory={},p.data.ajaxQueryNum=0,p.data.batch.selectAll=!0,p.data.batch.indexAddress={},p.data.batch.query=[]},p.fun.clear=function(){m.clear(),p.data.selectedPlanName="",h.selectedPlanID="",p.triggle={action:"clear"}},m.selectTestPlan=function(){var e={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,planID:h.selectedPlanID};p.data.ajaxQueryNum++,r.TestPlan.Detail(e).$promise.then(function(e){switch(e.statusCode){case u.COMMON.SUCCESS:m.clear(),p.data.ajaxQueryNum--;var t=e.caseList||[];p.data.isInheritCookie=1===e.planInfo.cookieInheritStatus,window.localStorage.setItem("EO_AUTOMATIC_SCENE_CASE_IS_COOKIE_INHERIT",p.data.isInheritCookie),t.map(function(t){e.planInfo.selectedCaseID.indexOf(t.caseID)>-1&&(p.data.batch.indexAddress[t.caseID]=1,p.data.batch.query.push(t.caseID)),p.data.testHistory[t.caseID]={responseType:t.latestTestResult,testTime:t.testTime}}),b.acceptIndexArr=e.planInfo.caseID,p.data.selectCaseNum=e.planInfo.selectedCaseID.length,p.ajaxResponse.query=t,b.acceptIndexArr.length!==p.data.selectCaseNum&&(p.data.batch.selectAll=!1),p.triggle={action:"selectTestPlan",param:e.planInfo.caseID};break;default:d.InfoModal("获取测试计划用例失败，"+o.FAILURE,"error")}})},m.editTestPlan=function(){var e=[],t=[];p.ajaxResponse.query.map(function(s){t.push(s.caseID),p.data.batch.indexAddress[s.caseID]&&e.push(s.caseID)});var s={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,planName:p.data.selectedPlanName,planID:h.selectedPlanID,planInfo:JSON.stringify({caseID:t,selectedCaseID:e,cookieInheritStatus:p.data.isInheritCookie===!0?1:0})};r.TestPlan.Edit(s).$promise.then(function(e){switch(e.statusCode){case u.COMMON.SUCCESS:d.InfoModal("保存测试方案成功","success");break;default:d.InfoModal("保存测试方案失败，"+o.FAILURE,"error")}})},p.fun.handleTestPlan=function(e){if(!e)if(0===p.ajaxResponse.query.length)e="query";else{if(p.data.selectedPlanName)return e="edit",void m.editTestPlan();e="save"}var t={type:e,ajaxRequest:{spaceKey:T.spaceKey,projectHashKey:T.projectHashKey}},s=null;switch(e){case"save":var a=[],o=[];p.ajaxResponse.query.map(function(e){a.push(e.caseID),p.data.batch.indexAddress[e.caseID]&&o.push(e.caseID)}),h.selectedPlanID&&(t.selectedPlanName=p.data.selectedPlanName,t.selectedPlanID=h.selectedPlanID),t.planInfo={caseID:a,selectedCaseID:o,cookieInheritStatus:p.data.isInheritCookie===!0?1:0},s=function(e){h.selectedPlanID=e.planID,p.data.selectedPlanName=e.planName};break;case"query":s=function(e){p.data.isSpreedConsole=!0,p.data.selectedPlanName=e.planName,h.selectedPlanID=e.planID,m.selectTestPlan()};break;case"manage":h.selectedPlanID&&(t.selectedPlanName=p.data.selectedPlanName,t.selectedPlanID=h.selectedPlanID),s=function(e){"change"===e.type?e.isDelete?(p.data.selectedPlanName="",h.selectedPlanID=""):p.data.selectedPlanName=e.planName:(p.data.isSpreedConsole=!0,p.data.selectedPlanName=e.planName,h.selectedPlanID=e.planID,m.selectTestPlan())}}d.Ams_TestPlanModal(t,function(e){e&&s(e)})},m.newTabCase=function(e){var t={caseID:e.item.caseID},s={commonCase:{uri:["home.ams.automatic.inside.commonCase.api"]},sceneCase:{uri:["home.ams.automatic.inside.scene.api"]}};window.open(l.href(s[p.CONST.COMPONENT_MODULE].uri[e.item.caseType],t))},m.initBlockTable=function(){p.component.blockListObject["case"]={baseFun:{showTestHistory:m.showTestHistory,getTime:m.getTime,checkIsValidItem:function(){return!p.testStatusObj.isTesting},clickCheckbox:function(e,t){switch(e){case"plus-single":p.data.selectCaseNum++;break;case"plus-all":p.data.selectCaseNum=p.data.selectCaseNum+t.currentLenght-t.oldLength;break;case"minus-single":p.data.selectCaseNum--;break;case"minus-all":p.data.selectCaseNum=p.data.selectCaseNum-t.oldLength}}},setting:{checkboxKeyIsNum:!0,trExpression:'ng-if="!item.isHide"',unsortableVar:"allIsTesting"},tdList:[{type:"sort"},{type:"checkbox",activeKey:"caseID",isWantedToExposeObject:!0},{thHtml:'用例名称<button ng-disabled="$ctrl.otherObject.allIsTesting" class="ml10 eo-operate-btn va_top" type="button" ng-click="$ctrl.otherObject.clearAllFun()">清空列表</button>',type:"thHtml",modelKey:"caseName"},{thKey:"最近测试结果",type:"html",html:n.get("module/ams/component/sceneBatchTest/partB/index.tmp.html"),"class":"w_200"},{thKey:"测试执行时间",type:"html","class":"w_200",html:"{{$ctrl.otherObject.testHistoryObj[item.caseID].testTime}}"},{type:"btn","class":"w_250",btnList:[{html:'{{$ctrl.otherObject.testHistoryObj[item.caseID].testing?"中止":"测试"}}',fun:p.fun.test,param:'"single",inputArg,vm.otherObject.apiID',"class":"batch-test-btn",itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting&&!$ctrl.otherObject.testHistoryObj[item.caseID].testing" testing="{{$ctrl.otherObject.testHistoryObj[item.caseID].testing||false}}"',isUnWantToStopPropagation:!0},{key:"编辑",fun:m.newTabCase,itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'},{key:"移出列表",operateName:"delete",fun:m.remove,param:"inputArg.$index,inputArg.item.caseID",itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'}]}]}},m.remove=function(e,t){if(p.ajaxResponse.query.splice(e,1),b.acceptIndexArr.splice(e,1),p.data.batch.indexAddress[t]){p.data.selectCaseNum--,delete p.data.batch.indexAddress[t];var s=p.data.batch.query.indexOf(t);p.data.batch.query.splice(s,1)}p.ajaxResponse.query.length!==p.data.selectCaseNum||p.data.batch.selectAll||(p.data.batch.selectAll=!0),p.data.testHistory[t]&&delete p.data.testHistory[t],p.triggle={action:"remove",param:t}},p.fun.spreedConsole=function(e){p.data.isSpreedConsole=e},m.getCaseList=function(e){p.data.ajaxQueryNum++;var t={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,module:T.module,caseID:JSON.stringify(e)},s=r.AutomatedTestCase.BatchQuery(t);s.$promise.then(function(t){switch(p.data.ajaxQueryNum--,t.statusCode){case u.COMMON.SUCCESS:var s=t.caseList||[];p.data.selectCaseNum+=s.length,s.map(function(e){p.data.batch.indexAddress[e.caseID]=1,p.data.batch.query.push(e.caseID),p.data.testHistory[e.caseID]={responseType:e.latestTestResult,testTime:e.testTime}}),p.ajaxResponse.query=(p.ajaxResponse.query||[]).concat(s)}p.triggle={action:"ajaxEnd",param:e}})},m.actionOpr=function(e){switch(e.action){case"add":m.getCaseList(e.param),0===b.acceptIndexArr.length&&(p.data.isSpreedConsole=!0),b.acceptIndexArr=b.acceptIndexArr.concat(e.param);break;case"selectTestPlan":p.fun.handleTestPlan("query");break;case"remove":e.param.map(function(e){var t=b.acceptIndexArr.indexOf(e);p.ajaxResponse.query.splice(t,1),b.acceptIndexArr.splice(t,1)});break;case"singleTest":h.caseTestHistoryObj={caseID:e.param.caseID,caseType:e.param.caseType};case"stopSingleTest":p.fun.test("singleTest",{item:{caseID:e.param.caseID}});break;case"changeExecuteType":p.fun.changeTestExecutorType(e.param.type);break;case"batchTest":p.fun.spreedConsole(!0),p.fun.test("all");break;case"changeExecutor":p.fun.changeTestSeverType()}},e.$watch("$ctrl.accept",function(){p.accept&&p.accept.action&&m.actionOpr(p.accept)}),p.fun.watchUi=function(e){switch(e){case"changeServerType":p.fun.changeTestSeverType();break;case"changeExecutorType":p.fun.changeTestExecutorType()}},p.fun.refreshPartA=function(){p.data.isOperate=!1,p.triggle={action:"refresh"}},m.formatRealTestReport=function(e,t,s){var a={responseList:[]};e.map(function(e){t[e]&&a.responseList.push(t[e])}),p.reportObject.object=Object.assign({},s,a)},m.showDdtReport=function(e){p.ddtObject.showDdtModal=!0,p.ddtObject.report=e,p.ddtObject.caseName=e.caseName},m.showTestHistory=function(e,t){var s=angular.copy(p.data.testHistory[t.caseID]);if(s&&s.time){if("ddt"===s.type)return void m.showDdtReport(s);switch(t.caseType){case 0:p.reportObject.status="automated-common-all",m.formatRealTestReport(s.tempIDArr,s.report,{time:s.time,reportStatus:s.reportStatus,unexecutedNum:s.unexecutedNum,assertErrNum:s.assertErrNum,timeoutErrNum:s.timeoutErrNum,totalNum:s.totalNum,passNum:s.passNum,requestErrNum:s.requestErrNum,codeErrNum:s.codeErrNum,terminateRequestNum:s.terminateRequestNum},[]);break;case 1:p.reportObject.status="automated-pro",p.reportObject.object=s}p.reportObject.object.baseInfo={caseName:s.caseName},p.reportObject.show=!0}else{var a={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,module:T.module,caseID:t.caseID};r.AutomatedTestHistory.TestReport(a).$promise.then(function(e){var s=e.latestHistory.result;if("ddt"===s.type)return void m.showDdtReport(s);switch(s.caseType||t.caseType){case 0:p.reportObject.status="automated-common-all";break;case 1:p.reportObject.status="automated-pro"}p.reportObject.object=s,p.reportObject.object.baseInfo={caseName:s.caseName},p.reportObject.show=!0})}},m.initGlobalTimeout=function(){var e=y.cache.getItem("AUTOMATIC_GLOBAL_TIMEOUT"),t={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey},s=function(){h.timeoutLimit=e.timeoutLimit,h.timeoutLimitType=e.timeoutLimitType};e?s():(d.global.ajax.Query_AutomatedGlobalTimeOut&&d.global.ajax.Query_AutomatedGlobalTimeOut.$cancelRequest(),d.global.ajax.Query_AutomatedGlobalTimeOut=r.Project.QueryTimeOut(t),d.global.ajax.Query_AutomatedGlobalTimeOut.$promise.then(function(t){e=t.timeoutSetting||{timeoutLimit:5e3,timeoutLimitType:0},s(),y.cache.setItem("AUTOMATIC_GLOBAL_TIMEOUT",e)}))},p.$onInit=function(){m.initBlockTable(),m.initGlobalTimeout(),p.ddtObject.showDdtItemReport=function(e,t,s){switch(s.caseType){case 0:p.reportObject.status="automated-common-all";break;case 1:p.reportObject.status="automated-pro"}p.reportObject.object=e,p.reportObject.object.baseInfo={caseName:t.collectionName},p.reportObject.show=!0}},e.$on("$stateChangeStart",function(){h.ws&&h.ws.close()})}angular.module("eolinker.ams").component("sceneBatchTestAmsPartB",{templateUrl:"module/ams/component/sceneBatchTest/partB/index.html",controller:e,bindings:{triggle:"=",accept:"<",reportObject:"=",inheritEnvObject:"=",ddtObject:"="}}),e.$inject=["$scope","COOKIE_CONFIG","Operate_CommonService","Cache_CommonService","RESPONSE_TEXT","$templateCache","$filter","Authority_CommonService","AutomatedTestResource","$state","CODE","$rootScope"]}();
"use strict";!function(){function e(e,t,a,s,o,r,i,u,c){var n=this;n.data={batch:{}},n.ajaxRequest={groupID:r.params.parentGroupID||0,spaceKey:eoSystemObj.VARIABLES.spaceKey,module:1},n.ajaxResponse={query:null},n.fun={},n.service={operateCommon:u,authority:s},n.component={listGroupCommonObject:null,menuObject:{list:null}};var p={};p.resetBatchInfo=function(){n.data.batch.isOperating=!1,n.data.batch.selectAll=!1,n.data.batch.query=[],n.data.batch.groupQuery=[],n.data.batch.indexAddress={},n.data.batchOprArchive=[]},p.isMaxItemNum=function(){var e={limitNum:n.service.authority.productUsingPermission.automaticTest.project,tips:n.service.authority.productUsingPermissionTips.automaticTest.project,productVersion:n.service.authority.product.ams};if(e.limitNum!==-1&&n.ajaxResponse.itemNum>=e.limitNum)switch(e.productVersion){case"free":return i.Common_UpgradeNoticeModal({mark:"AMS",module:"automatic_project_num"}),!0;default:return i.InfoModal(e.tips,"error"),!0}return!1},p["delete"]=function(t){var s={arg:t||{},option:{status:t.status,spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,resource:a.ProjectGroup,batchQuery:n.data.batch.query,batchGroupQuery:n.data.batch.groupQuery,callback:null,mark:"automatic"}};s.option.callback=function(a){switch(t.status){case"batch":e.$broadcast("$Init_LoadingCommonComponent"),p.resetBatchInfo();break;default:switch(t.which){case"project":n.ajaxResponse.query.splice(t.$index,1),n.ajaxResponse.itemNum--;break;case"group":e.$broadcast("$Init_LoadingCommonComponent")}}},n.service.operateCommon.outsideObject.fun.operate("delete",s.arg,s.option)},p.file=function(e){for(var t={tips:0===e.isArchive?"取消归档":"归档",request:{module:"1",spaceKey:n.ajaxRequest.spaceKey,isArchive:e.isArchive,projectHashKey:"batch"===e.status?JSON.stringify(n.data.batch.query):'["'+e.item.projectHashKey+'"]'},firstIsArchiveIndex:n.ajaxResponse.query.length},s=n.ajaxResponse.query.length-1;s>=0;s--)if(0===n.ajaxResponse.query[s].isArchive){t.firstIsArchiveIndex=s;break}var o=function(){a.Project.BatchFile(t.request).$promise.then(function(a){switch(a.statusCode){case c.COMMON.SUCCESS:switch(e.status){case"batch":if(1===e.isArchive)for(var s=n.ajaxResponse.query.length-1;s>=0;s--){var o=n.ajaxResponse.query[s];!n.data.batch.indexAddress[o.projectHashKey]||o.isArchive&&0!==o.isArchive||(o.isArchive=e.isArchive,o.clickMore=!1,n.ajaxResponse.query.splice(s,1),n.ajaxResponse.query.splice(t.firstIsArchiveIndex--,0,o))}p.resetBatchInfo();break;case"single":e.item.isArchive=e.isArchive,e.item.clickMore=!1,n.ajaxResponse.query.splice(e.$index,1),1===e.isArchive?n.ajaxResponse.query.splice(t.firstIsArchiveIndex,0,e.item):n.ajaxResponse.query.unshift(e.item)}i.InfoModal(t.tips+"成功！","success");break;default:i.InfoModal(t.tips+"失败！","error")}})};0!==e.isArchive?i.EnsureModal("归档项目",!1,"项目归档之后仅支持只读操作,如需编辑项目需要先取消归档,确认归档项目?",{btnType:2,btnMessage:"确认"},function(e){e&&o()}):o()},p.setGroupPermission=function(){var e={permissionName:"automatic",request:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,projectGroupID:n.ajaxRequest.groupID}};i.Product_ProjectGroupManageMemberModal(e,function(){})},p.move=function(e){var t={arg:e||{},option:{status:e.status,spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,groupID:n.ajaxRequest.groupID,resource:a.ProjectGroup,item:"batch"===e.status?{groupID:n.data.batch.groupQuery}:e.item||{},batchQuery:n.data.batch.query,batchGroupQuery:n.data.batch.groupQuery,callback:null,mark:"automatic"}};t.option.callback=function(t){"noChange"===t?(i.InfoModal("移动成功","success"),"batch"===e.status&&p.resetBatchInfo()):"group"===e.which?n.ajaxResponse.groupQuery.splice(e.$index,1):"batch"===e.status?p.filterQuery("delete"):n.ajaxResponse.query.splice(e.$index,1)},n.service.operateCommon.outsideObject.fun.operate("move",t.arg,t.option)},n.fun.init=function(){var e={resource:o.Project.Query,request:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID}};return i.global.ajax.Query_AutomatedProject=e.resource(e.request),i.global.ajax.Query_AutomatedProject.$promise.then(function(e){n.ajaxResponse.query=e.projectList.concat(e.archivedProjectList),n.ajaxResponse.groupQuery=e.childGroupList||[],n.ajaxResponse.itemNum=e.itemNum||0,n.service.authority.fun.setProjectGroupPermission("automatic",{userGrade:e.userGrade})}),i.global.ajax.Query_AutomatedProject.$promise},p.initMemberQuery=function(){var e={request:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,projectGroupID:n.ajaxRequest.groupID},promise:null};return e.promise=a.ProjectGroupMember.CommonQuery(e.request).$promise,e.promise},p.edit=function(e){var t={queryName:e.queryName||"query",arg:e||{},option:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID,callback:null,mark:"automatic"}};switch(t.option.callback=function(a){"edit"==e.status?n.ajaxResponse[t.queryName].splice(t.arg.$index,1):n.ajaxResponse.itemNum++,a.isArchive=e.item.isArchive||0,n.ajaxResponse[t.queryName].splice(0,0,a)},e.status){case"add":if(p.isMaxItemNum())return;t.option.resource=o.Project.Add,p.initMemberQuery().then(function(a){t.option.memberList=a.memberList||[],n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)});break;case"edit":t.option.resource=o.Project.Edit,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option);break;case"copy":if(p.isMaxItemNum())return;t.option.resource=o.Project.Copy,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)}},p.editGroup=function(e){var t={arg:e||{},option:{parentGroupID:n.ajaxRequest.groupID,spaceKey:n.ajaxRequest.spaceKey,callback:n.fun.init,groupID:null,mark:"projectGroup",module:n.ajaxRequest.module,key:"分组"}};switch(e.status){case"add":t.option.resource=a.ProjectGroup.Add,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option);break;case"edit":t.option.groupID=e.item.groupID,t.option.resource=a.ProjectGroup.Edit,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)}},p.filterQuery=function(e){switch(e){case"delete":n.ajaxResponse.groupQuery=n.ajaxResponse.groupQuery.filter(function(e,t){return!n.data.batch.indexAddress[e.groupID]}),n.ajaxResponse.query=n.ajaxResponse.query.filter(function(e,t){return!n.data.batch.indexAddress[e.projectHashKey]||(n.ajaxResponse.itemNum--,!1)})}p.resetBatchInfo()},p["import"]=function(){if(!p.isMaxItemNum()){var t={modal:{title:"导入自动化测试",version:1,status:"automatedProject",resource:o.Project,request:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID}}};i.Product_ImportModal(t.modal,function(t){t&&e.$broadcast("$Init_LoadingCommonComponent")})}},n.$onInit=function(){e.$emit("$WindowTitleSet",{list:["自动化测试列表"]});var t="归档";n.component.listGroupCommonObject={item:{primaryKey:"projectHashKey",resource:a.Project,"default":[{key:"名称",html:'<span ng-if="item.isArchive" class="p5 fs12 eo-color-tips-shallow mr10">'+t+"</span>{{item.projectName}}",contentClass:"item-title-li","class":"w_40percent"},{key:"版本号",html:"V&nbsp;{{item.projectVersion}}"},{key:"最后更新时间",html:"{{item.updateTime}}",isUnneccessary:!0}],operate:{funArr:[{key:"新标签打开",funName:"click",params:{which:"tab"}},{key:"编辑",fun:p.edit,params:{status:"edit"}},{key:"更多",type:"more",funArr:[{key:"移动",fun:p.move,params:{which:"project"}},{key:"复制",fun:p.edit,params:{status:"copy"}},{key:"取消归档",show:1,fun:p.file,showPoint:"isArchive",params:{isArchive:0,status:"single"}},{key:"归档",show:0,fun:p.file,showPoint:"isArchive",params:{isArchive:1,status:"single"}},{key:"删除",fun:p["delete"],params:{status:"single",which:"project"}}]}],"class":"w_250"}},group:{primaryKey:"groupID",resource:a.ProjectGroup,"default":[{key:"名称",colspan:3,html:"{{item.groupName}}",contentClass:"item-title-li"}],operate:{funArr:[{key:"编辑",fun:p.editGroup,params:{status:"edit"}},{key:"更多",type:"more",funArr:[{key:"移动",fun:p.move,params:{which:"group"}},{key:"删除",fun:p["delete"],params:{status:"single",which:"group"}}]}],"class":"w_220"}},setting:{permissionName:"automatic",clickJumpUri:"home.ams.automatic.inside.overview",batch:!0,colspan:3,warning:"尚未新建任何自动化测试"},baseFun:{batchSelectAll:function(e,t){switch(e){case"select":switch(t.isArchive){case 1:var a=n.data.batchOprArchive.indexOf(t.projectHashKey);a===-1&&n.data.batchOprArchive.push(t.projectHashKey)}break;case"cancel":n.data.batchOprArchive=[]}},batchItemClick:function(e){switch(e.isArchive){case 1:var t=n.data.batchOprArchive.indexOf(e.projectHashKey);t===-1?n.data.batchOprArchive.push(e.projectHashKey):n.data.batchOprArchive.splice(t,1)}}}},n.component.menuObject={list:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建自动化测试项目","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{key:"新建项目",fun:{"default":p.edit,params:{status:"add"}}},{key:"新建分组",fun:{"default":p.editGroup,params:{status:"add"}}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"导入",icon:"yunshangchuan",fun:{"default":p["import"]}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"分组权限管理",icon:"qunzu",attrPlaceholder:"group_authority_admin",fun:{"default":p.setGroupPermission}}]}],batchList:[{type:"btn","class":"pull-left",disabledPoint:"isBatchSelected",btnList:[{name:"删除",icon:"shanchu",disabled:!1,fun:{"default":p["delete"],params:{status:"batch"}}}]},{type:"btn","class":"pull-left",disabledPoint:"isGroupSelected",disableTip:"archiveDiasbledTipStatus",btnList:[{name:"归档",icon:"qiandao",disabled:!1,tips:"选择分组时无法使用归档操作",fun:{"default":p.file,params:{isArchive:1,status:"batch"}}}]},{type:"btn","class":"pull-left",disabledPoint:"isBatchSelected",btnList:[{name:"移动",icon:"wenjianjia",disabled:!1,fun:{"default":p.move,params:{status:"batch"}}}]},{type:"btn",disabledPoint:"isGroupAndArchiveSelected",disableTip:"setTeammateDiasbledTipStatus","class":"pull-left",btnList:[{name:"设置项目成员",icon:"tianjiahaoyou",disabled:!1,tips:"选中分组和归档项目时无法设置人员权限",fun:{"default":function(){i.Product_AddTeammateFromProjectModal({ajaxRequest:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,hashKey:n.data.batch.query,groupID:n.ajaxRequest.groupID},teammateNumLimit:!0},function(e){e&&p.resetBatchInfo()})},params:{isArchive:1,status:"batch"}}}]}],setting:{batch:!0,batchInitFun:p.resetBatchInfo,"class":"common-menu-fixed-seperate common-menu-lg",titleAuthority:"showTitle",title:"API 自动化测试"}}}}angular.module("eolinker.ams").component("homeAutomaticDefault",{templateUrl:"module/ams/ui/automatic/default/index.html",controller:e}),e.$inject=["$scope","RESPONSE_TEXT","GeneralFunResource","Authority_CommonService","AutomatedTestResource","$state","$rootScope","Operate_CommonService","CODE"]}();
"use strict";!function(){function e(e,i,t,o,r,a){var s=this;s.data={},s.interaction={request:{hashKey:t.params.projectHashKey,spaceKey:eoSystemObj.VARIABLES.spaceKey,module:1}},s.fun={},s.service={authority:a,navbar:o},s.fun.init=function(){var e={request:{hashKey:s.interaction.request.hashKey,spaceKey:s.interaction.request.spaceKey,module:s.interaction.request.module},uri:"home.ams.automatic.inside.overview"};s.data.sidebarShow=!1,s.service.authority.permission.automatic||(i.global.ajax.ProjectMember_GetProjectPermission=r.ProjectMember.GetProjectPermission(e.request),i.global.ajax.ProjectMember_GetProjectPermission.$promise.then(function(i){s.service.authority.fun.setPermission("automatic",{permission:i.permission||{},isArchive:i.isArchive,userGrade:i.permission.userGrade}),/home.ams.automatic.inside.public.env/.test(t.current.name)&&!s.service.authority.permission.automatic.environment.look?t.go(e.uri):/home.ams.automatic.inside.scene/.test(t.current.name)&&!s.service.authority.permission.automatic.sceneCase.look?t.go(e.uri):/home.ams.automatic.inside.timer/.test(t.current.name)&&!s.service.authority.permission.automatic.timedTask.look&&t.go(e.uri)}))}()}angular.module("eolinker.ams").component("homeAutomaticInside",{templateUrl:"module/ams/ui/automatic/inside/index.html",controller:e}),e.$inject=["$scope","$rootScope","$state","NavbarService","GeneralFunResource","Authority_CommonService"]}();
"use strict";!function(){function e(e,i,r,t){var s=this;s.data={sidebarShow:!1},s.service={authority:t};var o={},a={request:{hashKey:r.params.projectHashKey,spaceKey:eoSystemObj.VARIABLES.spaceKey,module:0}};o.setSidebarStatus=function(){r.current.name.indexOf("list")>-1?s.data.sidebarShow=!0:s.data.sidebarShow=!1},o.setSidebarStatus(),e.$on("$stateChangeSuccess",o.setSidebarStatus),o.init=function(){var e={request:{hashKey:a.request.hashKey,spaceKey:a.request.spaceKey,module:a.request.module},uri:""};s.service.authority.permission.project||i.ProjectMember.GetProjectPermission(e.request).$promise.then(function(i){switch(s.service.authority.fun.setPermission("project",{permission:i.permission||{},isArchive:i.isArchive,userGrade:i.permission.userGrade}),s.service.authority.permission.project.apiManagement.look?e.uri="home.ams.project.inside.api.list":s.service.authority.permission.project.statusCode.look?e.uri="home.ams.project.inside.code.list":s.service.authority.permission.project.projectPage.look?e.uri="home.ams.project.inside.doc.list":s.service.authority.permission.project.environment.look?e.uri="home.ams.project.inside.public.env.default":e.uri="home.ams.project.inside.overview",r.current.name){case"home.ams.project.inside.overview":break;case"home.ams.project.inside.iterationPlan":s.service.authority.permission.project.iterationPlan.look||r.go(e.uri);break;case"home.ams.project.inside.code.list":s.service.authority.permission.project.statusCode.look||r.go(e.uri);break;case"home.ams.project.inside.quickTest.default":break;default:if(/home.ams.project.inside.public.env/.test(r.current.name))s.service.authority.permission.project.environment.look||r.go(e.uri);else{if(/home.ams.project.inside.account/.test(r.current.name)||/home.ams.project.inside.authority/.test(r.current.name))break;if(/home.ams.project.inside.api/.test(r.current.name))s.service.authority.permission.project.apiManagement.look||r.go(e.uri);else if(/home.ams.project.inside.doc/.test(r.current.name))s.service.authority.permission.project.projectPage.look||r.go(e.uri);else{if(/home.ams.project.inside.public.function/.test(r.current.name))break;if(/home.ams.project.inside.public.dataStructure/.test(r.current.name))break;if(/home.ams.project.inside.plug/.test(r.current.name))break;r.go(e.uri)}}}})}()}angular.module("eolinker.ams").component("homeProjectInside",{templateUrl:"module/ams/ui/project/inside/index.html",controller:e}),e.$inject=["$scope","GeneralFunResource","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,a,s,r,o,i,c,u){var n=this;n.data={batch:{}},n.ajaxRequest={groupID:r.params.parentGroupID||0,spaceKey:eoSystemObj.VARIABLES.spaceKey,module:0},n.ajaxResponse={itemNum:null,query:null,groupQuery:null},n.fun={},n.service={operateCommon:i,authority:c},n.component={listGroupCommonObject:null,menuObject:{}};var p={};p.resetBatchInfo=function(){n.data.batch.isOperating=!1,n.data.batch.selectAll=!1,n.data.batch.query=[],n.data.batch.groupQuery=[],n.data.batch.indexAddress={},n.data.batchOprArchive=[]},p.initMemberQuery=function(){var e={request:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,projectGroupID:n.ajaxRequest.groupID},promise:null};return e.promise=a.ProjectGroupMember.CommonQuery(e.request).$promise,e.promise},n.fun.init=function(){var e={resource:s.Project.Query,request:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID}};return o.global.ajax.Query_Project=e.resource(e.request),o.global.ajax.Query_Project.$promise.then(function(e){n.ajaxResponse.query=e.projectList.concat(e.archivedProjectList),n.ajaxResponse.groupQuery=e.childGroupList||[],n.service.authority.fun.setProjectGroupPermission("project",{userGrade:e.userGrade})}),o.global.ajax.Query_Project.$promise},p["import"]=function(){var e={modal:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID,title:"导入项目",version:1,resource:s.Import}};o.Product_ImportModal(e.modal,function(e){e&&t.$broadcast("$Init_LoadingCommonComponent")})},p.edit=function(e){var t={arg:e||{},option:{spaceKey:n.ajaxRequest.spaceKey,groupID:n.ajaxRequest.groupID,callback:null,mark:"project"}};switch(t.option.callback=function(a){"edit"==e.status&&n.ajaxResponse.query.splice(t.arg.$index,1),a.isArchive=e.item.isArchive||0,n.ajaxResponse.query.splice(0,0,a)},e.status){case"add":t.option.resource=s.Project.Add,p.initMemberQuery().then(function(a){t.option.memberList=a.memberList||[],n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)});break;case"edit":t.option.resource=s.Project.Edit,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option);break;case"copy":t.option.resource=s.Project.Copy,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)}},p.editGroup=function(e){var t={arg:e||{},option:{parentGroupID:n.ajaxRequest.groupID,groupID:null,spaceKey:n.ajaxRequest.spaceKey,callback:n.fun.init,mark:"projectGroup",module:n.ajaxRequest.module,key:"分组"}};switch(e.status){case"add":t.option.resource=a.ProjectGroup.Add,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option);break;case"edit":t.option.groupID=e.item.groupID,t.option.resource=a.ProjectGroup.Edit,n.service.operateCommon.outsideObject.fun.operate(e.status,t.arg,t.option)}},p.setGroupPermission=function(){var e={permissionName:"project",request:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,projectGroupID:n.ajaxRequest.groupID}};o.Product_ProjectGroupManageMemberModal(e,function(){})},p["delete"]=function(e){var t={arg:e||{},option:{status:e.status,spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,resource:a.ProjectGroup,batchQuery:n.data.batch.query,batchGroupQuery:n.data.batch.groupQuery,callback:null,mark:"project"}};t.option.callback=function(t){switch(e.status){case"batch":p.filterQuery("delete");break;default:switch(e.which){case"project":n.ajaxResponse.query.splice(e.$index,1);break;case"group":n.ajaxResponse.groupQuery.splice(e.$index,1)}}},n.service.operateCommon.outsideObject.fun.operate("delete",t.arg,t.option)},p.filterQuery=function(e){switch(e){case"delete":n.ajaxResponse.groupQuery=n.ajaxResponse.groupQuery.filter(function(e,t){return!n.data.batch.indexAddress[e.groupID]}),n.ajaxResponse.query=n.ajaxResponse.query.filter(function(e,t){return!n.data.batch.indexAddress[e.projectHashKey]})}p.resetBatchInfo()},p.file=function(e){for(var t={tips:"0"==e.isArchive?"取消归档":"归档",request:{module:n.ajaxRequest.module,spaceKey:n.ajaxRequest.spaceKey,isArchive:e.isArchive,projectHashKey:"batch"==e.status?JSON.stringify(n.data.batch.query):'["'+e.item.projectHashKey+'"]'},firstIsArchiveIndex:n.ajaxResponse.query.length},s=n.ajaxResponse.query.length-1;s>=0;s--)if("0"==n.ajaxResponse.query[s].isArchive){t.firstIsArchiveIndex=s;break}var r=function(){a.Project.BatchFile(t.request).$promise.then(function(a){switch(a.statusCode){case u.COMMON.SUCCESS:switch(e.status){case"batch":if("1"==e.isArchive)for(var s=n.ajaxResponse.query.length-1;s>=0;s--){var r=n.ajaxResponse.query[s];!n.data.batch.indexAddress[r.projectHashKey]||r.isArchive&&"0"!=r.isArchive||(r.isArchive=e.isArchive,r.clickMore=!1,n.ajaxResponse.query.splice(s,1),n.ajaxResponse.query.splice(t.firstIsArchiveIndex--,0,r))}p.resetBatchInfo();break;case"single":e.item.isArchive=e.isArchive,e.item.clickMore=!1,n.ajaxResponse.query.splice(e.$index,1),"1"==e.isArchive?n.ajaxResponse.query.splice(t.firstIsArchiveIndex,0,e.item):n.ajaxResponse.query.unshift(e.item)}o.InfoModal(t.tips+"成功！","success");break;default:o.InfoModal(t.tips+"失败！","error")}})};"0"!=e.isArchive?o.EnsureModal("归档项目",!1,"项目归档之后仅支持只读操作,如需编辑项目需要先取消归档,确认归档项目?",{btnType:2,btnMessage:"确认"},function(e){e&&r()}):r()},p.move=function(e){var t={arg:e||{},option:{status:e.status,spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,groupID:n.ajaxRequest.groupID,resource:a.ProjectGroup,item:"batch"==e.status?{groupID:n.data.batch.groupQuery}:e.item||{},batchQuery:n.data.batch.query,batchGroupQuery:n.data.batch.groupQuery,callback:null,mark:"project"}};t.option.callback=function(t){"noChange"===t?(o.InfoModal("移动成功","success"),"batch"==e.status&&p.resetBatchInfo()):"group"==e.which?n.ajaxResponse.groupQuery.splice(e.$index,1):"batch"==e.status?p.filterQuery("delete"):n.ajaxResponse.query.splice(e.$index,1)},n.service.operateCommon.outsideObject.fun.operate("move",t.arg,t.option)},n.$onInit=function(){t.$emit("$WindowTitleSet",{list:["项目列表"]}),n.component.listGroupCommonObject={group:{primaryKey:"groupID",resource:a.ProjectGroup,"default":[{colspan:4,html:"{{item.groupName}}",contentClass:"item-title-li"}],operate:{funArr:[{key:"编辑",fun:p.editGroup,params:{status:"edit"}},{key:"更多",type:"more",funArr:[{key:"移动",fun:p.move,params:{which:"group"}},{key:"删除",fun:p["delete"],params:{status:"single",which:"group"}}]}],"class":"w_250"}},item:{primaryKey:"projectHashKey",resource:a.Project,"default":[{key:"名称",html:e("JsConstructHtml_CommonFilter")('<span ng-if="item.isArchive" class="p5 fs12 eo-color-tips-shallow mr10">{@archiveText}</span>{{item.projectName}}',{archiveText:"归档"}),contentClass:"item-title-li","class":"w_40percent"},{key:"版本号",html:"V&nbsp;{{item.projectVersion}}"},{key:"类型",html:"{{$ctrl.mainObject.PROJECT_TYPE_ARR[item.projectType]}}"},{key:"最后更新时间",html:"{{item.projectUpdateTime}}",isUnneccessary:!0}],operate:{funArr:[{key:"新标签打开",funName:"click",params:{which:"tab"}},{key:"编辑",fun:p.edit,params:{status:"edit"}},{key:"更多",type:"more",funArr:[{key:"移动",fun:p.move,params:{which:"project"}},{key:"复制",fun:p.edit,params:{status:"copy"}},{key:"取消归档",show:1,fun:p.file,showPoint:"isArchive",params:{isArchive:0,status:"single"}},{key:"归档",show:0,fun:p.file,showPoint:"isArchive",params:{isArchive:1,status:"single"}},{key:"删除",fun:p["delete"],params:{status:"single",which:"project"}}]}],"class":"w_220"}},setting:{permissionName:"project",clickJumpUri:"home.ams.project.inside.overview",batch:!0,colspan:4,warning:"尚未新建任何项目"},PROJECT_TYPE_ARR:["Web","App","PC","硬件/物联网","其他"],baseFun:{batchSelectAll:function(e,t){switch(e){case"select":switch(t.isArchive){case 1:var a=n.data.batchOprArchive.indexOf(t.projectHashKey);a===-1&&n.data.batchOprArchive.push(t.projectHashKey)}break;case"cancel":n.data.batchOprArchive=[]}},batchItemClick:function(e){switch(e.isArchive){case 1:var t=n.data.batchOprArchive.indexOf(e.projectHashKey);t===-1?n.data.batchOprArchive.push(e.projectHashKey):n.data.batchOprArchive.splice(t,1)}}}},n.component.menuObject={list:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建 API 项目","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{key:"新建项目",fun:{"default":p.edit,params:{status:"add"}}},{key:"新建分组",fun:{"default":p.editGroup,params:{status:"add"}}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"导入",icon:"yunshangchuan",fun:{"default":p["import"]}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"分组权限管理",icon:"qunzu",attrPlaceholder:"group_authority_admin",fun:{"default":p.setGroupPermission}}]}],batchList:[{type:"btn",disabledPoint:"isBatchSelected","class":"pull-left",btnList:[{name:"删除",icon:"shanchu",disabled:!1,fun:{"default":p["delete"],params:{status:"batch"}}}]},{type:"btn",disabledPoint:"isGroupSelected",disableTip:"archiveDiasbledTipStatus","class":"pull-left",btnList:[{name:"归档",icon:"qiandao",disabled:!1,tips:"选择分组时无法使用归档操作",fun:{"default":p.file,params:{isArchive:1,status:"batch"}}}]},{type:"btn",disabledPoint:"isBatchSelected","class":"pull-left",btnList:[{name:"移动",icon:"wenjianjia",disabled:!1,fun:{"default":p.move,params:{status:"batch"}}}]},{type:"btn",disabledPoint:"isGroupAndArchiveSelected",disableTip:"setTeammateDiasbledTipStatus","class":"pull-left",btnList:[{name:"设置项目成员",icon:"tianjiahaoyou",disabled:!1,tips:"选中分组和归档项目时无法设置人员权限",fun:{"default":function(){o.Product_AddTeammateFromProjectModal({ajaxRequest:{spaceKey:n.ajaxRequest.spaceKey,module:n.ajaxRequest.module,hashKey:n.data.batch.query,groupID:n.ajaxRequest.groupID},teammateNumLimit:!0},function(e){e&&p.resetBatchInfo()})},params:{isArchive:1,status:"batch"}}}]}],setting:{batch:!0,batchInitFun:p.resetBatchInfo,"class":"common-menu-fixed-seperate common-menu-lg",titleAuthority:"showTitle",title:"API 研发管理"}}}}angular.module("eolinker.ams").component("homeProjectDefault",{templateUrl:"module/ams/ui/project/default/index.html",controller:e}),e.$inject=["$filter","$scope","GeneralFunResource","ApiManagementResource","$state","$rootScope","Operate_CommonService","Authority_CommonService","CODE"]}();
"use strict";!function(){function e(e,o,a,i,t){var r=this;r.service={authority:a},r.data={menu:[{name:"项目",power:-1,keyMarkArr:["overview","scene","commonCase","timer","report"],childList:[{name:"概况",sref:"home.ams.automatic.inside.overview",icon:"jieshaoxinxi"},{name:"流程测试用例",sref:"home.ams.automatic.inside.scene",icon:"huopinfenliu",childSref:"home.ams.automatic.inside.scene.default",power:"sceneCase",params:{groupID:-1},attrPlaceholder:"scene_case_sidebar"},{name:"测试模板库",sref:"home.ams.automatic.inside.commonCase",childSref:"home.ams.automatic.inside.commonCase.default",icon:"bangongbao",power:"sceneCase",params:{groupID:-1},attrPlaceholder:"common_case_sidebar"},{base:"/timer/",name:"定时任务",sref:"home.ams.automatic.inside.timer",icon:"naozhong",childSref:"home.ams.automatic.inside.timer.default",power:"timedTask",tip:"Pro",permissionKey:"disabled",permission:"timedTask",permissionValue:1,params:{groupID:-1},click:function(){switch(r.service.authority.product.ams){case"enterprise":break;case"pro":i.Common_UpgradeNoticeModal({mark:"AMS",from:"renew",module:"timer_task"});break;default:i.Common_UpgradeNoticeModal({mark:"AMS",module:"timer_task"})}}},{name:"测试报告",sref:"home.ams.automatic.inside.report",icon:"tuwen",power:"downloadReport",click:function(){return r.service.authority.permission.automatic.sceneCase.look?o.go("home.ams.automatic.inside.report"):r.service.authority.permission.automatic.timedTask.look&&o.go("home.ams.automatic.inside.report",{reportType:"task"}),!0}}]},{name:"公用资源管理",keyMarkArr:["public"],power:-1,childList:[{name:"项目环境",sref:"home.ams.automatic.inside.public.env",childSref:"home.ams.automatic.inside.public.env.default",power:"environment",icon:"baoguo_hezi",attrPlaceholder:"automatic_test_env_sidebar"},{name:"通用函数",sref:"home.ams.automatic.inside.public.function",childSref:"home.ams.automatic.inside.public.function.default",icon:"baoguo_hezi",attrPlaceholder:"automatic_common_fn_sidebar"},{name:"数据库连接",sref:"home.ams.automatic.inside.public.database",childSref:"home.ams.automatic.inside.public.database.default",icon:"baoguo_hezi",attrPlaceholder:"database_sidebar"}]},{name:"自动化测试管理",keyMarkArr:["authority","account"],power:-1,click:function(e){e.item.childSref=r.service.authority.projectGroupPermission.automatic.editProject?"home.ams.automatic.inside.account.setting":"home.ams.automatic.inside.account.log"},childList:[{name:"权限管理",sref:"home.ams.automatic.inside.authority",icon:"qunzu",childSref:"home.ams.automatic.inside.authority.default",attrPlaceholder:"automatic_authority_sidebar"},{name:"项目设置",sref:"home.ams.automatic.inside.account.setting",power:"projectGroupPermission",powerName:"editProject",icon:"quanjushezhi"},{name:"日志",sref:"home.ams.automatic.inside.account.log",icon:"zhangdan-wancheng"}]}]},r.component={sidebarCommonObject:{}};var m={navbar:t},s={};s.setDownloadAuthority=function(){r.service.authority.permission.automatic.downloadReport={look:r.service.authority.permission.automatic.sceneCase.look||r.service.authority.permission.automatic.timedTask.look?1:0}},r.$onInit=function(){i.global.ajax.ProjectMember_GetProjectPermission?i.global.ajax.ProjectMember_GetProjectPermission.$promise["finally"](s.setDownloadAuthority):s.setDownloadAuthority(),r.component.sidebarCommonObject={mainObject:{baseInfo:{menu:r.data.menu,"class":"inside-sidebar",staticQuery:[{name:"返回自动化测试列表",sref:"home.ams.automatic.default",icon:"icon-chexiao"}]}}},m.navbar.fun.setNavQuery(r.component.sidebarCommonObject.mainObject.baseInfo.staticQuery[0],"home.ams.automatic.default",{module:1})}}angular.module("eolinker.ams").component("homeAutomaticInsideNavbar",{template:'<sidebar-common-component power-object="{sceneCase:$ctrl.service.authority.permission.automatic.sceneCase,environment:$ctrl.service.authority.permission.automatic.environment,downloadReport:$ctrl.service.authority.permission.automatic.downloadReport,timedTask:$ctrl.service.authority.permission.automatic.timedTask,projectGroupPermission: $ctrl.service.authority.projectGroupPermission.automatic}" permission-object="$ctrl.service.authority.productUsingPermission" main-object="$ctrl.component.sidebarCommonObject.mainObject"></sidebar-common-component>',controller:e}),e.$inject=["$scope","$state","Authority_CommonService","$rootScope","NavbarService"]}();
"use strict";!function(){function e(e,i,o,a){var r=this;r.component={sidebarCommonObject:{}},r.service={authority:i};var t={menu:[]},n={navbar:a};r.$onInit=function(){t.menu=[{name:"项目",power:-1,keyMarkArr:["overview","api","quickTest","apiCase","code","doc"],childList:[{base:"/overview",name:"项目概况",sref:"home.ams.project.inside.overview",icon:"jieshaoxinxi"},{base:"/api/",name:"API",sref:"home.ams.project.inside.api",icon:"lianjie",childSref:"home.ams.project.inside.api.list",power:"apiManagement",params:{groupID:-1}},{base:"/quickTest",name:"API 测试",sref:"home.ams.project.inside.quickTest.default",icon:"shanguangdeng",power:"apiTest",params:{timestamp:(new Date).getTime()}},{base:"/apiCase",name:"API 测试用例",sref:"home.ams.project.inside.apiCase",icon:"zhangdan-wancheng",power:"apiManagement",tip:"Pro",permissionKey:"disabled",permission:"apiCase",permissionValue:1,attrPlaceholder:"api_testcase_sidebar",click:function(){switch(r.service.authority.product.ams){case"free":o.Common_UpgradeNoticeModal({mark:"AMS",module:"api_case"});break;default:e.go("home.ams.project.inside.apiCase")}}},{name:"API 迭代计划",sref:"home.ams.project.inside.iterationPlan",icon:"riqi",power:"apiManagement",tip:"Pro",permissionKey:"disabled",permission:"iterationPlan",permissionValue:1,attrPlaceholder:"api_plan_sidebar",click:function(){switch(r.service.authority.product.ams){case"free":o.Common_UpgradeNoticeModal({mark:"AMS",module:"api_plan_sidebar"});break;default:e.go("home.ams.project.inside.iterationPlan")}}},{base:"/code",name:"状态码文档",sref:"home.ams.project.inside.code",childSref:"home.ams.project.inside.code.list",icon:"wenben",power:"statusCode",params:{groupID:-1}},{base:"/doc",name:"项目文档",sref:"home.ams.project.inside.doc",childSref:"home.ams.project.inside.doc.list",icon:"tuwen",power:"projectPage",params:{groupID:-1}}]},{name:"公用资源管理",keyMarkArr:["public"],power:-1,childList:[{name:"项目环境",sref:"home.ams.project.inside.public.env",childSref:"home.ams.project.inside.public.env.default",power:"environment",icon:"baoguo_hezi",attrPlaceholder:"api_test_env_sidebar"},{name:"数据结构",sref:"home.ams.project.inside.public.dataStructure",childSref:"home.ams.project.inside.public.dataStructure.default",icon:"baoguo_hezi",attrPlaceholder:"data_structue_sidebar"},{name:"通用函数",sref:"home.ams.project.inside.public.function",childSref:"home.ams.project.inside.public.function.default",icon:"baoguo_hezi",attrPlaceholder:"api_common_fn_sidebar"}]},{name:"管理",keyMarkArr:["authority","account"],power:-1,click:function(e){e.item.childSref=r.service.authority.projectGroupPermission.project.editProject?"home.ams.project.inside.account.setting":"home.ams.project.inside.account.log"},childList:[{name:"权限管理",sref:"home.ams.project.inside.authority",icon:"qunzu",childSref:"home.ams.project.inside.authority.default",attrPlaceholder:"api_authority_sidebar"},{name:"项目设置",sref:"home.ams.project.inside.account.setting",power:"projectGroupPermission",powerName:"editProject",icon:"quanjushezhi"},{name:"日志",sref:"home.ams.project.inside.account.log",icon:"zhangdan-wancheng"}]}],r.component.sidebarCommonObject={mainObject:{baseInfo:{menu:t.menu,"class":"inside-sidebar",staticQuery:[{name:"返回项目列表",sref:"home.ams.project.default",icon:"icon-chexiao"}]}}},n.navbar.fun.setNavQuery(r.component.sidebarCommonObject.mainObject.baseInfo.staticQuery[0],"home.ams.project.default",{module:0})}}angular.module("eolinker.ams").component("homeProjectInsideNavbar",{template:'<sidebar-common-component \n            power-object="{exportAndShare:$ctrl.service.authority.permission.project.exportAndShare,\n                apiManagement:$ctrl.service.authority.permission.project.apiManagement,\n                apiTest:$ctrl.service.authority.permission.project.apiTest,\n                statusCode:$ctrl.service.authority.permission.project.statusCode,\n                projectPage:$ctrl.service.authority.permission.project.projectPage,\n                environment:$ctrl.service.authority.permission.project.environment,\n                projectGroupPermission: $ctrl.service.authority.projectGroupPermission.project\n            }" permission-object="$ctrl.service.authority.productUsingPermission" main-object="$ctrl.component.sidebarCommonObject.mainObject"></sidebar-common-component>',controller:e}),e.$inject=["$state","Authority_CommonService","$rootScope","NavbarService"]}();
"use strict";!function(){function e(e,t,n,a,c){var o=this;o.data={status:0,envStatus:"show",envClass:"env-sm-menu-top",inheritEnvObj:{}},o.service={home:n,authority:c};var i={},s={cache:a};i.initEnv=function(){o.service.home.envObject.fun.resetObject(),/(default)/.test(t.current.name)?o.data.envClass="env-sm-menu-top":o.data.envClass="env-md-menu-top",/(scene\.default)|(\.commonCase)|(api)|(mode)/.test(t.current.name)?o.data.status=0:o.data.status=-1},i.init=function(){e.$emit("$WindowTitleSet",{list:["测试模板库","自动化测试"]}),s.cache.removeItem("AUTOMATIC_GLOBAL_TIMEOUT"),s.cache.clear("TEST_IMPORT_PRO_CODE_CACHE"),s.cache.clear("IMPROT_CASE_CACHE"),s.cache.clear("Common_Function_List"),s.cache.clear("apiList"),s.cache.clear("apiGroup"),i.initEnv(),e.$on("$stateChangeSuccess",i.initEnv)}()}angular.module("eolinker.ams").component("homeAutomaticInsideCommonCase",{templateUrl:"module/ams/ui/automatic/inside/content/commonCase/index.html",controller:e}),e.$inject=["$scope","$state","Operate_CommonService","Cache_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,a,o,s,n,i,r,c){var p=this;p.service={authority:o,amsCommon:n},p.ajaxResponse={projectInfo:null},p.component={overviewObject:{},tipComponentObject:{type:"text",status:"error",text:"当前项目已归档，如需编辑请先取消项目归档状态"}},p.fun={};var m={},l={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:c.params.projectHashKey},u={logAndNoticeParse:i};m.dump=function(){var e={modal:{mark:"common",title:"导出自动化测试",spaceKey:l.spaceKey,resource:t.Project}};r.AMS_ExportModal(e.modal,function(e){})},m.seeReport=function(a){var o={name:"测试任务列表："+a.item.dateTime,resource:t.AutomatedTestTask.QueryReportByDay,request:{spaceKey:l.spaceKey,projectHashKey:l.projectHashKey,dateTime:a.item.dateTime},responseKey:"logList",setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"测试任务名称",type:"html",html:"<span>{{item.taskName}}</span>","class":"pl20"},{thKey:"测试通过率",type:"html",html:"<span>{{item.successRate}}%</span>","class":"pl20"},{type:"btn",btnList:[{key:"下载测试报告",authority:"export",fun:function(a){if(a){var o=null,n={spaceKey:l.spaceKey,projectHashKey:l.projectHashKey,reportType:1,logID:a.item.logID,condition:a.key};return o=t.AutomatedTestHistory.ExportReport(n).$promise,o.then(function(t){switch(t.statusCode){case s.COMMON.SUCCESS:e.$broadcast("$DumpDirective_Click_TimeTaskFile",{response:{fileName:t.fileName}});break;default:r.InfoModal("下载失败，"+RESPONSE_TEXT.FAILURE,"error")}}),o}}}],"class":"w_100"}]};r.Common_ShowDataModal(o)},m.seeTimerChart=function(){var e={title:"定时测试任务通过率",query:p.ajaxResponse.projectInfo.taskList,xData:p.ajaxResponse.projectInfo.xData,yData:p.ajaxResponse.projectInfo.yData,blockListObject:{mainObject:{setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"日期",type:"html",html:"<span>{{item.dateTime}}</span>"},{thKey:"定时任务数量",type:"html",html:'<span>{{item.successCount+"/"+item.taskCount}}</span>'},{thKey:"通过率",type:"html",html:"<span>{{item.passRate}}%</span>"},{type:"btn",btnList:[{key:"查看详情",fun:m.seeReport}],"class":"w_100"}]}}};r.AMS_ChartAndTableModal(e)},m.seeUnpassCase=function(){var e={name:"未通过流程测试用例列表",resource:t.Project.QueryFailCase,request:{spaceKey:l.spaceKey,projectHashKey:l.projectHashKey},responseKey:"sceneCaseFailList",setting:{munalAddRow:!0,munalHideOperateColumn:!0},pagination:{pageSize:5},tdList:[{thKey:"流程测试用例名称",type:"html",html:"<span>{{item.caseName}}</span>","class":"pl20"},{type:"btn",btnList:[{key:"新标签打开",fun:function(e){var t={caseID:e.item.caseID},a=["home.ams.automatic.inside.scene.api"];window.open(c.href(a[e.item.caseType],t),"_blank")}}],"class":"w_100"}]};r.Common_ShowDataModal(e)},m.seeUserData=function(){var e={name:"人员工作统计",query:p.ajaxResponse.projectInfo.userList,setting:{munalAddRow:!0,munalHideOperateColumn:!0},pagination:{pageSize:5},tdList:[{thKey:"成员",type:"html",html:'<span class="logo_img mr5" style="background-image:url({{item.userImage?(\''+eoSystemObj.PRE_URL_UPLOAD_FILE+'\'+item.userImage):\'\'}});">{{item.userImage?"&nbsp;":item.userName.slice(0,1)}}</span><span class="name_span text_omit mr10">{{item.userName}}</span>',"class":"pl20"},{thKey:"创建流程测试用例数量",type:"html",html:"<span>{{item.caseCount}}</span>","class":"pl20"},{thKey:"测试通过率",type:"html",html:"<span>{{item.successRate+'%'}}</span>","class":"pl20"}]};r.Common_ShowDataModal(e)},m.edit=function(){var e={arg:{item:p.ajaxResponse.projectInfo},option:{spaceKey:l.spaceKey,callback:null,mark:"automatic"}};e.option.callback=function(e){p.component.overviewObject.mainObject.setting.title=e.projectName,p.ajaxResponse.projectInfo=angular.merge(p.ajaxResponse.projectInfo,e)},e.option.resource=t.Project.Edit,p.service.amsCommon.outsideObject.fun.operate("edit",e.arg,e.option)},m.initComponent=function(){p.component.overviewObject={mainObject:{list:[{key:"版本号",html:"V{{$ctrl.otherObject.projectInfo.projectVersion}}"},{type:"link",key:"协作人员数量",sref:"home.ams.automatic.inside.authority.default",html:"{{$ctrl.otherObject.projectInfo.partnerCount}} 人"},{key:"最后更新时间",html:"{{$ctrl.otherObject.projectInfo.updateTime}}</p>"},{type:"link",key:"流程测试用例数量",linkAuthority:"lookScene",sref:"home.ams.automatic.inside.scene.default",html:"{{$ctrl.otherObject.projectInfo.caseCount}}"},{key:"最近手动测试通过率",html:"{{$ctrl.otherObject.projectInfo.manualTestSuccessRate}}%"}],operate:[{type:"html",html:a("JsConstructHtml_CommonFilter")("<span>{@text}</span><span ng-class=\"{'cg':!(90>$ctrl.otherObject.projectInfo.passRate),'co':!(60>$ctrl.otherObject.projectInfo.passRate)&&(90>$ctrl.otherObject.projectInfo.passRate),'cr':60>$ctrl.otherObject.projectInfo.passRate}\">{{($ctrl.otherObject.projectInfo.passRate)+'%'}}</span><span>（{{$ctrl.otherObject.projectInfo.sceneCaseSuccessCount+\"/\"+$ctrl.otherObject.projectInfo.caseCount}}）</span>",{text:"流程测试用例通过率："}),btnList:[{key:"查看未通过测试的流程测试用例",fun:m.seeUnpassCase}]},{type:"html",html:'<div echart-common-directive style="height:40px;width:260px;" class="echart" ng-model="$ctrl.otherObject.timerChart" ng-if="$ctrl.otherObject.timerChart.xAxis.data.length"></div><div class="eo-status-tips m_auto" ng-if="!$ctrl.otherObject.timerChart.xAxis.data.length">暂无数据</div>',btnList:[{key:"查看定时测试任务通过率趋势",fun:m.seeTimerChart}]},{type:"html",html:'<div ng-repeat="item in $ctrl.otherObject.projectInfo.userList.slice(0,3)">\n                        <span class="logo_img mr5" style="background-image:url({{item.userImage?(\''+eoSystemObj.PRE_URL_UPLOAD_FILE+"'+item.userImage):''}});\">{{item.userImage?\"&nbsp;\":item.userName.slice(0,1)}}</span><span class=\"name_span text_omit mr10\">{{item.caseCount+'/'+item.successRate+'%'}}</span>\n                        </div>",btnList:[{key:"查看人员工作统计",fun:m.seeUserData}]},{icon:"yunxiazai",key:"导出自动化测试",authority:"export",btnList:[{key:"导出",fun:m.dump}]}],table:{menuObject:{list:[{type:"btn","class":"pull-right",btnList:[{name:"了解更多",icon:"iosgengduo",fun:{"default":function(){c.go("home.ams.automatic.inside.account.log")}}}]}],setting:{title:"项目动态（最近）"}},listObject:{mainObject:{item:{"default":[{key:"时间",html:"{{item.opTime}}"},{key:"操作",html:"{{item.opDesc}}"},{key:"成员",html:"{{item.operator}}"}]},setting:{unhover:!0}}}},setting:{divideArr:{list1:[0,3],list2:[3,5]},editFun:m.edit,title:p.ajaxResponse.projectInfo.projectName}}}},m.initChartComponent=function(){p.component.timerChart={grid:{left:0,right:0,top:0,bottom:0},xAxis:{show:!1,data:p.ajaxResponse.projectInfo.xData},yAxis:{show:!1},series:[{type:"line",smooth:!0,symbol:"none",sampling:"average",itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])},data:p.ajaxResponse.projectInfo.yData}]}},p.fun.init=function(){var a={promise:null,request:{spaceKey:l.spaceKey,projectHashKey:l.projectHashKey}};return e.$emit("$WindowTitleSet",{list:["自动化测试概况","自动化测试"]}),a.promise=t.Project.Detail(a.request).$promise.then(function(e){p.ajaxResponse.projectInfo=e||{},p.ajaxResponse.projectInfo.xData=[],p.ajaxResponse.projectInfo.yData=[],angular.forEach(p.ajaxResponse.projectInfo.taskList,function(e,t){e.passRate=(e.successCount/e.taskCount*100).toFixed(2),p.ajaxResponse.projectInfo.xData.unshift(e.dateTime),p.ajaxResponse.projectInfo.yData.unshift(e.passRate)}),e.caseCount?p.ajaxResponse.projectInfo.passRate=(e.sceneCaseSuccessCount/e.caseCount*100).toFixed(2):p.ajaxResponse.projectInfo.passRate="0.00",m.initComponent(),m.initChartComponent(),p.component.overviewObject.mainObject.table.listObject.list=u.logAndNoticeParse.fun.filterAutomatic(e.logList||[])}),a.promise}}angular.module("eolinker.ams").component("homeAutomaticInsideOverview",{templateUrl:"module/ams/ui/automatic/inside/content/overview/index.html",controller:e}),e.$inject=["$scope","AutomatedTestResource","$filter","Authority_CommonService","CODE","Operate_CommonService","Log_And_Notice_Parse_CommonService","$rootScope","$state"]}();
"use strict";!function(){function e(e,t,a,n,c){var i=this;i.data={status:0,envStatus:"show",envClass:"env-sm-menu-top",inheritEnvObj:{}},i.service={home:a,authority:c};var s={},o={cache:n};s.initEnv=function(){i.service.home.envObject.fun.resetObject(),i.data.envStatus="show",/(default)/.test(t.current.name)?i.data.envClass="env-sm-menu-top":i.data.envClass="env-md-menu-top",/(scene\.default)|(api)|(mode)/.test(t.current.name)?i.data.status=0:i.data.status=-1},s.init=function(){e.$emit("$WindowTitleSet",{list:["流程测试用例","自动化测试"]}),o.cache.removeItem("AUTOMATIC_GLOBAL_TIMEOUT"),o.cache.clear("TEST_IMPORT_PRO_CODE_CACHE"),o.cache.clear("IMPROT_CASE_CACHE"),o.cache.clear("Common_Function_List"),o.cache.clear("apiList"),o.cache.clear("apiGroup"),o.cache.clear("caseGroup"),o.cache.clear("omitCaseList"),s.initEnv(),e.$on("$stateChangeSuccess",s.initEnv)}()}angular.module("eolinker.ams").component("homeAutomaticInsideScene",{templateUrl:"module/ams/ui/automatic/inside/content/scene/index.html",controller:e}),e.$inject=["$scope","$state","Operate_CommonService","Cache_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,a,t,o,n,s,u,r,c){var i={},l={},p={},m={caseInfo:{}},f={};i.ajaxCommonCaseGroup=function(){return u.global.ajax.Query_Group=t.Group.Query({module:10,spaceKey:p.spaceKey,projectHashKey:p.projectHashKey}),u.global.ajax.Query_Group.$promise.then(function(e){m.groupList=r.sort.init(e).groupList}),u.global.ajax.Query_Group.$promise},i.confirmToChangeCase=function(){var a={title:"转换为测试模板",resource:o.AutomatedTestCase.ChangeToCommonCase,textArray:[{title:"分组",type:"select-multistage",selectKey:"groupName",selectValue:"groupID",key:"groupID",selectOptions:[],selectMainObj:{"new":{},original:{}}},{type:"html",html:'<p class="mt20 fs12 c999">*温馨提示：转换为测试模板后，已被引用的测试模板将会解除引用关系，自动转变为若干个步骤</p>'}],ajaxRequest:{},request:{caseID:p.caseID,projectHashKey:p.projectHashKey,spaceKey:p.spaceKey}},t=function(){a.textArray[0].selectOptions=m.groupList,a.ajaxRequest.groupID=m.groupList[0].groupID};if(m.groupList)t();else if(u.global.ajax.Query_Group)u.global.ajax.Query_Group.$promise["finally"](t);else{var n=i.ajaxCommonCaseGroup();n["finally"](t)}u.MixInputModal(a,function(a){a&&u.MessageModal("转换成功","直接新标签页打开此测试模板？",{button:{sure:{content:"确认",fun:function(){window.open(e.href(e.current.name.replace("scene","commonCase"),{caseID:a.commonCaseID}))}}}})})},i.changeToCommonCase=function(){i.confirmToChangeCase()},i.ajaxSceneCaseGroup=function(){return u.global.ajax.Query_SceneGroup=t.Group.Query({module:[5,10][p.module],spaceKey:p.spaceKey,projectHashKey:p.projectHashKey}),u.global.ajax.Query_SceneGroup.$promise.then(function(e){m.sceneGroupList=r.sort.init(e).groupList}),u.global.ajax.Query_SceneGroup.$promise},i.oprCase=function(t){var n=angular.copy(p),r={caseInfo:{caseName:""+("copy"===t?"副本-":"")+m.caseInfo.caseName,caseTag:m.caseInfo.caseTag.join(","),caseID:m.caseInfo.caseID},group:{groupID:m.caseInfo.groupID||-1,parent:[]},status:t};if("copy"!==t||!i.isMaxItemNum()){if(m.sceneGroupList)r.group.parent=m.sceneGroupList;else{var c=i.ajaxSceneCaseGroup();c["finally"](function(){r.group.parent=m.sceneGroupList})}u.AMS_AutomatedTest_EditCaseModal(r,function(r){if(r)switch(angular.merge(n,r),t){case"copy":o.AutomatedTestCase.Copy(n).$promise.then(function(e){switch(e.statusCode){case a.COMMON.SUCCESS:i.popupModalToWarningChangeUri({caseID:e.caseID,groupID:-1});break;default:u.InfoModal("操作失败，"+s.FAILURE,"error")}});break;case"edit":o.AutomatedTestCase.Edit(n).$promise.then(function(t){switch(t.statusCode){case a.COMMON.SUCCESS:u.InfoModal("编辑测试成功","success"),e.reload(e.current.name);break;default:u.InfoModal("操作失败，"+s.FAILURE,"error")}})}})}},i.isMaxItemNum=function(){var e={commonCase:"commonCase",sceneCase:"testCase"},a=n.productUsingPermission.automaticTest[e[p.module]],t=n.productUsingPermissionTips.automaticTest[e[p.module]],o=n.product.ams;if(a!=-1&&f.caseCount>=a)switch(o){case"free":return u.Common_UpgradeNoticeModal({mark:"AMS"}),!0;default:return u.InfoModal(t,"error"),!0}return!1},i.popupModalToWarningChangeUri=function(a){u.EnsureModal("温馨提示",!1,"当前用例已经复制成功。请问是否跳转到新的用例页面？",{btnMessage:"继续",btnType:1},function(t){t&&e.go(e.current.name,Object.assign({},e.params,a))})},i.deleteCase=function(){var e=[parseInt(p.caseID)],t={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,module:p.module,caseID:JSON.stringify(e)};u.EnsureModal("删除用例",!1,c.DELETE,{},function(e){e&&o.AutomatedTestCase.Delete(t).$promise.then(function(e){switch(e.statusCode){case a.COMMON.SUCCESS:u.InfoModal("用例删除成功","success"),i.goBack();break;default:u.InfoModal("删除失败，"+s.FAILURE,"error")}})})},i.goBack=function(){var a=e.current.name.lastIndexOf(".");e.go(e.current.name.substring(0,a)+".default")};var d={MUI_CHANGE_CASE_TO_COMMON:[{type:"divide","class":"pull-left",authority:"edit"},{type:"fun-list","class":"btn-li fun-list-li pull-left",authority:"edit",name:"转换为...",icon:"jiantou_zuoyouqiehuan",click:!0,funList:[{key:"测试模版",fun:{"default":i.changeToCommonCase}}]}],MUI_DEFAULT_ARR:[{type:"btn","class":"pull-left",btnList:[{name:"返回列表",icon:"chexiao",fun:{"default":i.goBack}}]},{type:"navigation","class":"menu-navigation",tabList:[{key:"测试流程",value:"step"},{key:"测试数据",value:"data"}]},{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":function(){i.oprCase("edit")}}},{name:"复制",icon:"fuzhi",fun:{"default":function(){i.oprCase("copy")}}},{name:"删除",icon:"shanchu",fun:{"default":i.deleteCase}}]}]};return i.initServiceData=function(){m={caseInfo:{}},f={}},l.getMUIConf=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];i.initServiceData();var o=a.split("|"),n={list:angular.copy(d.MUI_DEFAULT_ARR),setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}};switch(p=t,o[0]){case"scene":n.list=n.list.concat(d.MUI_CHANGE_CASE_TO_COMMON)}switch(o[1]){case"ui":n.list[1].tabList[0].fun=function(){e.go(e.current.name.replace("testData","api"),p)};break;case"code":n.list[1].tabList[0].fun=function(){e.go(e.current.name.replace("testData","mode"),p)}}switch(n.list[1].tabList[1].fun=function(){e.go(e.current.name.replace(/\.((api)|(mode))/,".testData"),Object.assign({mode:o[1]},p))},o[2]){case"step":n.list[1].value="step";break;case"data":n.list[1].value="data"}return n},l.setBasicData=function(e){m.caseInfo=e},l}angular.module("eolinker.ams").factory("CaseUI_AmsAutomaticService",e),e.$inject=["$state","CODE","GeneralFunResource","AutomatedTestResource","Authority_CommonService","RESPONSE_TEXT","$rootScope","Group_MultistageService","ENSURE_WARNIMG"]}();
"use strict";!function(){function e(e,t,a){var i=this;i.data={sidebarShow:!0,service:{cache:a},fun:{init:null}};var n={};n.init=function(){/timer.edit/.test(t.current.name)?i.data.sidebarShow=!1:i.data.sidebarShow=!0},n.init(),e.$on("$stateChangeSuccess",function(){/edit/.test(t.current.name)?i.data.sidebarShow=!1:i.data.sidebarShow=!0}),i.data.fun.init=function(){i.data.service.cache.clear("omitCaseList"),i.data.service.cache.clear("caseGroup"),e.$emit("$WindowTitleSet",{list:["定时任务","自动化测试"]})}()}angular.module("eolinker.ams").component("homeAutomaticInsideTimer",{templateUrl:"module/ams/ui/automatic/inside/content/timer/index.html",controller:e}),e.$inject=["$scope","$state","Cache_CommonService"]}();
"use strict";!function(){function e(e,t,a,s,o,n,i){var r=this;r.service={authority:n},r.data={pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},r.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:i.params.projectHashKey,page:i.params.page||1,reportType:"task"===i.params.reportType?1:0},r.ajaxResponse={query:null},r.fun={},r.component={listPageCommonObject:null,menuObject:{list:null,otherObject:null}};var c={};r.fun.init=function(){var t={spaceKey:r.ajaxRequest.spaceKey,projectHashKey:r.ajaxRequest.projectHashKey,page:r.ajaxRequest.page,pageSize:r.data.pagination.pageSize,reportType:r.ajaxRequest.reportType};return e.global.ajax.ReportQuery_AutomatedTestResource=o.AutomatedTestHistory.ReportQuery(t),e.global.ajax.ReportQuery_AutomatedTestResource.$promise.then(function(e){r.data.pagination.page=t.page,r.ajaxResponse.query=e.reportList||[],r.data.pagination.msgCount=e.itemNum||0}),e.global.ajax.ReportQuery_AutomatedTestResource.$promise},c.downloadInit=function(e){r.fun.downloadReport({item:e.item,key:e.key})},r.fun.downloadReport=function(s){if(s){var n=null,i={spaceKey:r.ajaxRequest.spaceKey,projectHashKey:r.ajaxRequest.projectHashKey,reportType:r.ajaxRequest.reportType,logID:s.item.logID,condition:s.key,module:s.item.isCommon?1:0};return n=o.AutomatedTestHistory.ExportReport(i).$promise,n.then(function(s){switch(s.statusCode){case t.COMMON.SUCCESS:a.$broadcast("$DumpDirective_Click_TestWordFile",{response:{fileName:s.fileName}});break;default:e.InfoModal("下载失败，"+RESPONSE_TEXT.FAILURE,"error")}}),n}},c.enterCase=function(e){var t={caseID:e.item.caseID},a="";switch(e.item.caseType){default:a=i.href("home.ams.automatic.inside.scene.api",t)}window.open(a,"_blank")},c.showCase=function(t){var a={name:"关联用例","class":"show_case_modal_hair",resource:o.AutomatedTestHistory.CaseQuery,request:{spaceKey:r.ajaxRequest.spaceKey,projectHashKey:r.ajaxRequest.projectHashKey,reportType:r.ajaxRequest.reportType,logID:t.logID,module:t.isCommon?1:0},responseKey:"caseList",tdList:[{thKey:"名称",type:"text",modelKey:"caseName","class":"pl20 w_400"},{thKey:'<span>正确率</span><tip-directive input="<p>场景测试正确率=测试通过的步骤数/场景内的总步骤数</p>"></tip-directive>',type:"html",html:"<span ng-class=\"{'cg':item.successRate==='100.00','cr':item.successRate&&item.successRate!=='100.00'}\">{{item.successRate?(item.successRate+\"%\"):\"-\"}}"}]};e.Common_ShowDataModal(a)},c["delete"]=function(n){e.EnsureModal("删除报告",!1,s.DELETE,{},function(s){if(s){var i={spaceKey:r.ajaxRequest.spaceKey,projectHashKey:r.ajaxRequest.projectHashKey,reportType:r.ajaxRequest.reportType,logID:"["+n.item.logID+"]",module:n.item.isCommon?1:0};o.AutomatedTestHistory.DeleteReport(i).$promise.then(function(s){switch(s.statusCode){case t.COMMON.SUCCESS:e.InfoModal("删除成功","success"),a.$broadcast("$Init_LoadingCommonComponent")}})}})},c.changeMenu=function(e){i.go(i.current.name,{page:1,reportType:0===e.key?"case":"task"})},r.$onInit=function(){a.$emit("$WindowTitleSet",{list:["测试报告","自动化测试"]}),r.component.listPageCommonObject={mainObject:{baseFun:{showCase:c.showCase},item:{"default":[{key:"测试完成时间",html:"{{item.testTime}}","class":"w_200"},{key:'<span>正确率</span><tip-directive input="<p>测试任务正确率=测试通过的用例个数/被测用例的总个数</p>"></tip-directive>',html:"<span ng-class=\"{'cg':item.successRate==='100.00','cr':item.successRate&&item.successRate!=='100.00'}\">{{item.successRate?(item.successRate+\"%\"):\"-\"}}","class":"w_60"},{key:"任务名称",showPoint:"reportType",show:1,html:"{{item.taskName}}"},{key:"类型",showPoint:"reportType",show:0,"class":"w_100",html:'{{item.isCommon===1?"通用":"场景"}}'},{key:"用例","class":"w_150",html:'<button type="button" class="eo_theme_btn_default show_btn_hair" ng-click="$ctrl.mainObject.baseFun.showCase(item)">查看</button>'}],operate:{funArr:[{key:"下载",type:"more",funArr:[{key:"全部",fun:c.downloadInit,params:{key:0}},{key:"仅错误报告",fun:c.downloadInit,params:{key:1}}]},{key:"删除",fun:c["delete"]}],"class":"w_150"}},setting:{warning:"尚未存在任何测试报告",unhover:!0}}},r.component.menuObject.mainObject={list:[{type:"tips-tab","class":"view-btn-li ml5 pull-left",activePoint:"reportType",tabList:[{name:"手动测试",active:0,authority:"case",fun:{"default":c.changeMenu,params:{key:0}}},{name:"定时测试任务",active:1,authority:"task",fun:{"default":c.changeMenu,params:{key:1}}}]}],setting:{"class":"common-menu-fixed-seperate"}}}}angular.module("eolinker.ams").component("homeAutomaticInsideReport",{templateUrl:"module/ams/ui/automatic/inside/content/report/index.html",controller:e}),e.$inject=["$rootScope","CODE","$scope","ENSURE_WARNIMG","AutomatedTestResource","Authority_CommonService","$state"]}();
"use strict";!function(){function t(t,o){var e=this;e.component={authorityGroupProductObject:{mainObject:{setting:{module:1,productName:"ams",permissionName:"automatic",uri:"home.ams.automatic.inside.authority.default",noun:{projectName:"自动化测试"}}}}},e.service={authority:o}}angular.module("eolinker.ams").component("homeAutomaticInsideAuthoritySidebar",{template:'<authority-group-product-component authority-object="{edit:$ctrl.service.authority.projectGroupPermission.automatic.editMember}"  main-object="$ctrl.component.authorityGroupProductObject.mainObject"></authority-group-product-component>',controller:t}),t.$inject=["$scope","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,o,n,r,c,a){var u=this;u.data={"static":{query:[{groupID:-1,groupName:"所有任务",icon:"caidan"}]}},u.component={groupCommonObject:{}},u.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey,groupID:n.params.groupID||-1},response:{query:[]}},u.service={authority:a};var s={};s.init=function(){c.clear()},s.init(),u.$onInit=function(){u.component.groupCommonObject={requestObject:{resource:o.Group,baseRequest:{module:6,spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey}},funObject:{btnGroupList:[{name:"新建分组","class":"eo_theme_btn_success block-btn",icon:"jiahao",funName:"edit"}],callback:{querySuccess:function(e){n.current.name.indexOf("edit")>-1?c.set(e,!0):c.set(e)}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:u.interaction.request},staticQuery:u.data["static"].query,itemFun:[{funName:"edit",key:"新建子分组",params:'"add-child",arg',isStrong:1},{funName:"edit",key:"编辑",params:'"edit",arg'},{funName:"delete",params:{modal:{title:"删除分组",message:"请问是否删除该分组？"}},key:"删除"}]}}}}angular.module("eolinker.ams").component("homeAutomaticInsideTimerSidebar",{template:'<group-default-common-Component  authority-object="$ctrl.service.authority.permission.automatic.timedTask" fun-object="$ctrl.component.groupCommonObject.funObject" sort-object="$ctrl.component.groupCommonObject.sortObject" main-object="$ctrl.component.groupCommonObject.mainObject" request-object="$ctrl.component.groupCommonObject.requestObject"></group-default-common-Component>',controller:e}),e.$inject=["$scope","AutomatedTestResource","GeneralFunResource","$state","$rootScope","GroupService","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,n,a,o,s,i,r,m,c,l){var u=this;u.data={isSessionShow:!1,hasMoreComment:!1,editID:0},u.fun={},u.ajaxResponse={historyList:null,memberList:null},u.amsEditorComponent={exportFun:{}},u.ajaxData={content:"",contentRaw:""},u.CONST={PRE_URL_UPLOAD_FILE:eoSystemObj.PRE_URL_UPLOAD_FILE,DEFAULT_IMG:["./assets/images/default_logo_female.jpg","./assets/images/default_logo_male.jpg","./assets/images/default_logo_female.jpg"]},u.component={dragChangeHeightCommonDirectiveObj:{setting:{minHeight:200,object:"height"},baseFun:{mouseDown:function(e){e[0].className=e[0].className.replace("transition_hpicpb","")}}}};var p={},f={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:a.params.projectHashKey,apiID:a.params.apiID},d={maxLen:0},g={editCommentItem:null};p.XssFilterHtml=function(e){return s.trustAsHtml(m("XssFilter")(e,{onIgnoreTagAttr:function(e,t,n,a){if(/(style)|(class)|(id)|(name)/.test(t))return t+'="'+n+'"'}}))},p.confirmBeforeEdit=function(e){u.ajaxData.contentRaw?t.EnsureModal("编辑评论",!1,"评论框中已经有内容，编辑评论会清空输入框原有的内容，请问是否继续？",{btnMessage:"继续",btnType:1},function(t){t&&e()}):e()},u.fun.handleMessage=function(e){e.item.contentHtml=p.XssFilterHtml(e.item.content),e.item.beReplyContent&&(e.item.beReplyHtml=p.XssFilterHtml(e.item.beReplyContent))},u.fun.edit=function(e){var t=function(){g.editCommentItem=e.item,u.data.editID=e.item.commentID,u.ajaxData.contentRaw=e.item.contentRaw,u.ajaxData.beReplyMsg=null};p.confirmBeforeEdit(t)},p.queryMember=function(){var e=function(e){u.ajaxResponse.memberList=e,u.ajaxResponse.memberList.unshift({connID:-1,memberNickName:"所有人"}),eoSystemObj.projectMemberList=[],u.ajaxResponse.memberList.forEach(function(e){e.showName=""+(e.memberNickName||e.userNickName)+(e.inviteCall?"（"+e.inviteCall+"）":""),eoSystemObj.projectMemberList.push({showName:e.showName,connID:e.connID});var t=e.showName.length;t>d.maxLen&&(d.maxLen=t)})},t=n.get("API_PROJECT_MEMBERLIST");return t?void e(t):void c.ProjectMember.TotalMemberQuery({hashKey:f.projectHashKey,spaceKey:f.spaceKey,module:0}).$promise.then(function(t){switch(t.statusCode){case r.COMMON.SUCCESS:e(t.memberList),n.set("API_PROJECT_MEMBERLIST",angular.copy(t.memberList));break;default:u.ajaxResponse.historyList=[]}})},u.fun.reply=function(e){var t=function(){u.data.editID="",u.ajaxData.contentRaw="",u.ajaxData.beReplyMsg=e.item};p.confirmBeforeEdit(t)},u.fun["delete"]=function(e){t.EnsureModal("是否删除该评论",!1,i.DELETE,{},function(n){n&&l.Comment.Delete({projectHashKey:f.projectHashKey,spaceKey:f.spaceKey,apiID:f.apiID,commentID:e.item.commentID}).$promise.then(function(n){switch(n.statusCode){case r.COMMON.SUCCESS:if(e.item.commentID===u.data.editID)return u.data.editID="",void(u.ajaxData.contentRaw="");t.InfoModal("删除评论成功","success"),u.ajaxResponse.historyList[e.$outerIndex].commentList.splice(e.$index,1);break;default:t.InfoModal("删除评论失败","error")}})})},u.fun.clickMessage=function(e){e.$event.stopPropagation();var n={};try{n.point=e.$event.target.classList[0]}catch(a){n.point="default"}"IMG"===e.$event.target.tagName&&t.TipsModal({html:e.$event.target.outerHTML,background:"width: fit-content;max-width: 95%;",style:"display: flex;",type:1,"class":"only_img_tip_modal"}),n.point},p.getConnID=function(e){u.ajaxData.connID=[];var t=e.match(/class=\"cm-atLink_member\" eo-attr-connID=\"-?[1-9]\d*\"/g);t&&t.some(function(e){var t=Number(e.match(/-?[1-9]\d*/)[0]);return t===-1?(u.ajaxResponse.memberList.forEach(function(e){e.connID!==-1&&u.ajaxData.connID.push(e.connID)}),!0):void(u.ajaxData.connID.indexOf(t)===-1&&u.ajaxData.connID.push(t))})},u.fun.sendMessage=function(){if(u.ajaxData.content){var e=u.ajaxData.beReplyMsg?"reply":u.data.editID?"edit":"add",n={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,apiID:f.apiID,content:u.ajaxData.content,contentRaw:u.ajaxData.contentRaw};p.getConnID(u.ajaxData.content),n.connID=JSON.stringify(u.ajaxData.connID);var a=null,o=null;switch(e){case"add":case"reply":o=l.Comment.Add,"reply"===e&&(n.beReplyContent=u.ajaxData.beReplyMsg.content,n.beReplyCommentID=u.ajaxData.beReplyMsg.commentID),d.nowConnID&&!d.nowMemberItem&&u.ajaxResponse.memberList.some(function(e){if(d.nowConnID===e.connID)return d.nowMemberItem=e,!0}),a=function(e){u.ajaxResponse.historyList[u.ajaxResponse.historyList.length-1].commentList.push({content:n.content,commentID:e.commentID,contentRaw:n.contentRaw,contentHtml:p.XssFilterHtml(n.content),updateTime:m("currentTimeFilter")(),beReplyContent:n.beReplyContent||null,userImage:d.nowMemberItem.userImage,inviteCall:d.nowMemberItem.inviteCall,memberNickName:d.nowMemberItem.memberNickName||d.nowMemberItem.userNickName,isNow:1}),u.ajaxData.contentRaw="",u.ajaxData.beReplyMsg=null};break;case"edit":o=l.Comment.Edit,n.commentID=u.data.editID,a=function(){g.editCommentItem.contentRaw=u.ajaxData.contentRaw,g.editCommentItem.content=u.ajaxData.content,g.editCommentItem.contentHtml=p.XssFilterHtml(g.editCommentItem.content),u.ajaxData.contentRaw="",u.data.editID="",t.InfoModal("编辑评论成功！","success")}}o(n).$promise.then(function(e){switch(e.statusCode){case r.COMMON.SUCCESS:a(e)}})}},u.fun.selectMember=function(e){u.amsEditorComponent.exportFun.insertMember(""+e.name+(e.loginCall?"（"+e.loginCall+"）":""))},u.fun.seeHistory=function(){u.data.stayScroll=!0,d.lastHistoryID=u.ajaxResponse.historyList[0].historyID,e.$broadcast("$Init_LoadingPartCommonComponent")},u.fun.init=function(){u.data.hasMoreComment=!1;var e=Object.assign({},f);return d.lastHistoryID?(e.historyID=d.lastHistoryID,d.lastHistoryID=""):u.ajaxResponse.historyList=null,t.global.ajax.Query_Comment=l.Comment.Query(e),t.global.ajax.Query_Comment.$promise.then(function(t){switch(t.statusCode){case r.COMMON.SUCCESS:if(e.historyID){var n=angular.copy(u.ajaxResponse.historyList);u.ajaxResponse.historyList=t.historyList.concat(n)}else u.ajaxResponse.historyList=t.historyList||[],u.data.hasMoreComment=t.hasMoreComment;d.nowConnID=t.connID;break;default:u.ajaxResponse.historyList=[]}}),t.global.ajax.Query_Comment.$promise},u.fun.keydown=function(t){var n=u.data.isMac?"metaKey":"ctrlKey";t[n]&&13===event.keyCode&&(e.$root&&e.$root.$$phase||e.$apply(),u.fun.sendMessage())},p.getMaxOffsetFram=function(e,t){t=t||d.maxLen+1;var n=e.ch-t;n=n<=0?0:n;var a={line:e.line,ch:n},o={line:e.line,ch:e.ch+t+1};return u.amsEditorComponent.exportFun.getRangeValue(a,o)},p.getMemberFramInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=arguments[2];n=n||/@[^@]*([\（]+([^\）]*)[\）]+|所有人)/g;var a=p.getMaxOffsetFram(e),o=a.match(n);if(!o)return!1;var s=[],i=-o[0].length;o.forEach(function(e,t){var n=s[s.length-1]||0;i=a.indexOf(e,n),s.push(i),s.push(i+e.length)});var r=e.ch-d.maxLen-1<0?e.ch:d.maxLen+1,m=null;if(s.some(function(e,n){return 0!==n&&("left"===t&&s[n-1]<r&&r<=e&&n%2===1?(m=(n-1)/2,!0):"right"===t&&s[n-1]<=r&&r<e&&n%2===1?(m=(n-1)/2,!0):void 0)}),m===-1||null===m)return!1;var c=o[m],l=0;return l=r-s[2*m],{totalFragment:c,offsetFragment:l}},u.$onInit=function(){u.exportFunObject={swithModalStatus:function(e){u.data.isSessionShow=e.showStatus}},o.bind("keydown",u.fun.keydown),p.queryMember(),u.data.isMac="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform,u.amsEditorComponent.exportFun=u.amsEditorComponent.exportFun||{},u.amsEditorComponent.exportFun.getMemberOffset=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=p.getMemberFramInfo(e,t);if(!n)return 0;n.totalFragment=n.totalFragment.slice(1);var a=!1;if(u.ajaxResponse.memberList.some(function(e){if(e.showName===n.totalFragment)return a=!0,!0}),a){if("left"===t)return n.offsetFragment;if("right"===t)return n.totalFragment.length-n.offsetFragment}return 0},u.amsEditorComponent.exportFun.judgeMember=function(e){var t=p.getMemberFramInfo(e,"left",/@[^@]*(\（+)[^\）]*|@[^@]*|@/g);if(!t)return 0;if("@"===t.totalFragment)return u.data.personKeyword="",1;var n=0;return t.totalFragment=t.totalFragment.slice(1),u.ajaxResponse.memberList.some(function(e){if(e.showName.indexOf(t.totalFragment)>-1)return n=t.totalFragment.length,u.data.personKeyword=t.totalFragment,!0}),n?n+1:0}}}angular.module("eolinker.ams").component("commentAmsComponent",{templateUrl:"module/ams/ui/project/inside/component/comment/index.html",controller:e,bindings:{mainObject:"<",exportFunObject:"="}}),e.$inject=["$scope","$rootScope","Cache_CommonService","$state","$element","$sce","ENSURE_WARNIMG","CODE","$filter","GeneralFunResource","ApiManagementResource"]}();
"use strict";!function(){function e(e,t,n,i,o){var a=this;a.data={pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0}},a.service={authority:n},a.ajaxResponse={query:null},a.fun={},a.component={blockListObject:{},menuObject:{list:null}};var s={},r={};s.notice=function(t){var n=Object.assign({memberID:t.item.memberID},r);a.mainObject.resouceModule.NoticeMember(n).$promise.then(function(t){switch(t.statusCode){case i.COMMON.SUCCESS:e.InfoModal("通知人员成功","success");break;case"160014":e.InfoModal("通知人员失败，没有开启API变更通知","error");break;case"160016":e.InfoModal("通知人员失败，没有选择变更通知方式","error");break;default:e.InfoModal("通知人员失败，"+RESPONSE_TEXT.FAILURE,"error")}})},s["delete"]=function(n){var o={title:"删除通知人员",message:"请问是否删除该通知人员？"},s=Object.assign({memberID:n.item.memberID},r);e.EnsureModal(o.title,!1,o.message,{},function(n){n&&a.mainObject.resouceModule.DeleteNoticeMember(s).$promise.then(function(n){switch(n.statusCode){case i.COMMON.SUCCESS:e.InfoModal("删除通知人员成功","success"),t.$broadcast("$Init_LoadingPartCommonComponent",{"boolean":!0});break;default:e.InfoModal("删除通知人员失败，"+RESPONSE_TEXT.FAILURE,"error")}})})},s.changeMemberNoticeEventType=function(t){var n=Object.assign({memberID:t.item.memberID,noticeEvent:JSON.stringify(t.item.noticeEvent)},r);a.mainObject.resouceModule.EditNoticeEvent(n).$promise.then(function(t){switch(t.statusCode){case i.COMMON.SUCCESS:e.InfoModal("修改通知设置成功","success");break;default:e.InfoModal("操作失败，"+RESPONSE_TEXT.FAILURE,"error")}})},a.fun.batchAddPeople=function(){if("free"===a.service.authority.product.ams)return void e.Common_UpgradeNoticeModal({mark:"AMS",module:"api_notice"});var n={modal:{title:"添加通知事件",request:{params:r,resource:a.mainObject.resouceModule.GetUnJoinedNoticeMember,responseKey:"memberList"},setting:{unscroll:!0,outputTotalArr:!0,baseFun:{watchFormLastChange:"selectPerson"}},staticBlockList:[{thKey:"通知事件",type:"select",multiple:!0,selectQuery:a.mainObject.eventArr,initialData:"[0]",modelKey:"noticeEvent"}]},request:r,fun:null,memberList:[]};e.Common_SelectPersonModal(n.modal,function(n){if(n){var o=Object.assign({},r);o.memberList=[],n.map(function(e,t){o.memberList.push({connID:e.connID,noticeEvent:e.noticeEvent})}),o.memberList=JSON.stringify(o.memberList),a.mainObject.resouceModule.AddNoticeMember(o).$promise.then(function(n){switch(n.statusCode){case i.COMMON.SUCCESS:e.InfoModal("添加通知事件成功","success"),t.$broadcast("$Init_LoadingPartCommonComponent",{"boolean":!0});break;default:e.InfoModal("添加通知事件失败，"+RESPONSE_TEXT.FAILURE,"error")}})}})},a.data.pagination.fun=function(){t.$broadcast("$Init_LoadingPartCommonComponent")},s.initTable=function(){a.component.blockListObject.query={mainObject:{setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"人员",type:"html",html:'\n                        <span class="eo_label_member_tips mr10" ng-if="item.isApiManager||item.isGlobal===1&&!$ctrl.authorityObject.isGlobal">{{item.isApiManager?"API 负责人":"全局"}}</span>\n                        <span class="logo-img" style="background-image:url({{item.userImage?(\''+eoSystemObj.PRE_URL_UPLOAD_FILE+"'+item.userImage):''}});\">&nbsp;</span>\n                        <span>{{item.memberNickName||item.userNickName||item.inviteCall}}</span>","class":"pl20"},{thKey:"通知事件",type:"select",selectQuery:a.mainObject.eventArr,multiple:!0,initialData:"item.noticeEvent",modelKey:"noticeEvent",fun:s.changeMemberNoticeEventType,disabled:"item.isApiManager||!$ctrl.authorityObject.edit||(!$ctrl.authorityObject.isGlobal&&item.isGlobal===1)"},{type:"btn",authority:"edit",btnList:[{key:"通知",fun:s.notice,itemExpression:'ng-if="!$ctrl.authorityObject.isGlobal"'},{key:"移除",fun:s["delete"],itemExpression:'ng-if="!item.isApiManager&&($ctrl.authorityObject.isGlobal||item.isGlobal!==1)"'}],"class":"w_100"}]}}},a.fun.init=function(){var t=Object.assign({page:a.data.pagination.page,pageSize:a.data.pagination.pageSize},r);return a.ajaxResponse.query=null,e.global.ajax.GetNoticeMember_Api=a.mainObject.resouceModule.GetNoticeMember(t),e.global.ajax.GetNoticeMember_Api.$promise.then(function(e){a.ajaxResponse.query=e.memberList||[],a.data.pagination.msgCount=e.logCount}),e.global.ajax.GetNoticeMember_Api.$promise},a.$onInit=function(){r=a.mainObject.ajaxRequest,s.initTable()}}angular.module("eolinker.ams").component("noticeMemberAmsComponent",{templateUrl:"module/ams/ui/project/inside/component/noticeMember/index.html",controller:e,bindings:{mainObject:"<",authorityObject:"<"}}),e.$inject=["$rootScope","$scope","Authority_CommonService","CODE","RESPONSE_TEXT"]}();
"use strict";!function(){function e(e,a,t,s,r,n){var i=this;i.data={isClick:!1,current:null,hasQuery:!1},i.fun={},i.ajaxResponse={caseList:null},i.service={authority:n};var u={cache:r};i.fun.loadPartCtrl=function(e){return e.promise},i.fun.queryCase=function(){if(i.input.request.apiID){var a={spaceKey:i.input.request.spaceKey,projectHashKey:i.input.request.projectHashKey,apiID:i.input.request.apiID},s=void 0;return s=t.TestCase.Query(a).$promise,s.then(function(e){i.data.hasQuery=!0,i.ajaxResponse.caseList=e.caseList||[]}),e.$emit("$TransferStation",{state:"$Init_LoadingPartCommonComponent",data:{promise:s}}),s}},i.fun.previewList=function(e){e.preventDefault(),i.readOnly||(i.data.hasQuery||i.fun.queryCase(),i.data.isClick=!i.data.isClick)},i.fun.click=function(a){if(a.item.caseData){i.data.isClick=!1,i.data.current=a.item;var t=null;try{t=a.item.caseData||{}}catch(s){t=i.history}e.$emit("$TransferStation",{state:"$Maunal_AceEditorAms",data:{data:t.raw,status:"reset"}}),i.reset.response={status:"0",httpCodeType:2,hadTest:!1,isHeader:!1},i.reset.format={isJson:!0,message:""},i.advancedSetting=a.item.advancedSetting||{requestRedirect:1},i.script={before:t.script.before,after:t.script.after,type:"0"},i.urlParam=t.urlParam,i.restfulParam=t.restfulParam,e.$emit("$TransferStation",{state:"$Maunal_AceEditorAms_Code_Ace_Editor_Js",data:i.script.before}),i.bindFun({arg:{apiRequestParamJsonType:t.apiRequestParamJsonType,apiRequestType:t.apiRequestType||"0",URL:t.URL,auth:t.auth,headers:t.headers,params:t.params,requestType:t.requestType,raw:t.raw,httpHeader:t.httpHeader}})}},i.fun.admin=function(){s.go("home.ams.project.inside.api.case",i.input.request)},i.fun.blur=function(){i.data.isClick=!1},i.fun.add=function(){var e={baseInfo:i.input.request,caseData:i.history,status:"add",from:"test",caseInfo:{advancedSetting:i.advancedSetting||{requestRedirect:1}}};i.input.response.statusCode&&(e.caseInfo.statusCode=i.input.response.statusCode.toString(),e.caseInfo.matchType=0,e.caseInfo.matchRule=u.cache.get(i.cacheVariable)),e.caseData.script=i.script,e.caseData.urlParam=i.urlParam,e.caseData.restfulParam=i.restfulParam,a.AMS_TestExampleModal(e,function(e){e&&i.fun.queryCase()})},i.$onDestroy=function(){}}angular.module("eolinker.ams").component("proInsideTestExample",{templateUrl:"module/ams/ui/project/inside/component/testExample/index.html",controller:e,bindings:{input:"<",history:"=",reset:"=",script:"=",urlParam:"=",restfulParam:"=",readOnly:"<",cacheVariable:"@",advancedSetting:"=",bindFun:"&"}}),e.$inject=["$scope","$rootScope","ApiManagementResource","$state","Cache_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,a,i,n,s){var o=this;o.data={sidebarShow:!1,envClass:"mt20",status:0,envStatus:"show"},o.service={home:a,authority:n};var c={},r={group:i,cache:s};c.initEnv=function(){var e={modelType:"home.ams.project.inside.api.list"===t.current.name?[]:{}};switch(o.service.home.envObject.fun.resetObject(e.modelType),o.data.envStatus="show","home.ams.project.inside.api.list"===t.current.name?(o.data.envClass="env-sm-menu-top",o.data.sidebarShow=!0):(o.data.envClass="env-md-menu-top",o.data.sidebarShow=!1),t.current.name){case"home.ams.project.inside.api.list":case"home.ams.project.inside.api.detail":case"home.ams.project.inside.api.test":case"home.ams.project.inside.api.case":o.data.status=0;break;default:o.data.status=-1}},o.$onInit=function(){r.cache.clear("Common_Function_List"),r.cache.clear("API_PROJECT_MEMBERLIST"),r.cache.removeItem("PROJECT_ITETATION_PLAN_LIST"),r.group.fun.clear(),c.initEnv(),e.$on("$stateChangeSuccess",c.initEnv)}}angular.module("eolinker.ams").component("homeProjectInsideApi",{templateUrl:"module/ams/ui/project/inside/content/api/index.html",controller:e}),e.$inject=["$scope","$state","Operate_CommonService","Group_MultistageService","Authority_CommonService","Cache_CommonService"]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,a,t,i,o,s,r,p,c){var u={service:{cache:i}},n={},l={};return l.popupModalToWarningChangeUri=function(a){o.EnsureModal("温馨提示",!1,"当前API已经复制成功。请问是否跳转到新的API页面？",{btnMessage:"继续",btnType:1},function(t){t&&e.go("home.ams.project.inside.api.detail",a)})},n.copyApi=function(a,i){var r={resource:s.Api.Copy,title:"复制API",textArray:[{type:"input",title:"API名称",key:"apiName",value:"副本-"+a.apiName,required:!0},{type:"select",title:"API请求方式",key:"apiRequestType",value:a.apiRequestType,selectOptions:t.METHOD_SELECT_QUERY},{type:"input",title:"API URI",key:"apiURI",value:a.apiURI,required:!0}],btnObject:{"class":"eo_theme_btn_info",text:"确认"},request:{apiID:a.apiID,projectHashKey:a.projectHashKey,spaceKey:a.spaceKey}};o.MixInputModal(r,function(t){t&&(a.isPopupModalToWarning?l.popupModalToWarningChangeUri(Object.assign({},e.params,{apiID:t.apiID})):o.InfoModal("复制成功","success"),i&&i(t))})},n.menu=function(a,t,i){var o={uri:{groupID:e.params.groupID,apiID:e.params.apiID,status:"object"===("undefined"==typeof a?"undefined":_typeof(a))?a.value:a},cache:{}};switch(o.uri.status){case"list":e.go("home.ams.project.inside.api.list",o.uri);break;case"detail":u.service.cache.set(null),e.go("home.ams.project.inside.api.detail",o.uri);break;case"test":e.go("home.ams.project.inside.api.test",o.uri);break;case"mock":e.go("home.ams.project.inside.api.mock",o.uri);break;case"history":e.go("home.ams.project.inside.api.history",o.uri);break;case"notice":e.go("home.ams.project.inside.api.notice",o.uri);break;case"edit":e.go("home.ams.project.inside.api.edit",o.uri);break;case"copy":e.go("home.ams.project.inside.api.edit",o.uri);break;case"case":e.go("home.ams.project.inside.api.case",o.uri);break;case"add":o.cache={apiRequestParam:i.request.params,apiResultParam:[],apiRestfulParam:i.restfulParam||[],apiUrlParam:i.urlParam||[],responseHeader:[],starred:0,apiStatus:"0",apiProtocol:i.request.httpHeader,apiRequestType:i.request.apiRequestType,apiURI:i.request.URL,apiName:"",groupID:-1,apiSuccessMock:u.service.cache.get(i.testResultCache),apiFailureMock:"",apiHeader:i.request.headers,apiNote:"",apiNoteRaw:"",apiNoteType:"0",apiRequestParamType:i.request.requestType,apiRequestParamJsonType:i.request.apiRequestParamJsonType,apiRequestRaw:i.request.raw,mockRule:[],mockResult:"",mockConfig:{type:"object"},apiAuth:i.request.auth,advancedSetting:i.advancedSetting||{requestRedirect:1},apiSuccessStatusCode:i.testHttpCode,successCode:"0",failureCode:"200"},window.localStorage.setItem("API_QUICK_TEST_CACHE",JSON.stringify(o.cache)),t.from="test",window.open(e.href("home.ams.project.inside.api.edit",t))}},n["delete"]=function(a){var t={request:{spaceKey:a.spaceKey,projectHashKey:a.projectHashKey,apiID:"["+a.apiID+"]"},uri:{groupID:a.groupID}};o.EnsureModal("移入回收站",!1,"确认要把API移入回收站吗？您可以稍后在API回收站恢复相关API。",{},function(a){a&&s.Api.Delete(t.request).$promise.then(function(a){switch(a.statusCode){case r.COMMON.SUCCESS:e.go("home.ams.project.inside.api.list",t.uri),o.InfoModal("Api移除成功，已移入回收站","success")}})})},n.recover=function(a){var t={modal:{list:angular.copy(p.get()),title:"恢复API所到分组选择"},request:{spaceKey:a.spaceKey,projectHashKey:a.projectHashKey,apiID:"["+a.apiID+"]",groupID:""},uri:{groupID:a.groupID}};return t.modal.list?void o.SelectVisualGroupModal(t.modal,function(a){a&&(t.request.groupID=a.groupID,s.Trash.Recover(t.request).$promise.then(function(a){switch(a.statusCode){case r.COMMON.SUCCESS:o.InfoModal("Api恢复成功","success"),e.go("home.ams.project.inside.api.list",t.uri)}}))}):void o.InfoModal("暂无分组，请先建立分组再恢复API！","error")},n.deleteCompletely=function(t){var i={request:{spaceKey:t.spaceKey,projectHashKey:t.projectHashKey,apiID:"["+t.apiID+"]"},uri:{groupID:t.groupID}};o.EnsureModal("永久性删除Api",!1,c.DELETE,{},function(t){t&&s.Trash.Delete(i.request).$promise.then(function(t){switch(t.statusCode){case r.COMMON.SUCCESS:e.go("home.ams.project.inside.api.list",i.uri),o.InfoModal("Api删除成功","success");break;default:o.InfoModal("删除失败，"+a.FAILURE,"error")}})})},n}angular.module("eolinker.ams").service("HomeProjectApi_Service",e),e.$inject=["$state","RESPONSE_TEXT","API_AMS_CONSTANT","Cache_CommonService","$rootScope","ApiManagementResource","CODE","GroupService","ENSURE_WARNIMG"]}();
"use strict";!function(){function e(e,a,t,o,n,s,i,r,c,u){var p=this;p.data={pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},batch:{}},p.fun={},p.ajaxResponse={query:null},p.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:s.params.projectHashKey,groupID:s.params.groupID||-1,keyword:window.sessionStorage.getItem("COMMON_SEARCH_TIP")},p.service={home:t,authority:u},p.component={menuObject:{},listDefaultCommonObject:{}};var l={},d={isQuerying:!0};l.resetBatchInfo=function(){p.data.batch.isOperating=!1,p.data.batch.selectAll=!1,p.data.batch.query=[],p.data.batch.indexAddress={}},l.scrollLoading=function(){var e={hasItem:p.ajaxResponse.query&&0!==p.ajaxResponse.query.length,hasNextPage:p.data.pagination.page<p.data.pagination.msgCount/p.data.pagination.pageSize,isQuerying:d.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&(d.isQuerying=!0,l.getQuery("preload",p.data.pagination.page+1))},l.filterQuery=function(){o.$broadcast("$Init_LoadingCommonComponent"),l.resetBatchInfo()},l["export"]=function(){var e={mark:"eolinkerAndExcel",title:"导出状态码",spaceKey:p.ajaxRequest.spaceKey,request:{codeID:JSON.stringify(p.data.batch.query)},resource:n.Code};r.AMS_ExportModal(e,function(e){e&&l.resetBatchInfo()})},l.getQuery=function(e,a,t){var o={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,groupID:p.ajaxRequest.groupID,pageSize:t||p.data.pagination.pageSize},s=[];switch(e){case"reset":o.page=1;break;default:s=p.ajaxResponse.query,o.page=a}return p.ajaxRequest.keyword?(o.keyword=p.ajaxRequest.keyword,r.global.ajax.Query_Code=n.Code.Search(o)):r.global.ajax.Query_Code=n.Code.Query(o),r.global.ajax.Query_Code.$promise.then(function(a){"reset"===e&&(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0),d.isQuerying=!1,p.ajaxResponse.query=s.concat(a.codeList||[]),p.data.pagination.msgCount=a.itemNum||0,t||(p.data.pagination.page=o.page)}),r.global.ajax.Query_Code.$promise},l["import"]=function(){var e={title:"批量导入状态码",fileType:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileTypeRegex:".(xls)|(xlsx)$",group:{title:"将状态码导入到以下分组",parent:c.get(),groupID:parseInt(p.ajaxRequest.groupID)},inputObject:{type:"file"},linkObject:{name:"下载模板文件",download:"导入状态码模板.xls",href:"assets/office/statusCode_Import.xls"},secondTitle:"选择文件（*.xls，*.xlsx）"},a=new FormData;return e.group.parent&&0!=e.group.parent?(a.append("spaceKey",p.ajaxRequest.spaceKey),a.append("projectHashKey",p.ajaxRequest.projectHashKey),void r.Common_UploadFile(e,function(e){e&&(a.append("groupID",e.groupID),a.append("excel",e.file),o.$broadcast("$Init_LoadingCommonComponent",{status:"import",request:a}))})):void r.InfoModal("请先建立分组！","error")},l.load=function(a){var t=null,o=a.request;return t=n.Code.Import(o).$promise.then(function(a){switch(a.statusCode){case i.COMMON.SUCCESS:case"310200":l.getQuery("reset"),r.InfoModal("导入成功","success");break;default:r.InfoModal("导入失败，"+e.FAILURE,"error")}})},l.edit=function(e){e=e||{};var a=c.get(),t={title:e.item?"编辑状态码":"新建状态码"};a&&0!=a.length?e.item?(e.item.version=1,e.item.spaceKey=p.ajaxRequest.spaceKey,e.item.projectHashKey=p.ajaxRequest.projectHashKey,r.AMS_CodeModal(t.title,e.item,function(e){e&&(r.InfoModal(t.title+"成功","success"),o.$broadcast("$Init_LoadingCommonComponent"))})):(e.item={version:1,spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,groupID:p.ajaxRequest.groupID},r.AMS_CodeModal(t.title,e.item,function(e){e&&r.InfoModal(t.title+"成功","success"),o.$broadcast("$Init_LoadingCommonComponent")})):r.InfoModal("请先建立分组！","error")},l["delete"]=function(t){var o=[];t?o.push(t.item.codeID):o=p.data.batch.query;var s={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,codeID:JSON.stringify(o)};r.EnsureModal("删除状态码",!1,a.DELETE,{},function(a){a&&n.Code.Delete(s).$promise.then(function(a){switch(a.statusCode){case i.COMMON.SUCCESS:t?(p.ajaxResponse.query.splice(t.$index,1),p.data.pagination.msgCount>p.data.pagination.page*p.data.pagination.pageSize&&l.getQuery("preload",p.data.pagination.page*p.data.pagination.pageSize,1),p.data.pagination.msgCount--):l.filterQuery(),r.InfoModal("状态码删除成功","success");break;default:r.InfoModal("删除失败，"+e.FAILURE,"error")}})})},l.batchBtnClickFun=function(){if(p.data.pagination.page!==Math.ceil(p.data.pagination.msgCount/p.data.pagination.pageSize)){var e={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,groupID:p.ajaxRequest.groupID},a=null;p.ajaxRequest.keyword?(e.keyword=p.ajaxRequest.keyword,a=n.Code.SearchIDQuery(e).$promise):a=n.Code.IDQuery(e).$promise,a.then(function(e){p.data.allQueryID=e.codeIDList||[]})}},p.fun.init=function(e){switch(e=e||{},e.status){case"import":return l.load(e);default:return l.getQuery("reset")}},p.$onInit=function(){o.$emit("$WindowTitleSet",{list:["[列表]状态码管理","API管理"]}),p.component.menuObject={list:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建状态码","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{key:"新建状态码",fun:{"default":l.edit,params:""}},{key:"批量导入",fun:{"default":l["import"]}}]},{type:"search","class":"pull-right",keyword:p.ajaxRequest.keyword,fun:p.service.home.searchObject.fun.search}],batchList:[{type:"btn",authority:"export","class":"pull-left",btnList:[{icon:"daochu",name:"导出",fun:{"default":l["export"]}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"删除",icon:"shanchu",fun:{"default":l["delete"],params:""}}]}],baseFun:{batchDefault:l.batchBtnClickFun},setting:{batchAuthority:"showBatch",batch:!0,batchInitFun:l.resetBatchInfo,titleAuthority:"showTitle",title:"状态码文档"}},p.component.listDefaultCommonObject={item:{primaryKey:"codeID","default":[{key:"状态码",html:"{{item.code}}",draggableCacheMark:"code"},{key:"描述",html:'<span title="{{item.codeDescription}}"> {{item.codeDescription}}</span>',draggableCacheMark:"desc"},{key:"分组",html:"{{item.groupName}}",draggableCacheMark:"group"}],operate:{funArr:[{key:"编辑",fun:l.edit,params:{status:"edit"}},{key:"删除",fun:l["delete"]}],"class":"w_100"}},setting:{draggable:!0,dragCacheVar:"AMS_CODE_LIST_DRAG_VAR",dragCacheObj:{code:"250px",desc:"400px",group:"150px"},page:!0,scroll:!0,scrollRemainRatio:7,isFixedHeight:!0,batch:!0,unhover:!0,warning:"尚无新建任何状态码"},baseFun:{scrollLoading:l.scrollLoading}}}}angular.module("eolinker.ams").component("homeProjectInsideCodeList",{templateUrl:"module/ams/ui/project/inside/content/code/index.html",controller:e}),e.$inject=["RESPONSE_TEXT","ENSURE_WARNIMG","Operate_CommonService","$scope","ApiManagementResource","$state","CODE","$rootScope","GroupService","Authority_CommonService"]}();
"use strict";!function(){function e(e){var n=this,o={group:e};n.$onInit=function(){o.group.fun.clear()}}angular.module("eolinker.ams").component("homeProjectInsideDoc",{templateUrl:"module/ams/ui/project/inside/content/doc/index.html",controller:e}),e.$inject=["Group_MultistageService"]}();
"use strict";!function(){function t(t){var e=this;e.component={reportObject:{object:{},show:!1}},e.triggleB={},e.triggleA={},e.$onInit=function(){t.$emit("$WindowTitleSet",{list:["迭代计划","API 管理"]})}}angular.module("eolinker.ams").component("homeProjectInsideIterationPlan",{templateUrl:"module/ams/ui/project/inside/content/iterationPlan/index.html",controller:t}),t.$inject=["$scope"]}();
"use strict";!function(){function t(t,e,o,n,i,a,r,s,c,p,l){var u=this;u.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:i.params.projectHashKey},response:{projectInfo:null}},u.data={},u.component={groupCommonObject:{},plugApiStatusStatisticsObject:{},overviewObject:{},tipComponentObject:{type:"text",status:"error",text:"当前项目已归档，如需编辑请先取消项目归档状态"},contributionChart:{},ganttObject:{setting:{style:{height:"56px"},unOperate:!0},reset:0,wheelDelta:0,xIndex:0}},u.fun={},u.service={authority:l,amsCommon:p};var m={},h={logAndNoticeParse:c,cache:s};m.openShare=function(){var t={promise:null,request:{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey,isShared:0==u.interaction.response.projectInfo.isShared?1:0}};t.promise=n.Project.setShareStatus(t.request).$promise.then(function(t){switch(t.statusCode){case r.COMMON.SUCCESS:u.interaction.response.projectInfo.isShared=u.interaction.response.projectInfo.isShared?0:1;break;default:a.InfoModal("编辑分享项目失败！","error")}})},m.share=function(){var t={modal:{title:"分享项目",version:1,request:{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey}}};a.AMS_ShareProjectModal(t.modal,function(t){t&&a.InfoModal("分享设置编辑成功","success")})},m.copyShareLink=function(){var t=document.createElement("input");t.setAttribute("readonly","readonly"),t.setAttribute("value",eoSystemObj.INHERIT_HOST+"#/share/index?shareCode="+u.interaction.response.projectInfo.projectShareCode,"_blank"),document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.execCommand("Copy")?a.InfoModal("复制成功","success"):a.InfoModal("复制失败","error")},m.seeApiStatus=function(t){t=t.item?t:{item:u.component.plugApiStatusStatisticsObject.array[0]};var e={modal:{title:"API统计",resource:n.Api.SelectApiList,array:u.component.plugApiStatusStatisticsObject.array,item:t.item,request:{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey,apiStatus:t.item.value,type:0}}};a.AMS_PlugApiStatusModal(e.modal,function(){})},m.seeContribution=function(){var t={title:"项目贡献度",query:u.interaction.response.projectInfo.projectHeat,xData:u.interaction.response.projectInfo.xData,yData:u.interaction.response.projectInfo.yData,blockListObject:{mainObject:{setting:{munalAddRow:!0,munalHideOperateColumn:!0},tdList:[{thKey:"更新热度",type:"html",html:"<span>{{item.heat}}</span>"},{thKey:"新增",type:"html",html:"<span>{{item.addCount}}</span>"},{thKey:"编辑",type:"html",html:"<span>{{item.editCount}}</span>"},{thKey:"更新时间",type:"html",html:"<span>{{item.date}}</span>"}]}}};a.AMS_ChartAndTableModal(t)},m.dump=function(){var t={modal:{title:"导出离线 API 文档",spaceKey:u.interaction.request.spaceKey,version:u.service.authority.product.ams,resource:n.Export,envList:u.interaction.response.projectInfo.envList,mark:"full"}};a.AMS_ExportModal(t.modal,function(t){})},m.settingSyncConfig=function(){var t={title:"自动生成API文档",ajaxRequest:Object.assign({},u.interaction.response.projectInfo.synchronizeSetting||{repositoryType:3},{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey})};null===t.ajaxRequest.repositoryType?t.ajaxRequest.repositoryType=3:t.ajaxRequest.step=2,a.Ams_GenerateApiModal(t,function(t){t&&m.syncCode()})},m.syncCode=function(){t.$broadcast("$Init_LoadingCommonComponent","sync")},m.waitSync=function(){var e=null;return e=n.Annotation.Synchronize(u.interaction.request).$promise,e.then(function(e){switch(e.statusCode){case r.COMMON.SUCCESS:a.InfoModal("同步成功","success"),t.$broadcast("$Init_LoadingCommonComponent");break;case r.COMMON.HAD_WARNING:break;default:a.InfoModal("同步失败","error")}}),e},m.seeGantt=function(){i.go("home.ams.project.inside.iterationPlan")},m.edit=function(){var t={arg:{item:u.interaction.response.projectInfo},option:{spaceKey:u.interaction.request.spaceKey,callback:null,mark:"project"}};t.option.callback=function(t){u.component.overviewObject.mainObject.setting.title=t.projectName,u.interaction.response.projectInfo=angular.merge(u.interaction.response.projectInfo,t)},t.option.resource=n.Project.Edit,u.service.amsCommon.outsideObject.fun.operate("edit",t.arg,t.option)},m.initChartComponent=function(){u.component.contributionChart={grid:{left:0,right:0,top:0,bottom:0},xAxis:{show:!1,data:u.interaction.response.projectInfo.xData},yAxis:{show:!1},series:[{type:"line",smooth:!0,symbol:"none",sampling:"average",itemStyle:{color:"rgb(255, 70, 131)"},areaStyle:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(255, 158, 68)"},{offset:1,color:"rgb(255, 70, 131)"}])},data:u.interaction.response.projectInfo.yData}]},u.component.plugApiStatusStatisticsObject={array:e.API_STATUS_SHOW_QUERY,totalCount:0,clickFun:m.seeApiStatus,setting:{}}},m.seeApiAboutCase=function(t){var e={};switch(e.modal={resource:n.Api.SelectApiList,request:{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey},responseKey:"apiList",setting:{munalAddRow:!0,munalHideOperateColumn:!0},pagination:{pageSize:5},tdList:[{thKey:"名称",type:"html",html:"<span>{{item.apiName}}</span>","class":"pl20"},{type:"btn",btnList:[{key:"新标签打开",fun:function(t){window.open(i.href("home.ams.project.inside.api.detail",{apiID:t.item.apiID}),"_blank")}}],"class":"w_100"}]},t.type){case"none":e.modal.name="未编写测试用例的API",e.modal.request.type=1,e.modal.tdList.splice(1,0,{thKey:"URL",type:"html",html:"<span>{{item.apiURI}}</span>","class":"pl20"});break;default:e.modal.name="查看测试不够完善的API（根据测试用例数量倒序排序）",e.modal.request.type=2,e.modal.tdList.splice(1,0,{thKey:"测试用例数量",type:"html",html:"<span>{{item.caseCount}}</span>","class":"pl20"})}a.Common_ShowDataModal(e.modal)},m.initComponent=function(){u.component.overviewObject={mainObject:{PRODUCT_TYPE_ARR:["Web","App","PC","硬件/物联网","其他"],list:[{key:"项目类型",html:'<div class="title-p">{{$ctrl.mainObject.PRODUCT_TYPE_ARR[$ctrl.otherObject.projectInfo.projectType]}}</div>'},{key:"版本号",html:"V{{$ctrl.otherObject.projectInfo.projectVersion}}"},{key:"更新时间",html:"{{$ctrl.otherObject.projectInfo.projectUpdateTime}}"},{type:"link",key:"API总数",linkAuthority:"lookApi",sref:"home.ams.project.inside.api.list",html:"{{$ctrl.otherObject.projectInfo.apiCount}}"},{type:"link",key:"状态码总数",linkAuthority:"lookCode",sref:"home.ams.project.inside.code.list",html:"{{$ctrl.otherObject.projectInfo.statusCodeCount}}"},{type:"link",key:"项目文档总数",linkAuthority:"lookPage",sref:"home.ams.project.inside.doc.list",html:"{{$ctrl.otherObject.projectInfo.pageCount}}"},{type:"link",key:"协作人员数量",sref:"home.ams.project.inside.authority.default",html:"{{$ctrl.otherObject.projectInfo.partnerCount}} 人"}],operate:[{type:"html",authority:"share",html:o("JsConstructHtml_CommonFilter")('<span class="iconfont icon-yun mr15 fs20"></span><span class="fg1">{@text}</span><span class="iconfont fs24 cp" ng-class="{\'icon-huadongkaiguan-guanbi\':!$ctrl.otherObject.projectInfo.isShared, \'icon-huadongkaiguan-dakai\':$ctrl.otherObject.projectInfo.isShared}" ng-click="$ctrl.mainObject.operate[0].fun()"></span>',{text:"在线分享项目"}),fun:m.openShare,btnList:[{key:"复制分享链接",authority:"isShareOpen",icon:"lianjie",fun:m.copyShareLink},{key:"设置",icon:"quanjushezhi",fun:m.share}]},{icon:"yunxiazai",key:"导出离线 API 文档",authority:"export",btnList:[{key:"导出",fun:m.dump}]},{icon:"leida-faxianx",key:"自动生成API文档",authority:"sync",btnList:[{key:"立即同步",icon:"jiazai_shuaxin",fun:m.syncCode},{key:"设置",icon:"quanjushezhi",fun:m.settingSyncConfig}]},{type:"html",authority:"pro",html:o("JsConstructHtml_CommonFilter")('<div class="eo-status-tips m_auto" ng-if="!$ctrl.otherObject.planList.length">{@text}</div><gantt-Echart-Common-Component ng-if="$ctrl.otherObject.planList.length" style="width:260px;" list="$ctrl.otherObject.planList" main-object="$ctrl.otherObject.ganttObject"></gantt-Echart-Common-Component>',{text:"暂无迭代计划"}),btnList:[{key:"管理迭代计划",fun:m.seeGantt}]},{type:"html",html:'<plug-api-status-statistics input="$ctrl.otherObject.plugApiStatusStatisticsObject"></plug-api-status-statistics>',btnList:[{key:"查看API统计",fun:m.seeApiStatus}]},{type:"html",html:'<div echart-common-directive style="height:40px;width:260px;" class="echart" ng-model="$ctrl.otherObject.contributionChart"></div>',btnList:[{key:"查看项目贡献度",fun:m.seeContribution}]},{type:"html",authority:"pro",html:o("JsConstructHtml_CommonFilter")("<span>{@text}</span><span ng-class=\"{'cg':!(90>$ctrl.otherObject.projectInfo.apiCaseRatio),'co':!(60>$ctrl.otherObject.projectInfo.apiCaseRatio)&&(90>$ctrl.otherObject.projectInfo.apiCaseRatio),'cr':60>$ctrl.otherObject.projectInfo.apiCaseRatio}\">{{($ctrl.otherObject.projectInfo.apiCaseRatio.toFixed(2))+'%'}}</span>",{text:"已编写测试用例的API占比："}),btnList:[{key:"查看未编写测试用例的API",fun:m.seeApiAboutCase,params:{type:"none"}}]},{type:"html",authority:"pro",html:o("JsConstructHtml_CommonFilter")("{@html_1}平均每个API的用例数量：{@html_2}{{$ctrl.otherObject.projectInfo.apiCaseCoverRatio}}个{@html_3}",{html_1:"<span>",html_2:"</span><span ng-class=\"{'cg':!(1>$ctrl.otherObject.projectInfo.apiCaseCoverRatio),'co':!(0.6>$ctrl.otherObject.projectInfo.apiCaseCoverRatio)&&(1>$ctrl.otherObject.projectInfo.apiCaseCoverRatio),'cr':0.6>$ctrl.otherObject.projectInfo.apiCaseCoverRatio}\">",html_3:"</span>"}),btnList:[{key:"查看测试不够完善的API",fun:m.seeApiAboutCase,params:{type:"imperfect"}}]}],table:{menuObject:{list:[{type:"btn","class":"pull-right",btnList:[{name:"了解更多",icon:"iosgengduo",fun:{"default":function(){i.go("home.ams.project.inside.account.log")}}}]}],setting:{title:"项目动态（最近）"}},listObject:{mainObject:{item:{"default":[{key:"时间",html:"{{item.opTime}}"},{key:"操作",html:"{{item.opDesc}}"},{key:"成员",html:"{{item.operator}}"}]},setting:{unhover:!0}}}},setting:{divideArr:{list1:[0,3],list2:[3,6],list3:[6,7]},editFun:m.edit,title:u.interaction.response.projectInfo.projectName}}}},m.parseProjectInfo=function(){var e={promise:null,request:{spaceKey:u.interaction.request.spaceKey,projectHashKey:u.interaction.request.projectHashKey}};return t.$emit("$WindowTitleSet",{list:["项目概况","API管理"]}),e.promise=n.Project.Detail(e.request).$promise.then(function(t){u.interaction.response.projectInfo=t||{},u.interaction.response.projectInfo.xData=[],u.interaction.response.projectInfo.yData=[],angular.forEach(u.interaction.response.projectInfo.projectHeat,function(t){u.interaction.response.projectInfo.xData.unshift(t.date),u.interaction.response.projectInfo.yData.unshift(t.heat)}),u.interaction.response.projectInfo.synchronizeSetting=u.interaction.response.projectInfo.synchronizeSetting||{},h.cache.set(t,"projectInfo"),m.initComponent(),m.initChartComponent();try{u.component.plugApiStatusStatisticsObject.totalCount=u.interaction.response.projectInfo.apiCount;for(var e in u.component.plugApiStatusStatisticsObject.array){var o=u.component.plugApiStatusStatisticsObject.array[e];o.count=u.interaction.response.projectInfo.apiStatusList[o.value]}}catch(n){}u.component.overviewObject.mainObject.table.listObject.list=h.logAndNoticeParse.fun.filterProject(t.logList||[])}),e.promise},u.fun.initPromise=function(t){switch(t){case"sync":return m.waitSync();default:return m.parseProjectInfo()}},u.$onInit=function(){}}angular.module("eolinker.ams").component("homeProjectInsideOverview",{templateUrl:"module/ams/ui/project/inside/content/overview/index.html",controller:t}),t.$inject=["$scope","API_AMS_CONSTANT","$filter","ApiManagementResource","$state","$rootScope","CODE","Cache_CommonService","Log_And_Notice_Parse_CommonService","Operate_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,c,o,n){var s=this;s.service={cache:o,home:c,authority:n},s.component={testObject:{}},s.fun={};var i={};i.init=function(){s.service.home.envObject.fun.resetObject(null)},i.cacheTestResponse=function(e){s.component.testObject.object[e].UNIT_TEST_RESULT=s.service.cache.get("UNIT_TEST_RESULT")},s.fun.click=function(c){i.cacheTestResponse(s.component.testObject.target),s.component.testObject.object[c].isAreadyInit=!0,e.$emit("$TransferStation",{state:"$HomeProjectInsideQuickTestSidebar",data:{groupID:s.component.testObject.object[c].vmAjaxRequest.groupID,apiID:s.component.testObject.object[c].vmAjaxRequest.apiID}}),t.go("home.ams.project.inside.quickTest.default",{timestamp:c,apiID:s.component.testObject.object[c].vmAjaxRequest.apiID,groupID:s.component.testObject.object[c].vmAjaxRequest.groupID})},s.fun.add=function(){i.cacheTestResponse(s.component.testObject.target);var c=(new Date).getTime();s.component.testObject.target=c,s.component.testObject.object[c]=null,e.$emit("$TransferStation",{state:"$HomeProjectInsideQuickTestSidebar"}),t.go("home.ams.project.inside.quickTest.default",{timestamp:c,apiID:null,groupID:null})},s.fun.moreClose=function(c){var o=0;switch(c){case"right":for(var n in s.component.testObject.object)n!=s.component.testObject.target?o&&delete s.component.testObject.object[n]:o=1;s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject));break;case"left":for(var n in s.component.testObject.object){if(n==s.component.testObject.target)break;delete s.component.testObject.object[n]}s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject));break;case"all":s.component.testObject={target:(new Date).getTime(),object:{}},s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject)),e.$emit("$TransferStation",{state:"$HomeProjectInsideQuickTestSidebar"}),t.go("home.ams.project.inside.quickTest.default",{timestamp:s.component.testObject.target,groupID:null,apiID:null});break;case"all-expect-current":for(var n in s.component.testObject.object)n!=s.component.testObject.target&&delete s.component.testObject.object[n];s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject))}},s.fun.close=function(c,o){if(c.stopPropagation(),s.component.testObject.target!==o)return delete s.component.testObject.object[o],void s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject));var n=null,i=!1,a=null,m=null;for(var r in s.component.testObject.object){if(r==s.component.testObject.target||i){if(n)break;if(!i){i=!0;continue}}if(n=r,a=s.component.testObject.object[r].vmAjaxRequest.apiID,m=s.component.testObject.object[r].vmAjaxRequest.groupID,i)break}n?(s.component.testObject.target=n,delete s.component.testObject.object[o]):s.component.testObject={target:(new Date).getTime(),object:{}};var p=n||s.component.testObject.target;s.component.testObject.object[p]&&(s.component.testObject.object[p].isAreadyInit=!0),e.$emit("$TransferStation",{state:"$HomeProjectInsideQuickTestSidebar",data:{groupID:m,apiID:a}}),t.go("home.ams.project.inside.quickTest.default",{timestamp:p,apiID:a,groupID:m})},e.$on("$stateChangeStart",function(e,t,c,o,n){return"home.ams.project.inside.quickTest.default"!==t.name?void s.service.cache.removeItem("QUICK_TEST_OBJECT"):(n.apiID!=c.apiID&&n.timestamp==c.timestamp&&(s.component.testObject.object[s.component.testObject.target]={}),s.service.cache.setItem("QUICK_TEST_OBJECT",JSON.stringify(s.component.testObject)),void i.init())}),e.$on("$stateChangeSuccess",function(){i.init()}),s.$onInit=function(){i.init();var e=JSON.parse(s.service.cache.getItem("QUICK_TEST_OBJECT")||"null");s.component.testObject=e||{object:{}},s.component.testObject.target=t.params.timestamp,s.service.cache.clear("Common_Function_List")}}angular.module("eolinker.ams").component("homeProjectInsideQuickTest",{templateUrl:"module/ams/ui/project/inside/content/quickTest/index.html",controller:e}),e.$inject=["$scope","$state","Operate_CommonService","Cache_CommonService","Authority_CommonService"]}();
"use strict";!function(){function t(t,o){var e=this;e.component={authorityGroupProductObject:{mainObject:{setting:{module:0,productName:"ams",permissionName:"project",uri:"home.ams.project.inside.authority.default"}}}},e.service={authority:o}}angular.module("eolinker.ams").component("homeProjectInsideAuthoritySidebar",{template:'<authority-group-product-component  authority-object="{edit:$ctrl.service.authority.projectGroupPermission.project.editMember}"   main-object="$ctrl.component.authorityGroupProductObject.mainObject"></authority-group-product-component>',controller:t}),t.$inject=["$scope","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,o,r,a,n,c,i){var s=this;s.data={"static":{query:[{groupID:-1,groupName:"所有API",icon:"caidan"},{groupID:-2,groupName:"回收站",icon:"shanchu"}]}},s.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,groupID:r.params.groupID||-1,apiID:r.params.apiID,orderNumber:[]},response:{query:[]}},s.component={groupCommonObject:{}},s.service={authority:c};var u={cache:i},p={};p.init=function(){u.cache.clear("ENV_QUERY_AMS_COMPONENT")},p.init(),p["export"]=function(e){var r={cache:u.cache.get("ENV_QUERY_AMS_COMPONENT"),modal:{title:"导出离线 API 文档",version:s.service.authority.product.ams,mark:"exceptHtml",spaceKey:s.interaction.request.spaceKey,request:{groupID:e.item.groupID},resource:t.ApiGroup},fun:null};r.fun=function(){a.AMS_ExportModal(r.modal)},r.cache?(r.modal.envList=r.cache,r.fun()):o.Env.All({spaceKey:s.interaction.request.spaceKey,projectHashKey:s.interaction.request.projectHashKey,module:0}).$promise.then(function(e){u.cache.set(e.envList||[],"ENV_QUERY_AMS_COMPONENT"),r.modal.envList=e.envList||[],r.fun()})},p["import"]=function(){var e={modal:{title:"导入分组",version:1,status:1,request:{spaceKey:s.interaction.request.spaceKey,projectHashKey:s.interaction.request.projectHashKey},resource:t.ApiGroup}};a.Product_ImportModal(e.modal,function(e){if(e)switch(s.component.groupCommonObject.mainObject.baseInfo.resetFlag=!s.component.groupCommonObject.mainObject.baseInfo.resetFlag,s.interaction.request.groupID){case-1:case"-1":r.go("home.ams.project.inside.api.list",{groupID:r.params.groupID?null:-1})}})},s.$onInit=function(){s.component.groupCommonObject={requestObject:{resource:o.Group,baseRequest:{module:2,spaceKey:s.interaction.request.spaceKey,projectHashKey:s.interaction.request.projectHashKey}},funObject:{btnGroupList:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建分组","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{funName:"edit",key:"新建分组"},{key:"导入",fun:p["import"]}]}],callback:{querySuccess:function(e){r.current.name.indexOf("list")>-1?n.set(e):n.set(e,!0)}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:s.interaction.request},staticQuery:s.data["static"].query,itemFun:[{funName:"edit",key:"新建子分组",params:'"add-child",arg',authority:"edit",isStrong:1},{fun:p["export"],key:"导出离线 API 文档",authority:"export"},{funName:"edit",key:"编辑",authority:"edit",params:'"edit",arg'},{funName:"delete",authority:"edit",params:{modal:{title:"删除分组",message:"删除分组后，该分组下的api将全部移入回收站，该操作无法撤销，确认删除？"}},key:"删除"}]}}}}angular.module("eolinker.ams").component("homeProjectInsideApiSidebar",{template:'<group-default-common-Component  authority-object="{\'edit\':$ctrl.service.authority.permission.project.apiManagement.edit,\'export\':$ctrl.service.authority.permission.project.exportAndShare.export}" fun-object="$ctrl.component.groupCommonObject.funObject" request-object="$ctrl.component.groupCommonObject.requestObject" main-object="$ctrl.component.groupCommonObject.mainObject" ></group-default-common-Component>',controller:e}),e.$inject=["$scope","ApiManagementResource","GeneralFunResource","$state","$rootScope","GroupService","Authority_CommonService","Cache_CommonService"]}();
"use strict";!function(){function e(e,o,r,t,a,c,n){var s=this;s.data={},s.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,groupID:r.params.groupID||-1,apiID:r.params.apiID,orderNumber:[]},response:{query:[]}},s.component={groupCommonObject:{}},s.service={authority:c}}angular.module("eolinker.ams").component("homeProjectInsideCaseSidebar",{template:"<div ></div>",controller:e}),e.$inject=["$scope","GeneralFunResource","$state","$rootScope","GroupService","Authority_CommonService","Cache_CommonService"]}();
"use strict";!function(){function e(e,t,o,r,n,a,c,u,i){var s=this;s.data={"static":{query:[{groupID:-1,groupName:"所有状态码",icon:"caidan"}]}},s.component={groupCommonObject:{}},s.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID||-1},response:{query:[]}},s.service={groupCommon:c,authority:u};var p={};p.init=function(){},p["export"]=function(e){var o={modal:{mark:"common",title:"导出分组",spaceKey:s.interaction.request.spaceKey,request:{groupID:e.item.groupID},resource:t.CodeGroup}};n.AMS_ExportModal(o.modal,function(e){})},p["import"]=function(){var e={modal:{title:"导入分组",version:1,status:1,request:{spaceKey:s.interaction.request.spaceKey,projectHashKey:s.interaction.request.projectHashKey},resource:t.CodeGroup}};n.Product_ImportModal(e.modal,function(e){if(e)switch(s.component.groupCommonObject.mainObject.baseInfo.resetFlag=!s.component.groupCommonObject.mainObject.baseInfo.resetFlag,s.interaction.request.groupID){case-1:case"-1":o.go("home.ams.project.inside.code.list",{groupID:o.params.groupID?null:-1})}})},i.$on("$stateChangeSuccess",function(){s.interaction.request.groupID=o.params.groupID||-1}),s.$onInit=function(){s.component.groupCommonObject={requestObject:{resource:e.Group,baseRequest:{module:3,spaceKey:s.interaction.request.spaceKey,projectHashKey:s.interaction.request.projectHashKey}},funObject:{btnGroupList:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建分组","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{funName:"edit",key:"新建分组"},{key:"导入",fun:p["import"]}]}],callback:{querySuccess:function(e){a.set(e)}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:s.interaction.request},staticQuery:s.data["static"].query,itemFun:[{funName:"edit",key:"新建子分组",params:'"add-child",arg',authority:"edit",isStrong:1},{fun:p["export"],key:"导出分组",authority:"export"},{funName:"edit",key:"编辑",authority:"edit",params:'"edit",arg'},{funName:"delete",key:"删除",authority:"edit",params:{modal:{title:"删除分组",message:"删除分组后，该分组内的状态码也将被删除，该操作无法撤销，确认删除？"}}}]}}}}angular.module("eolinker.ams").component("homeProjectInsideCodeSidebar",{template:'<group-default-common-Component  authority-object="{\'edit\':$ctrl.service.authority.permission.project.statusCode.edit,\'export\':$ctrl.service.authority.permission.project.exportAndShare.export}" fun-object="$ctrl.component.groupCommonObject.funObject"  request-object="$ctrl.component.groupCommonObject.requestObject" main-object="$ctrl.component.groupCommonObject.mainObject" ></group-default-common-Component>',controller:e}),e.$inject=["GeneralFunResource","ApiManagementResource","$state","CODE","$rootScope","GroupService","Group_MultistageService","Authority_CommonService","$scope"]}();
"use strict";!function(){function e(e,t,o,r,a,n,c){var i=this;i.data={"static":{query:[{groupID:-1,groupName:"所有文档",icon:"caidan"}]},sidebarShow:null},s={},i.component={groupCommonObject:{}},i.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,groupID:r.params.groupID||-1},response:{query:[]}},i.service={authority:c};var s={};s.init=function(){r.current.name.indexOf("list")>-1?i.data.sidebarShow=!0:i.data.sidebarShow=!1},s.init(),s["export"]=function(e){var t={modal:{mark:"common",title:"导出分组",spaceKey:i.interaction.request.spaceKey,request:{groupID:e.item.groupID},resource:o.DocGroup}};a.AMS_ExportModal(t.modal,function(e){})},s["import"]=function(){var e={modal:{title:"导入分组",version:1,status:1,request:{spaceKey:i.interaction.request.spaceKey,projectHashKey:i.interaction.request.projectHashKey},resource:o.DocGroup}};a.Product_ImportModal(e.modal,function(e){if(e)switch(i.component.groupCommonObject.mainObject.baseInfo.resetFlag=!i.component.groupCommonObject.mainObject.baseInfo.resetFlag,i.interaction.request.groupID){case-1:case"-1":r.go("home.ams.project.inside.doc.list",{groupID:r.params.groupID?null:-1})}})},e.$on("$stateChangeSuccess",function(){r.current.name.indexOf("list")>-1?i.data.sidebarShow=!0:i.data.sidebarShow=!1,i.interaction.request.groupID=r.params.groupID||-1}),i.$onInit=function(){i.component.groupCommonObject={requestObject:{resource:t.Group,baseRequest:{module:4,spaceKey:i.interaction.request.spaceKey,projectHashKey:i.interaction.request.projectHashKey}},funObject:{btnGroupList:[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建分组","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{funName:"edit",key:"新建分组"},{key:"导入",fun:s["import"]}]}],callback:{querySuccess:function(e){r.current.name.indexOf("list")>-1?n.set(e):n.set(e,!0)}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:i.interaction.request},staticQuery:i.data["static"].query,itemFun:[{funName:"edit",key:"新建子分组",authority:"edit",params:'"add-child",arg',isStrong:1},{fun:s["export"],key:"导出分组",authority:"export"},{funName:"edit",key:"编辑",authority:"edit",params:'"edit",arg'},{funName:"delete",key:"删除",authority:"edit",params:{modal:{title:"删除分组",message:"删除分组后，该分组内的文档也将被删除，该操作无法撤销，确认删除？"}}}]}}}}angular.module("eolinker.ams").component("homeProjectInsideDocSidebar",{template:'    <group-default-common-Component ng-show="$ctrl.data.sidebarShow" authority-object="{\'edit\':$ctrl.service.authority.permission.project.projectPage.edit,\'export\':$ctrl.service.authority.permission.project.exportAndShare.export}" fun-object="$ctrl.component.groupCommonObject.funObject"  request-object="$ctrl.component.groupCommonObject.requestObject" main-object="$ctrl.component.groupCommonObject.mainObject" ></group-default-common-Component>',controller:e}),e.$inject=["$scope","GeneralFunResource","ApiManagementResource","$state","$rootScope","GroupService","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,o){var n=this;n.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:t.params.projectHashKey,groupID:t.params.groupID||-1,apiID:t.params.apiID},response:{groupQuery:[],query:[]}},n.component={groupCommonObject:{}};var r={init:null,click:null};r.go=function(e){n.interaction.request.apiID=e.item.apiID,n.interaction.request.groupID=e.groupItem.parentGroupID,t.go("home.ams.project.inside.quickTest.default",n.interaction.request)},n.$onInit=function(){n.component.groupCommonObject={requestObject:{resource:e.ApiGroup,baseRequest:{apiID:null,spaceKey:n.interaction.request.spaceKey,projectHashKey:n.interaction.request.projectHashKey}},mainObject:{baseInfo:{name:"groupName",id:"groupID",current:n.interaction.request},baseFun:{go:r.go}}}},o.$on("$HomeProjectInsideQuickTestSidebar",function(e,t){t=t||{},n.interaction.request.apiID=t.apiID,n.interaction.request.groupID=t.groupID})}angular.module("eolinker").component("homeProjectInsideQuickTestSidebar",{template:'<group-quick-test-common-component request-object="$ctrl.component.groupCommonObject.requestObject" main-object="$ctrl.component.groupCommonObject.mainObject" list="$ctrl.interaction.response.query"></group-quick-test-common-component>',controller:e}),e.$inject=["ApiManagementResource","$state","$scope"]}();
"use strict";!function(){function e(e,o){var t=this;t.component={reportObject:{object:{},show:!1}},t.triggleB={},t.triggleA={},o.testCommonFun.downloadPcModal()}angular.module("eolinker.ams").component("homeProjectInsideCase",{templateUrl:"module/ams/ui/project/inside/content/case/index.html",controller:e}),e.$inject=["$scope","Operate_CommonService"]}();
"use strict";!function(){function e(e,t,o,n,s,i,a,r,c,u){var p=this;p.data={validToSwitchTestMethod:eoSystemObj.validToSwitchTestMethod,settingTypeQuery:[{key:"所有项目",value:0},{key:"自定义",value:1}],tabValue:0,projectList:[]},p.ajaxResponse={projectInfo:{},settingInfo:{}},p.component={blockListObject:{},tipComponentObject:{type:"html",status:"warning",downloadPc:function(){a.Common_DownLoad_PCModal({type:"imgModal"})},html:'受浏览器功能限制，如果您使用插件进行测试，超时限制将按照“总时间”进行计算，您可以 <button type="button" class="eo-operate-btn" ng-click="$ctrl.input.downloadPc()">下载PC客户端</button>享受完整体验'}},p.multiTabComponent={list:[{key:"项目",value:0},{key:"全局测试设置",value:3}]},p.fun={},p.CONST={TIMELIMIT_TYPE_ARR:[{key:"请求总时间",value:0},{key:"首字节返回时间",value:1}]},p.service={authority:r};var m={},j={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey,quotedProject:[]};m.initQuotedProject=function(){var e={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey};o.Project.GetQuotedProject(e).$promise.then(function(e){p.ajaxResponse.settingInfo=e.settingInfo||{settingType:0,projectList:[]},p.ajaxResponse.settingInfo.settingType=(p.ajaxResponse.settingInfo.settingType||0).toString(),p.ajaxResponse.settingInfo.projectList=p.ajaxResponse.settingInfo.projectList||[],(p.ajaxResponse.settingInfo.projectList||[]).map(function(e,t){j.quotedProject.push(e.projectHashKey)})})}(),m.resetPermission=function(){var e={module:1,spaceKey:j.spaceKey,hashKey:j.projectHashKey};t.ProjectMember.GetProjectPermission(e).$promise.then(function(e){p.service.authority.fun.setPermission("automatic",{permission:e.permission||{},isArchive:e.isArchive,userGrade:e.permission.userGrade})})},p.fun.file=function(){var e={module:1,spaceKey:j.spaceKey,isArchive:0===p.ajaxResponse.projectInfo.isArchive?1:0,projectHashKey:'["'+j.projectHashKey+'"]'},o=1===e.isArchive?"归档":"取消归档",n=function(){var n=t.Project.BatchFile(e).$promise;return n.then(function(t){switch(t.statusCode){case s.COMMON.SUCCESS:a.InfoModal(o+"成功！","success"),p.ajaxResponse.projectInfo.isArchive=e.isArchive,m.resetPermission();break;default:a.InfoModal(o+"失败！","error")}}),n};return 1!==e.isArchive?n():void a.EnsureModal("归档项目",!1,"项目归档之后仅支持只读操作,如需编辑项目需要先取消归档,确认归档项目?",{btnType:2,btnMessage:"确认"},function(e){if(e)return n()})},p.fun["delete"]=function(){var e={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey};a.EnsureModal("删除自动化测试",!0,"自动化测试删除后，所有自动化测试内数据均会被删除，并且无法恢复数据，请谨慎操作！",{},function(t){t&&o.Project.Delete(e).$promise.then(function(e){switch(e.statusCode){case s.COMMON.SUCCESS:n.go("home.ams.automatic.default"),a.InfoModal("删除成功","success");break;default:a.InfoModal("删除失败，"+c.FAILURE,"error")}})})},p.fun.deleteApiProject=function(e){p.ajaxResponse.settingInfo.projectList.splice(e.$index,1),j.quotedProject.splice(j.quotedProject.indexOf(e.item.projectHashKey),1)},p.fun.addProject=function(){a.Product_ImportCrossProjectModal({title:"选择可以被引用的API项目",mainObject:{type:"automaticQuotedProject",setting:{itemInitQuery:j.quotedProject,itemTitle:"项目",initGroupID:0,resultType:"item",staticQuery:[{groupID:0,groupName:"进行中"},{groupID:1,groupName:"已归档"}]},otherObject:{PROJECT_TYPE_QUERY:i.PROJECT_TYPE_QUERY},listComponent:{item:{batchItemExpression:"ng-disabled='$ctrl.otherObject.itemInitQuery.indexOf(item.projectHashKey)>-1'",primaryKey:"projectHashKey","default":[{key:"项目名称",html:"{{item.projectName}}"},{key:"版本",html:"{{item.projectVersion}}"},{key:"类型",html:"{{$ctrl.otherObject.PROJECT_TYPE_QUERY[item.projectType].key}}"}]},baseFun:{beforeSelect:function(e){return j.quotedProject.indexOf(e)===-1}},setting:{isFixedHeight:!0,batch:!0,batchInitStatus:"open",warning:"暂无可以被引用的API项目"}},baseParams:{spaceKey:j.spaceKey},impItemInfo:{queryResouceName:o.Project.GetApiProjectList,queryResponseKey:"projectList"}}},function(e){e&&e.forEach(function(e){j.quotedProject.indexOf(e.projectHashKey)===-1&&(p.ajaxResponse.settingInfo.projectList.push(e),j.quotedProject.push(e.projectHashKey))})})},p.fun.confirmBind=function(){var e={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey,settingType:p.ajaxResponse.settingInfo.settingType},t=null;switch(e.settingType){case 1:e.quotedProject=JSON.stringify(j.quotedProject)}return t=o.Project.SetQuotedProject(e).$promise.then(function(e){switch(e.statusCode){case s.COMMON.SUCCESS:a.InfoModal("保存成功","success");break;default:a.InfoModal("保存失败，"+c.FAILURE,"error")}})},p.fun.saveGlobalTimeout=function(){var t={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey,timeoutLimitType:p.ajaxResponse.timeoutSetting.timeoutLimitType,timeoutLimit:p.ajaxResponse.timeoutSetting.timeoutLimit};p.data.submitted=!0,e.TimeoutForm.$valid&&o.Project.EditTimeOut(t).$promise.then(function(e){switch(e.statusCode){case s.COMMON.SUCCESS:a.InfoModal("保存默认超时时间成功","success");break;default:a.InfoModal("保存默认超时时间失败，"+c.FAILURE,"error")}})},p.fun.confirm=function(){var t={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey,projectName:p.ajaxResponse.projectInfo.projectName,projectVersion:p.ajaxResponse.projectInfo.projectVersion},n=null;return e.BasicForm.$valid&&(n=o.Project.Edit(t).$promise,n.then(function(e){switch(e.statusCode){case s.COMMON.SUCCESS:a.InfoModal("编辑自动化测试信息成功","success");break;default:a.InfoModal("编辑自动化测试信息失败，"+c.FAILURE,"error")}})),n},p.fun.changeTab=function(){e.$broadcast("$Init_LoadingCommonComponent")},p.fun.init=function(){var e={spaceKey:j.spaceKey,projectHashKey:j.projectHashKey};switch(p.data.tabValue){case 3:return a.global.ajax.Info_Project=o.Project.QueryTimeOut(e),a.global.ajax.Info_Project.$promise.then(function(e){p.ajaxResponse.timeoutSetting=e.timeoutSetting||{timeoutLimit:5e3,timeoutLimitType:0}}),a.global.ajax.Info_Project.$promise;default:return a.global.ajax.Info_Project=o.Project.Detail(e),a.global.ajax.Info_Project.$promise.then(function(e){p.ajaxResponse.projectInfo=e||{}}),a.global.ajax.Info_Project.$promise}},m.initCommonHeaderTable=function(){p.component.blockListObject.referProject={tdList:[{thKey:"项目名称",type:"text",modelKey:"projectName","class":"pl20"},{thKey:"版本",type:"text",modelKey:"projectVersion"},{thKey:"类型",type:"html",html:"{{$ctrl.mainObject.API_DEV_PROJECT_TYPE_ARR[item.projectType]}}"},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete",fun:p.fun.deleteApiProject}]}],API_DEV_PROJECT_TYPE_ARR:u}},p.$onInit=function(){e.$emit("$WindowTitleSet",{list:["自动化测试设置","自动化测试"]}),m.initCommonHeaderTable()}}angular.module("eolinker.ams").component("homeAutomaticInsideSetting",{templateUrl:"module/ams/ui/automatic/inside/content/account/default/index.html",controller:e}),e.$inject=["$scope","GeneralFunResource","AutomatedTestResource","$state","CODE","API_AMS_CONSTANT","$rootScope","Authority_CommonService","RESPONSE_TEXT","API_DEV_PROJECT_TYPE_ARR"]}();
"use strict";!function(){function t(t,e){var o=this;o.component={authorityProductObject:{mainObject:{setting:{module:1,productName:"ams",noun:{projectName:"自动化测试"}}}}},o.service={authority:e}}angular.module("eolinker.ams").component("homeAutomaticInsideAuthorityDefault",{template:'<authority-product-component main-object="$ctrl.component.authorityProductObject.mainObject" authority-object="{editMember:$ctrl.service.authority.projectGroupPermission.automatic.editMember,editManager:$ctrl.service.authority.projectGroupPermission.automatic.editManager}"></authority-product-component>',controller:t}),t.$inject=["$scope","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,a,n,i,o,r,c){var s=this;s.service={authority:o},s.data={pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},s.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,page:r.params.page||1,conditionType:r.params.type||0,startTime:r.params.startTime,endTime:r.params.endTime,connID:r.params.connID,module:1},s.ajaxResponse={query:null},s.fun={};var m={logAndNoticeParse:a},l={};l.getMemberQuery=function(){var a={spaceKey:s.ajaxRequest.spaceKey,hashKey:s.ajaxRequest.projectHashKey,module:s.ajaxRequest.module};e.global.ajax.MemberQuery_Project=t.ProjectMember.TotalMemberQuery(a),e.global.ajax.MemberQuery_Project.$promise.then(function(e){s.ajaxResponse.memberList=e.memberList||[]})}(),s.component={listPageCommonObject:null,menuObject:{list:null,otherObject:null},datePickerObject:{request:{startTime:r.params.startTime?new Date(r.params.startTime):"",endTime:r.params.endTime?new Date(r.params.endTime):""},show:!1}},s.fun.init=function(){var t={spaceKey:s.ajaxRequest.spaceKey,projectHashKey:s.ajaxRequest.projectHashKey,page:s.ajaxRequest.page,pageSize:s.data.pagination.pageSize,conditionType:s.ajaxRequest.conditionType,startTime:s.ajaxRequest.startTime,endTime:s.ajaxRequest.endTime,connID:s.ajaxRequest.connID};return n.$emit("$WindowTitleSet",{list:["日志","自动化测试"]}),e.global.ajax.GetProjectLogList_Project=i.Project.GetProjectLogList(t),e.global.ajax.GetProjectLogList_Project.$promise.then(function(e){s.data.pagination.page=t.page,s.ajaxResponse.query=m.logAndNoticeParse.fun.filterAutomatic(e.logList||[]),s.data.pagination.msgCount=e.logCount||0}),e.global.ajax.GetProjectLogList_Project.$promise},s.fun.search=function(t){var a=null,n={page:null,type:3,startTime:c("currentTimeFilter")(s.component.datePickerObject.request.startTime,{min:"day"}),endTime:c("currentTimeFilter")(s.component.datePickerObject.request.endTime,{min:"day"})};n.startTime?n.endTime?(s.component.datePickerObject.show=!1,s.component.datePickerObject.request.startTime>s.component.datePickerObject.request.endTime&&(a=n.startTime,n.startTime=n.endTime,n.endTime=a),r.go("home.ams.automatic.inside.account.log",n)):e.InfoModal("请选择结束日期","error"):e.InfoModal("请选择开始日期","error")},l.filter=function(e){r.go("home.ams.automatic.inside.account.log",{page:null,type:e.key,startTime:null,endTime:null})},s.fun.select=function(){var t=null,a={title:"请选择所筛选的人员",query:s.ajaxResponse.memberList,key:"connID",initialData:s.ajaxRequest.connID};t=function(){e.Product_SelectPeopleModal(a,function(e){e&&r.go("home.ams.automatic.inside.account.log",{page:null,connID:e.value})})},s.ajaxResponse.memberList?t():e.global.ajax.MemberQuery_Project.$promise["finally"](t)},s.$onInit=function(){s.component.listPageCommonObject={mainObject:{item:{"default":[{key:"操作时间",html:"{{item.opTime}}","class":"w_200"},{key:"类型",html:"{{$ctrl.mainObject.OP_TYPE_ARR[item.opType]}}","class":"w_60"},{key:"操作对象","class":"w_150",html:"{{item.opTarget}}"},{key:"操作人","class":"w_150",html:"{{item.operator}}",isUnneccessary:!0},{key:"描述",html:"{{item.opDesc}}",title:"{{item.opDesc}}",isUnneccessary:!0}]},setting:{warning:"尚未存在任何日志",unhover:!0},OP_TYPE_ARR:["新建","更新","删除","其他"]}},s.component.menuObject.mainObject={list:[{type:"tips-tab","class":"view-btn-li menu-ml15 pull-left",activePoint:"conditionType",tabList:[{name:"今天",active:0,fun:{"default":l.filter,params:{key:0}}},{name:"七天之内",active:1,fun:{"default":l.filter,params:{key:1}}},{name:"过去30天",active:2,authority:"month",fun:{"default":l.filter,params:{key:2}}},{active:3,authority:"quarter",type:"html",html:'{{$ctrl.activeObject.startTime?($ctrl.activeObject.startTime+" - "+$ctrl.activeObject.endTime):"自定义时间段"}}<p datepicker-times-directive="$ctrl.otherObject.datePicker.fun(arg)" interaction="$ctrl.otherObject.datePicker.object"></p>',fun:{"default":function(e){e.$event.stopPropagation(),s.component.datePickerObject.show=!0}}}]},{type:"btn","class":"btn-group-li menu-ml10 pull-left",btnList:[{name:"所有人",icon:"jinxianshibutong",fun:{"default":s.fun.select}}]}],setting:{"class":"common-menu-fixed-seperate"}}}}angular.module("eolinker.ams").component("homeAutomaticInsideLog",{templateUrl:"module/ams/ui/automatic/inside/content/account/log/index.html",controller:e}),e.$inject=["$rootScope","GeneralFunResource","Log_And_Notice_Parse_CommonService","$scope","AutomatedTestResource","Authority_CommonService","$state","$filter"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,a,s,o,n,i,r,c,p,m,l,u,d,h,b){var y=this;y.data={selectedCommonCase:!1,status:u.params.status||"default",testHistory:{},plugObject:{needVersion:!0,matchVersion:593},batch:{isOperating:!1},testSeverType:window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE")||"plugin",selectStepNum:0,emptyStepNum:0,plugTransferToLocal:eoSystemObj.plugTransferToLocal},y.testStatusObj={isTesting:!1,showTestHistory:function(e,t,a){switch(y.data.testMethod){case"all":y.data.reportClickStatus="all",j.formatRealTestReport(e,y.data.testHistory,t,a),f.waitTestPointArr=f.testPointArr.filter(function(t){return e.indexOf(t)===-1}),y.component.reportObject.show=!0,j.testDownBasicOpr();break;case"single":f.singleTestItem.testing=!1,f.singleTestItem=null;break;case"ddt":y.component.ddtModal.testObj.basicData=t,f.singleTestItem&&(f.singleTestItem.testing=!1),f.singleTestItem=null}}},y.fun={},y.ajaxResponse={query:null},y.service={home:b,authority:h};var I={cache:d},g={COMPONENT_MODULE:u.current.name.indexOf("commonCase")>-1?"commonCase":"sceneCase",MATCH_TYPE_STR_ARR:["完全匹配","正则匹配","Json匹配","不校验","XML匹配","状态码校验"]},j={},f={testPointArr:[],testCheckboxObj:null,waitTestPointArr:[],singleTestItem:null},T={ws:null,wsLocalUrl:"ws://"+eoSystemObj.WS_TARGET_PREFIX_URL,wsServerUrl:(eoSystemObj.HOST.indexOf("https")>-1?"wss://":"ws://")+(eoSystemObj.PLATFORM.indexOf("sass")!==-1?eoSystemObj.WS_TARGET_PREFIX_URL:eoSystemObj.HOST.replace(/(http)(()|(s))(:\/\/)/,"")),wsUrl:""};y.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:u.params.projectHashKey,module:"commonCase"===g.COMPONENT_MODULE?1:0,caseID:u.params.caseID,groupID:u.params.groupID},y.component={reportObject:{object:{},show:!1,colorBindObj:{}},blockListObject:{},menuObject:{},topMenuObject:{},ddtModal:{testObj:{report:{},status:y.testStatusObj},showReport:function(e,t){y.data.reportClickStatus="all",j.formatRealTestReport(e.tempIDArr,e.report||e.responseList,e,[],{collectionName:e.collectionName,target:t}),y.component.reportObject.show=!0}}},j.resetBatchInfo=function(){y.data.batch.isOperating=!1,f.testCheckboxObj&&(y.data.batch.indexAddress=f.testCheckboxObj.indexAddress,y.data.batch.query=f.testCheckboxObj.query,y.data.batch.selectAll=f.testCheckboxObj.selectAll)},j.lockItem=function(e,t){var a={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,lockID:[],isLock:t?1:0,module:y.ajaxRequest.module};e.map(function(e){e.isEmpty||a.lockID.push(e.lockID)}),a.lockID=JSON.stringify(a.lockID),m.AutomatedTestCaseSingle.ChangeLock(a).$promise.then()},j.deleteBatchObj=function(e){do{var t=y.ajaxResponse.query[e].tempID;y.ajaxResponse.query.splice(e,1),y.data.batch.indexAddress[t]&&y.data.selectStepNum--,/TCE-/.test(t)&&y.data.emptyStepNum--;var a=y.data.batch.query.indexOf(t);a!==-1&&(y.data.batch.query.splice(a,1),delete y.data.batch.indexAddress[t])}while(e<y.ajaxResponse.query.length&&j.checkIsCommonCase(e,y.ajaxResponse.query[e]))},j.importExtraCase=function(){c.Product_ImportCrossProjectModal({title:"引用测试模板",mainObject:{type:"sceneCase",setting:{itemTitle:"测试模板库",initGroupID:null,staticQuery:[{groupID:null,groupName:"所有用例"}]},baseParams:{spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey},impGroupInfo:{resourceName:p.Group.Query,extraParams:{module:10}},impItemInfo:{queryResouceName:m.AutomatedTestCase.Query,searchResouceName:m.AutomatedTestCase.Search,queryIDResouceName:m.AutomatedTestCase.IDQuery,searchIDResouceName:p.CrossProject.SearchIDQuery,queryResponseKey:"caseList",queryIDResponseKey:"caseIDList",extraParams:{module:1}}}},function(t){if(t){var a={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,caseClass:2,module:0,commonCaseID:JSON.stringify(t)};m.AutomatedTestCase.AddCommonCase(a).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:c.InfoModal("引用用例成功！","success"),e.$broadcast("$Init_LoadingCommonComponent");break;case"401311":c.MessageModal("温馨提示","引用的用例模板中存在空白的模板，已经自动为您跳过空白模板。",{button:{cancel:{content:"确定","class":"eo_theme_btn_success"}}},function(){e.$broadcast("$Init_LoadingCommonComponent")})}})}})},j.importFromApiManage=function(e,t){c.Product_ImportCrossProjectModal({mainObject:{type:"ui",baseParams:{spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey},impProjectInfo:{resourceName:p.CrossProject.QueryProject,extraParams:{module:1}},impGroupInfo:{resourceName:p.CrossProject.QueryGroup,extraParams:{groupModule:2,module:1}},impItemInfo:{queryResouceName:p.CrossProject.QueryApi,searchResouceName:p.CrossProject.SearchApi,queryIDResouceName:p.CrossProject.QueryAllID,queryResponseKey:"apiList",extraParams:{module:1}},batchQueryResouce:{resource:p.CrossProject.QueryDetail,extraParams:{module:1}},batchAddResource:{resourceName:m.AutomatedTestCaseSingle.BatchAdd,extraParams:{module:y.ajaxRequest.module,caseID:y.ajaxRequest.caseID}},baseFun:{}}},function(e){e&&j.getQuery()})},j.parseSingleStepReport=function(e){y.component.reportObject.status=null,y.data.reportClickStatus="single";var t=e.general.match.type;y.component.reportObject.object={connID:e.connID,status:status,general:e.general,requestHeaders:"{}"==JSON.stringify(e.requestHeaders)?null:e.requestHeaders,responseHeaders:e.responseHeaders,requestBody:{requestType:"string"==typeof e.requestBody.body?"1":e.requestBody.requestType,body:"{}"==JSON.stringify(e.requestBody.body)?null:e.requestBody.body},returnResultType:e.returnResultType,response:e.response,errorReason:e.errorReason,baseInfo:{caseName:e.general.name,matchType:t,matchTypeMessage:0==t?"完全匹配":1==t?"正则匹配":2==t?"Json匹配":3==t?"不校验":4==t?"XML匹配":"状态码校验",statusCode:e.general.match.statusCode,matchRule:e.general.match.rule,matchHeaderRule:e.general.match.headerRule,matchHeaderType:e.general.match.headerType,matchHeaderTypeMessage:0==e.general.match.headerType?"不校验":"校验"},reportList:e.reportList,isLocal:e.isLocal}},j.showTestHistory=function(e,t){var a=angular.copy(y.data.testHistory[t.tempID]);if(a.connID||a.tempID)1===t.stepType?(y.component.reportObject.status="automated-pro",y.component.reportObject.object=a,a.baseInfo={caseName:a.name}):/^T-/.test(t.tempID)?(y.component.reportObject.status="automated-common-all",j.formatRealTestReport(a.tempIDArr,a.report,{time:a.time,reportStatus:a.reportStatus},[]),a.baseInfo={caseName:a.caseName}):/D-/.test(t.tempID)?(y.component.reportObject.status="sql",a.baseInfo={caseName:a.general.name},y.component.reportObject.object=a):j.parseSingleStepReport(a),y.component.reportObject.show=!0;else{var s={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,module:y.ajaxRequest.module,caseID:y.ajaxRequest.caseID,tempID:t.tempID};m.AutomatedTestHistory.TestReport(s).$promise.then(function(e){var a=e.latestHistory.result;return a?(1===t.stepType?(y.component.reportObject.status="automated-pro",a.baseInfo={caseName:a.caseName},y.component.reportObject.object=a):/^T-/.test(t.tempID)?(y.component.reportObject.status="automated-common-all",a.baseInfo={caseName:a.caseName},y.component.reportObject.object=a):/D-/.test(t.tempID)?(y.component.reportObject.status="sql",a.baseInfo={caseName:a.general.name},y.component.reportObject.object=a):j.parseSingleStepReport(a),void(y.component.reportObject.show=!0)):void c.InfoModal("暂无测试历史","error")})}},j.changeTestSeverType=function(){if(y.data.plugObject.useStatus)switch(y.data.testSeverType){case"nodejs":y.data.testSeverType="plugin";break;default:y.data.testSeverType="nodejs"}else{var e={html_1:"<div class='lh_30'><p>",html_2:"<a href='https://www.eolinker.com/#/plug/introduce' target='_blank' class='eo-status-warning' ><b>",html_3:"</b>",html_4:"</a>",html_5:"</p></div>",operate:window.plug&&"application/eolinker"==window.plug.type?"更新":"安装"},t="";t="更新"===e.operate?"{@html_1}测试增强插件已经提供新版本V5.9.3，请您先升级安装新版本插件{@html_2}[点此获取]{@html_3}{@html_4}。</br>升级插件版本后将会支持新的功能以及特性，由此带来不便之处，敬请谅解。{@html_5}":"{@html_1}如需切换使用插件测试，请先安装我们为您免费提供的 {@html_2}测试增强插件{@html_3} [点击获取]{@html_4}！{@html_5}",c.MessageModal("温馨提示",i("JsConstructHtml_CommonFilter")(t,e),{button:{sure:{content:"下载插件离线安装包",fun:function(){window.open(eoSystemObj.ADDRESS_PLUG)}}}}),y.data.testSeverType="nodejs"}window.localStorage.setItem("EOLINKER_TEST_USE_SOFTWARE_TYPE",y.data.testSeverType)},j.setAjaxQuery=function(e,t){var a=[];switch(e){case"all":y.ajaxResponse.query.map(function(e){y.data.batch.indexAddress[e.tempID]&&!/TCE-/.test(e.tempID)&&(a.push(e.tempID),y.data.testHistory[e.tempID]={responseType:"testing"})});break;default:y.ajaxResponse.query.map(function(e){(e.isLock||t.indexOf(e.tempID)>-1)&&!/TCE-/.test(e.tempID)&&(a.push(e.tempID),y.data.testHistory[e.tempID]={responseType:"testing"})})}return a},j.initGlobalTimeout=function(){var e=I.cache.getItem("AUTOMATIC_GLOBAL_TIMEOUT"),t={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey},a=function(){T.timeoutLimit=e.timeoutLimit,T.timeoutLimitType=e.timeoutLimitType};e?a():(c.global.ajax.Query_AutomatedGlobalTimeOut&&c.global.ajax.Query_AutomatedGlobalTimeOut.$cancelRequest(),c.global.ajax.Query_AutomatedGlobalTimeOut=m.Project.QueryTimeOut(t),c.global.ajax.Query_AutomatedGlobalTimeOut.$promise.then(function(t){e=t.timeoutSetting||{timeoutLimit:5e3,timeoutLimitType:0},a(),I.cache.setItem("AUTOMATIC_GLOBAL_TIMEOUT",e)}))},j.serverTest=function(e,t,a){var s=[];switch(e){case"all":y.testStatusObj.isTesting=!y.testStatusObj.isTesting,y.testStatusObj.isTesting&&(s=j.setAjaxQuery(e));break;case"single":f.singleTestItem=t,t.testing=y.testStatusObj.isTesting=y.data.testHistory[t.tempID].testing=!y.testStatusObj.isTesting,y.testStatusObj.isTesting&&(s=j.setAjaxQuery(e,[t.tempID]),y.data.testHistory[t.tempID].responseType="testing")}y.testStatusObj.isTesting?(T.ws&&("plugin"===y.data.testSeverType&&T.wsUrl.indexOf(T.wsLocalUrl)===-1||"nodejs"===y.data.testSeverType&&T.wsUrl.indexOf(T.wsServerUrl)===-1)&&(T.ws.close(),T.ws=null),f.testPointArr=s,f.waitTestPointArr=angular.copy(s),T.ws?T.ws.send(JSON.stringify({status:"ajax",env:y.service.home.envObject.object.total,query:s,testType:e,collectionArr:a})):j.bindWs(JSON.stringify({status:"ajax",env:y.service.home.envObject.object.total,query:s,testType:e,collectionArr:a}),!0)):(f.testPointArr.map(function(e){"testing"===y.data.testHistory[e].responseType?delete y.data.testHistory[e].responseType:""}),T.ws&&T.ws.send(JSON.stringify({status:"abort"})))},j.plugTest=function(e,t,a){var s=[];switch(e){case"all":y.testStatusObj.isTesting=!y.testStatusObj.isTesting;break;case"single":t.testing=y.testStatusObj.isTesting=y.data.testHistory[t.tempID].testing=!y.testStatusObj.isTesting}if(y.testStatusObj.isTesting){switch("ddt"===y.data.testMethod?y.testStatusObj.defaultCallback=function(e){for(var t in e){var a=e[t];a.responseType=a.reportStatus,y.component.ddtModal.testObj.report[t]=a}}:y.testStatusObj.defaultCallback=null,f.testPointArr=s,e){case"all":f.waitTestPointArr=angular.copy(s),y.ajaxResponse.query.map(function(e){y.data.batch.indexAddress[e.tempID]&&!/TCE-/.test(e.tempID)&&s.push(e.tempID)});break;case"single":y.ajaxResponse.query.map(function(e){!e.isLock&&t.tempID!==e.tempID||/TCE-/.test(e.tempID)||s.push(e.tempID)}),f.singleTestItem=t}s.map(function(e){y.data.testHistory[e]={responseType:"testing"}}),window.sessionStorage.setItem("plug-batchTest-info",JSON.stringify({env:y.service.home.envObject.object.total,query:s,timeoutLimit:T.timeoutLimit,timeoutLimitType:T.timeoutLimitType,collectionArr:a}))}else f.testPointArr.map(function(e){"testing"===y.data.testHistory[e].responseType?delete y.data.testHistory[e].responseType:""})},j.sendTestMsg=function(e,t,a){y.data.isOperate=!0;var s=y.data.plugObject.useStatus&&"nodejs"!==y.data.testSeverType;!eoSystemObj.plugTransferToLocal&&s?y.testStatusObj.isTesting?j.plugTest(e,t,a):(T.ws&&(T.ws.close(),T.ws=null),y.data.hideTips=window.localStorage.getItem("EO_PLUG_TIPS_HIDE"),"true"===y.data.hideTips?j.plugTest(e,t,a):c.Ams_Plug_TipsModal({},function(s){s&&("server"===s?(j.changeTestSeverType(),j.serverTest(e,t,a)):j.plugTest(e,t,a))})):j.serverTest(e,t,a)},j.test=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.ajaxResponse.caseInfo.hasDataCollection?(y.component.ddtModal.sendTestMsg=function(a){y.data.testMethod="ddt",j.sendTestMsg(e,t.item,a)},void(y.data.showDdtModal=!0)):(y.data.testMethod=e,void j.sendTestMsg(e,t.item))},j.pullApi=function(t){c.Ams_PullApiSettingModal({type:"ui"},function(t){if(t){var a=[],s=0;y.ajaxResponse.query.some(function(e){if(y.data.batch.indexAddress[e.tempID]&&(a.push(e.connID),s++),s===y.data.batch.query.length)return!0});var o={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,module:y.ajaxRequest.module,caseID:y.ajaxRequest.caseID,connID:JSON.stringify(a),synchronizeSetting:JSON.stringify(t)};m.AutomatedTestCaseSingle.SynchronizeData(o).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:e.$broadcast("$Init_LoadingCommonComponent"),c.InfoModal("同步成功","success"),j.resetBatchInfo();break;case"401400":c.InfoModal("同步成功","success"),j.resetBatchInfo();break;default:c.InfoModal("操作失败，"+r.FAILURE,"error")}})}})},j.warningTipOpr=function(e,t){if("edit"===e&&"api"!==t.typeName)return c.EnsureModal("无法编辑测试用例模板",!1,"无法在该用例内编辑引用的测试用例模板，您可以前往该用例模板的详情页进行编辑，或解除当前用例模板的引用关系后再编辑。",{btnType:2,btnMessage:"前往该用例模板页面",btnGroup:[{btnType:2,btnMessage:"解除引用关系",confirm:function(){j.cancelBindExtralCase(t)}}]},function(e){e&&j.goToCommonCase(t)}),!0},j.copy=function(t){if(!j.warningTipOpr("edit",t.item)){var a={title:"复制步骤",textArray:[{type:"input",title:"步骤名称",key:"apiName",value:"副本-"+t.item.apiName,required:!0}],btnObject:{"class":"eo_theme_btn_info",text:"确认"}},s=Object.assign({tempID:t.item.tempID},y.ajaxRequest);c.MixInputModal(a,function(t){t&&(s.apiName=t.apiName,m.AutomatedTestCaseSingle.Copy(s).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:e.$broadcast("$Init_LoadingCommonComponent"),c.InfoModal("复制成功","success");break;default:c.InfoModal("复制失败，"+r.FAILURE,"error")}}))})}},j.editStep=function(e,t){if(t=t||{item:{}},!j.warningTipOpr(e,t.item)){if(/D-/.test(t.item.tempID))return void j.oprSqlStep("edit",t);var a=e.split("_")||[],s=a.length>1?a[0]:e,o=1===t.item.stepType?"code":a[1]||"edit";u.go("home.ams.automatic.inside."+["scene","commonCase"][y.ajaxRequest.module]+"."+o,{groupID:y.ajaxRequest.groupID,caseID:y.ajaxRequest.caseID,operate:s,connID:t.item.connID,opr:s})}},j["delete"]=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!j.warningTipOpr("single"===t?"edit":"",a.item)){var s={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,module:y.ajaxRequest.module,caseID:y.ajaxRequest.caseID},o={title:"batch"===t?"批量删除步骤":"删除步骤",message:"请问是否删除该"+("batch"===t?"系列步骤？":"步骤？")};c.EnsureModal(o.title,!1,o.message,{},function(o){if(o){switch(t){case"batch":var n=[];y.ajaxResponse.query.map(function(e){y.data.batch.indexAddress[e.tempID]&&n.indexOf(e.commonCaseTempID||e.tempID)===-1&&n.push(e.commonCaseTempID||e.tempID)});break;default:n=[a.item.commonCaseTempID||a.item.tempID]}s.tempID=JSON.stringify(n),m.AutomatedTestCaseSingle.Delete(s).$promise.then(function(s){switch(s.statusCode){case l.COMMON.SUCCESS:switch(c.InfoModal("删除成功","success"),t){case"batch":e.$broadcast("$Init_LoadingCommonComponent"),j.resetBatchInfo();break;default:j.deleteBatchObj(a.$index)}}})}})}},j.decorateApiRequestType=function(e){var t=e.apiRequestType||0;return e.apiRequestTypeClass=s.METHOD_SHOW_QUERY[t]["class"],e.apiRequestTypeString=s.METHOD_SHOW_QUERY[t].key,e},j.setStepItem=function(e){e=j.decorateApiRequestType(e),y.data.batch.query.push(e.tempID),y.data.batch.indexAddress[e.tempID]=1,y.data.testHistory[e.tempID]={responseType:e.latestTestResult}},j.getQuery=function(){var e={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,module:y.ajaxRequest.module,caseID:y.ajaxRequest.caseID};return c.global.ajax.Query_AutomatedTestCaseSingle=m.AutomatedTestCaseSingle.Query(e),c.global.ajax.Query_AutomatedTestCaseSingle.$promise.then(function(e){f.testCheckboxObj=null,y.data.batch.query=[],y.data.batch.indexAddress={};var a=[];y.data.testHistory={},y.ajaxResponse.caseInfo={caseName:e.caseName||"未知用例",caseTag:e.caseTag,groupName:e.groupName,groupID:e.groupID,creator:e.creator,updateTime:e.updateTime,hasDataCollection:e.hasDataCollection,oldCaseType:e.oldCaseType},y.data.emptyStepNum=0;var s=0;(e.singleCaseList||[]).map(function(e,t){if(e.isCommonCase){var o=i("RandomColorFilter")(s);e.singleCaseList.length<=0&&(e.singleCaseList=[{isEmpty:1,tempID:"TCE-"+t,isLock:1,commonCaseTempID:e.tempID}],y.data.emptyStepNum++),e.singleCaseList.map(function(t,a){y.component.reportObject.colorBindObj[t.tempID]=o,t.ngStyleObj={"border-left-color":o},e.singleCaseList.length>1&&(t.ngStyleObj["background-color"]="transparent"),a===e.singleCaseList.length-1?t.isLast=!0:t.ngStyleObj["border-bottom"]="none",0===a?(t.isCommonCase=!0,t.caseName=e.caseName,t.caseConnID=e.connID):t.isSortDisable=!0,/^TD-/.test(t.tempID)&&(t.isDb=1),t.color=o,t.isInheritUiCase=!0,j.setStepItem(t)}),a=a.concat(e.singleCaseList),s++}else j.setStepItem(e),e.typeName="api",/D-/.test(e.tempID)&&(e.isDb=1),a.push(e)}),y.ajaxResponse.query=a,y.data.selectStepNum=y.ajaxResponse.query.length,y.data.batch.selectAll=!0,t.setBasicData({caseName:e.caseName,caseTag:e.caseTag,groupID:e.groupID})}),c.global.ajax.Query_AutomatedTestCaseSingle.$promise},j.oprSqlStep=function(e,t){p.Database.SimpleQuery({spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,module:1}).$promise.then(function(a){if((a.dbList||[]).length>0){var s=["home.ams.automatic.inside.scene.sql","home.ams.automatic.inside.commonCase.sql"],o={caseID:y.ajaxRequest.caseID,opr:e};t&&(o.connID=t.item.connID),I.cache.set(a.dbList,"Public_Resource_Db"),u.go(s[y.ajaxRequest.module],o)}else c.InfoModal("目前暂未创建数据库连接，请先前往公共资源管理中创建数据库连接","error")})},y.fun.init=function(){return j.getQuery()},j.formatRealTestReport=function(e,t,a,s){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},n={baseInfo:{caseName:o.collectionName||y.ajaxResponse.caseInfo.caseName},responseList:[]};y.component.reportObject.status=null,"history"===o.target?n.responseList=t:e.map(function(e){s.indexOf(e)===-1&&n.responseList.push(t[e])}),y.component.reportObject.object=Object.assign({},a,n)},j.testDownBasicOpr=function(){y.testStatusObj.isTesting=!1;for(var e in y.component.ddtModal.testObj.report)"testing"===y.component.ddtModal.testObj.report[e].responseType&&(y.component.ddtModal.testObj.report[e].responseType="");f.waitTestPointArr.length>0&&f.waitTestPointArr.map(function(e){y.data.testHistory[e].responseType=""})},j.bindWs=function(t){T.ws||(T.wsUrl="vspex_pc"===eoSystemObj.PLATFORM?"nodejs"===y.data.testSeverType?T.wsServerUrl:T.wsLocalUrl:T.wsServerUrl,T.ws=new WebSocket(T.wsUrl+"/nodeWebsocketServer/uiSceneCaseTest"),T.ws.onopen=function(){eoCookie.getCookieStrByUrl(n,function(e){if(T.ws.send(JSON.stringify({spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,module:y.ajaxRequest.module,timeoutLimit:T.timeoutLimit,timeoutLimitType:T.timeoutLimitType,caseType:0,cookie:e,status:"init",lang:window.eoLang})),t)switch("undefined"==typeof t?"undefined":_typeof(t)){case"string":T.ws.send(t);break;case"object":t.map(function(e,t){T.ws.send(e)})}})},T.ws.onmessage=function(t){var a=JSON.parse(t.data);switch(a.statusCode){case l.COMMON.SUCCESS:switch(y.data.testMethod){case"all":y.data.reportClickStatus="all",j.formatRealTestReport(f.testPointArr,y.data.testHistory,a,f.waitTestPointArr),y.component.reportObject.show=!0;break;case"single":f.singleTestItem.testing=!1,f.singleTestItem=null;break;case"ddt":y.component.ddtModal.testObj.basicData=a,f.singleTestItem&&(f.singleTestItem.testing=!1),f.singleTestItem=null}j.testDownBasicOpr();break;case"130000":case"140000":j.testDownBasicOpr();break;default:if(!y.testStatusObj.isTesting)return;switch(y.data.testMethod){case"ddt":for(var s in a){var o=a[s];o.responseType=o.reportStatus,y.component.ddtModal.testObj.report[s]=o}break;default:for(var n in a.report){var i=a.report[n];i.hasOwnProperty("responseType")||(i.responseType=i.status||i.reportStatus),/-/.test(n)||(n=parseInt(n)),y.data.testHistory[n]=i;var r=f.waitTestPointArr.indexOf(n);r>-1&&f.waitTestPointArr.splice(r,1)}}}e.$root&&e.$root.$$phase||e.$apply()},T.ws.onclose=function(e){T.ws=null},T.ws.onerror=function(e){T.ws=null})},j.checkIsCommonCase=function(e,t){return!(t.isCommonCase||!t.isInheritUiCase)},j.mouseLeave=function(){y.data.hoverBindCaseID=null},j.cancelBindExtralCase=function(t){c.EnsureModal("解除引用关系",!1,"解除该测试用例模板的引用关系后，您可以编辑该用例内的测试步骤，并且对原有用例模板的编辑将不再同步到当前用例中。",{btnMessage:"确定",btnType:2},function(a){a&&m.AutomatedTestCase.DereferenceCaseTemplate({spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,tempID:t.commonCaseTempID}).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:c.InfoModal("解除绑定成功","success"),e.$broadcast("$Init_LoadingCommonComponent")}})})},j.goToCommonCase=function(t){var a={caseID:t.caseID};window.open(u.href("home.ams.automatic.inside.commonCase.api",a)),c.MessageModal("刷新页面","编辑测试模板之后需要刷新页面才能生效",{button:{cancel:{content:"确认"}}},function(){e.$broadcast("$Init_LoadingCommonComponent")})},j.initTable=function(){return{setting:{tbodyExpression:'ng-mouseleave="$ctrl.mainObject.baseFun.tbodyMouseLeave()"',disabledSortModelKey:"isSortDisable",unsortableVar:"allIsTesting",trExpression:"style=\"border-color:{{$ctrl.otherObject.hoverBindCaseID===item.commonCaseTempID?item.color:''}};\" ng-mouseenter=\"$ctrl.mainObject.baseFun.focusTr('focus',item)\"",trNgClass:"ng-class=\"{'elem-active':$ctrl.activeObject.indexAddress[item.tempID]&&$ctrl.otherObject.nowIsBatchOperate,'cp':$ctrl.otherObject.nowIsBatchOperate,'focus_last_hasisa':item.isLast&&$ctrl.otherObject.hoverBindCaseID===item.commonCaseTempID}\""},CONST:{STEP_TYPE_STR_ARR:["API","COD","DB"],STEP_TYPE_CLASS_ARR:["default","purple","others"]},baseFun:{tbodyMouseLeave:j.mouseLeave,deleteExtralCase:j["delete"],cancelBindExtralCase:j.cancelBindExtralCase,focusTr:function(e,t){y.data.hoverBindCaseID=t.commonCaseTempID},sort:function(e){var t={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,module:y.ajaxRequest.module,orderList:{}},a=0;e.map(function(e,s){(e.isInheritUiCase&&e.isCommonCase||!e.isInheritUiCase)&&(t.orderList[e.commonCaseTempID||e.tempID]=a,a++)}),t.orderList=JSON.stringify(t.orderList),m.AutomatedTestCaseSingle.Sort(t).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:break;default:c.InfoModal("排序失败，"+r.FAILURE,"error")}})},bindApi:function(e){if(e.item.hasOwnProperty("commonCaseTempID"))return void c.EnsureModal("测试模板的API绑定关系只能在测试模板详情页面中设置",!1,"前往测试模板设置API绑定关系？",{btnMessage:"确定",btnType:2},function(t){t&&window.open(u.href("home.ams.automatic.inside.commonCase.api",{caseID:e.item.caseID}))});if(e.item.apiID&&e.item.apiProjectHashKey)window.open(u.href("home.ams.project.inside.api.detail",{apiID:e.item.apiID,projectHashKey:e.item.apiProjectHashKey}));else{var t={apiID:e.item.apiID,ajaxRequest:y.ajaxRequest},a=function(t){var a={spaceKey:y.ajaxRequest.spaceKey,projectHashKey:y.ajaxRequest.projectHashKey,caseID:y.ajaxRequest.caseID,module:y.ajaxRequest.module,connID:e.item.connID,apiID:t.apiID};m.AutomatedTestCaseSingle.BindApi(a).$promise.then(function(a){switch(a.statusCode){case l.COMMON.SUCCESS:e.item.apiID=t.apiID,e.item.apiProjectHashKey=t.apiProjectHashKey;break;default:c.InfoModal("绑定API失败!","error")}})};o.fun.bindApi(t,a)}},sortPartLastIndex:j.checkIsCommonCase,showTestHistory:j.showTestHistory,checkIsValidItem:function(e){if(y.testStatusObj.isTesting)return!1;if(e.isSelectAll)return!0;if(y.data.batch.isOperating){if(e.item.hasOwnProperty("commonCaseTempID"))for(var t=!y.data.batch.indexAddress[e.item.tempID],a=e.item.commonCaseTempID,s=!1,o=0;o<y.ajaxResponse.query.length;o++){var n=y.ajaxResponse.query[o];if(n.commonCaseTempID!==a&&s)break;n.commonCaseTempID===a&&n.tempID!==e.item.tempID&&(t?(y.data.batch.indexAddress[n.tempID]=1,y.data.batch.query.push(n.tempID)):(delete y.data.batch.indexAddress[n.tempID],y.data.batch.query.splice(y.data.batch.query.indexOf(n.tempID),1)),s=!0)}}else e.item.isLock&&y.data.batch.indexAddress[e.item.tempID]&&"relationalCheckbox"!==e.type&&(e.item.isLock=!1,j.lockItem([e.item],!1));return!0},goToCommonCase:j.goToCommonCase,clickCheckbox:function(e,t){if(y.data.batch.isOperating){y.data.selectedCommonCase=!1;for(var a=0;a<y.ajaxResponse.query.length;a++){var s=y.ajaxResponse.query[a];if(s.hasOwnProperty("commonCaseTempID")&&y.data.batch.indexAddress[s.tempID]){y.data.selectedCommonCase=!0;break}}}else switch(e){case"plus-single":y.data.selectStepNum++;break;case"plus-all":t&&(y.data.selectStepNum=y.data.selectStepNum+t.currentLenght-t.oldLength);break;case"minus-single":y.data.selectStepNum--;break;case"minus-all":t&&(y.data.selectStepNum=y.data.emptyStepNum);var o=!1;y.ajaxResponse.query.map(function(e){e.isLock&&(o=!0),e.isEmpty?(y.data.batch.indexAddress[e.tempID]=1,y.data.batch.query.push(e.tempID),e.isLock=!0):e.isLock=!1}),o&&j.lockItem(y.ajaxResponse.query,!1)}}},tdList:[{thKey:"顺序",type:"sort",itemHandleExpression:"ng-hide=\"!item.isCommonCase&&(item.tempID.indexOf('TC-')>-1||item.tempID.indexOf('TD-')>-1)\"",itemExpression:'ng-style="item.ngStyleObj" ng-if="!$ctrl.otherObject.nowIsBatchOperate&&$ctrl.authorityObject.edit"',isWantToPrepareWhenSort:!0},{thKey:'<span ng-show="!$ctrl.otherObject.nowIsBatchOperate">执行</span><tip-directive ng-show="!$ctrl.otherObject.nowIsBatchOperate" input="<p>仅会执行勾选的步骤</p>"></tip-directive>',"class":"w_90",type:"checkbox",activeKey:"tempID",checkboxClickAffectTotalItem:!0,itemExpression:"ng-style=\"$ctrl.otherObject.nowIsBatchOperate||!$ctrl.authorityObject.edit?item.ngStyleObj:{}\" ng-class=\"{'empty_checkbox_hasisa':(!$ctrl.otherObject.nowIsBatchOperate&&item.isEmpty)||($ctrl.otherObject.nowIsBatchOperate&&!item.isCommonCase&&(item.tempID.indexOf('TC-')>-1||item.tempID.indexOf('TD-')>-1))}\"",isWantedToExposeObject:!0},{thKey:'<span>锁定</span><tip-directive input="<p>勾选锁定的步骤一定会被按顺序执行，即使其他步骤出现异常。</p>"></tip-directive>',"class":"w_80",type:"relationalCheckbox",modelKey:"isLock",thItemExpression:'ng-show="!$ctrl.otherObject.nowIsBatchOperate"',itemExpression:'ng-class="{\'empty_checkbox_hasisa\':item.isEmpty}" ng-show="!$ctrl.otherObject.nowIsBatchOperate"',checkIsValidToRelate:function(e){if(j.lockItem([e],e.isLock),!y.data.batch.indexAddress[e.tempID]&&e.isLock)return!0},checkIsValidToRelateAll:function(e){if(j.lockItem(y.ajaxResponse.query,e),e&&!y.data.batch.selectAll)return!0}},{thKey:"绑定API",type:"html",thItemExpression:'ng-show="!$ctrl.otherObject.nowIsBatchOperate"',itemExpression:'ng-show="!$ctrl.otherObject.nowIsBatchOperate"',html:'<span ng-hide="item.stepType===1||item.isDb" class="eo-method-label cp"  ng-class="{\'eo-label-tips\':!item.apiID,\'eo-label-danger\':item.apiID&&!item.apiProjectHashKey,\'eo-label-default\':item.apiID&&item.apiProjectHashKey}" ng-click="$ctrl.mainObject.baseFun.bindApi({item:item})" eo-attr-tip-placeholder=\'{{item.apiID?(item.apiProjectHashKey?"automatic_bind_api_step":"automatic_bind_invalid_api_step"):"automatic_unbind_api_step"}}\'>{{item.apiID?(item.apiProjectHashKey?"已绑定":"已失效"):"未绑定"}}</span>',"class":"w_80"},{thKey:"步骤名称",type:"html",html:'<span ng-if="item.isEmpty">-</span><div class="text_omit" ng-hide="item.isEmpty"><span class="step_type_haisa eo-method-label eo-label-{{$ctrl.mainObject.CONST.STEP_TYPE_CLASS_ARR[item.isDb?2:item.stepType]||\'default\'}}" >{{$ctrl.mainObject.CONST.STEP_TYPE_STR_ARR[item.isDb?2:item.stepType]||\'API\'}}</span><span>{{item.apiName||item.caseName}}</span></div>'},{thKey:"URL",type:"html",html:'<span ng-if="item.isEmpty">-</span><div class="text_omit" ng-hide="item.isEmpty||!item.apiURI"><span class="eo-method-label eo-color-{{item.apiRequestTypeClass}}">{{item.apiRequestTypeString}}</span> {{item.apiURI}}</span></div>'},{thKey:"最近测试结果",type:"html",html:a.get("module/ams/ui/automatic/inside/content/scene/api/testResult.tmp.html"),"class":"w_150",itemExpression:'ng-if="$ctrl.otherObject.hasDataCollection===0"'},{type:"btn","class":"w_150",itemExpression:'ng-show="!$ctrl.otherObject.nowIsBatchOperate"',btnList:[{html:'{{$ctrl.otherObject.testHistoryObj[item.tempID].testing||item.testing?"中止":"测试"}}',fun:j.test,param:'"single",inputArg',"class":"batch-test-btn",isUnWantToStopPropagation:!0,itemExpression:'ng-if="!item.isEmpty" ng-disabled="$ctrl.otherObject.allIsTesting&&!$ctrl.otherObject.testHistoryObj[item.tempID].testing&&!item.testing" testing="{{($ctrl.otherObject.testHistoryObj[item.tempID].testing||item.testing)||false}}"'},{key:"编辑",authority:"edit",fun:j.editStep,param:'"edit",inputArg',itemExpression:'ng-show="!item.isEmpty" ng-disabled="$ctrl.otherObject.allIsTesting"'},{key:"更多",authority:"edit",type:"more",funArr:[{key:"复制",fun:j.copy},{key:"删除",fun:j["delete"],param:'"single",inputArg'}],itemExpression:'ng-show="!item.isEmpty"',btnItemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting"'}]}],extraTrHtml:i("JsConstructHtml_CommonFilter")('<div class="case_tr_hasisa f_row f_ac h_30" ng-style="{\'border-color\':item.color}"  ng-if="$ctrl.otherObject.hoverBindCaseID===item.commonCaseTempID&&item.isCommonCase" ><span class="eo-status-tips mr20 pl10 fs12">{@text_1}{{item.caseName}}</span><div ng-if="!$ctrl.otherObject.nowIsBatchOperate"><button type="button" ng-if="$ctrl.authorityObject.edit" class="eo-operate-btn" ng-click="$ctrl.mainObject.baseFun.deleteExtralCase(\'single_case\',{$index:$index,item:item})">{@text_2}</button><span class="c999 divide_line_hpiae pr10" ng-if="$ctrl.authorityObject.edit">|</span><button type="button" ng-if="$ctrl.authorityObject.edit" class="eo-operate-btn" ng-click="$ctrl.mainObject.baseFun.cancelBindExtralCase(item)">{@text_4}</button><span class="c999 divide_line_hpiae pr10" ng-if="$ctrl.authorityObject.edit">|</span><button type="button" class="eo-operate-btn lh_35 mr10" ng-click="$ctrl.mainObject.baseFun.goToCommonCase(item)">{@text_3}</button></div></div>',{text_1:"测试模板：",text_2:"删除该测试模板",text_4:"解除引用关系",text_3:"前往该测试模板编辑页面"})}},y.fun.showDdtReport=function(e){"ddt"===e.type?(y.data.isDdtReport=!0,y.data.showDdtModal=!0,y.component.ddtModal.reportObj=e):(1===e.caseType?y.component.reportObject.status="automated-pro":(delete y.component.reportObject.status,y.data.reportClickStatus="all"),y.component.reportObject.object=e,y.component.reportObject.object.baseInfo={caseName:e.caseName},y.component.reportObject.show=!0)},y.fun.watchUiAction=function(e){switch(e){case"closeDdtModal":y.data.isDdtReport=!1,y.data.showDdtModal=!1;break;case"changeTestMethod":j.changeTestSeverType();break;case"test":j.test("all");break;case"closeReportModal":y.data.modal=null;break;case"showReportModal":y.data.modal=!0}},y.$onInit=function(){I.cache.clear("caseGroup"),I.cache.clear("omitCaseList"),j.resetBatchInfo(),j.initGlobalTimeout(),y.component.blockListObject.api=j.initTable("api"),e.$emit("$TransferStation",{state:"$EnvInitReady"});var a=[];switch(g.COMPONENT_MODULE){case"commonCase":break;case"sceneCase":a=[{key:"添加测试模板","class":"btd_dashed",fun:{"default":j.importExtraCase}}]}y.component.menuObject={baseFun:{batchDefault:function(){f.testCheckboxObj=angular.copy(y.data.batch),y.data.batch.indexAddress={},y.data.batch.query=[]}},list:[{type:"only_drop_menu_btn",
authority:"edit",icon:"jiahao",name:"添加测试步骤","class":"commonCase"===g.COMPONENT_MODULE?"pull-left mr15 to_left_list_item_mcc":"pull-left to_left_list_item_mcc",btnClass:"eo_theme_btn_success",btnList:[{key:"从 API 文档新建 API 测试",fun:{"default":j.importFromApiManage,params:'"add"'}},{key:"新建空白 API 测试","class":"bbd_dashed",fun:{"default":j.editStep,params:'"add"'}},{key:"新建脚本 [Javascript]","class":"bbd_dashed",fun:{"default":j.editStep,params:'"add_code"'}},{key:"新建数据库测试",fun:{"default":j.oprSqlStep,params:'"add"'}}].concat(_toConsumableArray(a))}],batchList:[{type:"btn","class":"pull-left",disabledPoint:"disableBindApi",disableTip:"disableBindApiShowTips",btnList:[{name:"从关联的API文档更新数据",disabled:!0,tips:"选择测试模板时无法使用更新API信息的操作。",fun:{"default":j.pullApi,params:'"batch"'}}]},{type:"btn",btnList:[{name:"删除",fun:{"default":j["delete"],params:'"batch"'}}]}],setting:{batch:!0,batchInitFun:j.resetBatchInfo}},y.component.topMenuObject=t.getMUIConf(g.COMPONENT_MODULE.replace("Case","")+"|ui|step",y.ajaxRequest)},e.$on("$stateChangeStart",function(){T.ws&&T.ws.close()}),c.global.$watch.push(e.$watch("$ctrl.data.batch.isOperating",function(){y.envStatus=y.data.batch.isOperating?"hide":"show"}))}angular.module("eolinker.ams").component("homeAutomaticInsideSceneApi",{templateUrl:"module/ams/ui/automatic/inside/content/scene/api/index.html",controller:e,bindings:{envStatus:"="}}),e.$inject=["$scope","CaseUI_AmsAutomaticService","$templateCache","API_AMS_CONSTANT","Bind_Api_Service","COOKIE_CONFIG","$filter","RESPONSE_TEXT","$rootScope","GeneralFunResource","AutomatedTestResource","CODE","$state","Cache_CommonService","Authority_CommonService","Operate_CommonService"]}();
"use strict";!function(){function e(e,o){var c=this;c.component={codeStepObj:null};var a={cache:o};c.$onInit=function(){var o=e.current.name.indexOf("commonCase")>-1?1:0,n=["home.ams.automatic.inside.scene.api","home.ams.automatic.inside.commonCase.api"],t=a.cache.get("Public_Resource_Db");t&&a.cache.clear("Public_Resource_Db"),c.component.codeStepObj={setting:{backUrl:n[o],ajaxBasicRequest:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:e.params.projectHashKey,caseID:e.params.caseID,connID:e.params.connID,module:o,productModule:1}},dbCache:t}}}angular.module("eolinker.ams").component("homeAutomaticInsideSceneCode",{template:'<eo-Component-code-Step-Opr class="eo_theme_iblock" main-object="$ctrl.component.codeStepObj"></eo-Component-code-Step-Opr>',controller:e}),e.$inject=["$state","Cache_CommonService"]}();
"use strict";!function(){function e(e,a,t,s,n,i,r,o,p,c,u,m,l,y,d,h){var b=this;b.data={originApiID:"",operate:l.params.operate,menuType:"body",responseMenuType:"response",validToSwitchTestMethod:eoSystemObj.validToSwitchTestMethod,matchRuleMenuType:"response"},b.fun={},b.CONST={MATCH_HEADER_TYPE_ARR:[{key:"不校验",value:0},{key:"校验",value:1}],REQUEST_DATA_MENU_ARR:e.REQUEST_DATA_ARR,RESPONSE_DATA_MENU_ARR:[{key:'<span>返回头部</span><span class="ml5 iconfont icon-circle" ng-show="$ctrl.otherObj.responseHeader.length>1"></span>',value:"responseHeader"},{key:"<span>返回内容</span><span class=\"ml5 iconfont icon-circle\" ng-show=\"($ctrl.otherObj.resultParam.length>0&&$ctrl.otherObj.resultParamType=='2')||($ctrl.otherObj.resultParamType!='2'&&$ctrl.otherObj.resultParam[0].paramKey)\"></span>",value:"response"}],MATCH_RULE_DATA_MENU_ARR:[{key:"返回头部",value:"responseHeader"},{key:"返回结果",value:"response"}],MATCH_TYPE_ARR:[{key:"不校验",value:"3"},{key:"校验状态码",value:"5"},{key:"校验 JSON",value:"2"},{key:"校验 XML",value:"4"},{key:"全文匹配",value:"0"},{key:"正则表达式匹配",value:"1"}],TIMELIMIT_IS_GLOABL_ARR:[{key:"跟随项目全局设置时间",value:0},{key:"自定义",value:1}],TIMELIMIT_TYPE_ARR:[{key:"请求总时间",value:0},{key:"首字节返回时间",value:1}],JSON_MATCH_POSITION_TYPE_ARR:h.JSON_MATCH_POSITION_TYPE_ARR,jsonToParamObject:{headerItem:{headerName:"",headerValue:"",checkbox:!0},urlItem:{paramKey:"",paramInfo:"",checkbox:!0},responseHeaderItem:{headerName:"",headerValue:""},nestItem:{checkbox:!0,paramKey:"",paramType:"0",paramInfo:"",childList:[]},paramTypeObject:{"default":"0","int":"1","boolean":"2","float":"3,",array:"4",object:"5","null":"6",number:"7"}},requestMethodQuery:s.METHOD_SELECT_QUERY,requestProtocolQuery:[{key:"HTTP",value:"0"},{key:"HTTPS",value:"1"}],matchLoopQuery:[{key:"仅校验第一个元素",value:"0"},{key:"校验所有元素",value:"1"}],jsonTypeQuery:h.JSON_ROOT_TYPE_ARR,statusCodeQuery:[{key:"200",value:"200"},{key:"302",value:"302"},{key:"404",value:"404"},{key:"500",value:"500"},{key:"502",value:"502"},{key:"自定义",value:"0"}],matchRule:h.MATCH_RULE,RESPONSE_TYPE_ARR:n.RESPONSE_TYPE_ARR,scriptTypeQuery:[{key:"请求预处理",value:"0"},{key:"响应预处理",value:"1"}],bodyItemObject:{paramKey:"",paramInfo:"",checkbox:!0,childList:[]},REQUEST_BODY_TYPE_ARR:n.REQUEST_BODY_TYPE_ARR},b.ajaxResponse={caseData:{script:{}}},b.component={blockListObject:{},menuObject:{list:[]},keepGoingTabSelect:{list:[{type:"checkbox",resultType:"boolean",key:"keepGoing",name:"当前测试步骤校验为失败时，依然执行下一个测试步骤"}]},judgeSettingTabSelect:{list:[{type:"checkbox",key:"judgeSetting",name:"当某一校验规则判断为失败时，依然判断其余规则"}]},tipComponentObject:{type:"html",status:"warning",downloadPc:function(){o.Common_DownLoad_PCModal({type:"imgModal"})},html:'受浏览器功能限制，如果您使用插件进行测试，超时限制将按照“总时间”进行计算，您可以<button type="button" class="eo-operate-btn" ng-click="$ctrl.input.downloadPc()">下载PC客户端</button>享受完整体验'}};var j={manualChangeUrl:!1,expressionBuilderObject:null},f={cache:y,ams:d},T={},R={bodyParamObject:{},responseParamObject:{},responseMatchRule:{},responseCheckParamTypeListBlockItemObj:{}},x={COMPONENT_MODULE:l.current.name.indexOf("commonCase")>-1?"commonCase":"sceneCase",FORM_DATA_PARAM_TYPE_ARR:n.FORM_DATA_PARAM_TYPE_ARR,onlyYesAndNoTypeList:[{name:"否",value:"0"},{name:"是",value:"1"}],responseParamTypeList:h.JSON_PARAMTYPE_ARR},g={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:l.params.projectHashKey,caseID:l.params.caseID,connID:l.params.connID,groupID:l.params.groupID,module:"commonCase"===x.COMPONENT_MODULE?1:0,resultParam:[]},O={singleQuery:null};b.fun.changeJsonMatchPositionType=function(e,a,t){var s=t?a:b.ajaxResponse.jsonResultVerification.positionType;switch(s){case 0:b.component.blockListObject.responseCheck.setting.isLevel=!0,b.component.blockListObject.responseCheck.itemStructure={paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0"};break;case 1:b.component.blockListObject.responseCheck.setting.isLevel=!1,b.component.blockListObject.responseCheck.itemStructure={paramKey:"",paramInfo:"",matchRule:"0"}}e||(b.ajaxResponse.matchRule=[Object.assign({},b.component.blockListObject.responseCheck.itemStructure,{listDepth:0})])},b.fun.pullApi=function(){o.Ams_PullApiSettingModal({type:"ui"},function(e){if(e){var a={spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module,connID:b.ajaxResponse.connID,caseID:g.caseID,synchronizeSetting:JSON.stringify(e)};b.data.originApiID!=b.ajaxResponse.apiID&&(a.apiID=b.ajaxResponse.apiID),c.AutomatedTestCaseSingle.GetSynchronizeData(a).$promise.then(function(a){switch(a.statusCode){case m.COMMON.SUCCESS:var t={baseInfo:{apiName:["apiName"],apiURI:["apiURI"]},requestParam:{advancedSetting:["advancedSetting"]},responseParam:{header:["responseHeader"],body:["resultParam","resultParamJsonType","resultParamType"]}};for(var s in t)for(var n in t[s])0!==e[s][n]&&t[s][n].forEach(function(e){b.ajaxResponse[e]=a.singleCaseInfo[e]});b.ajaxResponse.caseData=a.singleCaseInfo.caseData,b.ajaxResponse.caseData.script.type=b.ajaxResponse.caseData.script.type||"0",r.$broadcast("$Maunal_AceEditorAms_Code_Ace_Editor_Js",b.ajaxResponse.caseData.script.before),T.initSingleCaseInfo({singleCaseInfo:b.ajaxResponse}),o.InfoModal("同步结果已显示在界面中","success");break;default:o.InfoModal("操作失败，"+u.FAILURE,"error")}})}})},b.fun.bindApi=function(){var e={apiID:b.ajaxResponse.apiID,ajaxRequest:g},a=function(e){b.ajaxResponse.apiID=e.apiID,b.ajaxResponse.apiPath=e.apiPath};t.fun.bindApi(e,a)},b.fun.unbindApi=function(){b.ajaxResponse.apiID="",b.ajaxResponse.apiPath=""},b.fun.formToOtherType=function(e){switch(e){case"body":try{b.ajaxResponse.caseData.restfulParam.map(function(e,a){e.paramType="0"})}catch(a){}b.fun.changeBodyType("0",angular.copy(b.ajaxResponse.caseData.restfulParam)),b.data.menuType="body";break;default:var t={paramType:"3",paramObject:p("paramLevelFilter")(b.ajaxResponse.caseData.params,{munalFilter:!0,munalReplaceKey:!0})};switch(e){case"json":t.paramType="2";break;case"xml":t.paramObject=[t.paramObject[0]]}b.fun.changeBodyType(t.paramType,t.paramObject)}},b.fun.changeBodyType=function(e,a){switch(R.bodyParamObject[b.ajaxResponse.caseData.requestType]=angular.copy(b.ajaxResponse.caseData.params),b.ajaxResponse.caseData.requestType=e,e){case"0":case"2":case"3":"0"===e?b.component.blockListObject.body.tdList[2].selectQuery=x.FORM_DATA_PARAM_TYPE_ARR:b.component.blockListObject.body.tdList[2].selectQuery=[{name:"[string]",value:"0"},{name:"[boolean]",value:"8"},{name:"[array]",value:"12"},{name:"[object]",value:"13"},{name:"[number]",value:"14"},{name:"[null]",value:"15"}],b.component.blockListObject.body.setting.munalHideOperateColumn="3"===e,b.ajaxResponse.caseData.params=angular.copy(a&&a.length>0?a:R.bodyParamObject[e]&&R.bodyParamObject[e].length>0?R.bodyParamObject[e]:[{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,listDepth:0}]),"3"===e?(b.ajaxResponse.caseData.params[0].paramType="13",b.component.blockListObject.body.setting.isStaticFirstIndex=!0):delete b.component.blockListObject.body.setting.isStaticFirstIndex;break;case"4":b.ajaxResponse.caseData.params=a||R.bodyParamObject[e]||{name:"",uuid:"",path:""}}},b.fun.changeResponseType=function(e,a){switch(R.responseParamObject[b.ajaxResponse.resultParamType]=angular.copy(b.ajaxResponse.resultParam),b.ajaxResponse.resultParamType=e,e){case"0":case"1":b.component.blockListObject.response.mainObject.setting.munalHideOperateColumn="1"===e,b.ajaxResponse.resultParam=angular.copy(a&&a.length>0?a:R.responseParamObject[e]&&R.responseParamObject[e].length>0?R.responseParamObject[e]:[{paramKey:"",paramInfo:"",paramType:"0",parent:".",listDepth:0}]),"1"===e&&(b.ajaxResponse.resultParam[0].paramType="5");break;default:b.ajaxResponse.resultParam=R.responseParamObject[e]||""}},b.fun.changeResponseMatchType=function(e,a){R.responseMatchRule[b.ajaxResponse.matchType]=angular.copy(b.ajaxResponse.matchRule),b.ajaxResponse.matchType=e;var t=(e||0).toString();switch("2"!==t?(R.positionType=b.ajaxResponse.jsonResultVerification.positionType,b.ajaxResponse.jsonResultVerification.positionType=0,b.fun.changeJsonMatchPositionType(!0,0,!0)):(R.hasOwnProperty("positionType")&&(b.ajaxResponse.jsonResultVerification.positionType=R.positionType),b.fun.changeJsonMatchPositionType(!0,R.positionType,!0)),t){case"2":case"4":b.component.blockListObject.responseCheck.setting.munalHideOperateColumn="4"==e,b.ajaxResponse.matchRule=angular.copy(a&&a.length>0?a:R.responseMatchRule[e]&&R.responseMatchRule[e].length?R.responseMatchRule[e]:[{paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0",listDepth:0}]),4===e&&(b.ajaxResponse.matchRule[0].paramType="5");break;default:b.ajaxResponse.matchRule=R.responseMatchRule[e]||""}},b.fun.changeVarType=function(e){var a=e.item;if("0"!=b.ajaxResponse.caseData.requestType)switch(a.paramType.toString()){case"12":case"13":if(!a.templateChildList)return;b.ajaxResponse.caseData.params=b.ajaxResponse.caseData.params.slice(0,e.$index+1).concat(a.templateChildList||[]).concat(b.ajaxResponse.caseData.params.slice(e.$index+1,b.ajaxResponse.caseData.params.length)),a.templateChildList=null;break;default:if(a.templateChildList)return;for(var t=e.$index+1;t<b.ajaxResponse.caseData.params.length&&!(b.ajaxResponse.caseData.params[t].listDepth<=b.ajaxResponse.caseData.params[e.$index].listDepth);)t++;a.templateChildList=b.ajaxResponse.caseData.params.splice(e.$index+1,t-e.$index-1)}},b.fun.btnClick=function(e,a){var t={point:a.$event.target.classList[0],splitQuery:e.split("-")};switch(t.point){case"btn-bind":T.bind(t.splitQuery[1],{item:a.item,parentItem:a.parentItem,mark:t.splitQuery[0],$last:a.$last});break;case"btn-construct":T.construct(t.splitQuery[1],{item:a.item,parentItem:a.parentItem,mark:t.splitQuery[0],$last:a.$last})}},T.construct=function(e,a){var t={mark:"automated",bindFun:T.expressionBuilderBind};a.item[e+"_expressionBuilderObject"]=a.item[e+"_expressionBuilderObject"]||{request:{},response:{}},t.request=a.item[e+"_expressionBuilderObject"].request,t.request.constant=a.item[e],t.response=a.item[e+"_expressionBuilderObject"].response,o.ExpressionBuilderModal(t,function(t){a.item[e]=t.response.result||a.item[e],a.item[e+"_expressionBuilderObject"]=t,a.callback&&a.callback({$index:a.$index,item:a.item})})},b.fun.changeParamType=function(e){switch(e.item.paramType.toString()){case"4":break;case"6":e.item.paramInfo="",e.item.isLoop="0";break;default:e.item.isLoop="0"}e.item.matchRule="0"},b.fun.changeUri=function(){j.manualChangeUrl=!0,b.ajaxResponse.caseData.urlParam=f.ams.urlParamObject.fun.reset(b.ajaxResponse.caseData.URL,b.ajaxResponse.caseData.urlParam).concat({paramKey:"",paramInfo:"",checkbox:!0})},b.fun.edit=function(e,a){switch(e){case"addChild":a.item.childList.push({paramKey:"",paramInfo:"",childList:[],matchRule:"0",parent:a.item.parent+a.item.paramKey+"."})}},b.fun.merge=function(){b.ajaxResponse.matchRule=angular.copy(b.ajaxResponse.resultParam),angular.forEach(b.ajaxResponse.matchRule,function(e,a){e.matchRule="0",e.checkExist="1",e.checkParamType="0",e.isLoop="0",delete e.paramInfo,delete e.templateChildList})},T.preBindParse=function(){var e=[];if(O.singleQuery.length<=0||O.singleQuery[0].tempID===parseInt(g.connID)&&"copy"!==b.data.operate)return void o.InfoModal("尚无前置API","error");for(var a in O.singleQuery){var t=O.singleQuery[a];switch((t.resultParamType||0).toString()){case"3":t.resultParam=[{paramKey:"binary",parent:"."}];break;case"2":t.resultParam=[{paramKey:"raw",parent:"."}];break;default:t.resultParam&&t.resultParam.length>0&&!t.resultParam[t.resultParam.length-1].paramKey&&t.resultParam.splice(t.resultParam.length-1,1)}e.push(t)}return e},T.modalExpressionBind=function(e){var a={query:T.preBindParse(),primaryKey:"tempID"},t="";a.query&&o.Product_AutomatedTest_BindModal(a,function(a){a&&(/^\./.test(a.bind)&&(a.bind=a.bind.slice(1,a.bind.length)),/^\["/.test(a.bind)||(t="."),e&&e("<"+a.mark+'["'+a.tempID+'"]'+(0==a.dataType?"":"[0]")+t+a.bind+">"))})},T.expressionBuilderBind=function(e){if(o.global.ajax.Query_AutomatedTestCaseSingle)T.modalExpressionBind(e);else{var a=T.getFrontExampleList();a["finally"](function(){T.modalExpressionBind(e)})}},T.modalBind=function(e,a){var t={query:T.preBindParse(),primaryKey:"tempID",isCanBindBinary:"binary"===e},s="";t.query&&o.Product_AutomatedTest_BindModal(t,function(e){e&&(/^\./.test(e.bind)&&(e.bind=e.bind.slice(1,e.bind.length)),/^\["/.test(e.bind)||(s="."),a&&a("<"+e.mark+'["'+e.tempID+'"]'+(0==e.dataType?"":"[0]")+s+e.bind+">."))})},T.bind=function(e,a){var t=function(t){a.item[e]=(a.item[e]||"")+t,a.callback&&a.callback({$index:a.$index,item:a.item})};if(o.global.ajax.Query_AutomatedTestCaseSingle)T.modalBind(e,t);else{var s=T.getFrontExampleList();s["finally"](function(){T.modalBind(e,t)})}},b.fun.confirm=function(){if(r.ConfirmForm.$invalid||b.data.isInvalidForm)return b.data.submitted=!0,void o.InfoModal("保存失败，请检查信息是否填写完整！","error");var e,t={stepType:0,spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module,connID:b.ajaxResponse.connID,caseID:g.caseID,caseData:angular.copy(b.ajaxResponse.caseData),resultParamType:b.ajaxResponse.resultParamType,jsonResultVerification:2==b.ajaxResponse.matchType?JSON.stringify(b.ajaxResponse.jsonResultVerification):null,statusCode:"",apiID:b.ajaxResponse.apiID,matchType:b.ajaxResponse.matchType,apiURI:b.ajaxResponse.caseData.URL,apiName:b.ajaxResponse.apiName,apiRequestType:b.ajaxResponse.caseData.apiRequestType,responseHeader:JSON.stringify(b.ajaxResponse.responseHeader,function(e,a){if(!/(\$\$hashKey)/.test(e))return a}),responseHeaderVerification:JSON.stringify(b.ajaxResponse.responseHeaderVerification,function(e,a){if(!/(\$\$hashKey)|(_expressionBuilderObject)/.test(e))return a}),projectTimeoutSetting:b.ajaxResponse.projectTimeoutSetting||0,timeoutLimit:b.ajaxResponse.timeoutLimit||5e3,delayTime:b.ajaxResponse.delayTime||0,timeoutLimitType:b.ajaxResponse.timeoutLimitType||0,judgeSetting:b.ajaxResponse.judgeSetting,advancedSetting:JSON.stringify(b.ajaxResponse.advancedSetting)};switch(t.resultParamType){case"0":t.resultParamJsonType=b.ajaxResponse.resultParamJsonType;case"1":t.resultParam=JSON.stringify(a.formatNestList(b.ajaxResponse.resultParam,{fun:function(e){if(!e.paramKey)return null}}),function(e,a){if(!/(\$\$hashKey)|(listDepth)/.test(e))return a});break;default:t.resultParam=b.ajaxResponse.resultParam}switch(t.caseData.auth.status){case"1":t.caseData.auth={status:"1",basicAuth:t.caseData.auth.basicAuth};break;case"2":t.caseData.auth={status:"2",jwtAuth:t.caseData.auth.jwtAuth};break;default:t.caseData.auth={status:"0"}}switch(t.matchType.toString()){case"2":case"4":t.matchRule=JSON.stringify(a.formatNestList(b.ajaxResponse.matchRule,{fun:function(e){if(!e.paramKey)return null}}),function(e,a){return e&&isNaN(e)&&!/(paramKey)|(paramType)|(paramInfo)|(childList)|(matchRule)|(checkExist)|(checkParamType)|(isLoop)/.test(e)?void 0:a});break;case"0":case"1":t.matchRule=b.ajaxResponse.matchRule}switch(t.caseData.requestType){case"1":delete t.caseData.params;break;case"0":case"2":case"3":t.caseData.params=a.formatNestList(t.caseData.params,{fun:function(e){if(!e.paramKey)return null}});case"4":delete t.caseData.raw}switch(t.caseData=JSON.stringify(t.caseData,function(e,a){if(!/(\$index)|(default)|(paramNote)|(\$\$hashKey)|(isFocus)|(headerID)|(paramID)|(paramName)|(paramLimit)|(paramValue)|(paramNotNull)|(paramNotNull)|(_expressionBuilderObject)|(templateChildList)|(paramValueList)|(listDepth)/.test(e))return a}),b.data.operate){case"add":case"copy":t.statusCode="0"!=b.ajaxResponse.statusCode?b.ajaxResponse.statusCode:b.ajaxResponse.code,e=c.AutomatedTestCaseSingle.Add(t).$promise,e.then(function(e){switch(e.statusCode){case m.COMMON.SUCCESS:o.InfoModal("新建API成功！","success"),b.fun.back();break;default:o.InfoModal("操作失败，"+u.FAILURE,"error")}});break;case"edit":t.statusCode=b.ajaxResponse.code,e=c.AutomatedTestCaseSingle.Edit(t).$promise,e.then(function(e){switch(e.statusCode){case m.COMMON.SUCCESS:case"401400":o.InfoModal("编辑API成功！","success"),b.fun.back();break;default:o.InfoModal("操作失败，"+u.FAILURE,"error")}})}return e},b.fun.bindBinaryFile=function(){var e=function(e){b.ajaxResponse.caseData.params={uuid:"",path:"",name:e}};if(o.global.ajax.Query_AutomatedTestCaseSingle)T.modalBind("binary",e);else{var a=T.getFrontExampleList();a["finally"](function(){T.modalBind("binary",e)})}},b.fun.back=function(){var e={groupID:g.groupID,caseID:g.caseID},a=["home.ams.automatic.inside.scene.api","home.ams.automatic.inside.commonCase.api"];l.go(a[g.module],e)},b.fun.importBinaryFile=function(){T.importFile(function(e){b.ajaxResponse.caseData.params=e.files[0]},{multi:!1})},T.ajaxTestFileQuery=function(){if("sass_web"!==eoSystemObj.PLATFORM){var e={spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module};c.TestFile.Query(e).$promise.then(function(e){b.data.fileObj={},b.ajaxResponse.fileList=e.fileList||[],b.ajaxResponse.fileList.map(function(e){b.data.fileObj[e.fileUUID]=e})})}},T.importFile=function(e,a){a=a||{multi:!0};var t={title:"添加测试文件",multi:a.multi,query:b.ajaxResponse.fileList,request:{params:{spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module},responseKey:"fileList",resource:c.TestFile.Query}};o.Vspex_SelectPublicFileModal(t,function(a){a&&e(a)})},T.getFrontExampleList=function(){return o.global.ajax.Query_AutomatedTestCaseSingle=c.AutomatedTestCaseSingle.GetFrontExampleList({spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module,caseID:g.caseID,connID:g.connID,orderNumber:b.ajaxResponse.orderNumber}),o.global.ajax.Query_AutomatedTestCaseSingle.$promise.then(function(e){O.singleQuery=e.singleCaseList||[]}),o.global.ajax.Query_AutomatedTestCaseSingle.$promise},b.fun.changeTimeoutSetting=function(){0===b.ajaxResponse.projectTimeoutSetting&&T.initGlobalTimeout()},T.initGlobalTimeout=function(){var e=f.cache.getItem("AUTOMATIC_GLOBAL_TIMEOUT"),a={spaceKey:g.spaceKey,projectHashKey:g.projectHashKey},t=function(){b.ajaxResponse.timeoutLimit=e.timeoutLimit,b.ajaxResponse.timeoutLimitType=e.timeoutLimitType};e?t():(o.global.ajax.Query_AutomatedGlobalTimeOut&&o.global.ajax.Query_AutomatedGlobalTimeOut.$cancelRequest(),o.global.ajax.Query_AutomatedGlobalTimeOut=c.Project.QueryTimeOut(a),o.global.ajax.Query_AutomatedGlobalTimeOut.$promise.then(function(a){e=a.timeoutSetting||{timeoutLimit:5e3,timeoutLimitType:0},t(),f.cache.setItem("AUTOMATIC_GLOBAL_TIMEOUT",e)}))},T.initSingleCaseInfo=function(e){b.ajaxResponse=e.singleCaseInfo||{caseData:{keepGoing:!0,auth:{status:"0"},headers:[],URL:"",params:[],httpHeader:"0",requestType:"0",apiRequestType:"0",script:{before:"",after:"",type:"0"}},statusCode:"200",matchType:3,jsonResultVerification:{resultType:"0",matchRule:"0"},responseHeader:[],judgeSetting:1,timeoutLimit:5e3,delayTime:0,projectTimeoutSetting:0,timeoutLimitType:0,advancedSetting:{requestRedirect:1}},b.data.originApiID=b.ajaxResponse.apiID,b.ajaxResponse.jsonResultVerification=b.ajaxResponse.jsonResultVerification||{resultType:"0",matchRule:"0"},b.ajaxResponse.jsonResultVerification.positionType=b.ajaxResponse.jsonResultVerification.positionType||0,b.ajaxResponse.advancedSetting=b.ajaxResponse.advancedSetting||{requestRedirect:1},b.fun.changeTimeoutSetting();try{b.ajaxResponse.responseHeaderVerification=b.ajaxResponse.responseHeaderVerification||{matchType:0,matchRule:[]},b.ajaxResponse.caseData.auth=b.ajaxResponse.caseData.auth||{status:"0"},b.ajaxResponse.caseData.auth.status=b.ajaxResponse.caseData.auth.status||0,b.ajaxResponse.caseData.apiRequestParamJsonType=b.ajaxResponse.caseData.apiRequestParamJsonType||"0",b.ajaxResponse.caseData.script=b.ajaxResponse.caseData.script||{before:"",after:"",type:"0"}}catch(t){b.ajaxResponse.caseData={auth:{status:"0"},headers:[],URL:"",params:[],httpHeader:"0",requestType:"0",apiRequestType:"0",script:{before:"",after:"",type:"0"}}}switch(r.$broadcast("$Maunal_AceEditorAms",b.ajaxResponse.caseData.raw),b.ajaxResponse.caseData.headers=a.initEditTableList(b.ajaxResponse.caseData.headers||[],{itemStructure:b.component.blockListObject.requestHeader.mainObject.itemStructure,lastFilterKey:"headerName"}),b.ajaxResponse.responseHeaderVerification.matchRule=a.initEditTableList(b.ajaxResponse.responseHeaderVerification.matchRule||[],{itemStructure:b.component.blockListObject.headerCheck.mainObject.itemStructure,lastFilterKey:"headerName"}),b.ajaxResponse.responseHeader=a.initEditTableList(b.ajaxResponse.responseHeader||[],{itemStructure:b.component.blockListObject.responseHeader.mainObject.itemStructure,lastFilterKey:"headerName"}),b.ajaxResponse.caseData.restfulParam=a.initEditTableList(b.ajaxResponse.caseData.restfulParam||[],{itemStructure:b.component.blockListObject.restful.mainObject.itemStructure,lastFilterKey:"paramKey"}),b.ajaxResponse.caseData.urlParam=a.initEditTableList(b.ajaxResponse.caseData.urlParam||[],{itemStructure:b.component.blockListObject.queryParam.mainObject.itemStructure,lastFilterKey:"paramKey"}),b.ajaxResponse.code=b.ajaxResponse.statusCode,b.ajaxResponse.statusCode="0",b.ajaxResponse.resultParamType=(b.ajaxResponse.resultParamType||0).toString(),b.ajaxResponse.resultParamJsonType=(b.ajaxResponse.resultParamJsonType||0).toString(),"2"!==b.ajaxResponse.resultParamType&&("1"==b.ajaxResponse.resultParamType&&b.ajaxResponse.resultParam.length>1&&b.ajaxResponse.resultParam.splice(b.ajaxResponse.resultParam.length-1,1),b.fun.changeResponseType(b.ajaxResponse.resultParamType,a.initEditTableList(b.ajaxResponse.resultParam||[],{isLoop:!0,munalHideOperateColumn:"1"==b.ajaxResponse.resultParamType,lastFilterKey:"paramKey",itemStructure:b.component.blockListObject.response.mainObject.itemStructure}))),b.ajaxResponse.caseData.requestType){case"3":b.ajaxResponse.caseData.params.length>1&&b.ajaxResponse.caseData.params.splice(b.ajaxResponse.caseData.params.length-1,1);case"0":case"2":b.fun.changeBodyType(b.ajaxResponse.caseData.requestType,a.initEditTableList(b.ajaxResponse.caseData.params||[],{isLoop:!0,munalHideOperateColumn:"3"===b.ajaxResponse.caseData.requestType,lastFilterKey:"paramKey",itemStructure:b.component.blockListObject.body.itemStructure,fun:"0"===b.ajaxResponse.caseData.requestType?function(e){e.paramType=eoSystemObj.CONST.AUTOMATIC_FORM_TYPE_ARR.indexOf(e.paramType)!==-1?e.paramType:"0"}:null}));break;case"4":b.fun.changeBodyType(b.ajaxResponse.caseData.requestType,b.ajaxResponse.caseData.params)}b.fun.changeJsonMatchPositionType(!0),/(2)|(4)/.test(b.ajaxResponse.matchType)&&("4"==b.ajaxResponse.matchType&&b.ajaxResponse.matchRule.length>1&&b.ajaxResponse.matchRule.splice(b.ajaxResponse.matchRule.length-1,1),b.fun.changeResponseMatchType(b.ajaxResponse.matchType,a.initEditTableList(b.ajaxResponse.matchRule||[],{isLoop:!0,munalHideOperateColumn:4==b.ajaxResponse.matchType,lastFilterKey:"paramKey",itemStructure:b.component.blockListObject.responseCheck.itemStructure})))},T.init=function(){var e={cache:{singleCaseInfo:f.cache.get("singleCaseInfo")}},t={spaceKey:g.spaceKey,projectHashKey:g.projectHashKey,module:g.module,caseID:g.caseID,connID:g.connID};switch(b.data.operate){case"add":b.ajaxResponse={caseData:{auth:{status:"0"},headers:a.initEditTableList([],{itemStructure:b.component.blockListObject.requestHeader.mainObject.itemStructure}),restfulParam:a.initEditTableList([],{itemStructure:b.component.blockListObject.restful.mainObject.itemStructure}),urlParam:a.initEditTableList([],{itemStructure:b.component.blockListObject.queryParam.mainObject.itemStructure}),URL:"",params:null,httpHeader:"0",requestType:"0",apiRequestType:"0",script:{before:"",after:"",type:"0"},apiRequestParamJsonType:"0",keepGoing:!0},resultParam:a.initEditTableList([],{itemStructure:b.component.blockListObject.response.mainObject.itemStructure}),statusCode:"200",matchType:3,responseHeaderVerification:{matchType:0,matchRule:a.initEditTableList([],{itemStructure:b.component.blockListObject.headerCheck.mainObject.itemStructure})},jsonResultVerification:{resultType:"0",matchRule:"0",positionType:0},responseHeader:a.initEditTableList([],{itemStructure:b.component.blockListObject.responseHeader.mainObject.itemStructure}),judgeSetting:1,timeoutLimit:5e3,delayTime:0,projectTimeoutSetting:0,timeoutLimitType:0,resultParamType:"0",resultParamJsonType:"0",advancedSetting:{requestRedirect:1}},T.initGlobalTimeout(),b.fun.changeBodyType("0");break;case"edit":case"copy":e.cache.singleCaseInfo?T.initSingleCaseInfo({singleCaseInfo:e.cache.singleCaseInfo}):(o.global.ajax.Info_AutomatedTestCaseSingle=c.AutomatedTestCaseSingle.Info(t),o.global.ajax.Info_AutomatedTestCaseSingle.$promise.then(function(e){T.initSingleCaseInfo(e||{})}))}o.global.$watch.push(r.$watch("$ctrl.ajaxResponse.caseData.urlParam",function(){if(j.manualChangeUrl)return void(j.manualChangeUrl=!1);try{b.ajaxResponse.caseData.URL=f.ams.urlParamObject.fun.$watch({params:b.ajaxResponse.caseData.urlParam||[],url:b.ajaxResponse.caseData.URL})}catch(e){}},!0))},T.reduceItemWhenIsOprDepth=function(e,a,t){return e.indexOf(t.paramType)===-1&&(t.paramType=a),!0},T.initResponseTable=function(){b.component.blockListObject.response={mainObject:{baseFun:{reduceItemWhenAddChildItem:function(e){T.reduceItemWhenIsOprDepth(["4","5"],"5",e)}},setting:{},itemStructure:{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,parent:"."},tdList:[{thKey:"字段名",type:"depthInput",modelKey:"paramKey",placeholder:"参数名","class":"w_300",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramInfo}\""},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType||'0'",selectQuery:x.responseParamTypeList,modelKey:"paramType","class":"w_150",selectQueryExpression:"$first&&$ctrl.otherObject.resultParamType==='1'?[{name:'object',value:'5'}]:$ctrl.mainObject.tdList[1].selectQuery"},{thKey:"说明",type:"input",modelKey:"paramInfo",placeholder:"字段说明"},{type:"btn","class":"w_200",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'ng-if="item.listDepth<4"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]}}},T.initBodyTable=function(){b.component.blockListObject.body={setting:{},baseFun:{reduceItemWhenAddChildItem:function(e){T.reduceItemWhenIsOprDepth(["2","12","13"],"13",e)},importFile:function(e){T.importFile(function(a){e.item.files=a.files,e.item.paramInfo=a.paramInfo})}},itemStructure:{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox",itemDisabledExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?'':'input-checkbox'"},{thKey:"参数名",type:"depthInput",modelKey:"paramKey",placeholder:"参数名","class":"w_300",btnList:[{key:"绑定",fun:T.bind,param:'"paramKey",inputArg'},{key:"构造器",fun:T.construct,param:'"paramKey",inputArg'}],itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramInfo}\""},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType",selectQuery:[],modelKey:"paramType","class":"w_150",fun:b.fun.changeVarType,selectQueryExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?[{name:'object',value:'13'}]:$ctrl.mainObject.tdList[2].selectQuery"},{thKey:"参数值",type:"autoCompleteAndFile",switchVar:"paramType",swicthFile:"1",modelKey:"paramInfo",placeholder:"参数值",munalDefineFileFun:!0,btnList:[{key:"绑定",fun:T.bind,param:'"paramInfo",inputArg'},{key:"构造器",fun:T.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_200",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:"ng-if=\"item.listDepth<4&&$ctrl.otherObject.bodyParamType!=='0'\""},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]}},T.initCommonParamTable=function(){var e={outputConfig:null};return e.outputConfig={mainObject:{itemStructure:{paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox"},{thKey:"参数名",type:"input",modelKey:"paramKey",placeholder:"参数名","class":"w_300",btnList:[{key:"绑定",fun:T.bind,param:'"paramKey",inputArg'},{key:"构造器",fun:T.construct,param:'"paramKey",inputArg'}],itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramInfo}\""},{thKey:"参数值",type:"input",modelKey:"paramInfo",placeholder:"参数值",btnList:[{key:"绑定",fun:T.bind,param:'"paramInfo",inputArg'},{key:"构造器",fun:T.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete"}]}]}},e.outputConfig},T.initHeaderTable=function(e){var a={};return a.outputConfig={mainObject:{itemStructure:{headerName:"",headerValue:""},tdList:[{thKey:"标签",type:"autoComplete",selectQuery:i.REQUEST_HEADER,modelKey:"headerName","class":"w_300",placeholder:"头部标签",itemExpression:"ng-class=\"{'eo-had-input-error':!item.headerName&&item.headerValue}\""},{thKey:"内容",type:"input",modelKey:"headerValue",placeholder:"头部内容"},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete"}]}]}},"requestHeader"===e&&(a.outputConfig.mainObject.itemStructure.checkbox=!0,a.outputConfig.mainObject.tdList[0].btnList=[{key:"绑定",fun:T.bind,param:'"headerName",inputArg'},{key:"构造器",fun:T.construct,param:'"headerName",inputArg'}],a.outputConfig.mainObject.tdList[1].btnList=[{key:"绑定",fun:T.bind,param:'"headerValue",inputArg'},{key:"构造器",fun:T.construct,param:'"headerValue",inputArg'}],a.outputConfig.mainObject.tdList.splice(0,0,{type:"checkbox",modelKey:"checkbox"})),a.outputConfig},T.initHeaderCheckTable=function(e){var a={};return a.outputConfig={mainObject:{itemStructure:{headerName:"",headerValue:"",checkExist:"1",matchRule:"0"},tdList:[{thKey:"标签",type:"autoComplete",selectQuery:i.REQUEST_HEADER,modelKey:"headerName","class":"w_300",placeholder:"头部标签",btnList:[{key:"绑定",fun:T.bind,param:'"headerName",inputArg'}],itemExpression:"ng-class=\"{'eo-had-input-error':!item.headerName&&item.headerValue}\""},{thKey:"存在性校验",type:"select",key:"name",value:"value",initialData:"item.checkExist||'1'",selectQuery:x.onlyYesAndNoTypeList,modelKey:"checkExist","class":"w_100"},{thKey:"内容校验",type:"select",key:"name",value:"value",initialData:"item.matchRule||'0'",selectQuery:[{name:"无",value:"0"},{name:"等于 [ = ]",value:"1"},{name:"不等于 [ != ]",value:"2"}],modelKey:"matchRule","class":"w_100"},{thKey:"预期结果",type:"input",modelKey:"headerValue",placeholder:"预期结果",btnList:[{key:"绑定",fun:T.bind,param:'"headerValue",inputArg'},{key:"构造器",fun:T.construct,param:'"headerValue",inputArg'}]},{type:"btn","class":"w_150",btnList:[{key:"删除",operateName:"delete"}]}]}},"requestHeader"===e&&(a.outputConfig.mainObject.itemStructure.checkbox=!0,a.outputConfig.mainObject.tdList[0].btnList=[{key:"绑定",fun:T.bind,param:'"headerName",inputArg'},{key:"构造器",fun:T.construct,param:'"headerName",inputArg'}],a.outputConfig.mainObject.tdList[1].btnList=[{key:"绑定",fun:T.bind,param:'"headerValue",inputArg'},{key:"构造器",fun:T.construct,param:'"headerValue",inputArg'}],a.outputConfig.mainObject.tdList.splice(0,0,{type:"checkbox",modelKey:"checkbox"})),a.outputConfig},T.initResponseCheckTable=function(){var e={baseFun:{reduceItemWhenAddChildItem:function(e){T.reduceItemWhenIsOprDepth(["4","5"],"5",e)}},setting:{isLevel:!0},itemStructure:{paramKey:"",paramInfo:"",checkExist:"1",matchRule:"0",checkParamType:"0",paramType:"0",isLoop:"0"},tdList:[{thKey:'{{$ctrl.otherObject.positionType===1?"Json Path":"参数名"}}',type:"depthInput",modelKey:"paramKey",placeholder:"{{$ctrl.otherObject.positionType===1?'Json Path':'参数名'}}","class":"w_300",btnList:[{key:"绑定",fun:T.bind,param:'"paramKey",inputArg'}],itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramInfo}\""},{thKey:"存在性校验",type:"select",key:"name",value:"value",initialData:"item.checkExist||'1'",selectQuery:x.onlyYesAndNoTypeList,modelKey:"checkExist","class":"w_100",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"类型校验",type:"select",key:"name",value:"value",initialData:"item.checkParamType||'0'",selectQuery:x.onlyYesAndNoTypeList,modelKey:"checkParamType","class":"w_100",
thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType||'0'",selectQuery:x.responseParamTypeList,modelKey:"paramType","class":"w_100",selectQueryExpression:"$first&&$ctrl.otherObject.matchType===4?[{name:'object',value:'5'}]:$ctrl.mainObject.tdList[3].selectQuery",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'}]};return e.tdList=e.tdList.concat([{thKey:"循环校验",type:"select",key:"name",value:"value",initialData:"item.isLoop||'0'",selectQuery:x.onlyYesAndNoTypeList,modelKey:"isLoop","class":"w_100",disabled:"item.paramType!='4'",thItemExpression:'ng-if="$ctrl.otherObject.positionType===0"',itemExpression:'ng-if="$ctrl.otherObject.positionType===0"'},{thKey:"内容校验",type:"select",key:"key",value:"value",initialData:"item.matchRule||'0'",selectQueryExpression:"$ctrl.otherObject.positionType===0?$ctrl.otherObject.matchRule[item.paramType]:$ctrl.otherObject.matchRule['jsonPath']",modelKey:"matchRule","class":"w_150"},{thKey:"预期结果",type:"input",modelKey:"paramInfo",placeholder:"预期结果",btnList:[{key:"绑定",fun:T.bind,param:'"paramInfo",inputArg'},{key:"构造器",fun:T.construct,param:'"paramInfo",inputArg'}]},{type:"btn","class":"w_150",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'ng-if="item.listDepth<4&&$ctrl.mainObject.setting.isLevel"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]),e},b.$onInit=function(){T.ajaxTestFileQuery(),b.component.blockListObject.requestHeader=T.initHeaderTable("requestHeader"),b.component.blockListObject.responseHeader=T.initHeaderTable("responseHeader"),b.component.blockListObject.queryParam=T.initCommonParamTable(),b.component.blockListObject.restful=T.initCommonParamTable(),b.component.blockListObject.headerCheck=T.initHeaderCheckTable(),b.component.blockListObject.responseCheck=T.initResponseCheckTable(),T.initResponseTable(),T.initBodyTable(),T.init(),b.component.menuObject.mainObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回列表",icon:"chexiao",fun:{"default":b.fun.back}},{name:"保存","class":"btn-save-mdcc eo_theme_btn_success block-btn",isWantToCheckInvalid:!0,fun:{disabled:1,"default":b.fun.confirm}}]}],setting:{"class":"common-menu-fixed-seperate inside_page_menu_mcc"}};var e=JSON.stringify(b.CONST.jsonToParamObject.nestItem);b.CONST.INSERT_BODY_TYPE_ARR=[{key:'<div set-to-params="paramKey" item=\''+e+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.requestType=='2'\""},{key:'<div import-method="3" set-to-params="paramKey" item=\''+e+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.requestType=='3'\""}];var a=JSON.stringify(b.CONST.jsonToParamObject.paramTypeObject);b.CONST.INSERT_RESPONSE_TYPE_ARR=[{key:'<div set-to-params="paramKey" param-type-object=\''+a+"' item='"+e+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.resultParamType === '0'\""},{key:'<div import-method="3" set-to-params="paramKey" param-type-object=\''+a+"' item='"+e+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.resultParamType === '1'\""}]}}angular.module("eolinker.ams").component("homeAutomaticInsideSceneEditSingle",{templateUrl:"module/ams/ui/automatic/inside/content/scene/editSingle/index.html",controller:e}),e.$inject=["API_DATA_CONST","ListBlock_CommonComponentService","Bind_Api_Service","API_AMS_CONSTANT","AMS_AUTOMATIC_UI_OBJ","HTTP_CONSTANT","$scope","$rootScope","$filter","AutomatedTestResource","RESPONSE_TEXT","CODE","$state","Cache_CommonService","Operate_CommonService","AUTOMATE_TEST_CONSTANT"]}();
"use strict";!function(){function e(e,a,t,n,o,c,s,i,r){var l=this;l.component={},l.data={canSave:!1},l.fun={},l.ajaxResponse={},l.service={authority:r};var u={COMPONENT_MODULE:s.current.name.indexOf("commonCase")>-1?"commonCase":"sceneCase",MODE:s.params.mode},p={},m={originTestData:{}},d={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:s.params.projectHashKey,module:"commonCase"===u.COMPONENT_MODULE?1:0,caseID:s.params.caseID};p.getUsefulName=function(e,a,t){var n="";switch(e){case"copy":n=t,a.some(function(o,c){if(o.collectionName===t)return n=p.getUsefulName(e,a,"副本-"+n),!0});break;case"add":var o=[];if(l.ajaxResponse.query.forEach(function(e,a){o.push(e.collectionName)}),!o.length)return"数据集-1";var c=1;o=o.sort(function(e,a){return e.length-a.length});for(var s=o.length-1;s>=0;s--){var i=o[s].match(/数据集-(\d+)/);if(i){c=Number(i[1])+1;break}}n="数据集-"+c}return n},p.deleteRaw=function(e){l.ajaxResponse.query.splice(e.$index,1)},p.addRow=function(){var e=p.getUsefulName("add");l.ajaxResponse.query.push({collectionName:e,data:{}})},p.copyRow=function(e){var a=p.getUsefulName("copy",l.ajaxResponse.query,"副本-"+e.item.collectionName);l.ajaxResponse.query.splice(e.$index+1,0,{collectionName:a,data:angular.copy(e.item.data)})},p.initBlockComponent=function(e){var a=!!e,t=[],n=0,o=0,c=null;a?(c=e,n=c.length,o=Object.keys(l.data.paramObj).length):(c=l.data.paramObj,n=Object.keys(c).length);for(var s=0;s<n;s++)t.push({thKey:"$dc{"+c[s]+"}",type:"input","class":"w_150",modelKey:"data['"+c[s]+"']",draggableCacheMark:c[s]+"_"+(s+o)}),a&&(l.data.paramObj[s+o]=c[s]);a?l.component.listBlockComponent.tdList=l.component.listBlockComponent.tdList.concat(t):l.component.listBlockComponent.tdList=[{thKey:"数据集名称",type:"html",html:'<input  autocomplete="off" type="text" class="eo-input eo_input_with_more_btn" ng-model="item.collectionName" ng-change="$ctrl.fun.watchFormLastChange({item:item,$index:$index})"><button class="more-btn iconfont icon-iosgengduo"  eo-drop-elem text-arr="$ctrl.mainObject.tdList[0].btnList" fn-click="$ctrl.mainObject.tdList[0].fun(target,{item:item,$index:$index})"></button>',"class":"cancel_overflow",fun:function(e,a){switch(e){case"copy":p.copyRow(a);break;case"delete":p.deleteRaw(a)}},btnList:[{key:"复制",value:"copy"},{key:"删除",value:"delete"}],draggableCacheMark:"name"}].concat(t)},p.setSaveStatus=function(){l.data.canSave=!0,m.watchQuery&&m.watchQuery(),m.watchParam&&m.watchParam()},p.addQueryWatcher=function(){m.watchQuery=e.$watch("$ctrl.ajaxResponse.query",function(){p.checkIsChange()&&p.setSaveStatus()},!0),m.watchParam=e.$watch("$ctrl.data.paramObj",function(){p.checkIsChange()&&p.setSaveStatus()},!0)},l.fun.init=function(){return n.global.ajax.Query_TestData=o.DataCollection.Query(d),n.global.ajax.Query_TestData.$promise.then(function(e){switch(e.statusCode){case c.COMMON.SUCCESS:a.setBasicData({caseName:e.caseName,caseTag:e.caseTag,groupID:e.groupID}),l.data.paramObj=e.paramList,l.ajaxResponse.query=e.dataCollectionList,p.initBlockComponent(),m.originTestData={paramObj:angular.copy(l.data.paramObj),dataCollectionList:angular.copy(e.dataCollectionList)},p.addQueryWatcher();break;default:l.ajaxResponse.query=[]}}),n.global.ajax.Query_TestData.$promise},p.parseTextToTestData=function(e){var a={paramObj:{},dataCollectionList:[]};if(!e)return a;var t=Papa.parse(e,{skipEmptyLines:!0,transform:function(e){return e.replace(/\r$/,"")}}).data;if(!t.length)return a;var n=t[0];return n.forEach(function(e,t){if(0!==t){var n=e.match(/\$dc{(.*)}/),o=e;n&&(o=n[1]),o&&(a.paramObj[t-1]=o)}}),1===t.length?a:(t.shift(),t.forEach(function(e){if(e[0]){var t={collectionName:e[0],data:{}};for(var n in a.paramObj)t.data[a.paramObj[n]]=e[Number(n)+1];a.dataCollectionList.push(t)}}),a)},p.parseTestDataToText=function(e){var a="";if(!(e.paramObj&&Object.keys(e.paramObj).length||l.ajaxResponse.query&&l.ajaxResponse.query.length))return a;var t={fields:["数据集名称"],data:[]};return angular.forEach(e.paramObj,function(e,a){e&&t.fields.push("$dc{"+e+"}")}),e.dataCollectionList.forEach(function(a,n){var o=[a.collectionName];angular.forEach(e.paramObj,function(e,t){o.push(a.data[e])}),t.data.push(o)}),a=Papa.unparse(t)},p.save=function(e){var a={};a="string"==typeof e?p.parseTextToTestData(e):{paramObj:l.data.paramObj,dataCollectionList:l.ajaxResponse.query};var t=Object.assign({paramList:JSON.stringify(a.paramObj),dataCollectionList:JSON.stringify(a.dataCollectionList)},d);o.DataCollection.Save(t).$promise.then(function(e){switch(e.statusCode){case c.COMMON.SUCCESS:n.InfoModal("保存成功","success"),m.originTestData=angular.copy(a),l.data.canSave=!1,p.addQueryWatcher();break;default:n.InfoModal("保存失败","error")}})},p["import"]=function(){var e={title:"导入 CSV",fileType:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",inputObject:{type:"file"},linkObject:{name:"下载模板文件",download:"导入数据集模版.csv",href:"assets/office/testData_Import.csv"},secondTitle:"选择文件（*.csv）"};n.Common_UploadFile(e,function(e){if(e){var a=new FileReader;a.readAsText(e.file),a.onloadend=function(e){p.textToList(this.result)}}})},p.addColumn=function(){var e={title:"添加变量",desc:"",btnType:2,content:'<p><span>变量名称</span></p><p class="c999 mb10 mt5">多个变量之间使用换行分割，只需要填写$dc{key}内的key即可。</p>',btnMessage:"确定"};n.CommonSingleTextareaModal(e,function(e){if(e){var a=e.desc,t=Papa.parse(a,{skipEmptyLines:!0,transform:function(e){return e.replace(/\r$/,"")}}).data,n=[];t.forEach(function(e){e[0]&&n.push(e[0])}),p.initBlockComponent(n)}})},p.textToList=function(e){var a=p.parseTextToTestData(e);l.data.paramObj=a.paramObj,p.initBlockComponent(),l.ajaxResponse.query=a.dataCollectionList},p.edit=function(){var e=p.parseTestDataToText({dataCollectionList:l.ajaxResponse.query,paramObj:l.data.paramObj}),a={title:"文本模式",desc:e,size:"large",placeholder:"多个变量之间使用逗号分割，只需要填写$dc{}中的内容即可，例如:\n数据集名称,$dc{param_1},$dc{param_2},$dc{param_3}\n数据集1,a,b,c\n数据集2,d,e,f\n数据集3,g,h,i",btnType:2,btnMessage:"确定"};n.CommonSingleTextareaModal(a,function(e){e&&p.textToList(e.desc)})},p.checkIsChange=function(){var e=function(e){return JSON.stringify(e,function(e,a){if(!/isItemClick/.test(e))return a})};return e(m.originTestData)!==e({paramObj:l.data.paramObj,dataCollectionList:l.ajaxResponse.query})},l.$onInit=function(){l.component.topMenuObject=a.getMUIConf(u.COMPONENT_MODULE.replace("Case","")+"|"+u.MODE+"|data",d),l.component.topMenuObject.list[1].tabList[0].checkIsValid=function(){return!p.checkIsChange()||(l.component.topMenuObject.list[1].tabList[0].fun(),!1)},l.component.menuObject={list:[{type:"more-btn",authority:"edit",icon:"jiahao","class":"pull-left",btnClass:"eo_theme_btn_success",name:"添加数据集（行）",btnList:[{key:"手动添加",fun:{"default":p.addRow}},{key:"导入 CSV",fun:{"default":p["import"]}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"添加变量（列）","class":"block-btn eo_theme_btn_success",icon:"jiahao",fun:{"default":p.addColumn}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"批量编辑",icon:"wenben",fun:{"default":p.edit}}]},{type:"divide",authority:"canSave","class":"pull-left"},{type:"btn",authority:"canSave","class":"pull-left",btnList:[{name:"保存","class":"block-btn eo_theme_btn_success",fun:{"default":p.save}}]}],baseFun:{},setting:{title:"测试数据集","class":"content_box_menu_mcc"}},window.onbeforeunload=eoSystemObj.windowOnBeforeUnload,l.component.listBlockComponent={tdList:null,baseFun:{watchFormLastChange:function(){p.setSaveStatus()}},setting:{blankTips:"暂无测试数据",munalAddRow:!0,draggable:!0,isChangeColumn:!0,dragCacheVar:"AUTOMATIC_TEST_DATA_LIST_DRAG_VAR",dragCacheObj:{name:"400px"}}}},e.$on("$stateChangeStart",function(e,a,t){window.onbeforeunload=null,!m.cancelSave&&p.checkIsChange()&&(e.preventDefault(),n.EnsureModal("您有未保存的内容",!1,"当前页面中存在未保存的改动，离开页面将导致改动失效，请确认是否离开当前页面？",{btnMessage:"确定",btnType:1},function(e){e&&(m.cancelSave=!0,s.go(a,t))}))})}angular.module("eolinker.ams").component("homeAutomaticInsideSceneTestData",{templateUrl:"module/ams/ui/automatic/inside/content/scene/testData/index.html",controller:e}),e.$inject=["$scope","CaseUI_AmsAutomaticService","RESPONSE_TEXT","$rootScope","AutomatedTestResource","CODE","$state","Cache_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,a,o,c){var t=this;t.component={sqlStepObj:null};var n={cache:c};t.$onInit=function(){var c=e.current.name.indexOf("commonCase")>-1?1:0,s=["home.ams.automatic.inside.scene.api","home.ams.automatic.inside.commonCase.api"],m=n.cache.get("Public_Resource_Db");m&&n.cache.clear("Public_Resource_Db"),t.component.sqlStepObj={setting:{backUrl:s[c],ajaxBasicRequest:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:e.params.projectHashKey,caseID:e.params.caseID,connID:e.params.connID,module:c,productModule:1}},dbCache:m,Resource:a.DatabaseOperation,DbResource:o.Database}}}angular.module("eolinker.ams").component("homeAutomaticInsideSceneSql",{template:'<eo-Component-Sql-Step-Opr class="eo_theme_iblock" main-object="$ctrl.component.sqlStepObj"></eo-Component-Sql-Step-Opr>',controller:e}),e.$inject=["$state","AutomatedTestResource","GeneralFunResource","Cache_CommonService"]}();
"use strict";!function(){function e(e,t,a,s,o,n,i,r,c,u,l){var m=this;m.data={pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},plugObject:{needVersion:!0},statusObject:{testing:!1},batch:{}},m.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey,groupID:n.params.groupID,taskID:[],keyword:window.sessionStorage.getItem("COMMON_SEARCH_TIP")},m.ajaxResponse={query:null},m.fun={},m.service={group:r,home:u,authority:l},m.component={menuObject:{},listDefaultCommonObject:null};var p={},d={isQuerying:!0};p.resetBatchInfo=function(){m.data.batch.isOperating=!1,m.data.batch.selectAll=!1,m.data.batch.query=[],m.data.batch.indexAddress={}},p.scrollLoading=function(){var e={hasItem:m.ajaxResponse.query&&0!==m.ajaxResponse.query.length,hasNextPage:m.data.pagination.page<m.data.pagination.msgCount/m.data.pagination.pageSize,isQuerying:d.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&(d.isQuerying=!0,p.getQuery("preload",m.data.pagination.page+1))},p.filterQuery=function(){e.$broadcast("$Init_LoadingCommonComponent"),p.resetBatchInfo()},p.singleTest=function(e){e=e||{};var t={spaceKey:m.ajaxRequest.spaceKey,projectHashKey:m.ajaxRequest.projectHashKey,taskID:e.item.taskID};i.AutomatedTestTask.Test(t,function(t){switch(t.statusCode){case c.COMMON.SUCCESS:m.ajaxResponse.query[e.$index].testTime=o("currentTimeFilter")(),s.InfoModal("执行请求已提交，稍后请在历史记录中查看!","success")}})},p["delete"]=function(e){var o=[];e?o.push(e.item.taskID):o=m.data.batch.query;var n={spaceKey:m.ajaxRequest.spaceKey,projectHashKey:m.ajaxRequest.projectHashKey,taskID:JSON.stringify(o)};s.EnsureModal("删除任务",!1,t.DELETE,{},function(t){t&&i.AutomatedTestTask.Delete(n).$promise.then(function(t){switch(t.statusCode){case c.COMMON.SUCCESS:e?(m.ajaxResponse.query.splice(e.$index,1),m.data.pagination.msgCount>m.data.pagination.page*m.data.pagination.pageSize&&p.getQuery("preload",m.data.pagination.page*m.data.pagination.pageSize,1),m.data.pagination.msgCount--):p.filterQuery(),s.InfoModal("任务删除成功","success");break;default:s.InfoModal("删除失败，"+a.FAILURE,"error")}})})},p.edit=function(e,t){var a={status:e,groupID:n.params.groupID},o=m.service.group.get();if(!o||0==o)return void s.InfoModal("请先建立分组！","error");switch(e){case"edit":a.taskID=t.item.taskID}n.go("home.ams.automatic.inside.timer.edit",a)},p.getQuery=function(e,t,a){var o={spaceKey:m.ajaxRequest.spaceKey,projectHashKey:m.ajaxRequest.projectHashKey,groupID:m.ajaxRequest.groupID>0?m.ajaxRequest.groupID:null,pageSize:a||m.data.pagination.pageSize},n=[];switch(e){case"reset":o.page=1;break;default:n=m.ajaxResponse.query,o.page=t}return m.ajaxRequest.keyword?(o.keyword=m.ajaxRequest.keyword,s.global.ajax.Query_AutomatedTestTask=i.AutomatedTestTask.Search(o)):s.global.ajax.Query_AutomatedTestTask=i.AutomatedTestTask.Query(o),s.global.ajax.Query_AutomatedTestTask.$promise.then(function(t){"reset"===e&&(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0),d.isQuerying=!1,m.ajaxResponse.query=n.concat(t.taskList||[]),m.data.pagination.msgCount=t.itemNum||0,a||(m.data.pagination.page=o.page)}),s.global.ajax.Query_AutomatedTestTask.$promise},p.batchBtnClickFun=function(){if(m.data.pagination.page!==Math.ceil(m.data.pagination.msgCount/m.data.pagination.pageSize)){var e={spaceKey:m.ajaxRequest.spaceKey,projectHashKey:m.ajaxRequest.projectHashKey,groupID:m.ajaxRequest.groupID>0?m.ajaxRequest.groupID:null},t=null;m.ajaxRequest.keyword?(e.keyword=m.ajaxRequest.keyword,t=i.AutomatedTestTask.SearchIDQuery(e).$promise):t=i.AutomatedTestTask.IDQuery(e).$promise,t.then(function(e){m.data.allQueryID=e.taskIDList||[]})}},m.fun.init=function(){return p.getQuery("reset")},p.click=function(e){p.edit("edit",e)},p.setStatus=function(e){var t=null,o={spaceKey:m.ajaxRequest.spaceKey,projectHashKey:m.ajaxRequest.projectHashKey,taskID:e.item.taskID,taskStatus:0==m.ajaxResponse.query[e.$index].taskStatus?1:0};t=i.AutomatedTestTask.ChangeStatus(o).$promise,t.then(function(t){switch(t.statusCode){case c.COMMON.SUCCESS:m.ajaxResponse.query[e.$index].taskStatus=o.taskStatus,s.InfoModal(e.item.taskStatus?"关闭任务成功！":"开启任务成功","success");break;default:s.InfoModal("操作失败，"+a.FAILURE,"error")}})},m.$onInit=function(){p.resetBatchInfo(),m.component.menuObject.mainObject={list:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"新建定时任务",icon:"jiahao","class":"eo_theme_btn_success block-btn",fun:{"default":p.edit,params:'"add"'}}]},{type:"search","class":"pull-right",keyword:m.ajaxRequest.keyword,fun:m.service.home.searchObject.fun.search}],batchList:[{type:"btn","class":"pull-left",btnList:[{name:"删除",icon:"shanchu",fun:{"default":p["delete"],params:""}}]}],baseFun:{batchDefault:p.batchBtnClickFun},setting:{batch:!0,title:"定时任务",batchInitFun:p.resetBatchInfo}},m.component.listDefaultCommonObject={mainObject:{item:{primaryKey:"taskID","default":[{key:"任务名称",html:"{{item.taskName}}",draggableCacheMark:"name"},{key:"周期",html:'<span style="margin-right:5px;">{{$ctrl.mainObject.TASK_CYCLE_ARR[item.taskCycle]}}</span><span ng-repeat="childItem in item.taskDate">{{$ctrl.mainObject.TASK_DATE_ARR[childItem]}}{{$last?"":"、"}}</span>&nbsp;<span ng-repeat="childItem in item.taskTime" ng-class="{\'margin-left\':$first}">{{childItem}}:00{{$last?"":"、"}}</span>',draggableCacheMark:"cycle"},{key:"状态",html:'{{item.taskStatus?"开启":"暂停"}}',draggableCacheMark:"status"},{key:"上次测试时间",html:'{{item.testTime||""}}',draggableCacheMark:"testTime"}],operate:{funArr:[{key:"编辑",authority:"operate",fun:p.edit,params:'"edit",arg'},{key:"历史",authority:"download",fun:function(){n.go("home.ams.automatic.inside.report",{reportType:"task"})}},{key:"更多",type:"more",authority:"operate",funArr:[{key:"执行",fun:p.singleTest},{type:"html",html:"{{['开启','暂停'][item.taskStatus]}}",fun:p.setStatus},{key:"删除",fun:p["delete"]}]}],"class":"w_150"}},TESK_STATUS_ARR:["开启","暂停"],TASK_CYCLE_ARR:["[每日]","[每周]"],TASK_DATE_ARR:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],setting:{page:!0,scroll:!0,scrollRemainRatio:7,draggable:!0,dragCacheVar:"AMS_AUTOMATIC_TIMER_TASK_LIST_DRAG_VAR",dragCacheObj:{name:"300px",cycle:"250px",status:"100px",testTime:"150px"},colspan:4,warning:"尚未新建任何定时任务",isFixedHeight:!0,batch:!0},baseFun:{scrollLoading:p.scrollLoading,click:p.click}}}}}angular.module("eolinker.ams").component("homeAutomaticInsideTimerDefault",{template:'<div class="home-automatic-inside-default"><menu-common-component authority-object="$ctrl.service.authority.permission.automatic.timedTask"   main-object="$ctrl.component.menuObject.mainObject" other-object="{batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length,statusObject:$ctrl.component.batchTestObject}"></menu-common-component><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.automatic.timedTask.edit,download:$ctrl.service.authority.permission.automatic.timedTask.download}" main-object="$ctrl.component.listDefaultCommonObject.mainObject"list="$ctrl.ajaxResponse.query"  show-object="{}" other-object="{batch:$ctrl.data.batch,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div>',controller:e}),e.$inject=["$scope","ENSURE_WARNIMG","RESPONSE_TEXT","$rootScope","$filter","$state","AutomatedTestResource","GroupService","CODE","Operate_CommonService","Authority_CommonService"]}();
"use strict";!function(){function e(e,a,t,s,n,o,i,u,r){var c=this;c.data={status:u.params.status,userPhoneNumber:[{value:""}],userEmail:[{value:""}],current:{dateIllegal:!1,timeIllegal:!1,caseIllegal:!1,mailIllegal:!1,dateRadio:0,timeRadio:0},submitted:!1,cycleList:[{key:"周",value:1},{key:"日",value:0}],noticeList:[{key:"关闭",value:0},{key:"仅测试成功通知",value:1},{key:"仅测试失败通知",value:2},{key:"全部通知",value:3}],loopList:[{key:"永久有效",value:0},{key:"仅执行一次",value:1}],executeWayList:[{key:"并行测试",value:0},{key:"串行测试",value:1}],group:{parent:[],child:[],grandson:[]},dateList:[{key:"星期日"},{key:"星期一"},{key:"星期二"},{key:"星期三"},{key:"星期四"},{key:"星期五"},{key:"星期六"}],timeList:[{key:"00:00"},{key:"01:00"},{key:"02:00"},{key:"03:00"},{key:"04:00"},{key:"05:00"},{key:"06:00"},{key:"07:00"},{key:"08:00"},{key:"09:00"},{key:"10:00"},{key:"11:00"},{key:"12:00"},{key:"13:00"},{key:"14:00"},{key:"15:00"},{key:"16:00"},{key:"17:00"},{key:"18:00"},{key:"19:00"},{key:"20:00"},{key:"21:00"},{key:"22:00"},{key:"23:00"}]},c.fun={},c.constant={headerArray:e.REQUEST_HEADER},c.ajaxRequest={taskID:u.params.taskID,groupID:u.params.groupID,spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:u.params.projectHashKey,caseID:[]},c.ajaxResponse={envList:null,taskInfo:{taskName:"",caseList:[],taskCycle:1,taskLoop:0,noticeSetting:0,noticeType:1,executeWay:0,groupID:parseInt(u.params.groupID||"-1"),envID:0}},c.component={blockListObject:{},menuObject:{list:[]},selectMultistageCommonComponentObject:{"new":{},original:{}},envSelectObj:{setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5" ng-if="item.isGlobal">全局</span>'}}},c.service={authority:r};var l={},p={taskEnv:{frontURI:"",headerList:[{headerName:"",headerValue:""}],paramList:[{paramKey:"",paramValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}}};l.getEnv=function(){o.Env.Query({spaceKey:c.ajaxRequest.spaceKey,projectHashKey:c.ajaxRequest.projectHashKey,module:1}).$promise.then(function(e){c.ajaxResponse.envList=[{envName:"无",frontURI:"",envID:0,headerList:[{headerName:"",headerValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],paramList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}}].concat(e.envList||[]).concat([{envName:"自定义",frontURI:"",envID:-1,headerList:[{headerName:"",headerValue:""}],additionalParamList:[{paramKey:"",paramValue:""}],paramList:[{paramKey:"",paramValue:""}],envAuth:{status:"0"}}])})},c.fun.deleteNotice=function(e,a){switch(e){case"phone":c.data.userPhoneNumber.splice(a.$index,1);break;case"email":c.data.userEmail.splice(a.$index,1)}},c.fun.changeEnv=function(){c.ajaxResponse.taskInfo.envID==-1&&(c.ajaxResponse.taskInfo.taskEnv=c.ajaxResponse.taskInfo.taskEnv||Object.assign({},p.taskEnv))},l.authForm=function(e){return 0===e.length},c.fun.change=function(e){e.item=e.item||c.ajaxResponse.taskInfo.taskEnv;var a={reset:{},length:{header:e.item.headerList.length?e.item.headerList.length-1:0}};if(e.$last)switch(e["switch"]){case 0:e.item.headerList.push({headerName:"",headerValue:""});break;case 1:e.item.paramList.push({paramKey:"",paramValue:""});break;case 2:e.item.additionalParamList.push({paramKey:"",paramValue:""});break;default:(!e.item.headerList[a.length.header]||e.item.headerList[a.length.header].headerName||e.item.headerList[a.length.header].headerValue)&&(e.item.headerList.push({headerName:"",headerValue:""}),e.item.paramList.push({paramKey:"",paramValue:""}),e.item.additionalParamList.push({paramKey:"",paramValue:""}))}},c.fun.deleteCaseList=function(e){c.ajaxResponse.taskInfo.caseList.splice(e.$index,1),c.ajaxRequest.caseID.splice(c.ajaxRequest.caseID.indexOf(e.item.caseID),1)},c.fun.init=function(){l.getEnv();var e={cache:{group:a.get()}};e.cache.group&&("add"!=c.data.status?e.promise=n.AutomatedTestTask.Detail({spaceKey:c.ajaxRequest.spaceKey,taskID:c.ajaxRequest.taskID,groupID:c.component.selectMultistageCommonComponentObject["new"].value,projectHashKey:c.ajaxRequest.projectHashKey}).$promise.then(function(e){if(i.COMMON.SUCCESS==e.statusCode){switch(c.ajaxResponse.taskInfo=e.taskInfo,(c.ajaxResponse.taskInfo.caseList||[]).map(function(e,a){c.ajaxRequest.caseID.push(e.caseID)}),e.taskInfo.taskLoop){case 0:(c.ajaxResponse.taskInfo.taskDate||[]).map(function(e,a){c.data.dateList[e].checkbox=!0}),(c.ajaxResponse.taskInfo.taskTime||[]).map(function(e,a){c.data.timeList[e].checkbox=!0});break;case 1:c.data.current.dateRadio=(c.ajaxResponse.taskInfo.taskDate||[0])[0]||0,c.data.current.timeRadio=(c.ajaxResponse.taskInfo.taskTime||[0])[0]||0}if(c.ajaxResponse.taskInfo.groupID=e.taskInfo.groupID,c.ajaxResponse.taskInfo.executeWay=c.ajaxResponse.taskInfo.executeWay||0,!c.ajaxResponse.taskInfo.envID)if(c.ajaxResponse.taskInfo.taskEnv){c.ajaxResponse.taskInfo.envID=-1;try{c.ajaxResponse.taskInfo.taskEnv.envAuth.status=c.ajaxResponse.taskInfo.taskEnv.envAuth.status||"0"}catch(a){c.ajaxResponse.taskInfo.taskEnv.envAuth={status:"0"}}c.fun.change({$last:1})}else c.ajaxResponse.taskInfo.envID=0;c.fun.changeNotice("all",{$last:1})}}):(c.ajaxResponse.taskInfo.taskStatus=1,c.ajaxResponse.taskInfo.taskEnv=angular.copy(p.taskEnv)),e.promise?e.promise["finally"](function(){c.data.timerGroup=e.cache.group}):c.data.timerGroup=e.cache.group)},c.fun.init(),c.fun.back=function(){var e={uri:{groupID:c.ajaxRequest.groupID}};u.go("home.ams.automatic.inside.timer.default",e.uri)},c.fun.changeNotice=function(e,a){if(a.$last)switch(e){case"phone":c.data.userPhoneNumber.push({value:""});break;case"email":c.data.userEmail.push({value:""});break;default:var t={array:[]};c.ajaxResponse.taskInfo.userEmail&&c.ajaxResponse.taskInfo.userEmail.map(function(e,a){t.array.push({value:e})}),c.data.userEmail=t.array.concat(c.data.userEmail)}},l.queryCaseByID=function(){},c.fun.importCase=function(){s.Product_ImportCrossProjectModal({title:"添加用例",mainObject:{type:"sceneCase",setting:{itemTitle:"用例",itemInitQuery:c.ajaxRequest.caseID,initGroupID:null,staticQuery:[{groupID:null,groupName:"所有用例"}]},baseParams:{spaceKey:c.ajaxRequest.spaceKey,projectHashKey:c.ajaxRequest.projectHashKey},listComponent:{item:{batchItemExpression:"ng-disabled='$ctrl.otherObject.itemInitQuery.indexOf(item.caseID)>-1'"},baseFun:{beforeSelect:function(e){return c.ajaxRequest.caseID.indexOf(e)===-1}}},impGroupInfo:{resourceName:o.Group.Query,extraParams:{module:5}},impItemInfo:{queryResouceName:n.AutomatedTestCase.Query,searchResouceName:n.AutomatedTestCase.Search,queryIDResouceName:n.AutomatedTestCase.IDQuery,searchIDResouceName:o.CrossProject.SearchIDQuery,queryResponseKey:"caseList",queryIDResponseKey:"caseIDList",extraParams:{module:0}}}},function(e){if(e){var a=e.filter(function(e){if(c.ajaxRequest.caseID.indexOf(e)===-1)return!0}),s=null,o={spaceKey:c.ajaxRequest.spaceKey,projectHashKey:c.ajaxRequest.projectHashKey,caseID:JSON.stringify(a)};s=n.AutomatedTestTask.BatchQuery(o).$promise,s.then(function(a){switch(a.statusCode){case i.COMMON.SUCCESS:c.ajaxRequest.caseID=e,c.ajaxResponse.taskInfo.caseList=(a.caseList||[]).concat(c.ajaxResponse.taskInfo.caseList)}}),t.$broadcast("$Init_LoadingCommonComponent",{promise:s})}})},l.confirm=function(){var e={output:{spaceKey:c.ajaxRequest.spaceKey,projectHashKey:c.ajaxRequest.projectHashKey,groupID:c.component.selectMultistageCommonComponentObject["new"].value,taskID:c.ajaxRequest.taskID,taskName:c.ajaxResponse.taskInfo.taskName,taskRemark:c.ajaxResponse.taskInfo.taskRemark,taskCycle:c.ajaxResponse.taskInfo.taskCycle,executeWay:c.ajaxResponse.taskInfo.executeWay,taskLoop:c.ajaxResponse.taskInfo.taskLoop,noticeType:c.ajaxResponse.taskInfo.noticeType,noticeSetting:c.ajaxResponse.taskInfo.noticeSetting,caseID:[]},dateList:[],timeList:[],userPhoneNumber:[],userEmail:[]};if(c.data.submitted=!0,!t.editForm.$invalid){switch(c.ajaxResponse.taskInfo.taskCycle){case 1:switch(e.output.taskLoop){case 0:c.data.dateList.map(function(a,t){a.checkbox&&e.dateList.push(t)});break;case 1:e.dateList.push(parseInt(c.data.current.dateRadio))}if(c.data.current.dateIllegal=l.authForm(e.dateList),c.data.current.dateIllegal)return}switch(e.output.taskLoop){case 0:c.data.timeList.map(function(a,t){a.checkbox&&e.timeList.push(t)});break;case 1:e.timeList.push(parseInt(c.data.current.timeRadio))}switch(c.ajaxResponse.taskInfo.envID){case 0:break;case-1:switch(e.output.taskEnv=c.ajaxResponse.taskInfo.taskEnv,e.output.taskEnv.envAuth.status){case"1":e.output.taskEnv.envAuth={status:"1",basicAuth:e.output.taskEnv.envAuth.basicAuth};break;case"2":e.output.taskEnv.envAuth={status:"2",jwtAuth:e.output.taskEnv.envAuth.jwtAuth};break;default:e.output.taskEnv.envAuth={status:"0"}}e.output.taskEnv=JSON.stringify(e.output.taskEnv);break;default:e.output.envID=c.ajaxResponse.taskInfo.envID}if(c.data.current.timeIllegal=l.authForm(e.timeList),!c.data.current.timeIllegal&&(c.data.current.caseIllegal=l.authForm(c.ajaxRequest.caseID),!c.data.current.caseIllegal)){1===e.output.executeWay&&(e.output.cookieInheritStatus=c.ajaxResponse.taskInfo.cookieInheritStatus?1:0),e.output.taskDate=JSON.stringify(e.dateList),e.output.taskTime=JSON.stringify(e.timeList);var a=!0,s=!1,n=void 0;try{for(var o,i=c.ajaxResponse.taskInfo.caseList[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var u=o.value;e.output.caseID.push(u.caseID)}}catch(r){s=!0,n=r}finally{try{!a&&i["return"]&&i["return"]()}finally{if(s)throw n}}return e.output.caseID=JSON.stringify(e.output.caseID),c.data.userEmail.map(function(a,t){a.value&&e.userEmail.push(a.value)}),e.output.userEmail=JSON.stringify(e.userEmail),e.output}}},c.fun.load=function(e){return e.promise},c.fun.requestProcessing=function(){delete c.data.current.caseIllegal,delete c.data.current.mailIllegal,delete c.data.current.dateIllegal,delete c.data.current.timeIllegal;var e={request:l.confirm(),promise:null};return c.data.current.caseIllegal?void s.InfoModal("编辑失败，当前用例列表为空！","error"):c.data.current.mailIllegal?void s.InfoModal("编辑失败，请检查邮箱格式！","error"):c.data.current.dateIllegal||c.data.current.timeIllegal?void s.InfoModal("编辑失败，请检查信息是否填写完整！","error"):(e.promise=l.edit({request:e.request}),t.$broadcast("$Init_LoadingCommonComponent",{promise:e.promise}),e.promise)},l.edit=function(e){var a={promise:null};return"edit"===c.data.status?n.AutomatedTestTask.Edit(e.request).$promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:s.InfoModal("任务编辑成功","success"),c.fun.back()}}):(a.promise=n.AutomatedTestTask.Add(e.request).$promise,a.promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:s.InfoModal("任务新建成功","success"),c.fun.back()}})),a.promise},l.initCaseListTable=function(){c.component.blockListObject["case"]={tdList:[{thKey:"顺序",type:"sort"},{thKey:"用例名称",type:"text",modelKey:"caseName"},{thKey:"分组",type:"text",modelKey:"groupName","class":"w_200"},{thKey:"创建者",type:"html",html:"{{item.creator}}","class":"w_200"},{thKey:"更新时间",type:"text",modelKey:"updateTime","class":"w_150"},{type:"btn",authority:"edit","class":"w_100",btnList:[{key:"删除",operateName:"delete",fun:c.fun.deleteCaseList}]}]}},l.initHeaderTable=function(){c.component.blockListObject.header={mainObject:{itemStructure:{headerName:"",headerValue:""},tdList:[{thKey:"标签",type:"autoComplete",selectQuery:e.REQUEST_HEADER,modelKey:"headerName","class":"w_300",placeholder:"头部标签",itemExpression:"ng-class=\"{'eo-had-input-error':item.headerValue&&!item.headerName}\""},{thKey:"内容",type:"input",modelKey:"headerValue",placeholder:"头部内容"},{type:"btn","class":"w_100",authority:"edit",btnList:[{key:"删除",operateName:"delete"}]}]}}},l.initLevelTable=function(){var e={outputConfig:null};return e.outputConfig={mainObject:{itemStructure:{paramKey:"",paramValue:""},tdList:[{thKey:"参数名",type:"input",modelKey:"paramKey",placeholder:"参数名",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramValue}\"","class":"w_300"},{thKey:"参数值",type:"input",modelKey:"paramValue",placeholder:"参数值"},{type:"btn","class":"w_100",authority:"edit",btnList:[{key:"删除",operateName:"delete"}]}]}},e.outputConfig},l.initEmailTable=function(){c.component.blockListObject.emial={mainObject:{baseFun:{watchFormLastChange:function(e){/^[0-9A-Za-z-_.]+@[0-9a-z-]+\.[a-z]{2,20}(\.[a-z]{2,20}){0,1}$/.test(e.item.value)===!1?e.item.$invalid=c.data.current.mailIllegal=!0:e.item.$invalid=c.data.current.mailIllegal=!1}},itemStructure:{value:""},tdList:[{thKey:"邮箱",type:"input",modelKey:"value",errorTip:"请填写正确的邮箱",placeholder:"邮箱",itemExpression:"ng-class=\"{'eo-input-error':item.$invalid&&$ctrl.otherObject.submitted}\"","class":"w_300"},{type:"btn",authority:"edit",btnList:[{key:"删除",operateName:"delete"}]},{type:"text"}]}}},c.$onInit=function(){l.initCaseListTable(),l.initHeaderTable(),l.initEmailTable(),c.component.blockListObject.extraParam=l.initLevelTable(),c.component.blockListObject.globalParam=l.initLevelTable(),c.component.menuObject.mainObject={list:[{type:"btn","class":"btn-group-li menu-ml15 pull-left",btnList:[{name:"返回任务列表",icon:"chexiao",fun:{"default":c.fun.back}}]},{type:"btn","class":"pull-left",authority:"edit",btnList:[{name:"保存","class":"eo_theme_btn_success block-btn",fun:{disabled:1,"default":c.fun.requestProcessing}}]}],setting:{"class":"common-menu-fixed-seperate"}}},t.$on("$SidebarFinish",function(){c.fun.init()})}angular.module("eolinker.ams").component("homeAutomaticInsideTimerEdit",{templateUrl:"module/ams/ui/automatic/inside/content/timer/edit/index.html",controller:e}),e.$inject=["HTTP_CONSTANT","GroupService","$scope","$rootScope","AutomatedTestResource","GeneralFunResource","CODE","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,a,o,r,c,n,i,s,p,u){var j=this;j.data={menuType:0},j.multiTabComponent={list:[{key:"项目",value:0},{key:"API",value:1},{key:"Mock API",value:2},{key:"API / 文档变更通知",value:3}]},j.ajaxData={projectInfo:{}},j.service={authority:p},j.CONST={PROJECT_TYPE_QUERY:c.PROJECT_TYPE_QUERY,MOCK_SETTING:[{name:"验证请求方式",key:"requestTypeCheck"},{name:"验证请求参数",key:"requestParamCheck"},{name:"验证请求头部",key:"requestHeaderCheck"}]},j.fun={};var f={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey},y={};j.component={noticeMemberApiObj:{resouceModule:o.Notification,ajaxRequest:{spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,module:0},eventArr:r.API},noticeMemberDocObj:{resouceModule:o.Notification,ajaxRequest:{spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,module:1},eventArr:r.DOC}},j.fun.switchStatus=function(e){j.ajaxData[e.type][e.key]=0===j.ajaxData[e.type][e.key]?1:0},j.fun.copyProject=function(){var e={spaceKey:f.spaceKey,groupID:f.groupID,mark:"project",resource:o.Project.Copy,filterInfoModal:!0,callback:function(e){s.MessageModal("复制成功","请问是否跳转到新项目？",{button:{sure:{content:"确认",fun:function(){n.go("home.ams.project.inside.overview",{projectHashKey:e.projectHashKey})}}}})}};a.outsideObject.fun.operate("copy",{item:j.ajaxData.projectInfo},e)},j.fun.saveSwitchSetting=function(e){var t={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey},a=null;switch(e){case"api":case"statusCode":t.type=1,t.duplicateCheckSetting=JSON.stringify(j.ajaxData.duplicateCheckSetting),a=o.Project.ConfirmProjectSetting(t).$promise;break;case"mock":t.type=0,t.mockApiSetting=JSON.stringify(j.ajaxData.mockApiSetting),a=o.Project.ConfirmProjectSetting(t).$promise;break;case"noticeSetting":t.noticeApiManagerSetting=j.ajaxData.noticeApiManagerSetting,a=o.Notification.UpdateNoticeSetting(t).$promise}return a.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:s.InfoModal("保存配置成功","success");break;default:s.InfoModal("操作失败，"+u.FAILURE,"error")}}),a},j.fun["delete"]=function(){var e={request:{spaceKey:f.spaceKey,projectHashKey:f.projectHashKey}};s.EnsureModal("删除项目",!0,"项目删除后，所有项目内数据均会被删除，并且无法恢复数据，请谨慎操作！",{},function(t){t&&o.Project.Delete(e.request).$promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:n.go("home.ams.project.default"),s.InfoModal("删除成功","success");break;default:s.InfoModal("删除失败，"+u.FAILURE,"error")}})})},y.resetPermission=function(){var e={module:0,spaceKey:f.spaceKey,hashKey:f.projectHashKey};t.ProjectMember.GetProjectPermission(e).$promise.then(function(e){j.service.authority.fun.setPermission("project",{permission:e.permission||{},isArchive:e.isArchive,userGrade:e.permission.userGrade})})},j.fun.file=function(){var e={module:0,spaceKey:f.spaceKey,isArchive:0===j.ajaxData.projectInfo.isArchive?1:0,projectHashKey:'["'+f.projectHashKey+'"]'},a=1===e.isArchive?"归档":"取消归档",o=function(){var o=t.Project.BatchFile(e).$promise;return o.then(function(t){switch(t.statusCode){case i.COMMON.SUCCESS:s.InfoModal(a+"成功！","success"),j.ajaxData.projectInfo.isArchive=e.isArchive,y.resetPermission();break;default:s.InfoModal(a+"失败！","error")}}),o};return 1!==e.isArchive?o():void s.EnsureModal("归档项目",!1,"项目归档之后仅支持只读操作,如需编辑项目需要先取消归档,确认归档项目?",{btnType:2,btnMessage:"确认"},function(e){if(e)return o()})},j.fun.confirm=function(){var t={request:{spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,projectName:j.ajaxData.projectInfo.projectName,projectVersion:j.ajaxData.projectInfo.projectVersion,projectType:j.ajaxData.projectInfo.projectType},promise:null};return e.BasicForm.$valid&&(t.promise=o.Project.Edit(t.request).$promise,t.promise.then(function(e){switch(e.statusCode){case i.COMMON.SUCCESS:s.InfoModal("编辑成功","success");break;default:s.InfoModal("编辑失败，"+u.FAILURE,"error")}})),t.promise},j.fun.init=function(){var t={request:{spaceKey:f.spaceKey,projectHashKey:f.projectHashKey}};return e.$emit("$WindowTitleSet",{list:["项目设置","API管理"]}),s.global.ajax.Info_Project=o.Project.Detail(t.request),s.global.ajax.Info_Project.$promise.then(function(e){j.ajaxData.projectInfo=e||{},j.ajaxData.mockApiSetting=e.mockApiSetting,j.ajaxData.duplicateCheckSetting=e.duplicateCheckSetting,j.ajaxData.projectInfo.projectType=(j.ajaxData.projectInfo.projectType||0).toString(),j.ajaxData.noticeApiManagerSetting=e.noticeApiManagerSetting}),s.global.ajax.Info_Project.$promise}}angular.module("eolinker.ams").component("homeProjectInsideSetting",{templateUrl:"module/ams/ui/project/inside/content/account/default/index.html",controller:e}),e.$inject=["$scope","GeneralFunResource","Operate_CommonService","ApiManagementResource","NOTICE_MEMBER_OBJ","API_AMS_CONSTANT","$state","CODE","$rootScope","Authority_CommonService","RESPONSE_TEXT"]}();
"use strict";!function(){function t(t,e){var o=this;o.component={authorityProductObject:{mainObject:{setting:{module:0,productName:"ams"}}}},o.service={authority:e}}angular.module("eolinker.ams").component("homeProjectInsideAuthorityDefault",{template:'<authority-product-component main-object="$ctrl.component.authorityProductObject.mainObject" authority-object="{editMember:$ctrl.service.authority.projectGroupPermission.project.editMember,editManager:$ctrl.service.authority.projectGroupPermission.project.editManager}"></authority-product-component>',controller:t}),t.$inject=["$scope","Authority_CommonService"]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,a,s,o,n,i,r,c,p,l,u,m){var f=this;f.data={plugObject:{needVersion:!0,matchVersion:580},batch:{isOperating:!1},testHistory:{},testSeverType:window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE")||"plugin",plugTransferToLocal:eoSystemObj.plugTransferToLocal},f.testStatusObj={isTesting:!1},f.fun={},f.ajaxResponse={query:[],apiInfo:null},f.service={authority:c,home:p},f.component={blockListObject:{},listMenuObject:{},menuObject:{list:null},reportObject:{object:{},show:!1}};var y={ws:null,wsLocalUrl:"ws://"+eoSystemObj.WS_TARGET_PREFIX_URL,wsServerUrl:(eoSystemObj.HOST.indexOf("https")>-1?"wss://":"ws://")+(eoSystemObj.PLATFORM.indexOf("sass")!==-1?eoSystemObj.WS_TARGET_PREFIX_URL:eoSystemObj.HOST.replace(/(http)(()|(s))(:\/\/)/,"")),wsUrl:""},d={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID,apiID:o.params.apiID},h={},I={"default":r},b={testPointArr:[]};h.resetBatchInfo=function(){f.data.batch.isOperating=!1,f.data.batch.indexAddress={},f.data.batch.query=[],f.data.batch.selectAll=!1},h.changeTestSeverType=function(){if(f.data.plugObject.useStatus)switch(f.data.testSeverType){case"nodejs":f.data.testSeverType="plugin";break;default:f.data.testSeverType="nodejs"}else{var e={html_1:"<div class='lh_30'><p>",html_2:"<a href='https://www.eolinker.com/#/plug/introduce' target='_blank' class='eo-status-warning' ><b>",html_3:"</b>",html_4:"</a>",html_5:"</p></div>",operate:window.plug&&"application/eolinker"===window.plug.type?"更新":"安装"},t="";t="更新"===e.operate?"{@html_1}测试增强插件已经提供新版本V5.9.3，请您先升级安装新版本插件{@html_2}[点此获取]{@html_3}{@html_4}。</br>升级插件版本后将会支持新的功能以及特性，由此带来不便之处，敬请谅解。{@html_5}":"{@html_1}如需切换使用插件测试，请先安装我们为您免费提供的 {@html_2}测试增强插件{@html_3} [点击获取]{@html_4}！{@html_5}",i.MessageModal("温馨提示",u("JsConstructHtml_CommonFilter")(t,e),{button:{sure:{content:"下载插件离线安装包",fun:function(){window.open(eoSystemObj.ADDRESS_PLUG)}}}}),f.data.testSeverType="nodejs"}window.localStorage.setItem("EOLINKER_TEST_USE_SOFTWARE_TYPE",f.data.testSeverType)},h.getApiDetail=function(){var e={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,groupID:d.groupID,apiID:d.apiID};return i.global.ajax.Detail_Api=s.Api.Detail(e),i.global.ajax.Detail_Api.$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:try{e.apiInfo.authInfo&&!e.apiInfo.authInfo.hasOwnProperty("status")&&(e.apiInfo.authInfo.status=0)}catch(t){}f.ajaxResponse.apiInfo=e.apiInfo}}),i.global.ajax.Detail_Api.$promise},h.showTestHistory=function(e,t){var a=angular.copy(f.data.testHistory[t.caseID]),o=function(){var t=a.general.match.type.toString();f.component.reportObject.object={status:e,general:Object.assign({},{match:{rule:a.general.match.rule}},a.general),requestHeaders:"{}"===JSON.stringify(a.requestHeaders)?null:a.requestHeaders,requestBody:{requestType:"string"==typeof a.requestBody.body?"1":a.requestBody.requestType,body:"{}"===JSON.stringify(a.requestBody.body)?null:a.requestBody.body},returnResultType:a.returnResultType,responseHeaders:a.responseHeaders,response:a.response,baseInfo:{caseName:a.general.name,matchType:"3"===t?2:"2"===t?3:t,matchTypeMessage:"0"===t?"完全匹配":"1"===t?"正则匹配":"2"===t?"不匹配":"3"===t?"Json匹配":"4"===t?"XML匹配":"状态码校验",statusCode:a.general.match.statusCode,matchHeaderType:0,matchHeaderTypeMessage:"不校验"},errorReason:a.errorReason,reportList:a.reportList,isLocal:a.isLocal},f.component.reportObject.show=!0};if(a.general)o();else{var n={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,caseID:t.caseID};s.TestCase.InfoReport(n).$promise.then(function(e){a=e.reportInfo,a.general.match?(f.data.testHistory[t.caseID]=angular.copy(a),o()):s.TestCase.CaseData(n).$promise.then(function(e){a.general.match={rule:e.matchRule,type:e.matchType,statusCode:e.statusCode,jsonResultVerification:e.jsonResultVerification},f.data.testHistory[t.caseID]=angular.copy(a),o()})})}},h.test=function(e,t){f.data.isOperate=!0,f.data.testMethod=e;var a=f.data.plugObject.useStatus&&"nodejs"!==f.data.testSeverType,s=[];switch(e){case"all":f.testStatusObj.isTesting=!f.testStatusObj.isTesting,f.testStatusObj.isTesting&&(s=[{apiID:d.apiID,caseIDArr:[]}],f.ajaxResponse.query.map(function(e){s[0].caseIDArr.push(e.caseID),f.data.testHistory[e.caseID].responseType="testing"}));break;case"single":f.testStatusObj.isTesting=f.data.testHistory[t.item.caseID].testing=!f.data.testHistory[t.item.caseID].testing,f.testStatusObj.isTesting&&(s=[{apiID:d.apiID,caseIDArr:[t.item.caseID]}],f.data.testHistory[t.item.caseID]&&(f.data.testHistory[t.item.caseID].responseType="testing"))}f.testStatusObj.isTesting?(b.testPointArr=s,!eoSystemObj.plugTransferToLocal&&a?(y.ws&&(y.ws.close(),y.ws=null),window.sessionStorage.setItem("plug-batchTest-info",JSON.stringify(s))):(y.ws&&("plugin"===f.data.testSeverType&&y.wsUrl.indexOf(y.wsLocalUrl)===-1||"nodejs"===f.data.testSeverType&&y.wsUrl.indexOf(y.wsServerUrl)===-1)&&(y.ws.close(),y.ws=null),y.ws?y.ws.send(JSON.stringify({status:"ajax",env:f.service.home.envObject.object.total,query:s})):h.bindWs(JSON.stringify({status:"ajax",env:f.service.home.envObject.object.total,query:s}),!0))):(b.testPointArr.map(function(e){e.caseIDArr.map(function(e){"testing"===f.data.testHistory[e].responseType?delete f.data.testHistory[e].responseType:""})}),y.ws&&y.ws.send(JSON.stringify({status:"abort"})))},h.copy=function(t,a){var o={title:"复制测试用例",textArray:[{type:"input",title:"用例名称",key:"caseName",value:"副本-"+a,required:!0}],btnObject:{"class":"eo_theme_btn_info",text:"确认"}},r=Object.assign({caseID:t},d);i.MixInputModal(o,function(t){t&&(r.caseName=t.caseName,s.TestCase.Copy(r).$promise.then(function(t){switch(t.statusCode){case n.COMMON.SUCCESS:e.$broadcast("$Init_LoadingCommonComponent"),i.InfoModal("复制成功","success");break;default:i.InfoModal("复制失败，"+m.FAILURE,"error")}}))})},h.pullApi=function(){i.Ams_PullApiSettingModal({type:"apiCase"},function(t){if(t){var a={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:d.apiID,caseID:JSON.stringify(f.data.batch.query),synchronizeSetting:JSON.stringify(t)};s.TestCase.SynchronizeData(a).$promise.then(function(t){switch(t.statusCode){case n.COMMON.SUCCESS:e.$broadcast("$Init_LoadingCommonComponent"),i.InfoModal("同步成功","success"),h.resetBatchInfo();break;default:i.InfoModal("操作失败，"+m.FAILURE,"error")}})}})},f.fun.edit=function(t,a){if("free"===f.service.authority.product.ams)return void i.Common_UpgradeNoticeModal({mark:"AMS",module:"api_case"});var s={baseInfo:Object.assign({},d,{caseID:"add"!==t?a.item.caseID:null}),caseInfo:{},status:t};switch(t){case"add":if(f.ajaxResponse.apiInfo)switch(s.dataStructureList=f.ajaxResponse.apiInfo.dataStructureList,s.caseInfo={caseData:{headers:f.ajaxResponse.apiInfo.headerInfo,params:f.ajaxResponse.apiInfo.requestInfo,URL:f.ajaxResponse.apiInfo.baseInfo.apiURI,requestType:f.ajaxResponse.apiInfo.baseInfo.apiRequestParamType.toString(),raw:f.ajaxResponse.apiInfo.baseInfo.apiRequestRaw,apiRequestType:f.ajaxResponse.apiInfo.baseInfo.apiRequestType.toString(),httpHeader:f.ajaxResponse.apiInfo.baseInfo.apiProtocol.toString(),urlParam:f.ajaxResponse.apiInfo.urlParam,restfulParam:f.ajaxResponse.apiInfo.restfulParam,auth:f.ajaxResponse.apiInfo.authInfo,apiRequestParamJsonType:f.ajaxResponse.apiInfo.baseInfo.apiRequestParamJsonType,script:{before:f.ajaxResponse.apiInfo.baseInfo.beforeInject,after:f.ajaxResponse.apiInfo.baseInfo.afterInject,type:"0"}},advancedSetting:f.ajaxResponse.apiInfo.baseInfo.advancedSetting||{requestRedirect:1}},f.ajaxResponse.apiInfo.resultParamType){case 0:s.caseInfo.jsonResultVerification={resultType:f.ajaxResponse.apiInfo.resultParamJsonType||0},s.caseInfo.matchType=3,s.caseInfo.matchRule=angular.copy(f.ajaxResponse.apiInfo.resultInfo);break;case 1:s.caseInfo.matchType=4,s.caseInfo.matchRule=angular.copy(f.ajaxResponse.apiInfo.resultInfo);break;case 2:s.caseInfo.matchType=0,s.caseInfo.matchRule=f.ajaxResponse.apiInfo.resultInfo;break;case 3:s.caseInfo.matchType=2;break;default:s.caseInfo.matchType=3,s.caseInfo.matchRule=u("paramLevelToNestFilter")(f.ajaxResponse.apiInfo.resultInfo,{isInheritParamType:!0})}s.caseInfo.matchRule=s.caseInfo.matchRule||[],i.AMS_TestExampleModal(s,function(t){t&&e.$broadcast("$Init_LoadingCommonComponent")});break;case"copy":return void h.copy(a.item.caseID,a.item.caseName);default:var o=b[a.item.caseID];o?s.caseInfo=Object.assign({},s.caseInfo,o):s.caseInfo=null,i.AMS_TestExampleModal(s,function(e){e&&(e.output.creator=a.item.creator,b[a.item.caseID]=e.output,e.output.jsonResultVerification=JSON.parse(e.output.jsonResultVerification),f.ajaxResponse.query[a.$index]=e.output)})}},h["delete"]=function(t,a){var o={modal:{title:"删除测试用例",message:"请问是否删除该测试用例？"},request:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:d.apiID,caseID:"batch"===t?JSON.stringify(f.data.batch.query):"["+a.item.caseID+"]"}};i.EnsureModal(o.modal.title,!1,o.modal.message,{},function(r){r&&s.TestCase.Delete(o.request).$promise.then(function(s){switch(s.statusCode){case n.COMMON.SUCCESS:i.InfoModal("测试用例删除成功","success"),"batch"===t?(e.$broadcast("$Init_LoadingCommonComponent"),h.resetBatchInfo()):f.ajaxResponse.query.splice(a.$index,1);break;default:i.InfoModal("测试用例删除失败","error")}})})},f.fun.init=function(){var t={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:d.apiID,module:1};return e.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:"case"}}),i.global.ajax.Query_TestCase=s.TestCase.Query(t),i.global.ajax.Query_TestCase.$promise.then(function(t){f.ajaxResponse.apiName=t.apiName,f.ajaxResponse.apiURI=t.apiURI,f.ajaxResponse.apiRequestType=t.apiRequestType,f.ajaxResponse.query=t.caseList||[],f.ajaxResponse.query.map(function(e){f.data.testHistory[e.caseID]={responseType:e.latestTestResult,testTime:e.testTime}}),e.$emit("$WindowTitleSet",{list:["[用例测试]"+t.apiName,"API","API管理"]})}),i.global.ajax.Query_TestCase.$promise},h.bindWs=function(a){y.ws||(y.wsUrl="vspex_pc"===eoSystemObj.PLATFORM?"nodejs"===f.data.testSeverType?y.wsServerUrl:y.wsLocalUrl:y.wsServerUrl,y.ws=new WebSocket(y.wsUrl+"/nodeWebsocketServer/apiCase"),y.ws.onopen=function(){eoCookie.getCookieStrByUrl(t,function(e){if(y.ws.send(JSON.stringify({spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,cookie:e,status:"init"})),a)switch("undefined"==typeof a?"undefined":_typeof(a)){case"string":y.ws.send(a);break;case"object":a.map(function(e,t){y.ws.send(e)})}})},y.ws.onmessage=function(t){var a=JSON.parse(t.data);switch(a.statusCode){case n.COMMON.SUCCESS:case"120000":f.testStatusObj.isTesting=!1;break;default:if(!f.testStatusObj.isTesting)return;for(var s in a)f.data.testHistory=Object.assign({},f.data.testHistory,a[s])}e.$root&&e.$root.$$phase||e.$apply()},y.ws.onclose=function(e){y.ws=null},y.ws.onerror=function(e){y.ws=null})},h.initTestHistoryTable=function(){f.component.blockListObject.testList={setting:{trNgClass:"ng-class=\"{'elem-active':$ctrl.activeObject.indexAddress[item.caseID]&&$ctrl.otherObject.nowIsBatchOperate,'cp':$ctrl.otherObject.nowIsBatchOperate}\""},baseFun:{showTestHistory:h.showTestHistory},tdList:[{type:"checkbox",activeKey:"caseID",thItemExpression:'ng-show="$ctrl.otherObject.nowIsBatchOperate"',itemExpression:'ng-show="$ctrl.otherObject.nowIsBatchOperate"',checkboxClickAffectTotalItem:!0,isWantedToExposeObject:!0},{thKey:"用例名称",type:"text",modelKey:"caseName","class":"pl20"},{thKey:"最近测试结果",type:"html",html:a.get("module/ams/ui/project/inside/content/api/case/index.tmp.html"),"class":"w_150"},{thKey:"测试时间",type:"html","class":"w_200",html:"{{$ctrl.otherObject.testHistoryObj[item.caseID].testTime}}"},{thKey:"创建者",type:"text",modelKey:"creator","class":"w_200"},{type:"btn","class":"w_200",authority:"showOperateColumn",itemExpression:'ng-show="!$ctrl.otherObject.nowIsBatchOperate"',btnList:[{html:'{{$ctrl.otherObject.testHistoryObj[item.caseID].testing?"中止":"测试"}}',authority:"test",fun:h.test,param:'"single",inputArg',"class":"batch-test-btn",itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting&&!$ctrl.otherObject.testHistoryObj[item.caseID].testing" testing="{{$ctrl.otherObject.testHistoryObj[item.caseID].testing||false}}"',isUnWantToStopPropagation:!0},{key:"复制",authority:"editApiCase",fun:f.fun.edit,param:'"copy",inputArg',itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'},{key:"编辑",authority:"editApiCase",fun:f.fun.edit,param:'"edit",inputArg',itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'},{key:"删除",authority:"editApiCase",operateName:"delete",fun:h["delete"],param:'"single",inputArg',itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'}]}]}},h.newTestCase=function(){if("free"===f.service.authority.product.ams)return void i.Common_UpgradeNoticeModal({mark:"AMS",module:"api_case"});if(f.ajaxResponse.apiInfo)f.fun.edit("add");else{var e=h.getApiDetail();e["finally"](function(){f.fun.edit("add")})}},f.$onInit=function(){h.initTestHistoryTable(),h.resetBatchInfo(),f.service.home.testCommonFun.downloadPcModal(),f.component.menuObject.mainObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回API列表",icon:"chexiao",fun:{"default":I["default"].menu,params:"'list',"+JSON.stringify(d)}}]},{type:"navigation","class":"menu-navigation",fun:I["default"].menu,value:"case",tabList:[{key:"API",value:"detail"},{key:"测试",authority:"test",value:"test"},{key:"测试用例",value:"case"},{key:"Mock API",authority:"mockApi",value:"mock"}]},{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":I["default"].menu,params:"'edit',"+JSON.stringify(d)}},{name:"复制",icon:"fuzhi",fun:{"default":function(){I["default"].copyApi(Object.assign({},d,{apiName:f.ajaxResponse.apiName,apiURI:f.ajaxResponse.apiURI,apiRequestType:f.ajaxResponse.apiRequestType,isPopupModalToWarning:!0}))}}},{name:"删除",icon:"shanchu",fun:{"default":I["default"]["delete"],params:JSON.stringify(d)}}]}],setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}};var e=a.get("module/ams/ui/project/inside/content/api/case/testBtn.tmp.html");f.component.listMenuObject={list:[{type:"btn",authority:"edit",btnList:[{name:"新建用例",icon:"jiahao","class":"eo_theme_btn_success block-btn menu-mr15 ",fun:{"default":h.newTestCase}}]},{type:"customized-html","class":"test-btn-container",fun:h.test,otherFun:h.changeTestSeverType,html:e}],batchList:[{type:"btn",btnList:[{name:"从关联的API文档更新数据",fun:{"default":h.pullApi,params:'"batch"'}},{name:"删除",fun:{"default":h["delete"],params:'"batch"'}}]}],setting:{batch:!0,batchInitFun:h.resetBatchInfo,"class":"common-menu-ul f_row f_ac"}}},e.$on("$stateChangeStart",function(){y.ws&&y.ws.close()})}angular.module("eolinker.ams").component("homeProjectInsideApiCase",{templateUrl:"module/ams/ui/project/inside/content/api/case/index.html",controller:e}),e.$inject=["$scope","COOKIE_CONFIG","$templateCache","ApiManagementResource","$state","CODE","$rootScope","HomeProjectApi_Service","Authority_CommonService","Operate_CommonService","$sce","$filter","RESPONSE_TEXT"]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,a,t,s,r,i,n,o,p,l,m,c,u,d,y){var f=this;f.data={isFailedDemo:!1},f.CONST={OPERATE_TITLE:{notice:"变更通知",log:"版本管理",comment:"评论"},METHOD_ARR:a.METHOD_ARR,API_STATUS_SHOW_QUERY:a.API_STATUS_QUERY},f.fun={},f.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,apiID:o.params.apiID,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID},f.commentComponent={mainObject:{},exportFunObject:{}},f.ajaxResponse={},f.service={home:c,authority:i,"default":u},f.component={menuObject:{list:null},noticeMemberObj:{resouceModule:n.Notification,ajaxRequest:{spaceKey:f.ajaxRequest.spaceKey,id:f.ajaxRequest.apiID,projectHashKey:f.ajaxRequest.projectHashKey,module:2},eventArr:t.API},blockListObject:{}};var b={structureObject:{},dbFieldObj:{}},j={},h={groupCommon:d};j.initGroupInfo=function(e){f.ajaxResponse.baseInfo.groupPath=h.groupCommon.fun.getGroupPath({currentGroupID:e.groupID,groupInfo:h.groupCommon.fun.generalGroupInfo({list:y.get()}),resultType:"string"})},f.fun.generatePreviewData=function(e){var a={title:"预览数据",dataType:e};switch(e){case"body":a.data=f.service.home.envObject.object.model.requestInfo,a.dataInfo={apiRequestType:f.ajaxResponse.baseInfo.apiRequestParamType,apiRequestParamJsonType:f.ajaxResponse.baseInfo.apiRequestParamJsonType};break;case"requestHeader":a.data=f.service.home.envObject.object.model.headerInfo;break;case"responseHeader":a.data=f.ajaxResponse.responseHeader;break;case"urlParam":a.data=f.service.home.envObject.object.model.urlParam;break;case"response":a.data=f.ajaxResponse.resultInfo,a.dataInfo={resultParamType:f.ajaxResponse.resultParamType,resultParamJsonType:f.ajaxResponse.resultParamJsonType}}l.Product_PreviewApiDataModal(a)},f.fun.showModal=function(e){return"free"===f.service.authority.product.ams&&"log"!==e?void l.Common_UpgradeNoticeModal({mark:"AMS",module:"api_"+e}):("comment"===e&&(f.ajaxResponse.hasUnreadComment=0),void(f.data.modal=e))},f.fun.closeModal=function(){f.data.modal=null},f.fun.set=function(e){var a={groupID:f.ajaxRequest.groupID,apiID:f.ajaxRequest.apiID,status:"edit"};window.open(o.href("home.ams.project.inside.api.edit",a)+"#"+e,"_blank")},f.fun.changeApiStatus=function(t){l.AMS_ChangeStatusModal({title:"编辑API状态",query:a.API_STATUS_QUERY_PANEL_ARR,status:f.ajaxResponse.baseInfo.apiStatus},function(a){if(a){var t={spaceKey:f.ajaxRequest.spaceKey,projectHashKey:f.ajaxRequest.projectHashKey,apiID:"["+f.ajaxRequest.apiID+"]",apiStatus:a.status};n.Api.ChangeStatus(t).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:f.ajaxResponse.baseInfo.apiStatus=a.status,l.InfoModal("编辑状态成功","success");break;default:l.InfoModal("编辑状态，"+e.FAILURE,"error")}})}})},j.parseSturctDataBlockList=function(e,a){if(e.structureID){var t=[],s=angular.copy(b.structureObject[e.structureID].structureData);for(var r in s){var i=s[r],n=e.updateData[i.paramID];n&&n.structureIsHide||(i.listDepth=a+(i.listDepth||0),t.push(Object.assign({},i,n)))}return t}},f.fun.watchUi=function(e){switch(e){case"newTab":window.open(window.location.href,"_blank");break;case"adminCase":o.go("home.ams.project.inside.api.case",{apiID:f.ajaxRequest.apiID,groupID:f.ajaxRequest.groupID})}},f.fun.init=function(){var e={spaceKey:f.ajaxRequest.spaceKey,projectHashKey:f.ajaxRequest.projectHashKey,apiID:f.ajaxRequest.apiID};return l.global.ajax.Detail_Api=n.Api.Detail(e),l.global.ajax.Detail_Api.$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:f.ajaxResponse=e.apiInfo,j.initGroupInfo(f.ajaxResponse.baseInfo),f.ajaxResponse.hasUnreadComment=e.hasUnreadComment||0,b.dbFieldObj=Object.assign(b.dbFieldObj,e.apiInfo.dbFieldObj),b.structureObject=Object.assign(b.structureObject,e.apiInfo.dataStructureList),r.$emit("$WindowTitleSet",{list:["[API文档]"+e.apiInfo.baseInfo.apiName,"API","API管理"]}),e.apiInfo.baseInfo.apiTag=(e.apiInfo.baseInfo.apiTag||"").length>0?e.apiInfo.baseInfo.apiTag.split(","):"";var a=["Form-data","Raw","JSON","XML","Binary"];e.apiInfo.baseInfo.apiRequestParamTypeString=a[e.apiInfo.baseInfo.apiRequestParamType];var t=["JSON","XML","Raw","Binary"];switch(e.apiInfo.resultParamTypeString=t[e.apiInfo.resultParamType],e.apiInfo.baseInfo.apiProtocol){case 0:f.ajaxResponse.baseInfo.protocol="HTTP";break;case 1:f.ajaxResponse.baseInfo.protocol="HTTPS"}switch(f.ajaxResponse.resultParamType){case 0:case 1:f.ajaxResponse.resultInfo=s.initReadonlyTableList(f.ajaxResponse.resultInfo,{fun:j.parseSturctDataBlockList});break;case 2:case 3:break;default:f.ajaxResponse.resultInfo=m("paramLevelFilter")(f.ajaxResponse.resultInfo)}switch(f.service.home.envObject.object.model={baseInfo:{apiURI:e.apiInfo.baseInfo.apiURI,apiRequestRaw:e.apiInfo.baseInfo.apiRequestRaw,apiRequestParamType:e.apiInfo.baseInfo.apiRequestParamType,apiRequestBinary:e.apiInfo.baseInfo.apiRequestBinary},headerInfo:e.apiInfo.headerInfo,urlParam:e.apiInfo.urlParam,restfulParam:m("paramLevelFilter")(e.apiInfo.restfulParam)},e.apiInfo.baseInfo.apiRequestParamType){case 0:f.service.home.envObject.object.model.requestInfo=m("paramLevelFilter")(e.apiInfo.requestInfo,{structFun:function(e,a,t){for(var s=angular.copy(b.structureObject[e.structureID].structureData),r=s.length-1;r>=0;r--){var i=s[r];i=Object.assign({},i,e.updateData[i.paramID]),i.structureIsHide||(i.paramKeyHtml=i.paramKey,a.splice(0,0,i.paramKey),t.splice(0,0,i))}},isStructModelKey:"structureID"});break;case 2:case 3:f.service.home.envObject.object.model.requestInfo=s.initReadonlyTableList(e.apiInfo.requestInfo,{fun:j.parseSturctDataBlockList})}f.ajaxResponse.baseInfo.apiNoteHtml=m("XssFilter")(f.ajaxResponse.baseInfo.apiNote,{onIgnoreTagAttr:function(e,a,t,s){if(/(style)|(class)|(id)|(name)/.test(a))return a+'="'+t+'"'}}),f.ajaxResponse.baseInfo.successMockCode=e.apiInfo.baseInfo.sampleURI+"/"+f.ajaxResponse.baseInfo.mockCode,f.ajaxResponse.baseInfo.failureMockCode=e.apiInfo.baseInfo.sampleURI+"/"+f.ajaxResponse.baseInfo.mockCode+"&resultType=failure",r.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:1}})}}),l.global.ajax.Detail_Api.$promise},f.fun.showDataStructure=function(e){if(e.$event&&e.$event.stopPropagation(),f.ajaxResponse.dataStructureList[e.item.paramType]){var a={data:f.ajaxResponse.dataStructureList[e.item.paramType],input:{}};switch(a.data.structureType.toString()){case"17":a.input={name:"数据结构[Enum]： "+a.data.structureName,query:a.data.structureData,tips:a.data.structureDesc,tdList:[{thKey:"枚举值",type:"text",modelKey:"paramKey"},{thKey:"类型",type:"html",html:'{{item.paramType==0?"[string]":item.paramType==1?"[file]":item.paramType==2?"[json]":item.paramType==3?"[int]":item.paramType==4?"[float]":item.paramType==5?"[double]":item.paramType==6?"[date]":item.paramType==7?"[datetime]":item.paramType==8?"[boolean]":item.paramType==9?"[byte]":item.paramType==10?"[short]":item.paramType==11?"[long]":item.paramType==12?"[array]":item.paramType==13?"[object]":item.paramType==15?"[null]":"[number]"}}',"class":"w_100"},{thKey:"说明",modelKey:"paramName",type:"text","class":"ws_normal lh_1point75"}]};break;default:var t={16:"XML",0:"Form-data",15:"JSON",12:"Array",13:"Object"};a.input={name:"数据结构["+t[a.data.structureType]+"]： "+a.data.structureName,query:a.data.structureData,tips:a.data.structureDesc,tdList:[{thKey:"参数名",type:"depthText",modelKey:"paramKey"},{thKey:"类型",type:"html",html:'{{item.paramType==0?"[string]":item.paramType==1?"[file]":item.paramType==2?"[json]":item.paramType==3?"[int]":item.paramType==4?"[float]":item.paramType==5?"[double]":item.paramType==6?"[date]":item.paramType==7?"[datetime]":item.paramType==8?"[boolean]":item.paramType==9?"[byte]":item.paramType==10?"[short]":item.paramType==11?"[long]":item.paramType==12?"[array]":item.paramType==13?"[object]":item.paramType==15?"[null]":"[number]"}}',"class":"w_100"},{thKey:"必填",type:"html",html:'{{item.paramNotNull==0?"是":""}}',"class":"w_80"},{thKey:"说明",type:"text",modelKey:"paramName","class":"ws_normal lh_1point75"},{thKey:m("JsConstructHtml_CommonFilter")('<button type="button" class="eo-operate-btn" ng-click="$ctrl.data.isSpreedBtnClick=!$ctrl.data.isSpreedBtnClick;$ctrl.data.isSpreed=true;$ctrl.mainObject.baseFun.spreedAll($event);$ctrl.data.isSpreed=false;">{@text}</button>',{text:'{{$ctrl.data.isSpreedBtnClick?"全部收缩":"全部展开"}}'}),type:"html",html:m("JsConstructHtml_CommonFilter")('<span class="eo-status-default fs12" ng-show="item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)">{@text}</span>',{text:'{{item.isClick?"收缩":"展开"}}'}),"class":"w_100"}],baseFun:{spreedAll:j.spreedAll,itemClick:j.spreedSingleItem},setting:{trClass:"va_tr_asad",trDirective:'insert-Html-Common-Directive insert-type="after" template-id="paramDetail_Template_js" bind-fun="$ctrl.mainObject.baseFun.itemClick(item,$ctrl.data.isSpreed,$ctrl.data.isSpreedBtnClick)"',trNgClass:"ng-class=\"{'cp':item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)}\""}}}l.Common_ShowDataModal(a.input)}},f.fun.storage=function(){var e={spaceKey:f.ajaxRequest.spaceKey,projectHashKey:f.ajaxRequest.projectHashKey,apiID:f.ajaxRequest.apiID};switch(l.global.ajax.Star_Api&&l.global.ajax.Star_Api.$cancelRequest(),f.ajaxResponse.baseInfo.starred){case 0:l.global.ajax.Star_Api=n.Star.Add(e),l.global.ajax.Star_Api.$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:f.ajaxResponse.baseInfo.starred=1}});break;case 1:l.global.ajax.Star_Api=n.Star.Delete(e),l.global.ajax.Star_Api.$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:f.ajaxResponse.baseInfo.starred=0}})}},j.spreedAll=function(e){var a=e.target.parentNode.parentNode.parentNode.getElementsByClassName("tr-tbd");for(var t in a){var s=a[t];switch(_typeof(a[t])){case"object":s.click()}}},j.spreedSingleItem=function(e,a,t){return a?e.isClick=t:e.isClick=!e.isClick,e.paramValue||e.paramLimit||e.paramValueList&&e.paramValueList.length>0&&e.paramValueList[0].value||e.dbArr&&b.dbFieldObj[e.dbArr[2]]?!a||{"throw":"needToStopEvent",valid:!0}:!!a&&{"throw":"needToStopEvent",valid:!1}},j.initLevelTable=function(e){var a={baseFun:{spreedAll:j.spreedAll,itemClick:j.spreedSingleItem,showDataStructure:f.fun.showDataStructure,showField:function(e){var a=n.Api.GetField({fieldID:e,spaceKey:f.ajaxRequest.spaceKey,projectHashKey:f.ajaxRequest.projectHashKey}).$promise;return a.then(function(e){l.AMS_ShowDbFieldModal(e.fieldInfo||{})}),a}},dbFieldObj:b.dbFieldObj,setting:{trClass:"va_tr_asad",trDirective:'insert-Html-Common-Directive insert-type="after" template-id="paramDetail_Template_js" bind-fun="$ctrl.mainObject.baseFun.itemClick(item,$ctrl.data.isSpreed,$ctrl.data.isSpreedBtnClick)"',trNgClass:"ng-class=\"{'cp':item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)||($ctrl.mainObject.dbFieldObj[item.dbArr[2]])}\""},CONST:{PARAM_TYPE_OBJ:{0:"[string]",1:"[file]",2:"[json]",3:"[int]",4:"[float]",5:"[double]",6:"[date]",7:"[datetime]",8:"[boolean]",9:"[byte]",10:"[short]",11:"[long]",12:"[array]",13:"[object]",14:"[number]",15:"[null]"}},tdList:[{thKey:"参数名",type:"depthHtml",html:'<span class="param-name-span">{{item.paramKeyHtml||item.paramKey}}</span><span class="btn-copy btn-hover eo_theme_btn_default" copy-common-directive copy-model="item.paramKeyHtml||item.paramKey">复制</span>',"class":"w_300"},{thKey:"类型",type:"html",selectQuery:b.structureObject,html:'<div ng-click="$ctrl.mainObject.baseFun.showDataStructure({item:item,$event:$event})" ng-class="{\'eo-status-default cp\':$ctrl.mainObject.tdList[1].selectQuery[item.paramType]}"><span class="param-type-span">{{$ctrl.mainObject.CONST.PARAM_TYPE_OBJ[item.paramType]||(\'[\'+($ctrl.mainObject.tdList[1].selectQuery[item.paramType].structureName||\'string\')+\']\')}}</span><span class="btn-hover eo_theme_btn_default" ng-if="$ctrl.mainObject.tdList[1].selectQuery[item.paramType]">更多</span></div>',"class":"w_150"},{thKey:"response"===e?"必含":"必填",type:"html",html:'{{item.paramNotNull==0?"是":""}}',"class":"w_80"},{thKey:"说明",type:"text",modelKey:"paramName","class":"ws_normal lh_1point75"},{thKey:m("JsConstructHtml_CommonFilter")('<button type="button" class="eo-operate-btn" ng-click="$ctrl.data.isSpreedBtnClick=!$ctrl.data.isSpreedBtnClick;$ctrl.data.isSpreed=true;$ctrl.mainObject.baseFun.spreedAll($event);$ctrl.data.isSpreed=false;">{@text}</button>',{text:'{{$ctrl.data.isSpreedBtnClick?"全部收缩":"全部展开"}}'}),type:"html",html:m("JsConstructHtml_CommonFilter")('<span class="eo-status-default fs12" ng-show="item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)||($ctrl.mainObject.dbFieldObj[item.dbArr[2]])">{@text}</span>',{text:'{{item.isClick?"收缩":"展开"}}'}),"class":"w_100"}]};return a},j.initCommonHeaderTable=function(e){var a={tdList:[{thKey:"标签",type:"text",modelKey:"headerName","class":"w_300"},{thKey:"内容",type:"text",modelKey:"headerValue"}]};switch(e){case"requestHeader":a=Object.assign({},a,{baseFun:{spreedAll:j.spreedAll,itemClick:j.spreedSingleItem},setting:{trDirective:'insert-Html-Common-Directive insert-type="after" template-id="paramDetail_Template_js" bind-fun="$ctrl.mainObject.baseFun.itemClick(item,$ctrl.data.isSpreed,$ctrl.data.isSpreedBtnClick)"',trNgClass:"ng-class=\"{'cp':item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)}\""}}),a.tdList.splice(1,0,{thKey:"必填",type:"html",html:'{{item.paramNotNull==1?"":"是"}}',"class":"w_80"}),a.tdList.push({thKey:m("JsConstructHtml_CommonFilter")('<button type="button" class="eo-operate-btn" ng-click="$ctrl.data.isSpreedBtnClick=!$ctrl.data.isSpreedBtnClick;$ctrl.data.isSpreed=true;$ctrl.mainObject.baseFun.spreedAll($event);$ctrl.data.isSpreed=false;">{@text}</button>',{text:'{{$ctrl.data.isSpreedBtnClick?"全部收缩":"全部展开"}}'}),type:"html",html:m("JsConstructHtml_CommonFilter")('<span class="eo-status-default fs12" ng-show="item.paramValue||item.paramLimit||(item.paramValueList.length>0&&item.paramValueList[0].value)">{@text}</span>',{text:'{{item.isClick?"收缩":"展开"}}'}),"class":"w_100"})}return a},f.fun.copyApi=function(){f.service["default"].copyApi(Object.assign({},f.ajaxRequest,{apiName:f.ajaxResponse.baseInfo.apiName,apiURI:f.ajaxResponse.baseInfo.apiURI,apiRequestType:f.ajaxResponse.baseInfo.apiRequestType,isPopupModalToWarning:!0}))},f.$onInit=function(){f.component.blockListObject.response=j.initLevelTable("response"),f.component.blockListObject.body=j.initLevelTable("body"),f.component.blockListObject.queryParam=j.initLevelTable("queryParam"),f.component.blockListObject.restful=j.initLevelTable("restful"),f.component.blockListObject.responseHeader=j.initCommonHeaderTable("responseHeader"),f.component.blockListObject.requestHeader=j.initCommonHeaderTable("requestHeader");var e={array:[],menu:[]};switch(f.ajaxRequest.groupID){case"-2":e.array=[{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"恢复",icon:"jiazai_shuaxin",fun:{"default":f.service["default"].recover,params:JSON.stringify(f.ajaxRequest)}},{name:"彻底删除",icon:"shanchu",fun:{"default":f.service["default"].deleteCompletely,params:JSON.stringify(f.ajaxRequest)}}]}];break;default:e.array=[{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":f.service["default"].menu,params:"'edit',"+JSON.stringify(f.ajaxRequest)}},{name:"复制",icon:"fuzhi",fun:{"default":f.fun.copyApi}},{name:"删除",icon:"shanchu",fun:{"default":f.service["default"]["delete"],params:JSON.stringify(f.ajaxRequest)}}]}],e.menu=[{key:"测试",authority:"test",value:"test"},{key:"测试用例",value:"case"},{key:"Mock API",authority:"mockApi",value:"mock"}]}f.component.menuObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回API列表",icon:"chexiao",fun:{"default":f.service["default"].menu,params:'"list",'+JSON.stringify(f.ajaxRequest)}}]},{type:"navigation","class":"menu-navigation",fun:f.service["default"].menu,value:"detail",tabList:[{key:"API",value:"detail"}].concat(e.menu)}].concat(e.array),setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}}}}angular.module("eolinker.ams").component("homeProjectInsideApiDetail",{templateUrl:"module/ams/ui/project/inside/content/api/detail/index.html",controller:e}),e.$inject=["RESPONSE_TEXT","API_AMS_CONSTANT","NOTICE_MEMBER_OBJ","ListBlock_CommonComponentService","$scope","Authority_CommonService","ApiManagementResource","$state","CODE","$rootScope","$filter","Operate_CommonService","HomeProjectApi_Service","Group_MultistageService","GroupService"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}!function(){function e(e,a,t,s,i,r,n,o,p,u,c,l,m,d,f,y,b,I){var h=this,j={cache:s},R={updateDesc:"",dbFieldObj:{},htmlTmpArr:i.get("module/ams/ui/project/inside/content/api/edit/index.tmp.html").split("<eo-divide></eo-divide>")},S={bodyParamObject:{},beforeApiObject:{},responseParamObject:{},structDataObj:{}},x={demoMaxLen:a,TAB_BLOCK_LIST_CONF:{setting:{trClass:"hover-tr-lbcc"},tdList:[{type:"checkbox",isWantedToExposeObject:!0,checkboxClickAffectTotalItem:!0,activeKey:"value",activeValue:1},{thKey:"列表项",type:"text",modelKey:"key"}]},STRUCT_TYPE_OBJ:{16:"XML",0:"Form-data",15:"JSON",12:"Array",13:"Object",17:"Enum"},defaultTypeList:[{value:"0",name:"[string]"},{value:"1",name:"[file]"},{value:"2",name:"[json]"},{value:"3",name:"[int]"},{value:"4",name:"[float]"},{value:"5",name:"[double]"},{value:"6",name:"[date]"},{value:"7",name:"[datetime]"},{value:"8",name:"[boolean]"},{value:"9",name:"[byte]"},{value:"10",name:"[short]"},{value:"11",name:"[long]"},{value:"12",name:"[array]"},{value:"13",name:"[object]"},{value:"14",name:"[number]"},{value:"15",name:"[null]"}],jsonTypeList:[{value:"0",name:"[string]"},{value:"12",name:"[array]"},{value:"13",name:"[object]"},{value:"14",name:"[number]"},{value:"15",name:"[null]"},{value:"2",name:"[json]"},{value:"3",name:"[int]"},{value:"4",name:"[float]"},{value:"5",name:"[double]"},{value:"6",name:"[date]"},{value:"7",name:"[datetime]"},{value:"8",name:"[boolean]"},{value:"10",name:"[short]"},{value:"11",name:"[long]"}]},T={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:c.params.projectHashKey,groupID:c.params.groupID,apiID:c.params.apiID},g={};h.data={bodyTabBlockObj:{selectAll:!1},responseTabBlockObj:{selectAll:!1},typeSelect:[],apiGroup:null,menuType:"body",isSendNotice:!0,tabBlockListHtml:'<list-Block-Common-Component class="w_200 dp_b tab_block_list_mcc" active-object="$ctrl.otherObj.active" list="$ctrl.otherObj.list" main-object="$ctrl.otherObj.conf"></list-Block-Common-Component>',contentType:{array:[{key:"Auto",value:""},{key:"Text(text/plain)",value:"text/plain"},{key:"JSON(application/json)",value:"application/json"},{key:"Javascript(application/javascript)",value:"application/javascript"},{key:"XML(application/xml)",value:"application/xml"},{key:"XML(text/xml)",value:"text/xml"},{key:"HTML(text/html)",value:"text/html"}],current:{key:"Auto",value:""}},inputSubmited:!1,menu:0,jsonToParamObject:{headerItem:{headerName:"",headerValue:"",paramNotNull:!0,"default":0},resultItem:{paramNotNull:!0,paramName:"",paramKey:"",type:"0",paramType:"0",paramValueList:[]},resultValueItem:{value:"",paramType:"0",valueDescription:""},requestItem:{paramNotNull:!0,paramType:"0",paramName:"",paramKey:"",paramValue:"",paramLimit:"",paramNote:"",paramValueList:[],"default":0,childList:[]},requestValueItem:{value:"",paramType:"0",valueDescription:""},urlValueItem:{value:"",valueDescription:""}},script:{},responseMenuType:"response",bodyParam:[],bodyParamType:0,bodyJsonRootType:0,operateName:c.params.status},h.ajaxResponse={apiInfo:{groupID:c.params.groupID||-1,apiID:c.params.apiID,apiRichNote:"",apiMarkdownNote:"",apiNoteRaw:"",apiNoteType:"1",apiRequestParamType:"0",apiRequestRaw:"",apiHeader:[],apiRequestParam:[],apiResultParam:[],apiRestfulParam:[],apiUrlParam:[],responseHeader:[],starred:0,apiURI:"/",apiAuth:{status:"0"},advancedSetting:{requestRedirect:1},resultParamJsonType:0,fileList:[]}},h.CONST={TAB_BLOCK_LIST_ARR:[{key:"参数说明",value:"desc"},{key:"参数示例",value:"demo"},{key:"参数限制",value:"limit"}],CONVERT_TYPE_ARR:[{key:"Json",value:"response-json",expression:'ng-if="item==1"'},{key:"XML",value:"response-xml",expression:'ng-if="item==0"'}],API_STATUS_QUERY_PANEL_ARR:t.API_STATUS_QUERY_PANEL_ARR,REQUEST_DATA_MENU_ARR:e.REQUEST_DATA_ARR,RESPONSE_MENU_ARR:[{key:'<span>返回头部</span><span class="iconfont icon-circle ml5 eo-status-success" ng-show="$ctrl.otherObj.responseHeader>1"></span>',value:"responseHeader"},{key:'<span>返回结果</span><span class="iconfont icon-circle ml5 eo-status-success" ng-show="$ctrl.otherObj.apiResultParam>1"></span>',value:"response"}],responseTypeQuery:[{key:"JSON",value:0},{key:"XML",value:1},{key:"Raw",value:2},{key:"Binary",value:3}],requestMethodQuery:t.METHOD_SELECT_QUERY,requestProtocolQuery:[{key:"HTTP",value:"0"},{key:"HTTPS",value:"1"}],jsonTypeQuery:[{key:"Object",value:0},{key:"Array",value:1}],requestHeader:d.REQUEST_HEADER,requestParamLimit:d.REQUEST_PARAM,lazyload:b.LAZY_EDITOR,scriptTypeQuery:[{key:"请求预处理",value:"0"},{key:"响应预处理",value:"1"}],noteTypeQuery:[{key:"Markdown",value:"1"},{key:"富文本编辑器",value:"0"}],requestTypeQuery:[{key:"Form-data",value:0},{key:"JSON",value:2},{key:"XML",value:3},{key:"Raw",value:1},{key:"Binary",value:4}]},h.fun={},h.service={authority:I},h.component={bodyTabBlockListObj:Object.assign({},x.TAB_BLOCK_LIST_CONF,{baseFun:{teardownWhenCheckboxIsClick:function(e,a){g.setTabListStorage("API_EDIT_BODY_TAB_BLOCK_LIST",e,a)}}}),responseTabBlockListObj:Object.assign({},x.TAB_BLOCK_LIST_CONF,{baseFun:{teardownWhenCheckboxIsClick:function(e,a){g.setTabListStorage("API_EDIT_RESPONSE_TAB_BLOCK_LIST",e,a)}}}),blockListObject:{},menuObject:{list:[]},selectPersonCommonComponentObject:{},selectMultistageCommonComponentObject:{"new":{},original:{}},tagObject:{query:[],flag:0},packageAdminObj:{setting:{editable:!0,isWantToExposeFunConstructIdArr:!0},requestBody:{spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,type:0},uploadResource:u.Package.Upload},packageAdminExposeObj:{}},h.fun.clickResponseDemo=function(e){var a=void 0,t=void 0,s=void 0,i=["200","302","404","500","502"];switch(e){case"success":t="Success",s="成功示例";break;case"failure":t="Failure",s="失败示例"}a={name:s,code:i.indexOf(h.ajaxResponse.apiInfo[e+"Code"])===-1?"0":h.ajaxResponse.apiInfo[e+"Code"],customCode:i.indexOf(h.ajaxResponse.apiInfo[e+"Code"])===-1?h.ajaxResponse.apiInfo["api"+t+"StatusCode"]:"",contentType:h.ajaxResponse.apiInfo["api"+t+"ContentType"],text:h.ajaxResponse.apiInfo["api"+t+"Mock"]||""},m.Ams_ResponseDemoModal(a,function(a){a&&(h.ajaxResponse.apiInfo[e+"Code"]=a.code,h.ajaxResponse.apiInfo["api"+t+"StatusCode"]=a.customCode,h.ajaxResponse.apiInfo["api"+t+"ContentType"]=a.contentType,h.ajaxResponse.apiInfo["api"+t+"Mock"]=a.text)})},g.changeResponseType=function(e){h.fun.changeVarType("response",e)},g.changeBodyType=function(e){h.fun.changeVarType("body",e)},g.setTabListStorage=function(e,a,t){var s={};t.map(function(e){a.indexAddress.hasOwnProperty(e.value)?s[e.value]=a.indexAddress[e.value]:delete s[e.value]}),window.localStorage.setItem(e,JSON.stringify(s))},g.filterStructDataStringify=function(e,a){if(!/(paramID)|(structureID)|(structureName)|(structureTypeString)/.test(e))return a},g.queryIterationPlan=function(){h.ajaxResponse.planList=j.cache.getItem("PROJECT_ITETATION_PLAN_LIST"),h.ajaxResponse.planList||u.Iteration.Query({spaceKey:T.spaceKey,projectHashKey:T.projectHashKey}).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:h.ajaxResponse.planList=e.planList||[],j.cache.setItem("PROJECT_ITETATION_PLAN_LIST",h.ajaxResponse.planList)}})},h.fun.formToOtherType=function(e){switch(e){case"get":R.manualChangeUrl=!1,h.ajaxResponse.apiInfo.apiUrlParam=JSON.parse(JSON.stringify(h.data.bodyParam,g.filterStructDataStringify)),h.data.menuType="url";break;case"body":h.fun.changeBodyType(0,angular.copy(h.ajaxResponse.apiInfo.apiRestfulParam)),h.data.menuType="body";break;case"response-json":var a=JSON.parse(JSON.stringify(h.ajaxResponse.apiInfo.apiResultParam,g.filterStructDataStringify));a.push(angular.copy(h.component.blockListObject.response.itemStructure)),h.fun.changeResponseType(0,a);break;case"response-xml":var t=[];for(var s in h.ajaxResponse.apiInfo.apiResultParam){s=parseInt(s);var i=h.ajaxResponse.apiInfo.apiResultParam[s];if(!(0===s||s>0&&i.listDepth>h.ajaxResponse.apiInfo.apiResultParam[0].listDepth))break;t.push(i)}h.fun.changeResponseType(1,JSON.parse(JSON.stringify(t,g.filterStructDataStringify)));break;default:var r={paramType:3,paramObject:y("paramLevelFilter")(h.data.bodyParam,{munalFilter:!0,munalReplaceKey:!0})};switch(e){case"json":r.paramType=2;break;case"xml":r.paramObject=[r.paramObject[0]]}h.fun.changeBodyType(r.paramType,JSON.parse(JSON.stringify(r.paramObject,g.filterStructDataStringify)))}},h.fun.changeResponseType=function(e,a){switch(S.responseParamObject[h.ajaxResponse.apiInfo.resultParamType]=angular.copy(h.ajaxResponse.apiInfo.apiResultParam),h.ajaxResponse.apiInfo.resultParamType=e,a&&0===a.length&&(a=null),e){case 0:case 1:h.component.blockListObject.response.setting.munalHideOperateColumn=1==e,h.ajaxResponse.apiInfo.apiResultParam=angular.copy(a||S.responseParamObject[e]||[{paramKey:"",paramInfo:"",paramType:"0",listDepth:0,paramNotNull:!0}]),1===e?(h.ajaxResponse.apiInfo.apiResultParam[0].paramType=13,h.component.blockListObject.response.setting.isStaticFirstIndex=!0,h.component.blockListObject.response.setting.unSortIndex=0):(delete h.component.blockListObject.response.setting.unSortIndex,delete h.component.blockListObject.response.setting.isStaticFirstIndex,1===h.ajaxResponse.apiInfo.apiResultParam.length&&(h.ajaxResponse.apiInfo.apiResultParam[0].isLast=!0));break;case 2:case 3:h.ajaxResponse.apiInfo.apiResultParam=a||S.responseParamObject[e]||""}},h.fun.changeVarType=function(e,a){var t=a.item,s=null;if(!t.hasOwnProperty("paramID")){switch(e){case"response":s=h.ajaxResponse.apiInfo.apiResultParam;break;case"body":s=h.data.bodyParam}switch(t.paramType.toString()){case"2":case"12":case"13":if(!t.templateChildList)return;var i=s.slice(0,a.$index+1).concat(t.templateChildList||[]).concat(s.slice(a.$index+1,s.length));switch(e){case"response":h.ajaxResponse.apiInfo.apiResultParam=i;break;case"body":h.data.bodyParam=i}t.templateChildList=null;break;default:if(t.templateChildList)return;for(var r=a.$index+1;r<s.length&&!(s[r].listDepth<=s[a.$index].listDepth);)r++;t.templateChildList=s.splice(a.$index+1,r-a.$index-1)}}},h.fun.changeBodyType=function(e,a){switch(S.bodyParamObject[h.data.bodyParamType]=angular.copy(h.data.bodyParam),h.data.bodyParamType=e,e){case 0:case 2:case 3:0==e?(h.component.blockListObject.body.setting.isLevel=!1,h.component.blockListObject.body.tdList[3].selectQuery=angular.copy(x.defaultTypeList).concat(angular.copy(h.data.typeSelect.slice(16,h.data.typeSelect.length)))):(h.component.blockListObject.body.setting.isLevel=!0,h.component.blockListObject.body.tdList[3].selectQuery=angular.copy(x.jsonTypeList).concat(angular.copy(h.data.typeSelect.slice(16,h.data.typeSelect.length)))),h.data.bodyParam=angular.copy(a||S.bodyParamObject[e]||[Object.assign({},h.component.blockListObject.body.itemStructure,{listDepth:0})]),3===e?(h.data.bodyParam[0].paramType=13,h.component.blockListObject.body.setting.unSortIndex=0,h.component.blockListObject.body.setting.isStaticFirstIndex=!0,h.component.blockListObject.body.setting.munalHideOperateColumn=!0,1===h.data.bodyParam.length&&delete h.data.bodyParam[0].isLast):(delete h.component.blockListObject.body.setting.unSortIndex,delete h.component.blockListObject.body.setting.isStaticFirstIndex,h.component.blockListObject.body.setting.munalHideOperateColumn=!1)}},h.fun.quickSelectContentType=function(e,a){a&&a.stopPropagation(),e?/content-type/i.test(h.ajaxResponse.apiInfo.apiHeader[0].headerName)?h.ajaxResponse.apiInfo.apiHeader.splice(0,1,{headerName:"Content-Type",headerValue:e,paramNotNull:!0}):h.ajaxResponse.apiInfo.apiHeader.splice(0,0,{headerName:"Content-Type",headerValue:e,paramNotNull:!0}):h.ajaxResponse.apiInfo.apiHeader.splice(0,1)},h.fun.quickSetExpression=function(e){var a={javascript:"",callback:null};a.javascript=e.value,o.$broadcast("$InsertText_AceEditorAms_Code_Ace_Editor_Js",a.javascript,e.offset)},m.global.$watch.push(o.$watch('$ctrl.ajaxResponse.apiInfo.apiHeader[0]["headerValue"]',function(){try{if(/content-type/i.test(h.ajaxResponse.apiInfo.apiHeader[0].headerName))switch(h.ajaxResponse.apiInfo.apiHeader[0].headerValue.toLowerCase()){case"text/plain":h.data.contentType.current=h.data.contentType.array[1];break;case"application/json":h.data.contentType.current=h.data.contentType.array[2];break;case"application/javascript":h.data.contentType.current=h.data.contentType.array[3];break;case"application/xml":h.data.contentType.current=h.data.contentType.array[4];break;case"text/xml":h.data.contentType.current=h.data.contentType.array[5];break;case"text/html":h.data.contentType.current=h.data.contentType.array[6];break;default:h.data.contentType.current={key:"Auto",value:""}}else h.data.contentType.current={key:"Auto",value:""}}catch(e){}})),h.fun.menu=function(e){h.data.menu=e.value},g.filterGlobalParam=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";/{{(((?!(}})).)*)}}/.test(e);)e=e.replace(/{{(((?!(}})).)*)}}/g,"$1");return e},h.fun.oprUri=function(e){switch(e){case"focus":R.focusOriginalUri=g.filterGlobalParam(h.ajaxResponse.apiInfo.apiURI);break;case"blur":var a=g.filterGlobalParam(h.ajaxResponse.apiInfo.apiURI),t=R.focusOriginalUri.match(/{(((?!(})).)*)}/g)||[],s=a.match(/{(((?!(})).)*)}/g)||[],i=[];h.ajaxResponse.apiInfo.apiRestfulParam=h.ajaxResponse.apiInfo.apiRestfulParam.filter(function(e,a){var r=t.indexOf("{"+e.paramKey+"}");if(r!==-1){if(!s[r])return!1;e.paramKey=s[r].replace(/{(.*)}/,"$1"),i.push(r)}return e}),s=s.filter(function(e,a){return i.indexOf(a)===-1&&e}),h.ajaxResponse.apiInfo.apiRestfulParam.map(function(e){var a=s.indexOf("{"+(e.paramKey||"")+"}");a!==-1&&s.splice(a,1)}),s.map(function(e){h.ajaxResponse.apiInfo.apiRestfulParam.splice(h.ajaxResponse.apiInfo.apiRestfulParam.length-1,0,{paramKey:e.replace(/{(.*)}/,"$1"),paramNotNull:1,paramType:"0"})})}},g.initStatus=function(e){return t.API_STATUS_QUERY[e||0].key},g.initRequestType=function(e){var a=t.METHOD_ARR;return a[e]},g.paramMoreSetting=function(e,a){var t={body:"请求参数",restful:"REST参数",response:"返回参数",url:"Query参数",header:"请求头部"},s={header:"headerName"},i={header:"headerValue"},r={title:t[e]+"详情",status:e,item:angular.copy(a.item),constant:h.CONST.requestParamLimit,typeSelect:"url"===e?h.data.jsonTypeSelect:h.data.typeSelect,keyModelName:s[e],valueModelName:i[e],ajaxRequest:{spaceKey:T.spaceKey,projectHashKey:T.projectHashKey},dbCache:S.dbCache,resource:u};if("header"===e)r.filterParamType=!0,r.filterParamDemo=!0,r.filterDb=!0;else if(!h.service.authority.spacePermission.dbm.look)if(a.item.dbArr&&R.dbFieldObj[a.item.dbArr[2]]){r.dbReadonly=!0;var n=R.dbFieldObj[a.item.dbArr[2]];r.dbCache={dbList:[{name:n.databaseName,id:n.databaseID}],tableObj:{},fieldObj:{}},r.dbCache.tableObj[n.databaseID]=[{name:n.tableName,id:n.tableID}],r.dbCache.fieldObj[n.tableID]=[{name:n.fieldName,id:n.fieldID}]}else r.filterDb=!0;r.item.paramValueList=r.item.paramValueList||[],m.AMS_RequestParamEditModal(r,function(t){if(S.dbCache=t.dbCache,!t.isClose)switch(e){case"body":"structure"!=a.type?h.data.bodyParam.splice(a.$index,1,t.item):h.data.bodyParam[a.$parentIndex].structureData.splice(a.$index,1,t.item);break;case"restful":h.ajaxResponse.apiInfo.apiRestfulParam.splice(a.$index,1,t.item);break;case"url":h.ajaxResponse.apiInfo.apiUrlParam.splice(a.$index,1,t.item);break;case"response":h.ajaxResponse.apiInfo.apiResultParam.splice(a.$index,1,t.item);break;case"header":h.ajaxResponse.apiInfo.apiHeader.splice(a.$index,1,t.item)}})},h.fun.back=function(){"add"==h.data.operateName?c.go("home.ams.project.inside.api.list",{groupID:T.groupID}):c.go("home.ams.project.inside.api.detail",{groupID:T.groupID,apiID:T.apiID})},g.generateLog=function(e){var a={basic:[]};return h.component.selectMultistageCommonComponentObject.original.value!=h.component.selectMultistageCommonComponentObject["new"].value&&a.basic.push("[编辑] 分组:\n原始值:"+h.component.selectMultistageCommonComponentObject.original.text+"\n新值: "+h.component.selectMultistageCommonComponentObject["new"].text+"\n-"),e.apiStatus!=S.beforeApiObject.apiStatus&&a.basic.push("[编辑] API状态:\n原始值:"+g.initStatus(S.beforeApiObject.apiStatus)+"\n新值: "+g.initStatus(e.apiStatus)+"\n-"),e.apiProtocol!=S.beforeApiObject.apiProtocol&&a.basic.push("[编辑] 请求协议:\n原始值:"+(0==S.beforeApiObject.apiProtocol?"http":"https")+"\n新值: "+(0==e.apiProtocol?"http":"https")+"\n-"),e.apiRequestType!=S.beforeApiObject.apiRequestType&&a.basic.push("[编辑] 请求方式:\n原始值:"+g.initRequestType(S.beforeApiObject.apiRequestType)+"\n新值: "+g.initRequestType(e.apiRequestType)+"\n-"),(e.apiURI||"")!=(S.beforeApiObject.apiURI||"")&&a.basic.push("[编辑] 请求地址:\n原始值:"+S.beforeApiObject.apiURI+"\n新值: "+e.apiURI+"\n-"),(e.apiName||"")!=(S.beforeApiObject.apiName||"")&&a.basic.push("[编辑] API名称:\n原始值:"+S.beforeApiObject.apiName+"\n新值: "+e.apiName+"\n-"),a.basic.length>0&&a.basic.unshift("\n=====\n\n#基础信息\n\n====="),a.basic.join("\n")},g.filterUnUpdateStructParam=function(e,a){var t={};e=angular.copy(e);var s=e.paramNotNull?"0":"1";return e.structureIsHide&&(t.structureIsHide=!0),a.paramNotNull!==s&&(t.paramNotNull=s),a.paramType!==e.paramType&&(t.paramType=e.paramType),a.paramName!==e.paramName&&(t.paramName=e.paramName),a.paramValue!==e.paramValue&&(t.paramValue=e.paramValue),a.paramLimit!==e.paramLimit&&(t.paramLimit=e.paramLimit),a.paramNote!==e.paramNote&&(t.paramNote=e.paramNote),a["default"]!==e["default"]&&(t["default"]=e["default"]),JSON.stringify(a.paramValueList)!==JSON.stringify(e.paramValueList)&&(t.paramValueList=e.paramValueList),t},g.checkIsStruct=function(e,a,t){/^S/.test(e.paramType)?t.indexOf(e.paramType.substr(1))===-1&&t.push(e.paramType.substr(1)):e.paramType>999&&a.indexOf(e.paramType)===-1&&a.push(e.paramType),e.paramValueList&&e.paramValueList.length>0&&angular.forEach(e.paramValueList,function(e,s){/^S/.test(e.paramType)?t.indexOf(e.paramType.substr(1))===-1&&t.push(e.paramType.substr(1)):e.paramType>999&&a.indexOf(e.paramType)===-1&&a.push(e.paramType)})},g.filterJsonStringify=function(e,a){if(!/(\$\$hashKey)|(isLast)|(\$index)|(paramID)|(mouseLeave)|(moreParam)|(valueID)|(templateChildList)|(listDepth)|(paramKeyHtml)|(isHide)|(isShrink)/.test(e))return a},g.checkForm=function(e){var a={spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,groupID:h.component.selectMultistageCommonComponentObject["new"].value,apiManagerConnID:h.component.selectPersonCommonComponentObject.value,apiID:T.apiID,apiRestfulParam:"",apiResultParam:"",apiUrlParam:"",responseHeader:"",apiTag:JSON.stringify(h.component.tagObject.query||[]),starred:h.ajaxResponse.apiInfo.starred,apiStatus:h.ajaxResponse.apiInfo.apiStatus,apiProtocol:h.ajaxResponse.apiInfo.apiProtocol,apiRequestType:h.ajaxResponse.apiInfo.apiRequestType,apiURI:h.ajaxResponse.apiInfo.apiURI,apiName:h.ajaxResponse.apiInfo.apiName,apiSuccessMock:h.ajaxResponse.apiInfo.apiSuccessMock,apiFailureMock:h.ajaxResponse.apiInfo.apiFailureMock,apiHeader:h.ajaxResponse.apiInfo.apiHeader,apiNote:"1"==h.ajaxResponse.apiInfo.apiNoteType?h.ajaxResponse.apiInfo.apiMarkdownNote:h.ajaxResponse.apiInfo.apiRichNote,apiNoteRaw:h.ajaxResponse.apiInfo.apiNoteRaw,apiNoteType:h.ajaxResponse.apiInfo.apiNoteType,apiRequestParamType:h.data.bodyParamType,apiRequestParamJsonType:h.data.bodyJsonRootType,resultParamJsonType:h.ajaxResponse.apiInfo.resultParamJsonType,resultParamType:h.ajaxResponse.apiInfo.resultParamType,apiFailureStatusCode:"",apiSuccessStatusCode:"",apiFailureContentType:h.ajaxResponse.apiInfo.apiFailureContentType,apiSuccessContentType:h.ajaxResponse.apiInfo.apiSuccessContentType,beforeInject:h.ajaxResponse.apiInfo.beforeInject,afterInject:h.ajaxResponse.apiInfo.afterInject,apiAuth:'{"status":"0"}',advancedSetting:JSON.stringify(h.ajaxResponse.apiInfo.advancedSetting),structureID:[],databaseFieldID:[],globalStructureID:[]};switch(h.ajaxResponse.apiInfo.apiAuth.status){case"1":a.apiAuth=JSON.stringify({status:"1",basicAuth:h.ajaxResponse.apiInfo.apiAuth.basicAuth});break;case"2":a.apiAuth=JSON.stringify({status:"2",jwtAuth:h.ajaxResponse.apiInfo.apiAuth.jwtAuth})}var t={apiRequestParam:[],apiResultParam:[],apiHeader:[],apiUrlParam:[],apiRestfulParam:[],responseHeader:[],fun:null};switch(h.check=!1,h.data.operateName){case"edit":a.noticeType=h.data.isSendNotice?0:1}h.ajaxResponse.apiInfo.successCode&&"0"!==h.ajaxResponse.apiInfo.successCode?a.apiSuccessStatusCode=h.ajaxResponse.apiInfo.successCode:a.apiSuccessStatusCode=h.ajaxResponse.apiInfo.apiSuccessStatusCode||"200",h.ajaxResponse.apiInfo.failureCode&&"0"!==h.ajaxResponse.apiInfo.failureCode?a.apiFailureStatusCode=h.ajaxResponse.apiInfo.failureCode:a.apiFailureStatusCode=h.ajaxResponse.apiInfo.apiFailureStatusCode||"200",a.apiSuccessStatusCode&&a.apiFailureStatusCode||(h.check=!0),t.parseHeaderFun=function(e,a){var t=[];for(var s in e){var i=e[s];if(!i.headerName&&i.headerValue)return void(h.check=!0);i.headerName&&(i=angular.copy(i),"responseHeader"===a?(delete i.paramNotNull,delete i["default"]):i.paramNotNull=i.paramNotNull?"0":"1",delete i.paramType,t.push(i)),delete i.paramType}return t};var s=function(e){var t=[];for(var s in e){var i=e[s];if(!i.paramKey&&i.paramName)return void(h.check=!0);i.paramKey&&(i=angular.copy(i),"1"==i.paramType&&(i.paramValueList=[]),i.paramNotNull=i.paramNotNull?"0":"1",i.dbArr&&i.dbArr[2]&&a.databaseFieldID.indexOf(i.dbArr[2])===-1&&a.databaseFieldID.push(i.dbArr[2]),/^S/.test(i.paramType)?a.globalStructureID.indexOf(i.paramType.substr(1))===-1&&a.globalStructureID.push(i.paramType.substr(1)):i.paramType>999&&a.structureID.indexOf(i.paramType)===-1&&a.structureID.push(i.paramType),i.paramValueList&&i.paramValueList.length>0&&i.paramValueList.map(function(e){/^S/.test(e.paramType)?a.globalStructureID.indexOf(e.paramType.substr(1))===-1&&a.globalStructureID.push(e.paramType.substr(1)):e.paramType>999&&a.structureID.indexOf(e.paramType)===-1&&a.structureID.push(e.paramType)}),t.push(i))}return t},i=function(e){return"1"==e.paramType&&(e.paramValueList=[]),e.paramNotNull=e.paramNotNull?"0":"1",e.paramKey?(e.dbArr&&e.dbArr[2]&&a.databaseFieldID.indexOf(e.dbArr[2])===-1&&a.databaseFieldID.push(e.dbArr[2]),g.checkIsStruct(e,a.structureID,a.globalStructureID),!0):e.paramName?(h.check=!0,!1):null},n=function(e,t,s){if(e.structureID){/^S/.test(e.structureID)?a.globalStructureID.indexOf(e.structureID.substr(1))===-1&&a.globalStructureID.push(e.structureID.substr(1)):a.structureID.indexOf(e.structureID)===-1&&a.structureID.push(e.structureID);for(var r={},n=t;n<s.length;n++){var o=s[n];if(n!==t&&!g.checkIsSameStructData(e,o))break;g.checkIsStruct(o,a.structureID,a.globalStructureID);var p=g.filterUnUpdateStructParam(o,S.structDataObj[e.structureID].structureData[n-t]);o.dbArr&&o.dbArr[2]&&a.databaseFieldID.indexOf(o.dbArr[2])===-1&&(p.dbArr=o.dbArr,a.databaseFieldID.push(o.dbArr[2])),"{}"!==JSON.stringify(p)&&(r[o.paramID]=p)}return{currentIndex:n,newItem:{structureID:e.structureID,updateData:r}}}return i(e)};if(!h.check)switch(h.data.bodyParamType){case 0:case 2:case 3:angular.copy(h.data.bodyParam,t.apiRequestParam),t.apiRequestParam=r.formatNestList(h.data.bodyParam,{fun:function(e,a){return n(e,a,h.data.bodyParam)}});break;case 1:a.apiRequestRaw=h.ajaxResponse.apiInfo.apiRequestRaw;break;case 4:a.apiRequestBinary=h.ajaxResponse.apiInfo.apiRequestBinary}if(h.check||(t.apiHeader=t.parseHeaderFun(h.ajaxResponse.apiInfo.apiHeader)),h.check||(t.responseHeader=t.parseHeaderFun(h.ajaxResponse.apiInfo.responseHeader,"responseHeader")),h.check||(t.apiRestfulParam=s(h.ajaxResponse.apiInfo.apiRestfulParam)),h.check||(t.apiUrlParam=s(h.ajaxResponse.apiInfo.apiUrlParam)),!h.check)switch(h.ajaxResponse.apiInfo.resultParamType){case 0:case 1:t.apiResultParam=r.formatNestList(h.ajaxResponse.apiInfo.apiResultParam,{fun:function(e,a){return n(e,a,h.ajaxResponse.apiInfo.apiResultParam)}}),h.check||(a.apiResultParam=JSON.stringify(t.apiResultParam,g.filterJsonStringify));break;case 2:case 3:a.apiResultParam=h.ajaxResponse.apiInfo.apiResultParam}return h.check||(a.responseHeader=JSON.stringify(t.responseHeader,g.filterJsonStringify),a.apiHeader=JSON.stringify(t.apiHeader,g.filterJsonStringify),a.apiUrlParam=JSON.stringify(t.apiUrlParam,g.filterJsonStringify),a.apiRequestParam=JSON.stringify(t.apiRequestParam,g.filterJsonStringify),a.apiRestfulParam=JSON.stringify(t.apiRestfulParam,g.filterJsonStringify),a.structureID=JSON.stringify(a.structureID),a.databaseFieldID=JSON.stringify(a.databaseFieldID),a.globalStructureID=JSON.stringify(a.globalStructureID)),a.apiSuccessMock&&a.apiSuccessMock.length>x.demoMaxLen&&(a.apiSuccessMock=a.apiSuccessMock.slice(0,x.demoMaxLen)),a.apiFailureMock&&h.ajaxResponse.apiInfo.apiFailureMock.length>x.demoMaxLen&&(a.apiFailureMock=h.ajaxResponse.apiInfo.apiFailureMock.slice(0,x.demoMaxLen)),"edit"==h.data.operateName&&(a.updateDesc=g.generateLog(a)),a},h.fun.load=function(e){return e.promise},h.fun.requestProcessing=function(e){var a,t=g.checkForm(),s=h.component.packageAdminExposeObj.constructIdArr?h.component.packageAdminExposeObj.constructIdArr():[];if(s)if(o.ConfirmForm.$valid&&!h.check)switch(t.fileID=s.join(","),e.status){case 0:a=g.keep({request:t});break;case 1:a=g.quickEdit({request:t});break;case 2:a=g.modify({request:t})}else m.InfoModal("Api编辑失败，请检查信息是否填写正确！","error"),h.data.inputSubmited=!0;else m.InfoModal("目前有文件尚未上传完成，请等待文件上传完成！","error");return o.$emit("$TransferStation",{state:"$Init_LoadingCommonComponent",data:{promise:a}}),a},g.keep=function(e){var a=null;return a=u.Api.Add(e.request).$promise,a.then(function(a){switch(a.statusCode){case l.COMMON.SUCCESS:m.InfoModal("Api新建成功","success"),h.ajaxResponse.apiInfo={projectHashKey:T.projectHashKey,groupID:h.ajaxResponse.apiInfo.groupID,apiHeader:[],responseHeader:[],apiRequestParam:[],apiRestfulParam:[],apiResultParam:[],apiUrlParam:[],starred:0,fileList:[],apiURI:"/"},h.data.bodyParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.body.itemStructure}),S.bodyParamObject={},e.request.apiRequestRaw&&o.$broadcast("$ResetAceEditor_AmsEditor_Raw_Ace_Editor_Js"),h.data.script.type="0",o.$broadcast("$ResetAceEditor_AmsEditor_Code_Ace_Editor_Js"),o.$broadcast("$ResetInitial_SelectMultistageCommonComponent"),h.ajaxResponse.apiInfo.apiTag="",h.component.tagObject.flag++,h.ajaxResponse.apiInfo.apiStatus="0",h.ajaxResponse.apiInfo.apiProtocol="0",h.ajaxResponse.apiInfo.apiRequestType="0",h.data.bodyParamType=0,h.data.bodyJsonRootType=0,h.ajaxResponse.apiInfo.resultParamJsonType=0,h.ajaxResponse.apiInfo.apiNoteType="1",h.ajaxResponse.apiInfo.apiRichNote="",h.ajaxResponse.apiInfo.apiMarkdownNote="",h.data.inputSubmited=!1,h.ajaxResponse.apiInfo.successCode="200",h.ajaxResponse.apiInfo.failureCode="200",h.ajaxResponse.apiInfo.apiSuccessStatusCode="",h.ajaxResponse.apiInfo.apiFailureStatusCode="",h.ajaxResponse.apiInfo.apiSuccessContentType="text/html; charset=UTF-8",h.ajaxResponse.apiInfo.apiFailureContentType="text/html; charset=UTF-8",h.ajaxResponse.apiInfo.beforeInject="",h.ajaxResponse.apiInfo.afterInject="",h.ajaxResponse.apiInfo.apiAuth={status:"0"},h.ajaxResponse.apiInfo.advancedSetting={requestRedirect:1},h.ajaxResponse.apiInfo.responseHeader=r.initEditTableList([],{itemStructure:h.component.blockListObject.responseHeader.itemStructure}),h.ajaxResponse.apiInfo.apiHeader=r.initEditTableList([],{itemStructure:h.component.blockListObject.requestHeader.itemStructure}),h.fun.changeBodyType(0,r.initEditTableList([],{itemStructure:h.component.blockListObject.body.itemStructure})),h.ajaxResponse.apiInfo.apiRestfulParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.restful.itemStructure}),h.ajaxResponse.apiInfo.resultParamType=0,h.ajaxResponse.apiInfo.apiResultParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.response.itemStructure}),h.ajaxResponse.apiInfo.apiUrlParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.queryParam.itemStructure}),window.scrollTo(0,0),h.data.menu=0;break;case l.COMMON.HAD_WARNING:h.data.inputSubmited=!0;break;default:h.data.inputSubmited=!0,m.InfoModal("操作失败，请稍候再试或提交工单反馈","error")}}),a},g.quickEdit=function(e){var a=null;return a=u.Api.Edit(e.request).$promise,a.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:R.munalSave=!0,c.go("home.ams.project.inside.api.detail",{groupID:T.groupID,apiID:T.apiID}),m.InfoModal("Api编辑成功","success");break;case l.COMMON.HAD_WARNING:h.data.inputSubmited=!0;break;default:h.data.inputSubmited=!0,m.InfoModal("操作失败，请稍候再试或提交工单反馈","error")}}),a},g.modify=function(e){var a=null;if("edit"==h.data.operateName){var t={title:"更新描述",desc:e.request.updateDesc||"",content:'<p><span>更新描述</span><span class="c999 fs12">（选填）</span></p><p class="c999 mb10 mt5">填写更新描述有助于团队成员了解API的变更内容</p>'};m.CommonSingleTextareaModal(t,function(a){a.check&&(e.request.updateDesc=a.desc,u.Api.Edit(e.request).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:R.munalSave=!0,c.go("home.ams.project.inside.api.detail",{groupID:T.groupID,apiID:T.apiID}),m.InfoModal("Api编辑成功","success");break;case l.COMMON.HAD_WARNING:h.data.inputSubmited=!0;break;default:h.data.inputSubmited=!0,m.InfoModal("操作失败，请稍候再试或提交工单反馈","error")}}))})}else a=u.Api.Add(e.request).$promise,a.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:R.munalSave=!0,c.go("home.ams.project.inside.api.detail",{groupID:T.groupID,apiID:e.apiID}),m.InfoModal("Api新建成功","success");break;case l.COMMON.HAD_WARNING:h.data.inputSubmited=!0;break;default:h.data.inputSubmited=!0,m.InfoModal("操作失败，请稍候再试或提交工单反馈","error")}});return a},o.$on("$SidebarFinish",function(){h.fun.init()}),g.initStructureData=function(e){n.DataStructure.QueryData({spaceKey:T.spaceKey,projectHashKey:T.projectHashKey,module:0}).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:var a=[];switch(h.ajaxResponse.dataStructureList=e.dataStructureList,angular.forEach(h.ajaxResponse.dataStructureList,function(e,t){e.structureIndex=t;var s={name:"["+e.structureName+"]",value:e.structureID};h.data.typeSelect.push(s),h.data.jsonTypeSelect.push(s),a.push(s),S.structDataObj[e.structureID]=e}),h.data.bodyParamType){case 0:h.component.blockListObject.body.tdList[3].selectQuery=angular.copy(x.defaultTypeList.concat(a));break;case 2:case 3:h.component.blockListObject.body.tdList[3].selectQuery=angular.copy(x.jsonTypeList.concat(a))}}})},g.initCommonExpression=function(){h.data.apiGroup=f.get(),h.data.script.type="0",g.initDataStatus()},g.initDataStatus=function(){h.ajaxResponse.apiInfo.apiSuccessContentType=h.ajaxResponse.apiInfo.apiSuccessContentType||"text/html; charset=UTF-8",h.ajaxResponse.apiInfo.apiFailureContentType=h.ajaxResponse.apiInfo.apiFailureContentType||"text/html; charset=UTF-8",h.ajaxResponse.apiInfo.successCode=h.ajaxResponse.apiInfo.apiSuccessStatusCode||"200",h.ajaxResponse.apiInfo.failureCode=h.ajaxResponse.apiInfo.apiFailureStatusCode||"200",S.beforeApiObject={apiStatus:h.ajaxResponse.apiInfo.apiStatus,apiProtocol:h.ajaxResponse.apiInfo.apiProtocol,apiRequestType:h.ajaxResponse.apiInfo.apiRequestType,apiURI:h.ajaxResponse.apiInfo.apiURI,apiName:h.ajaxResponse.apiInfo.apiName}},g.initEmptyStatus=function(){S.beforeApiObject={apiStatus:"0",apiProtocol:"0",apiRequestType:"0",apiURI:"/",apiName:""}},g.parseSturctDataBlockList=function(e,a,t,s){if(e.structureID){var i=angular.copy(t)[e.structureID],r=i.structureData;return r.map(function(t,n){0===n&&(t.structureName=i.structureName,t.structureID=i.structureID,t.isGlobal=i.isGlobal,t.structureTypeString=g.getStructType(i.structureType)),t.listDepth=a+(t.listDepth||0),delete t.isLast;var o=Object.assign({},t,e.updateData[t.paramID]);s(o),r[n]=o}),r}s(e)},g.initDetail=function(){var e,a,t;if("test"===c.params.from&&(e=window.localStorage.getItem("API_QUICK_TEST_CACHE"),window.localStorage.removeItem("API_QUICK_TEST_CACHE")),"add"!=h.data.operateName)a=u.Api.Detail({spaceKey:T.spaceKey,apiID:T.apiID,groupID:T.groupID,projectHashKey:T.projectHashKey}).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:e.apiInfo.baseInfo.advancedSetting=e.apiInfo.baseInfo.advancedSetting||{
requestRedirect:1},h.ajaxResponse.apiInfo=e.apiInfo.baseInfo,R.focusOriginalUri=h.ajaxResponse.apiInfo.apiURI,h.ajaxResponse.apiInfo.fileList=e.apiInfo.fileList,h.ajaxResponse.apiInfo.responseHeader=r.initEditTableList(e.apiInfo.responseHeader,{itemStructure:h.component.blockListObject.responseHeader.itemStructure}),h.ajaxResponse.apiInfo.apiHeader=r.initEditTableList(e.apiInfo.headerInfo,{fun:function(e){e.paramNotNull="0"==(e.paramNotNull||0).toString()},itemStructure:h.component.blockListObject.requestHeader.itemStructure}),R.dbFieldObj=e.apiInfo.dbFieldObj,h.ajaxResponse.apiInfo.apiStatus=""+h.ajaxResponse.apiInfo.apiStatus,h.ajaxResponse.apiInfo.apiProtocol=""+h.ajaxResponse.apiInfo.apiProtocol,h.ajaxResponse.apiInfo.apiRequestType=""+h.ajaxResponse.apiInfo.apiRequestType,h.data.bodyParamType=h.ajaxResponse.apiInfo.apiRequestParamType,h.data.bodyJsonRootType=h.ajaxResponse.apiInfo.apiRequestParamJsonType||0,h.ajaxResponse.apiInfo.resultParamJsonType=e.apiInfo.resultParamJsonType,h.ajaxResponse.apiInfo.apiNoteType=""+h.ajaxResponse.apiInfo.apiNoteType,h.ajaxResponse.apiInfo.apiRichNote="0"==h.ajaxResponse.apiInfo.apiNoteType?h.ajaxResponse.apiInfo.apiNote:"",h.ajaxResponse.apiInfo.apiMarkdownNote="1"==h.ajaxResponse.apiInfo.apiNoteType?h.ajaxResponse.apiInfo.apiNote:"";try{e.apiInfo.authInfo.status=e.apiInfo.authInfo.status||"0"}catch(a){}switch(h.ajaxResponse.apiInfo.apiAuth=e.apiInfo.authInfo,o.$emit("$WindowTitleSet",{list:["[编辑]"+h.ajaxResponse.apiInfo.apiName,"API","API管理"]}),h.ajaxResponse.apiInfo.groupID=e.apiInfo.baseInfo.groupID,o.$broadcast("$Maunal_AceEditorAms_Raw_Ace_Editor_Js",e.apiInfo.baseInfo.apiRequestRaw),t=function(e){e.paramNotNull="0"==(e.paramNotNull||0).toString(),e.paramType=e.paramType||0,e.paramValueList=e.paramValueList||[],e.dbArr&&!R.dbFieldObj[e.dbArr[2]]&&delete e.dbArr,e.paramType<1e3&&(e.paramType=e.paramType.toString())},h.component.blockListObject.body.setting.isLevel=0!=h.data.bodyParamType,h.fun.changeBodyType(h.data.bodyParamType,r.initEditTableList(e.apiInfo.requestInfo||[],{fun:function(a,s){return g.parseSturctDataBlockList(a,s,e.apiInfo.dataStructureList,t)},munalHideOperateColumn:!!(3==h.data.bodyParamType&&e.apiInfo.requestInfo&&e.apiInfo.requestInfo.length>0),itemStructure:h.component.blockListObject.body.itemStructure})),h.ajaxResponse.apiInfo.apiRestfulParam=r.initEditTableList(e.apiInfo.restfulParam,{fun:t,itemStructure:h.component.blockListObject.restful.itemStructure}),e.apiInfo.resultParamType){case 0:case 1:h.fun.changeResponseType(parseInt(e.apiInfo.resultParamType),r.initEditTableList(e.apiInfo.resultInfo||[],{fun:function(a,s){return g.parseSturctDataBlockList(a,s,e.apiInfo.dataStructureList,t)},munalHideOperateColumn:1==e.apiInfo.resultParamType,lastFilterKey:"paramKey",itemStructure:h.component.blockListObject.response.itemStructure}));break;case 2:case 3:h.fun.changeResponseType(e.apiInfo.resultParamType,e.apiInfo.resultInfo);break;default:e.apiInfo.resultInfo.map(function(e){t(e)});var s=y("paramLevelFilter")(e.apiInfo.resultInfo,{munalReplaceKey:!0}),i=angular.copy(h.component.blockListObject.response.itemStructure);i.listDepth=0,s.push(i),h.fun.changeResponseType(0,s)}h.ajaxResponse.apiInfo.apiUrlParam=r.initEditTableList(e.apiInfo.urlParam,{fun:function(e){e.paramNotNull=!parseInt(e.paramNotNull||"0"),e.paramValueList=e.paramValueList||[]},itemStructure:h.component.blockListObject.queryParam.itemStructure})}});else if(e){o.$emit("$windowTitle",{apiName:"[新建API]"});try{h.ajaxResponse.apiInfo=JSON.parse(e)}catch(s){}o.$broadcast("$Maunal_AceEditorAms_Raw_Ace_Editor_Js",h.ajaxResponse.apiInfo.apiRequestRaw),h.data.bodyParamType=parseInt(h.ajaxResponse.apiInfo.apiRequestParamType||"0"),h.component.blockListObject.body.setting.isLevel=0!=h.data.bodyParamType,h.data.bodyJsonRootType=h.ajaxResponse.apiInfo.apiRequestParamJsonType||0,h.ajaxResponse.apiInfo.resultParamJsonType=h.ajaxResponse.apiInfo.resultParamJsonType||0,g.initEmptyStatus(),t=function(e){e.paramNotNull=e.checkbox,e.paramName="",e.paramValue="",e.paramLimit="",e.paramNote="",e.paramValueList=e.paramInfo?[{value:e.paramInfo,valueDescription:""}]:[],e["default"]=0},h.ajaxResponse.apiInfo.responseHeader=r.initEditTableList([],{itemStructure:h.component.blockListObject.responseHeader.itemStructure}),h.ajaxResponse.apiInfo.apiHeader=r.initEditTableList((h.ajaxResponse.apiInfo.apiHeader||[]).slice(0,-1),{fun:t,itemStructure:h.component.blockListObject.requestHeader.itemStructure}),h.data.bodyParam=h.ajaxResponse.apiInfo.apiRequestParam;try{"1"!==h.data.bodyParamType&&(h.data.bodyParam[h.data.bodyParam.length-1].isLast=!0)}catch(i){}h.ajaxResponse.apiInfo.apiRestfulParam=r.initEditTableList((h.ajaxResponse.apiInfo.apiRestfulParam||[]).slice(0,-1),{fun:t,itemStructure:h.component.blockListObject.restful.itemStructure}),h.ajaxResponse.apiInfo.apiUrlParam=r.initEditTableList((h.ajaxResponse.apiInfo.apiUrlParam||[]).slice(0,-1),{fun:t,itemStructure:h.component.blockListObject.queryParam.itemStructure}),h.ajaxResponse.apiInfo.apiResultParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.response.itemStructure}),h.ajaxResponse.apiInfo.resultParamType=0}else o.$emit("$windowTitle",{apiName:"[新建API]"}),h.ajaxResponse.apiInfo.resultParamType=0,h.ajaxResponse.apiInfo.apiStatus="0",h.ajaxResponse.apiInfo.apiProtocol="0",h.ajaxResponse.apiInfo.apiRequestType="0",h.ajaxResponse.apiInfo.apiNoteType="1",h.ajaxResponse.apiInfo.responseHeader=r.initEditTableList([],{itemStructure:h.component.blockListObject.responseHeader.itemStructure}),h.ajaxResponse.apiInfo.apiHeader=r.initEditTableList([],{itemStructure:h.component.blockListObject.requestHeader.itemStructure}),h.data.bodyParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.body.itemStructure}),h.ajaxResponse.apiInfo.apiRestfulParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.restful.itemStructure}),h.ajaxResponse.apiInfo.apiResultParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.response.itemStructure}),h.ajaxResponse.apiInfo.apiUrlParam=r.initEditTableList([],{itemStructure:h.component.blockListObject.queryParam.itemStructure}),g.initEmptyStatus();a?a["finally"](g.initCommonExpression):g.initCommonExpression()},g.initMemberList=function(){var e={spaceKey:T.spaceKey,hashKey:T.projectHashKey,module:0};n.ProjectMember.TotalMemberQuery(e).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:h.ajaxResponse.memberList=e.memberList,"add"===h.data.operateName&&(h.ajaxResponse.apiInfo.apiManagerConnID=e.currentUser.connID);break;default:h.ajaxResponse.memberList=[]}})},g.getStructLength=function(e,a,t){for(var s=e+1;s<a.length&&(!a[s].structureID&&a[s].paramID);s++)t&&t(a[s]);return s-e},g.checkIsSameStructData=function(e,a){return!(a.structureID||!a.paramID)},g.getStructType=function(e){return x.STRUCT_TYPE_OBJ[e]},g.deleteStructParamData=function(e){delete e.structureID,delete e.paramID,delete e.structureTypeString,delete e.structureName},g.deleteStructData=function(e,a,t){m.EnsureModal("删除该数据结构",!1,"是否要删除该数据结构的引用？<br/>该操作仅删除数据结构与API文档的关联，并不会删除实际的数据结构。",{},function(s){if(s){var i=g.getStructLength(e,a);t(i)}})},g.importStructureData=function(e,a,t,s){var i=null,r=null,n=null;switch(t){case"body":i={0:["0"],2:["15","12","13"],3:["16","12","13"]},r=h.data.bodyParamType,n=function(e){"1"===e.paramType&&0!==r?e.paramType="0":e.paramType=e.paramType||"0"};break;default:i={0:["15","12","13"],1:["16","12","13"]},r=h.ajaxResponse.apiInfo.resultParamType,n=function(e){e.paramType=e.paramType||"0"}}var o=angular.copy(h.ajaxResponse.dataStructureList),p=[],u=[];o.map(function(e,a){i[r].indexOf(e.structureType)>-1?p.push(e):(e.isDisabled=!0,u.push(e))});var c={title:"引用数据结构",radioThKey:" ",noneHtml:y("JsConstructHtml_CommonFilter")('<span>{@text_1}</span><a class="eo_link" target="_blank" ui-sref="home.ams.project.inside.public.dataStructure.default">{@text_2}</a>',{text_1:"暂无对应类型的数据结构，",text_2:"前往数据结构管理页面"}),query:p.concat(u),type:"radio",disabledTip:"当前参数类型不支持引用该数据结构",disabledModelKey:"isDisabled",queryKey:"structureIndex",tdList:[{thKey:"数据结构名称",type:"html",html:'<span class="eo-label-options plr5 ptb2 mr5" ng-if="item.isGlobal">全局</span><span>{{item.structureName}}</span>'},{thKey:"描述",type:"text",modelKey:"structureDesc","class":"pl20"},{thKey:"类型",type:"html",html:"{{$ctrl.mainObject.setting.STRUCT_TYPE_OBJ[item.structureType]}}","class":"w_100"}],setting:{STRUCT_TYPE_OBJ:x.STRUCT_TYPE_OBJ,trClass:"hover-tr-lbcc",trNgClass:"ng-class=\"{'disable-tr':item.isDisabled}\" "}};m.Product_SelectTableModal(c,function(e){if("number"==typeof e){var t=angular.copy(h.ajaxResponse.dataStructureList[e].structureData);t.map(function(t,s){t.paramNotNull=!parseInt(t.paramNotNull||"0"),0===s&&(t.isGlobal=h.ajaxResponse.dataStructureList[e].isGlobal,t.structureName=h.ajaxResponse.dataStructureList[e].structureName,t.structureID=h.ajaxResponse.dataStructureList[e].structureID,t.structureTypeString=g.getStructType(h.ajaxResponse.dataStructureList[e].structureType)),n(t),t.listDepth=(a.listDepth||0)+(t.listDepth||0),delete t.isLast}),s(t)}})},g.setStructParamDisplayStatus=function(e,a,t){if(a.structureIsHide=!a.structureIsHide,a.structureIsHide)for(e++;e<t.length&&t[e].listDepth>a.listDepth;)t[e].structureIsHide=!0,e++;else for(e--;e>=0;)t[e].listDepth<a.listDepth&&(t[e].structureIsHide=!1),e--},g.cancleStructLink=function(e,a,t){m.EnsureModal("取消该数据结构的关联",!1,"是否要独立保存该数据结构的信息到API文档中，并且取消该数据结构与API文档的关联？<br/>取消与数据结构的关联之后，数据结构的改动将不会再同步到API文档中。",{btnMessage:"确定",btnType:2},function(s){s&&(g.deleteStructParamData(a),g.getStructLength(e,t,g.deleteStructParamData))})},g.importFieldData=function(e,a){m.AMS_SelectDbFieldModal({ajaxRequest:{spaceKey:T.spaceKey,projectHashKey:T.projectHashKey},dbCache:S.dbCache},function(t){if(S.dbCache=t.dbCache,!t.isClose){var s=[];t.valueList.map(function(e){s.push({value:e.value,type:0,valueDescription:e.desc})}),a([{paramNotNull:!0,paramType:"0",paramName:t.fieldDesc,paramKey:t.fieldName,paramValue:t.defaultValue,paramLimit:"",paramNote:"",paramValueList:s,"default":0,listDepth:e.listDepth,dbArr:t.dbArr}])}})},g.reduceItemWhenIsOprDepth=function(e){switch(e.paramType){case"2":case"12":case"13":break;default:e.paramType="13"}return!0},g.initDepthTable=function(e){var a={},t=null,s=null,i=null,r=null,n=null,o=null,p={desc:1};switch(e){case"body":try{h.data.bodyTabBlockObj.indexAddress=JSON.parse(window.localStorage.getItem("API_EDIT_BODY_TAB_BLOCK_LIST"))||p}catch(u){h.data.bodyTabBlockObj.indexAddress=p}a={paramKey:"参数名",paramNotNull:"必填",xmlCheckStr:"bodyParamType===3",isLevel:!1},n=g.changeBodyType,t=function(e){g.deleteStructData(e,h.data.bodyParam,function(a){h.data.bodyParam.splice(e,a)})},s=function(e,a){g.importStructureData(e,a,"body",function(a){h.data.bodyParam=h.data.bodyParam.slice(0,e).concat(a).concat(h.data.bodyParam.slice(e,h.data.bodyParam.length))})},i=function(e,a){g.setStructParamDisplayStatus(e,a,h.data.bodyParam)},r=function(e,a){g.cancleStructLink(e,a,h.data.bodyParam)},o=function(e,a){g.importFieldData(a,function(a){h.data.bodyParam=h.data.bodyParam.slice(0,e).concat(a).concat(h.data.bodyParam.slice(e,h.data.bodyParam.length))})};break;default:try{h.data.responseTabBlockObj.indexAddress=JSON.parse(window.localStorage.getItem("API_EDIT_RESPONSE_TAB_BLOCK_LIST"))||p}catch(u){h.data.responseTabBlockObj.indexAddress=p}a={paramKey:"字段名",paramNotNull:"必含",xmlCheckStr:"resultParamType===1",isLevel:!0},n=g.changeResponseType,t=function(e){g.deleteStructData(e,h.ajaxResponse.apiInfo.apiResultParam,function(a){h.ajaxResponse.apiInfo.apiResultParam.splice(e,a)})},s=function(e,a){g.importStructureData(e,a,"response",function(a){h.ajaxResponse.apiInfo.apiResultParam=h.ajaxResponse.apiInfo.apiResultParam.slice(0,e).concat(a).concat(h.ajaxResponse.apiInfo.apiResultParam.slice(e,h.ajaxResponse.apiInfo.apiResultParam.length))})},i=function(e,a){g.setStructParamDisplayStatus(e,a,h.ajaxResponse.apiInfo.apiResultParam)},r=function(e,a){g.cancleStructLink(e,a,h.ajaxResponse.apiInfo.apiResultParam)},o=function(e,a){g.importFieldData(a,function(a){h.ajaxResponse.apiInfo.apiResultParam=h.ajaxResponse.apiInfo.apiResultParam.slice(0,e).concat(a).concat(h.ajaxResponse.apiInfo.apiResultParam.slice(e,h.ajaxResponse.apiInfo.apiResultParam.length))})}}var l={setting:{isLevel:a.isLevel,trExpression:"ng-class=\"{'structure_item_bg':item.paramID}\"",disabledSortModelKey:["paramID"],disabledSortInAndAfterModelKey:["isLast"],illegalAutomaticAddRowModelKey:"paramID"},baseFun:{sortPartLastIndex:g.checkIsSameStructData,deleteStructData:t,sortIn:g.reduceItemWhenIsOprDepth,reduceItemWhenAddChildItem:g.reduceItemWhenIsOprDepth,watchFormLastChange:function(e){delete e.item.isLast},importFieldData:o,importStructureData:s,setStructParamDisplayStatus:i,cancleStructLink:r,goToStructureEdit:function(e){window.open(c.href(e.isGlobal?"home.public.dataStructure.operate":"home.ams.project.inside.public.dataStructure.operate",{structureID:e.structureID.toString().replace("S",""),status:"edit"}))}},itemStructure:{paramNotNull:!0,paramType:"0",paramName:"",paramKey:"",paramValue:"",paramLimit:"",paramNote:"",paramValueList:[],"default":0,childList:[],isLast:!0},tdList:[{type:"html",html:y("JsConstructHtml_CommonFilter")('<span class="eo-status-tips">{@text}</span><span sv-group-handle></span>',{text:"添加"}),"class":"static_td_hpiae",itemExpression:'ng-if="item.isLast"'},{type:"sort",itemHandleExpression:'ng-hide="($first&&$ctrl.otherObject.'+a.xmlCheckStr+')||item.isLast||(!item.structureID&&item.paramID)"',itemExpression:'ng-if="!item.isLast"'},{thKey:a.paramKey,type:"depthInput",modelKey:"paramKey",tdItemExpression:"ng-class=\"{'new_text_input_hpiae':item.isLast}\"",itemExpression:'ng-class="{\'eo-input-error\':!item.paramKey&&item.paramName}" ng-disabled="item.paramID"',placeholder:a.paramKey},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType",selectQuery:"body"===e?[]:h.data.typeSelect,selectQueryExpression:"$first&&$ctrl.otherObject."+a.xmlCheckStr+"?[{name:'object',value:'13'}]:$ctrl.mainObject.tdList[3].selectQuery",modelKey:"paramType","class":"w_150",fun:n,itemExpression:'ng-if="!item.isLast"'},{thKey:a.paramNotNull,type:"checkbox",modelKey:"paramNotNull",itemDisabledExpression:"$first&&$ctrl.otherObject."+a.xmlCheckStr+"?'':'input-checkbox'",itemExpression:'ng-if="!item.isLast"',"class":"w_80"},{thKey:"说明",type:"input",modelKey:"paramName",placeholder:"参数说明",tdItemExpression:'ng-if="$ctrl.otherObject.tabBlockActiveObj.desc&&!item.isLast"'},{thKey:"示例",type:"input",modelKey:"paramValue","class":"param_value_hpiae_eoui",placeholder:"参数示例",tdItemExpression:'ng-if="$ctrl.otherObject.tabBlockActiveObj.demo&&!item.isLast"'},{thKey:"限制",type:"input",modelKey:"paramLimit","class":"param_value_hpiae_eoui",placeholder:"参数限制",tdItemExpression:'ng-if="$ctrl.otherObject.tabBlockActiveObj.limit&&!item.isLast"'},{type:"html",html:R.htmlTmpArr[0],itemExpression:'ng-if="item.isLast"',"class":"of_inherit"},{type:"btn","class":"w_250",itemExpression:'ng-if="!item.isLast"',btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:'eo-attr-tip-placeholder="add_child_btn" ng-if="item.listDepth<4'+("body"===e?"&&$ctrl.otherObject.bodyParamType!==0":"")+'&&!item.paramID"'},{key:"更多设置",operateName:"more",fun:g.paramMoreSetting,param:'"'+e+'",inputArg',itemExpression:'eo-attr-tip-placeholder="more_setting_btn" '},{key:"插入",operateName:"insert",itemExpression:'eo-attr-tip-placeholder="insert_param_btn" ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)&&!item.paramID"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)&&!item.paramID"'},{type:"html",itemExpression:' ng-if="item.paramID"',html:y("JsConstructHtml_CommonFilter")('<button type="button" class="eo-operate-btn" ng-click="$ctrl.mainObject.baseFun.setStructParamDisplayStatus($index,item)">{@text}</button>',{text:'{{item.structureIsHide?"显示字段":"隐藏字段"}}'})}]},{"class":"w_250",type:"btn",itemExpression:'ng-if="item.isLast"',btnList:[{key:"删除",operateName:"delete"}]}],extraTrHtml:y("JsConstructHtml_CommonFilter")('<div class="structure_data_hpiae f_row f_ac" ng-if="item.structureID" ><span class="eo-status-tips mr20 pl20 fs12">{@text_1}{{item.structureName}} [{{item.structureTypeString}}]</span><button type="button" class="eo-operate-btn lh_35" ng-click="$ctrl.mainObject.baseFun.deleteStructData($index,item)">{@text_2}</button><span class="c999 divide_line_hpiae pr10">|</span><button type="button" class="eo-operate-btn lh_35 mr10" ng-click="$ctrl.mainObject.baseFun.cancleStructLink($index,item)">{@text_3}</button><span class="c999 divide_line_hpiae pr10">|</span><a target="_blank" class="eo-operate-btn" ng-click="$ctrl.mainObject.baseFun.goToStructureEdit(item)">{@text_4}</a></div>',{text_1:"数据结构：",text_2:"删除该数据结构",text_3:"取消该数据结构的关联",text_4:"前往该数据结构编辑页面"})};return l},g.initLevelTable=function(e){var a=null;switch(e){case"restful":a=function(e,a){g.importFieldData(a,function(a){h.ajaxResponse.apiInfo.apiRestfulParam=h.ajaxResponse.apiInfo.apiRestfulParam.slice(0,e).concat(a).concat(h.ajaxResponse.apiInfo.apiRestfulParam.slice(e,h.ajaxResponse.apiInfo.apiRestfulParam.length))})};break;case"url":a=function(e,a){g.importFieldData(a,function(a){h.ajaxResponse.apiInfo.apiUrlParam=h.ajaxResponse.apiInfo.apiUrlParam.slice(0,e).concat(a).concat(h.ajaxResponse.apiInfo.apiUrlParam.slice(e,h.ajaxResponse.apiInfo.apiUrlParam.length))})}}var t={baseFun:{watchFormLastChange:function(e){delete e.item.isLast},importFieldData:a},setting:{disabledSortInAndAfterModelKey:["isLast"]},itemStructure:{paramNotNull:!0,paramType:"0",paramName:"",paramKey:"",paramValue:"",paramLimit:"",paramNote:"",paramValueList:[],"default":0,isLast:!0},tdList:[{type:"html",html:y("JsConstructHtml_CommonFilter")('<span class="eo-status-tips">{@text}</span><span sv-group-handle></span>',{text:"添加"}),"class":"static_td_hpiae",itemExpression:'ng-if="item.isLast"'},{type:"sort",itemExpression:'ng-if="!item.isLast"'},{thKey:"参数名",type:"input",modelKey:"paramKey","class":"w_300",placeholder:"参数名",tdItemExpression:"ng-class=\"{'new_text_input_hpiae':item.isLast}\"",itemExpression:"ng-class=\"{'eo-input-error':!item.paramKey&&item.paramName}\""},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType||'0'",selectQuery:[],modelKey:"paramType","class":"w_150",itemExpression:'ng-if="!item.isLast"'},{thKey:"必填",type:"checkbox",modelKey:"paramNotNull",itemExpression:'ng-if="!item.isLast"',"class":"w_80"},{thKey:"说明",type:"input",modelKey:"paramName",placeholder:"参数说明",tdItemExpression:'ng-if="!item.isLast"'},{thKey:"示例",type:"input",modelKey:"paramValue","class":"param_value_hpiae_eoui",placeholder:"参数示例",tdItemExpression:'ng-if="!item.isLast"'},{type:"html",html:R.htmlTmpArr[1],itemExpression:'ng-if="item.isLast"',"class":"of_inherit"},{type:"btn","class":"w_250",btnList:[{key:"更多设置",operateName:"more",fun:g.paramMoreSetting,param:'"'+e+'",inputArg'},{key:"插入",operateName:"insert",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]};switch(e){case"url":t.tdList[3].selectQuery=h.data.jsonTypeSelect;break;default:t.tdList[3].selectQuery=h.data.typeSelect}return t},g.initHeaderTable=function(e){var a={requiredArr:[],moreSettingArr:[],itemStructure:{headerName:"",headerValue:"",isLast:!0}};switch(e){case"requestHeader":a.requiredArr=[{thKey:"必填",type:"checkbox",modelKey:"paramNotNull",itemExpression:'ng-if="!item.isLast"',"class":"w_80"}],a.moreSettingArr=[{key:"更多设置",operateName:"more",fun:g.paramMoreSetting,param:'"header",inputArg'}],a.itemStructure=Object.assign({},a.itemStructure,{paramNotNull:!0,"default":0})}var t={itemStructure:a.itemStructure,setting:{disabledSortInAndAfterModelKey:["isLast"]},baseFun:{watchFormLastChange:function(e){delete e.item.isLast}},tdList:[{type:"html",html:y("JsConstructHtml_CommonFilter")('<span class="eo-status-tips">{@text}</span><span sv-group-handle></span>',{text:"添加"}),"class":"static_td_hpiae",itemExpression:'ng-if="item.isLast"'},{type:"sort",itemExpression:'ng-if="!item.isLast"'},{thKey:"标签",type:"autoComplete",selectQuery:d.REQUEST_HEADER,modelKey:"headerName",placeholder:"头部标签","class":"w_300",itemExpression:"ng-class=\"{'new_text_input_hpiae':item.isLast,'eo-had-input-error':item.headerValue&&!item.headerName}\""}].concat(a.requiredArr).concat([{thKey:"内容",type:"input",modelKey:"headerValue",placeholder:"头部内容",itemExpression:'ng-if="!item.isLast"'},{type:"btn","class":"w_150",btnList:a.moreSettingArr.concat([{key:"删除",operateName:"delete"}])}])};return t},h.fun.init=function(){f.get()&&g.initDetail()},h.$onInit=function(){h.data.typeSelect=angular.copy(x.defaultTypeList),h.data.jsonTypeSelect=angular.copy(x.jsonTypeList),h.component.blockListObject.body=g.initDepthTable("body"),h.component.blockListObject.requestHeader=g.initHeaderTable("requestHeader"),h.component.blockListObject.responseHeader=g.initHeaderTable(),h.component.blockListObject.restful=g.initLevelTable("restful"),h.component.blockListObject.queryParam=g.initLevelTable("url"),h.component.blockListObject.response=g.initDepthTable("response"),g.initStructureData(),g.initMemberList(),h.fun.init();var e=[],a=[];switch(h.data.operateName){case"edit":a=[{type:"btn","class":"pull-left",btnList:[{name:"保存","class":"eo_theme_btn_success block-btn",fun:{disabled:1,"default":h.fun.requestProcessing,params:{status:2}}}]}],e=[{type:"customized-html","class":"pull-left",authority:"isPay",fun:function(){h.data.isSendNotice=!h.data.isSendNotice},html:y("JsConstructHtml_CommonFilter")('<button class="ignore-notice-checkbox-btn common-btn menu-ml15" ng-click="item.fun({item:item})" ><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.activeObject.isSendNotice}"></span>{@text}</button>',{text:"发送文档变更通知给相关人员"})}];break;case"add":a=[{type:"more-btn",icon:"jiahao",name:"保存","class":"ml10 pull-left",btnClass:"eo_theme_btn_success",btnList:[{key:"保存API",fun:{disabled:1,"default":h.fun.requestProcessing,params:{status:2}}},{key:"保存并继续新建API",fun:{disabled:1,"default":h.fun.requestProcessing,params:{status:0}}}]}]}h.component.menuObject={list:[{type:"btn","class":"btn-group-li  pull-left",btnList:[{name:"add"==h.data.operateName?"返回API列表":"返回API详情",icon:"chexiao",fun:{"default":h.fun.back}}]},{type:"divide","class":"pull-left"}].concat(_toConsumableArray(a),[{type:"navigation","class":"menu-navigation",activePoint:"menu",fun:h.fun.menu,tabList:[{key:"API描述",value:0},{key:"返回示例",value:1},{key:"额外说明",value:2}]}]).concat(e),setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}},window.onbeforeunload=eoSystemObj.windowOnBeforeUnload;var t=JSON.stringify(h.data.jsonToParamObject.requestItem);h.CONST.INSERT_BODY_TYPE_ARR=[{key:'<div set-to-params="paramKey" item=\''+t+'\' reset-result="item" set-value="paramName" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.requestType==2"'},{key:'<div import-method="4" set-to-params="paramKey" item=\''+t+'\' reset-result="item" set-value="paramName" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.requestType==2"'},{key:'<div import-method="3" set-to-params="paramKey" item=\''+t+'\' reset-result="item" set-value="paramName" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.requestType==3"'}];var s=JSON.stringify(h.data.jsonToParamObject.resultItem),i=JSON.stringify(h.data.jsonToParamObject.resultValueItem);h.CONST.INSERT_RESPONSE_TYPE_ARR=[{key:'<div set-to-params="paramKey" item=\''+s+"' value-item='"+i+'\' reset-result="item" set-value="paramValueList" set-value-key="value" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.resultParamType == 0"'},{key:'<div  set-to-params="paramKey" item=\''+s+"' value-item='"+i+'\' reset-result="item" set-value="paramValueList" set-value-key="value" import-method="4" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.resultParamType == 0"'},{key:'<div  set-to-params="paramKey" item=\''+s+"' value-item='"+i+'\' reset-result="item" set-value="paramValueList" set-value-key="value" import-method="3" level-status="nest"></div>',expression:' ng-if="$ctrl.otherObj.resultParamType == 1"'}]},o.$on("$stateChangeStart",function(e,a,t){window.onbeforeunload=null,!R.munalSave&&g.generateLog(h.ajaxResponse.apiInfo)&&(e.preventDefault(),m.EnsureModal("您有未保存的内容",!1,"当前页面中存在未保存的改动，离开页面将导致改动失效，请确认是否离开当前页面？",{btnMessage:"确定",btnType:1},function(e){e&&(R.munalSave=!0,c.go(a,t))})),j.cache.clear("testInfo")})}angular.module("eolinker.ams").component("homeProjectInsideApiEdit",{templateUrl:"module/ams/ui/project/inside/content/api/edit/index.html",controller:e}),e.$inject=["API_DATA_CONST","AMS_MAX_API_DEMO_SIZE","API_AMS_CONSTANT","Cache_CommonService","$templateCache","ListBlock_CommonComponentService","GeneralFunResource","$scope","$location","ApiManagementResource","$state","CODE","$rootScope","HTTP_CONSTANT","GroupService","$filter","HTML_LAZYLOAD","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,o,i,a,s,n,r){var p=this;p.data={apiName:"",pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},p.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:a.params.projectHashKey,groupID:a.params.groupID,apiID:a.params.apiID},response:{query:null}},p.fun={init:null,deleteHistory:null,toggleHistory:null},p.service={authority:r},p.component={blockListObject:{},listPageCommonObject:null,proInsideVersionComparisonObject:{show:!1}};var c={proInsideVersionComparisonObject:{request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:a.params.projectHashKey,groupID:a.params.groupID,apiID:a.params.apiID},apiInfo:null},historyInfo:null},u={};p.data.pagination.fun=function(){e.$broadcast("$Init_LoadingPartCommonComponent")},u.compare=function(t){var o={fun:null};c.historyInfo=t.item,c.proInsideVersionComparisonObject.request.historyID=t.item.historyID,p.component.proInsideVersionComparisonObject.updateDesc=t.item.updateDesc,o.fun=function(){p.component.proInsideVersionComparisonObject.show=!0,e.$broadcast("$VersionComparison_AmsProInsideComponent",angular.copy(c.proInsideVersionComparisonObject))},c.proInsideVersionComparisonObject.apiInfo?o.fun():n.global.ajax.Detail_Api.$promise["finally"](function(){o.fun()})},p.fun.init=function(){var t={request:{spaceKey:p.interaction.request.spaceKey,projectHashKey:p.interaction.request.projectHashKey,apiID:p.interaction.request.apiID,page:p.data.pagination.page,pageSize:p.data.pagination.pageSize}};return n.global.ajax.HistoryList_Api=i.Api.HistoryList(t.request),n.global.ajax.HistoryList_Api.$promise.then(function(t){switch(p.interaction.response.query=t.apiHistoryList||[],t.statusCode){case s.COMMON.SUCCESS:p.data.pagination.msgCount=t.historyCount}p.data.apiName=t.apiName,e.$emit("$WindowTitleSet",{list:["[版本管理]"+t.apiName,"API","API管理"]})}),n.global.ajax.HistoryList_Api.$promise},p.fun.changePage=function(){p.fun.init()},u.deleteHistory=function(e){var t={request:{spaceKey:p.interaction.request.spaceKey,projectHashKey:p.interaction.request.projectHashKey,apiHistoryID:e.item.historyID,apiID:e.item.apiID}};n.EnsureModal("删除历史记录",!1,o.DELETE,{},function(o){o&&i.Api.DeleteHistory(t.request).$promise.then(function(t){switch(t.statusCode){case s.COMMON.SUCCESS:p.interaction.response.query.splice(e.$index,1),n.InfoModal("历史记录删除成功","success");break;default:n.InfoModal("删除失败，此为当前版本或当前版本已被删除！","error")}})})},u.showUpdateDesc=function(e){n.MessageModal("更新描述",'<pre style="overflow:auto">'+e.item.updateDesc+"</pre>")},u.toggleHistory=function(t){switch(t.origin){case"compare-component":t.item=c.historyInfo}var o={request:{spaceKey:p.interaction.request.spaceKey,projectHashKey:p.interaction.request.projectHashKey,apiHistoryID:t.item.historyID,apiID:t.item.apiID}};return n.global.ajax.toggleHistory_Api&&n.global.ajax.toggleHistory_Api.$cancelRequest(),n.global.ajax.toggleHistory_Api=i.Api.toggleHistory(o.request),n.global.ajax.toggleHistory_Api.$promise.then(function(o){switch(o.statusCode){case s.COMMON.SUCCESS:for(var i=0;i<p.interaction.response.query.length;i++)if(1==p.interaction.response.query[i].isNow){p.interaction.response.query[i].isNow=0;break}p.interaction.response.query[t.$index].isNow=1,n.InfoModal("切换版本成功！","success"),e.$emit("$TransferStation",{state:"$Init_LoadingCommonComponent"})}}),n.global.ajax.toggleHistory_Api.$promise},u.compare=function(e){switch(p.service.authority.product.ams){case"free":return void n.Common_UpgradeNoticeModal({mark:"AMS",module:"api_version_compare"});default:window.open(a.href("textDiff",{key:p.interaction.request.spaceKey+"#"+p.interaction.request.projectHashKey+"#"+p.interaction.request.apiID+"#"+e.item.historyID}))}},u.initTable=function(){p.component.blockListObject.query={mainObject:{tdList:[{thKey:"",type:"html",html:t("JsConstructHtml_CommonFilter")('<span class="eo-color-default current-icon" ng-if="item.isNow==1">{@text}</span>',{text:"当前"}),"class":"tac w_50 "},{thKey:"人员",type:"html",html:'<span class="logo-img pull-left" style="background-image:url({{userImage.userImage?(\''+eoSystemObj.PRE_URL_UPLOAD_FILE+"'+$ctrl.data.textObject.userImage):''}});\">&nbsp;</span><span>{{item.operator}}</span>"},{thKey:"操作时间",type:"text",modelKey:"updateTime"},{type:"btn","class":"w_250",btnList:[{key:'对比<span class="pay_label_hpiah">Pro</span>',fun:u.compare,itemExpression:"ng-class=\"{'eo-status-danger compare_btn_hpiah':$ctrl.otherObject.productType==='free'}\" ng-if=\"item.isNow==0\""},{key:"详情",fun:u.showUpdateDesc},{key:"切换",fun:u.toggleHistory,itemExpression:'ng-if="$ctrl.authorityObject.edit&&item.isNow==0"'},{key:"删除",fun:u.deleteHistory,itemExpression:'ng-if="$ctrl.authorityObject.edit&&item.isNow==0"'}]}]}}},p.$onInit=function(){u.initTable()}}angular.module("eolinker.ams").component("homeProjectInsideApiHistory",{templateUrl:"module/ams/ui/project/inside/content/api/history/index.html",controller:e}),e.$inject=["$scope","$filter","ENSURE_WARNIMG","ApiManagementResource","$state","CODE","$rootScope","Authority_CommonService"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}!function(){function e(e,t,a,r,i,s,o,n,c,l,p,u,d,m,h){var g=this;g.data={batch:{},pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},listOrderBy:JSON.parse(window.localStorage.PROJECT_SORTTYPE||'{"orderBy": 3,"asc": 0}'),filterObject:{}},g.service={home:o,authority:m},g.fun={};var f={cache:h,"default":a},y={},b={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:l.params.projectHashKey,groupID:l.params.groupID||-1,searchCondition:window.sessionStorage.getItem("COMMON_SEARCH_TIP"),apiID:[],connID:null,module:0},I={previousPage:1,preloadData:null,operatorFilterConf:{canFilterValue:"connID",canFilter:!0,filterArr:[],"class":"w_300",filterHtml:'{{item.memberNickName||item.partnerNickName||item.userNickName}}<span class="eo-status-tips fs12">（{{item.inviteCall}}）</span>'}};g.component={menuObject:{},listDefaultCommonObject:{}},g.fun.onResize=function(){window.innerWidth<=1300&&e.$emit("$TransferStation",{state:"$HomeProjectInsideSidebarShrink"})},y.resetBatchInfo=function(){g.data.batch.isOperating=!1,g.data.batch.selectAll=!1,g.data.batch.query=[],g.data.batch.indexAddress={}},y.batchBtnClickFun=function(){if(g.data.pagination.page!==Math.ceil(g.data.pagination.msgCount/g.data.pagination.pageSize)){var e={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,groupID:b.groupID,orderBy:g.data.listOrderBy.orderBy,asc:g.data.listOrderBy.asc};if(b.searchCondition&&'{"keyword":"","starred":-1}'!=b.searchCondition)try{angular.merge(e,JSON.parse(b.searchCondition)),e.apiTag&&(e.apiTag.indexOf('""')!==-1&&(e.tagFliter=1,e.apiTag=e.apiTag.replace(/("")|("",)/,"")),e.apiTag=JSON.parse(e.apiTag).join(","))}catch(t){}c.Api.QueryApiID(e).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:g.data.allQueryID=e.apiIDList}})}},y.filterQuery=function(){e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"}),y.resetBatchInfo()},y.ajaxSearchCondition=function(e,t){c.Api.getSearchConditionList({spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,groupID:b.groupID}).$promise.then(function(a){e.sortAndFilterConf.filterArr=[{apiTag:""}].concat(_toConsumableArray(a.tagList||[])),t&&(t[0].sortAndFilterConf.filterArr=t[1].sortAndFilterConf.filterArr=a.memberList||[])})},y.search=function(t){if(b.searchCondition||t.item.keyword){var a=b.searchCondition?JSON.parse(b.searchCondition):{starred:-1,keyword:""};a.keyword=t.item.keyword||"",b.searchCondition=JSON.stringify(a),window.sessionStorage.setItem("COMMON_SEARCH_TIP",b.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})}},y.translateApiStatus=function(e){return{apiStatusString:t.API_STATUS_QUERY[e].key,apiStatusClass:"eo-label-"+t.API_STATUS_QUERY[e]["class"]}},y.filter=function(e){var a={output:[],apiStatusObject:{}};for(var r in e){var i=e[r];a.apiStatusObject=y.translateApiStatus(i.apiStatus),i.apiStatusClass=a.apiStatusObject.apiStatusClass,i.apiStatusString=a.apiStatusObject.apiStatusString,i.apiRequestMethod=t.METHOD_SHOW_QUERY[i.apiRequestType].key,i.apiRequestMethodClass="eo-label-"+t.METHOD_SHOW_QUERY[i.apiRequestType]["class"],i.tmpApiURI=i.apiURI,a.output.push(i)}return a.output},y["export"]=function(){var e={cache:f.cache.get("ENV_QUERY_AMS_COMPONENT"),modal:{mark:"exceptHtml",title:"导出离线 API 文档",version:g.service.authority.product.ams,spaceKey:b.spaceKey,request:{projectHashKey:b.projectHashKey,apiID:JSON.stringify(g.data.batch.query)},resource:c.Api},fun:null};e.fun=function(){u.AMS_ExportModal(e.modal,function(e){e&&y.resetBatchInfo()})},e.cache?(e.modal.envList=e.cache,e.fun()):s.Env.All({spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,module:0}).$promise.then(function(t){f.cache.set(t.envList||[],"ENV_QUERY_AMS_COMPONENT"),e.modal.envList=e.cache,e.fun()})},y["import"]=function(){var t={modal:{title:"批量导入API",fileTypeRegex:".amsa$",group:{title:"将API导入到以下分组",parent:d.get(),groupID:parseInt(b.groupID)},inputObject:{type:"file"},secondTitle:"导入的EOLINKER AMS文件（*.amsa）"}};return t.modal.group.parent&&0!=t.modal.group.parent?void u.Common_UploadFile(t.modal,function(t){if(t){var a=new FormData;a.append("spaceKey",b.spaceKey),a.append("projectHashKey",b.projectHashKey),a.append("groupID",t.groupID),a.append("file",t.file),e.$broadcast("$Init_LoadingCommonComponent",{status:"import",request:a})}}):void u.InfoModal("请先建立分组！","error")},y.load=function(e){var t,a=e.request;return t=c.Api.Import(a).$promise,t.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:y.init();case"310200":u.InfoModal("导入成功","success");break;default:u.InfoModal("导入失败，"+i.FAILURE,"error")}}),t},y.edit=function(e){e=e||{};var t={cache:d.get(),uri:{status:e.status,groupID:l.params.groupID||(window.sessionStorage.getItem("COMMON_SEARCH_TIP")?null:b.groupID)}};t.cache&&0!=t.cache.length?("add"!==e.status&&(t.uri.apiID=e.item.apiID),l.go("home.ams.project.inside.api.edit",t.uri)):u.InfoModal("请先建立分组！","error")},y.sort=function(t){g.data.listOrderBy=t.listOrderBy,e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},y.storage=function(e){if(g.data.batch.isOperating||"-2"==b.groupID)return void y.click(e);e=e||{};var t={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:e.item.apiID};switch(e.item.starred){case 0:c.Star.Add(t).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:e.item.starred=1}});break;case 1:c.Star.Delete(t).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:e.item.starred=0}})}},y.deleteOrRemoveApi=function(e,t){var a,r={ensureModal:null,infoModal:null,resource:null},s={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey};switch(t.status){case"remove":"single"==t.mark?r.ensureModal={title:"移除API",secondTitle:"确认移除？"}:r.ensureModal={title:"移入回收站",secondTitle:"确认要把这些API移入回收站吗？您可以稍后在API回收站恢复相关API。"},r.infoModal={tip:"Api移除成功，已移入回收站"},a=c.Api.Delete;break;case"delete":r.ensureModal={title:"永久性删除Api",secondTitle:n.DELETE},r.infoModal={tip:"Api删除成功"},"batch"==t.mark&&(r.ensureModal.title="（批量）"+r.ensureModal.title),a=c.Trash.Delete}switch(t.mark){case"single":s.apiID="["+e.item.apiID+"]";break;case"batch":s.apiID=JSON.stringify(g.data.batch.query)}r.fun=function(e){y.filterQuery()},u.EnsureModal(r.ensureModal.title,!1,r.ensureModal.secondTitle,{},function(t){t&&a(s).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:r.fun(e.$index),u.InfoModal(r.infoModal.tip,"success");break;default:u.InfoModal("操作失败，"+i.FAILURE,"error")}})})},y.recover=function(e){e=e||{};var t={modal:{list:angular.copy(d.get()),title:"恢复API所到分组选择"}},a={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:"["+e.item.apiID+"]",groupID:""};return t.modal.list&&0!=t.modal.list.length?void u.SelectVisualGroupModal(t.modal,function(e){e&&(a.groupID=e.groupID,c.Trash.Recover(a).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:u.InfoModal("Api恢复成功","success"),y.filterQuery()}}))}):void u.InfoModal("暂无分组，请先建立分组再操作！","error")},y.clean=function(){var e={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey};u.EnsureModal("清空回收站",!1,"此操作无法恢复，确认清空？",{},function(t){t&&c.Trash.Clean(e).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:u.InfoModal("回收站清空成功","success"),g.service.home.envObject.object.model=[],g.data.pagination.msgCount=0}})})},y.copyApi=function(e){f["default"].copyApi({apiName:e.apiName,apiID:e.apiID,apiURI:e.tmpApiURI,projectHashKey:b.projectHashKey,spaceKey:b.spaceKey,apiRequestType:e.apiRequestType},function(t){g.service.home.envObject.object.model.splice(e.$index,0,y.filter([{apiID:t.apiID,apiURI:t.apiURI,apiName:t.apiName,apiRequestMethod:e.apiRequestMethod,apiRequestMethodClass:e.apiRequestMethodClass,apiRequestType:t.apiRequestType,apiStatus:e.apiStatus,apiStatusClass:e.apiStatusClass,apiStatusString:e.apiStatusString,apiTag:e.apiTag,createTime:e.createTime,apiUpdateTime:r("currentTimeFilter")(),clickMore:!1,groupName:e.groupName,groupPath:e.groupPath,starred:e.starred,creator:e.creator,updater:e.updater}])[0]),g.data.pagination.msgCount++})},y.click=function(e){var t={};try{t.point=e.$event.target.classList[0]}catch(a){t.point="default"}switch(t.point){case"btn-star":y.storage(e);break;case"btn-newtag":y.newTarget(e);break;case"btn-copy":y.copyApi(e.item);break;case"btn-edit":e.status="edit",y.edit(e);break;case"btn-recover":y.recover(e);break;case"btn-delete":y.deleteOrRemoveApi(e,{mark:"single",status:"delete"});break;case"btn-remove":y.deleteOrRemoveApi(e,{mark:"single",status:"remove"});break;case"btn-change-status":y.changeApiStatus("single",{item:{apiID:e.item.apiID,apiStatus:e.item.apiStatus},$index:e.$index});break;default:l.go("home.ams.project.inside.api.detail",{groupID:l.params.groupID||(window.sessionStorage.getItem("COMMON_SEARCH_TIP")?null:b.groupID),apiID:e.item.apiID})}},y.newTarget=function(e){var t={uri:{groupID:l.params.groupID||(window.sessionStorage.getItem("COMMON_SEARCH_TIP")?null:b.groupID),apiID:e.item.apiID}};window.open(l.href("home.ams.project.inside.api.detail",t.uri),"_blank")},y.batchMoveGroup=function(){var e={modal:{list:angular.copy(d.get()),title:"批量编辑API分组",current:b}},t={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:JSON.stringify(g.data.batch.query),groupID:""};return e.modal.list&&0!=e.modal.list.length?void u.SelectVisualGroupModal(e.modal,function(e){e&&(t.groupID=e.groupID,c.Api.Move(t).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:"-1"!=(b.groupID||-1).toString()&&e.groupInfo.parentGroupPath[e.groupID].indexOf(Number(b.groupID))==-1&&e.groupID!=b.groupID?y.filterQuery():(y.resetItemFromArr({groupName:e.groupName}),y.resetBatchInfo()),u.InfoModal("Api批量编辑分组成功","success");break;default:u.InfoModal("操作失败"+i.FAILURE,"error")}}))}):void u.InfoModal("暂无分组，请先建立分组再操作！","error")},y.bindIterationPlan=function(){var e={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey},t=f.cache.getItem("PROJECT_ITETATION_PLAN_LIST"),a=function(){if(!t||0==t.length)return void u.EnsureModal("暂无测试计划",!1,"暂无测试计划， 是否新建一个新的测试计划？",{btnMessage:"确定",btnType:2},function(e){if(e){var t={title:"新建迭代计划",resource:c.Iteration.AddAndBind,textArray:[{type:"input",title:"计划名称",key:"planName",value:"",maxlength:"32",pattern:"^.{1,32}$",required:!0}],datePickerObject:{type:"datePicker",title:"计划持续时间",notSameDay:!0},request:{spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:JSON.stringify(g.data.batch.query)}};u.MixInputModal(t,function(e){e&&(u.InfoModal("新建迭代计划并绑定API成功","success"),y.resetBatchInfo())})}});var a={title:"将API绑定到迭代计划",query:t,type:"radio",queryKey:"planID",tdList:[{thKey:"计划名称",type:"text",modelKey:"planName"},{thKey:"开始时间",type:"text",modelKey:"startTime"},{thKey:"结束时间",type:"text",modelKey:"endTime"}],setting:{trClass:"hover-tr-lbcc"}};u.Product_SelectTableModal(a,function(t){t&&(e.planID=t,e.apiID=JSON.stringify(g.data.batch.query),c.Iteration.BatchBindApi(e).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:u.InfoModal("绑定成功","success"),y.resetBatchInfo();break;default:u.InfoModal("操作失败"+i.FAILURE,"error")}}))})};t&&t.length>0?a():c.Iteration.Query(e).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:t=e.planList||[],a(),f.cache.setItem("PROJECT_ITETATION_PLAN_LIST",t);break;default:u.InfoModal("操作失败"+i.FAILURE,"error")}})},y.changeApiStar=function(e){var t={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:JSON.stringify(g.data.batch.query),starred:e.item.value};c.Api.ChangeStar(t).$promise.then(function(t){switch(t.statusCode){case p.COMMON.SUCCESS:y.resetItemFromArr({starred:e.item.value,apiUpdateTime:r("currentTimeFilter")()}),y.resetBatchInfo(),u.InfoModal("批量编辑星标成功","success");break;default:u.InfoModal("编辑失败，"+i.FAILURE,"error")}})},y.resetItemFromArr=function(e){var t=g.data.batch.query.length;for(var a in g.service.home.envObject.object.model){var r=g.service.home.envObject.object.model[a];if(g.data.batch.indexAddress[r.apiID]&&(g.service.home.envObject.object.model[a]=Object.assign({},r,e),t--,t<=0))return}},y.changeApiStatus=function(e,a){a=a||{};var s={apiStatusObject:{}},o={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:"single"==e?"["+a.item.apiID+"]":JSON.stringify(g.data.batch.query)};s.fun=function(t,a){o.apiStatus=a,c.Api.ChangeStatus(o).$promise.then(function(n){switch(n.statusCode){case p.COMMON.SUCCESS:switch(s.apiStatusObject=y.translateApiStatus(a),e){case"single":g.service.home.envObject.object.model[t].apiStatus=o.apiStatus,g.service.home.envObject.object.model[t].apiStatusClass=s.apiStatusObject.apiStatusClass,g.service.home.envObject.object.model[t].apiStatusString=s.apiStatusObject.apiStatusString,g.service.home.envObject.object.model[t].apiUpdateTime=r("currentTimeFilter")(),u.InfoModal("编辑状态成功","success");break;case"batch":y.resetItemFromArr({apiStatus:o.apiStatus,apiStatusClass:s.apiStatusObject.apiStatusClass,apiStatusString:s.apiStatusObject.apiStatusString,apiUpdateTime:r("currentTimeFilter")()}),y.resetBatchInfo(),u.InfoModal("批量编辑状态成功","success")}break;default:u.InfoModal("编辑状态，"+i.FAILURE,"error")}})},u.AMS_ChangeStatusModal({title:"编辑API状态",query:t.API_STATUS_QUERY_PANEL_ARR,status:a.item.apiStatus},function(e){e&&s.fun(a.$index,e.status)})},y.batchRecover=function(){var e={modal:{list:angular.copy(d.get()),title:"恢复API所到分组选择"}},t={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,apiID:JSON.stringify(g.data.batch.query),groupID:""};return e.modal.list&&0!=e.modal.list.length?void u.SelectVisualGroupModal(e.modal,function(e){e&&(t.groupID=e.groupID,c.Trash.Recover(t).$promise.then(function(e){switch(e.statusCode){case p.COMMON.SUCCESS:y.filterQuery(),u.InfoModal("Api批量恢复成功","success")}}))}):void u.InfoModal("暂无分组，请先建立分组再操作！","error")},y.init=function(t){var a={temApiTag:"",fun:null},r={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,groupID:b.groupID,orderBy:g.data.listOrderBy.orderBy,asc:g.data.listOrderBy.asc,pageSize:g.data.pagination.pageSize},i=c.Api.Query;switch(I.isQuerying=!0,t){case"preload":if(I.isQuerying=!1,r.page=g.data.pagination.page+1,I.preloadData&&r.page===I.preloadData.dataPage)return;I.preloadData={dataPage:r.page},a.fun=function(t){I.preloadData.itemNum=t.itemNum,I.preloadData.apiList=t.apiList,g.data.batch.selectAll&&g.data.allQueryID&&g.data.batch.query.length!==g.data.allQueryID.length&&(g.data.batch.selectAll=!1),g.data.pagination.msgCount=I.preloadData.itemNum,g.service.home.envObject.object.model=y.filter(g.service.home.envObject.object.model.concat(I.preloadData.apiList||[])),g.data.pagination.page++,I.preloadData=null,e.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:0}})};break;default:I.isQuerying=!1,r.page=g.data.pagination.page,a.fun=function(t){if(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0,g.data.pagination.msgCount=t.itemNum,g.service.home.envObject.object.model=y.filter(t.apiList||[]),e.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:0}}),g.data.batch.isOperating){g.data.batch.selectAll=!1;for(var a=!1,r=0;r<g.service.home.envObject.object.model.length;r++)if(g.data.batch.query.indexOf(g.service.home.envObject.object.model[r][g.component.listDefaultCommonObject.mainObject.item.primaryKey])===-1){a=!0;break}g.service.home.envObject.object.model.length&&!a&&(g.data.batch.selectAll=!0)}I.preloadData=null}}if(b.searchCondition&&'{"keyword":"","starred":-1}'!=b.searchCondition)try{angular.merge(r,JSON.parse(b.searchCondition)),r.apiTag&&(r.apiTag.indexOf('""')!==-1&&(r.tagFliter=1,r.apiTag=r.apiTag.replace(/("")(,|)/,"")),r.apiTag=JSON.parse(r.apiTag).join(","))}catch(s){}else b.groupID==-2&&(i=c.Trash.Query);return u.global.ajax.Query_Api&&u.global.ajax.Query_Api.$cancelRequest(),u.global.ajax.Query_Api=i(r),u.global.ajax.Query_Api.$promise.then(a.fun),u.global.ajax.Query_Api.$promise},y.scrollLoading=function(){var e={hasItem:g.service.home.envObject.object.model&&0!==g.service.home.envObject.object.model.length,hasNextPage:g.data.pagination.page<g.data.pagination.msgCount/g.data.pagination.pageSize,isQuerying:I.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&y.init("preload")},y.setFilter=function(t,a){var r=JSON.parse(b.searchCondition)||{keyword:"",starred:-1};switch(t){case"starred":a.selectAll?r.starred=-1:r.starred=a.query[0];break;case"creatorID":case"updaterID":case"apiStatus":case"apiTag":a.selectAll?delete r[t]:r[t]=JSON.stringify(a.query)}b.searchCondition=JSON.stringify(r),window.sessionStorage.setItem("COMMON_SEARCH_TIP",b.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},y.initColumnFilter=function(){var e={star:1,status:1,requestMethod:1,creator:1,updater:1,updateTime:1,apiTag:0,apiID:0,createTime:0,group:0};try{g.data.filterObject.indexAddress=Object.assign({},e,JSON.parse(window.localStorage.AMS_PROJECT_COLOUMN_FILTER_OBJECT))}catch(t){g.data.filterObject.indexAddress=e}for(var a in g.data.filterObject.indexAddress)0===g.data.filterObject.indexAddress[a]&&delete g.data.filterObject.indexAddress[a]},g.fun.init=function(e){switch(e=e||{},e.status){case"import":return y.load(e);case"reset":return g.data.pagination.page=1,y.init();default:return y.init()}},y.parseFilterIndexAddress=function(){var e=void 0,t={starred:-1,keyword:""},a={},r=["apiStatus","apiTag","creatorID","updaterID"];try{e=JSON.parse(b.searchCondition)||t}catch(i){e=t}return e&&(e.starred!==-1&&(a.starred={},a.starred[e.starred]=1),r.map(function(t){if(e[t]){a[t]={};var r=JSON.parse(e[t]),i=!0,s=!1,o=void 0;try{for(var n,c=r[Symbol.iterator]();!(i=(n=c.next()).done);i=!0){var l=n.value;a[t][l]=1}}catch(p){s=!0,o=p}finally{try{!i&&c["return"]&&c["return"]()}finally{if(s)throw o}}}})),a.keyword=e.keyword,a},g.$onInit=function(){f.cache.clear("ENV_QUERY_AMS_COMPONENT");var a={array:[],batchArr:[],conditionArray:[],langObject:{clickToChangeStatus:"点击修改API状态",copy:"复制"}};e.$emit("$WindowTitleSet",{list:["[列表]API","API管理"]});var r=y.parseFilterIndexAddress(),i=void 0,s={key:"标签 ",showPoint:"columnFilterObject",showVariable:"apiTag",show:1,sort:!0,html:"{{item.apiTag}}",draggableCacheMark:"tag",sortAndFilterConf:{canFilterValue:"apiTag",canFilter:!0,filterArr:[],"class":"w_200",filterHtml:'<span ng-class="{\'c999\':item.apiTag===\'\'}">{{item.apiTag===""?"空白标签":item.apiTag}}</span>',filterIndexAddress:r.apiTag,checkboxKeyIsNum:!1},filterFun:function(e){y.setFilter("apiTag",e)}};switch(g.component.listDefaultCommonObject.mainObject={item:{primaryKey:"apiID","default":[{thType:"html",showPoint:"columnFilterObject",showVariable:"star",show:1,"class":"w_30",html:"-2"==b.groupID?'<span class="iconfont" ng-show="!($ctrl.otherObject.batch.isOperating&&item.starred==0)" ng-class="{\'icon-htmal5icon24\':item.starred==1}"><span>':'<a class="btn-star iconfont" ng-if="$ctrl.authorityObject.operate" ng-show="!($ctrl.otherObject.batch.isOperating&&item.starred==0)" ng-class="{\'icon-shoucang\':item.starred==0,\'icon-htmal5icon24\':item.starred==1}"></a><span class="iconfont" ng-if="!$ctrl.authorityObject.operate" ng-class="{\'icon-htmal5icon24\':item.starred==1}"></span>',sort:!0,sortAndFilterConf:{canFilter:!0,filterArr:[{key:"无",value:0},{key:"星标",value:1}],filterHtml:"{{item.key}}",filterIndexAddress:r.starred,containerClass:"pr10 eo_to_top_10"},filterFun:function(e){y.setFilter("starred",e)}},{key:"ID",showPoint:"columnFilterObject",showVariable:"apiID",show:1,html:"{{item.apiID}}",draggableCacheMark:"id"},{thType:"html",thHtml:"APIs",sort:!0,sortOrderByVal:0,html:"-2"==b.groupID?'<span class="api-status-label {{item.apiStatusClass}}" ng-if="$ctrl.showObject.columnFilterObject.status==1" >{{item.apiStatusString}}</span><div class="name-box"><span class="api-name">{{item.apiName}}</span><span class="btn-hover eo_theme_btn_default" ng-if="!$ctrl.otherObject.batch.isOperating" copy-common-directive copy-model="item.apiName">'+a.langObject.copy+"</span></div>":'<span class="btn-change-status api-status-label {{item.apiStatusClass}}" title="'+a.langObject.clickToChangeStatus+'" ng-if="$ctrl.authorityObject.operate&&$ctrl.showObject.columnFilterObject.status==1">{{item.apiStatusString}}</span><span class="api-status-label {{item.apiStatusClass}}" ng-if="$ctrl.showObject.columnFilterObject.status==1&&!$ctrl.authorityObject.operate">{{item.apiStatusString}}</span><div class="name-box" ng-class="{\'w_100percent\':!$ctrl.showObject.columnFilterObject.status}"><span class="api-name">{{item.apiName}}</span><span class="btn-hover eo_theme_btn_default" ng-if="!$ctrl.otherObject.batch.isOperating" copy-common-directive copy-model="item.apiName" >'+a.langObject.copy+"</span></div>",draggableCacheMark:"name",sortAndFilterConf:{canFilter:!0,canSort:!0,filterHtml:"{{item.key}}","class":"w_200",filterArr:t.API_STATUS_QUERY,filterIndexAddress:r.apiStatus},filterFun:function(e){y.setFilter("apiStatus",e)}},{key:"URL","class":"cancel-nowrap",sort:!0,sortOrderByVal:4,draggableCacheMark:"url",html:'<span class="eo-method-label {{item.apiRequestMethodClass}}" ng-if="$ctrl.showObject.columnFilterObject.requestMethod==1">{{item.apiRequestMethod}}</span><div class="url-box" ng-class="{\'w_100percent\':!$ctrl.showObject.columnFilterObject.requestMethod}"><div class="api-url"><span class="api-url-text" title="{{item.apiURI}}">{{item.apiURI}}</span></div><span class="btn-hover eo_theme_btn_default" ng-if="!$ctrl.otherObject.batch.isOperating"  copy-common-directive copy-model="item.apiURI">'+a.langObject.copy+"</span></div>",sortAndFilterConf:{canSort:!0}},{key:"分组",html:"{{item.groupName}}",showPoint:"columnFilterObject",showVariable:"group",show:1,draggableCacheMark:"group"},s],operate:{"class":"w_180"}},setting:{draggable:!0,dragCacheVar:"AMS_API_LIST_DRAG_VAR",dragCacheObj:{name:"250px",url:"250px",id:"50px",tag:"150px",group:"100px",deleteTime:"150px",creator:"100px",createTime:"150px",updater:"100px",updateTime:"150px"},isFixedHeight:!0,batch:!0,page:!0,autoSort:!0,sortStorageKey:"PROJECT_SORTTYPE",sortDefaultVal:{storageVal:{orderBy:3,asc:0},sortOrder:"asc"},scroll:!0,scrollRemainRatio:7},baseFun:{click:y.click,scrollLoading:y.scrollLoading,autoSortFun:y.sort}},b.groupID){case"-2":g.data.filterObject.indexAddress={star:1,status:1,requestMethod:1,apiTag:1,group:1},a.array=[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"全部删除","class":"eo_theme_btn_danger block-btn",fun:{"default":y.clean}}]}],a.batchArr=[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"批量恢复",fun:{"default":y.batchRecover}},{name:"批量删除",fun:{"default":y.deleteOrRemoveApi,params:'arg,{"mark":"batch","status":"delete"}'}}]}],g.component.listDefaultCommonObject.mainObject.item["default"]=g.component.listDefaultCommonObject.mainObject.item["default"].concat([{key:"删除时间",html:"{{item.removeTime}}",draggableCacheMark:"deleteTime"}]),g.component.listDefaultCommonObject.mainObject.item.operate.funArr=[{key:"恢复","class":"btn-recover"},{key:"彻底删除","class":"btn-delete"}],g.component.listDefaultCommonObject.mainObject.setting.warning="尚未回收任何API";break;default:y.initColumnFilter(),a.array=[{type:"more-btn",authority:"edit",icon:"jiahao",name:"新建 API","class":"pull-left",btnClass:"eo_theme_btn_success",btnList:[{key:"新建API",fun:{"default":y.edit,params:{status:"add"}}},{key:"导入API",fun:{"default":y["import"]}}]},{type:"tab_block_list","class":"pull-right ml15",name:"列表项",icon:"shebeisousuo",blockName:"listItem",query:[{key:"ID",value:"apiID"},{key:"星标",value:"star"},{key:"API状态",value:"status"},{key:"请求方式",value:"requestMethod"},{key:"分组",value:"group"},{key:"标签",value:"apiTag"},{key:"创建者",value:"creator"},{key:"最近更新者",value:"updater"},{key:"创建时间",value:"createTime"},{key:"更新时间",value:"updateTime"}]},{type:"customized-html","class":" fun-list-li  pull-right ml0",html:'<div style="width:180px;height:30px"></div>'}],a.batchArr=[{type:"btn","class":"pull-left",authority:"editPlan",btnList:[{name:"添加到迭代计划...",fun:{"default":y.bindIterationPlan}}]},{type:"fun-list","class":"fun-list-li pull-left",name:"设置星标",authority:"edit",funList:[{key:"无",value:0,fun:{"default":y.changeApiStar}},{key:"星标",value:1,fun:{"default":y.changeApiStar}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"设置状态",fun:{"default":y.changeApiStatus,params:'"batch",arg'}}]},{type:"btn",authority:"export","class":"pull-left",btnList:[{name:"导出离线 API 文档",fun:{"default":y["export"]}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"移动",fun:{"default":y.batchMoveGroup}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"删除",fun:{"default":y.deleteOrRemoveApi,params:'arg,{"mark":"batch","status":"remove"}'}}]}],g.component.listDefaultCommonObject.mainObject.item.operate.funArr=[{key:"编辑","class":"btn-edit"},{key:"新标签打开","class":"btn-newtag"},{type:"more",key:"更多",funArr:[{key:"复制","class":"btn-copy"},{key:"删除","class":"btn-remove"}]}],g.component.listDefaultCommonObject.mainObject.setting.warning="尚未新建任何API",i=[{key:"创建者",html:"{{item.creator}}",showPoint:"columnFilterObject",showVariable:"creator",show:1,draggableCacheMark:"creator",sort:!0,sortAndFilterConf:Object.assign({},I.operatorFilterConf,{filterIndexAddress:r.creatorID}),filterFun:function(e){y.setFilter("creatorID",e)}},{key:"最近更新者",html:"{{item.updater}}",showPoint:"columnFilterObject",showVariable:"updater",show:1,draggableCacheMark:"updater",sort:!0,sortAndFilterConf:Object.assign({},I.operatorFilterConf,{filterIndexAddress:r.updaterID}),filterFun:function(e){y.setFilter("updaterID",e)}}],g.component.listDefaultCommonObject.mainObject.item["default"]=g.component.listDefaultCommonObject.mainObject.item["default"].concat([].concat(_toConsumableArray(i),[{key:"创建时间",showPoint:"columnFilterObject",showVariable:"createTime",show:1,sort:!0,sortOrderByVal:3,html:"{{item.createTime}}",draggableCacheMark:"createTime",sortAndFilterConf:{"class":"eo_to_right_0",canSort:!0}},{key:"更新时间",showPoint:"columnFilterObject",showVariable:"updateTime",show:1,sort:!0,sortOrderByVal:1,html:"{{item.apiUpdateTime}}",draggableCacheMark:"updateTime",sortAndFilterConf:{"class":"eo_to_right_0",canSort:!0}}]))}y.ajaxSearchCondition(s,i),g.component.menuObject={list:[],batchList:a.batchArr,baseFun:{batchDefault:y.batchBtnClickFun},setting:{listItemStorageName:"AMS_PROJECT_COLOUMN_FILTER_OBJECT",batchAuthority:"showBatch",batch:!0,batchInitFun:y.resetBatchInfo,titleAuthority:"showTitle",title:"API文档"}},g.component.menuObject.list=a.array.concat(g.component.menuObject.list).concat(a.conditionArray).concat([{type:"search","class":"pull-right",keyword:r.keyword||"",fun:y.search}])},u.global.$watch.push(e.$watch("$ctrl.data.batch.isOperating",function(){g.envStatus=g.data.batch.isOperating?"hide":"show"}))}angular.module("eolinker.ams").component("homeProjectInsideApiList",{templateUrl:"module/ams/ui/project/inside/content/api/list/index.html",controller:e,bindings:{envStatus:"="}}),e.$inject=["$scope","API_AMS_CONSTANT","HomeProjectApi_Service","$filter","RESPONSE_TEXT","GeneralFunResource","Operate_CommonService","ENSURE_WARNIMG","ApiManagementResource","$state","CODE","$rootScope","GroupService","Authority_CommonService","Cache_CommonService"]}();
"use strict";!function(){function e(e,t,a,i,o,n,s){var c=this;c.fun={};var p={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:a.params.projectHashKey,groupID:a.params.groupID,apiID:a.params.apiID};c.ajaxResponse={query:[]},c.service={authority:s},c.component={menuObject:{list:null},blockListObject:{}};var u={},r={"default":n};c.fun.init=function(){var a={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,apiID:p.apiID};return o.global.ajax.Query_MockExpectation=t.MockExpectation.Query(a),o.global.ajax.Query_MockExpectation.$promise.then(function(t){c.ajaxResponse.query=t.expectationList||[],c.ajaxResponse.mockURI=t.mockURI,c.ajaxResponse.apiInfo=t.apiInfo||{},e.$emit("$WindowTitleSet",{list:["[Mock测试]"+c.ajaxResponse.apiInfo.apiName,"API","API管理"]})}),o.global.ajax.Query_MockExpectation.$promise},u["delete"]=function(e){var a={title:"删除期望",message:"请问是否删除该期望？"},n={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,apiID:p.apiID,expectationID:e.item.expectationID};o.EnsureModal(a.title,!1,a.message,{},function(a){a&&t.MockExpectation.Delete(n).$promise.then(function(t){switch(t.statusCode){case i.COMMON.SUCCESS:o.InfoModal("期望删除成功","success"),c.ajaxResponse.query.splice(e.$index,1)}})})},u.previewMockData=function(e){var t={ajaxRequest:{spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,apiID:p.apiID,expectationID:e.item.expectationID},extralData:{mockURI:c.ajaxResponse.mockURI,apiRequestType:c.ajaxResponse.apiInfo.apiRequestType},authority:c.service.authority.permission.project.apiManagement};o.AMS_MockPreviewModal(t)},u.initLevelTable=function(){var e={baseFun:{trClick:u.previewMockData},tdList:[{thKey:"期望名称",type:"text",modelKey:"expectationName","class":"pl20"},{thKey:"创建者",type:"text",modelKey:"creator","class":"w_150"},{thKey:"编辑时间",type:"text",modelKey:"updateTime"},{type:"btn","class":"w_300",btnList:[{key:"预览",fun:u.previewMockData},{key:"复制",fun:c.fun.edit,param:'"copy",inputArg',authority:"mockApi"},{key:"编辑",fun:c.fun.edit,param:'"edit",inputArg',authority:"mockApi"},{key:"删除",fun:u["delete"],authority:"mockApi"}]}]};return e},c.fun.edit=function(e,t){var a={setting:{operateName:e},ajaxRequest:{spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,apiID:p.apiID}};switch(e){case"add":a.setting.title="新建Mock API期望";break;case"edit":a.ajaxRequest.expectationID=t.item.expectationID,a.setting.title="编辑Mock API期望";break;case"copy":a.ajaxRequest.expectationID=t.item.expectationID,a.setting.title="复制Mock API期望"}o.AMS_MockSettingModal(a,function(e){e&&(o.InfoModal(a.setting.title+"成功","success"),c.fun.init())})},c.$onInit=function(){c.component.blockListObject.mock=u.initLevelTable(),c.component.menuObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回API列表",icon:"chexiao",fun:{"default":r["default"].menu,params:"'list',"+JSON.stringify(p)}}]},{type:"navigation","class":"menu-navigation",fun:r["default"].menu,value:"mock",tabList:[{key:"API",value:"detail"},{key:"测试",authority:"test",value:"test"},{key:"测试用例",value:"case"},{key:"Mock API",authority:"mockApi",value:"mock"}]},{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":r["default"].menu,params:"'edit',"+JSON.stringify(p)}},{name:"复制",icon:"fuzhi",fun:{"default":function(){r["default"].copyApi(Object.assign({},p,{apiName:c.ajaxResponse.apiInfo.apiName,apiURI:c.ajaxResponse.apiInfo.apiURI,apiRequestType:c.ajaxResponse.apiInfo.apiRequestType,isPopupModalToWarning:!0}))}}},{name:"删除",icon:"shanchu",fun:{"default":r["default"]["delete"],params:JSON.stringify(p)}}]}],setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}}}}angular.module("eolinker.ams").component("homeProjectInsideApiMock",{templateUrl:"module/ams/ui/project/inside/content/api/mock/index.html",controller:e}),e.$inject=["$scope","ApiManagementResource","$state","CODE","$rootScope","HomeProjectApi_Service","Authority_CommonService"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}!function(){function e(e,t,a,o,n,s,r,c,i,p,m,u,l,d,b,f,j,y,T){var h=this;h.data=null,h.fun={},h.CONST={jsonTypeQuery:[{key:"Object",value:"0"},{key:"Array",value:"1"}],requestMethodQuery:o.METHOD_SELECT_QUERY,requestHeader:d.REQUEST_HEADER,scriptTypeQuery:[{key:"请求预处理",value:"0"},{key:"响应预处理",value:"1"}],requestTypeQuery:[{key:"Form-data",value:"0"},{key:"JSON",value:"2"},{key:"XML",value:"3"},{key:"Raw",value:"1"},{key:"Binary",value:"4"}],RAW_CONTENT_TYPE_ARR:[{key:"Auto",value:""},{key:"Text(text/plain)",value:"text/plain"},{key:"JSON(application/json)",value:"application/json"},{key:"Javascript(application/javascript)",value:"application/javascript"},{key:"XML(application/xml)",value:"application/xml"},{key:"XML(text/xml)",value:"text/xml"},{key:"HTML(text/html)",value:"text/html"}],FORM_DATA_CONTENT_TYPE_ARR:[{key:"Auto",value:""},{key:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"},{key:"multipart/form-data",value:"multipart/form-data"}]},h.serviceHome=null,h.service={authority:j},h.unitTestObjectComponent=null,h.unitTestObjectComponentOutput=null,h.component={blockListObject:{},menuObject:{list:null},unitTestObjectOutput:{}};var v=null,O={"default":f,cache:b},I={},R={Test:m.current.name.indexOf("quickTest")>-1&&!m.params.apiID?p.QuickTest:p.Test},x=null,C={API_DEMO_MAX_SIZE:e,DOMAIN_REGEX:"^(((http|ftp|https)://)|)(([\\w\\-_]+([\\w\\-\\.]*)?(\\.("+a.join("|")+")))|((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|(localhost))((\\/)|(\\?)|(:)|($))"};h.fun.adminCookie=function(){l.AMS_CookieAdminModal()},h.fun.changeTestSeverType=function(){if(h.data.plugObject.useStatus)switch(h.unitTestObjectComponent.testSeverType){case"nodejs":h.unitTestObjectComponent.testSeverType="plugin",h.data.response.responseType="text";break;default:if(!eoSystemObj.plugTransferToLocal&&new RegExp(n,"i").test(new RegExp(C.DOMAIN_REGEX).test(h.serviceHome.envObject.object.model.URL)?h.serviceHome.envObject.object.model.URL:(h.serviceHome.envObject.object.total.frontURI||"")+h.serviceHome.envObject.object.model.URL))return void l.EnsureModal("切换使用服务器测试",!1,"当前测试url为内网地址，如果切换为服务器测试会无法获得测试结果，请问是否切换？",{btnMessage:"切换为服务器测试",btnType:2,btnCancelMessage:"依然使用插件测试"},function(e){e&&(h.unitTestObjectComponent.testSeverType="nodejs",h.unitTestObjectComponent.strongSetTestByServer=!0,h.data.response.responseType="text")});h.unitTestObjectComponent.testSeverType="nodejs",h.data.response.responseType="text"}else{var e={html_1:"<div class='lh_30'><p>",html_2:"<a href='https://www.eolinker.com/#/plug/introduce' target='_blank' class='eo-status-warning' ><b>",html_3:"</b>",html_4:"</a>",html_5:"</p></div>",operate:window.plug&&"application/eolinker"==window.plug.type?"更新":"安装"},t="";t="更新"===e.operate?"{@html_1}测试增强插件已经提供新版本V5.9.3，请您先升级安装新版本插件{@html_2}[点此获取]{@html_3}{@html_4}。</br>升级插件版本后将会支持新的功能以及特性，由此带来不便之处，敬请谅解。{@html_5}":"{@html_1}如需切换使用插件测试，请先安装我们为您免费提供的 {@html_2}测试增强插件{@html_3} [点击获取]{@html_4}！{@html_5}",l.MessageModal("温馨提示",c("JsConstructHtml_CommonFilter")(t,e),{button:{sure:{content:"下载插件离线安装包",fun:function(){window.open(eoSystemObj.ADDRESS_PLUG)}}}}),h.unitTestObjectComponent.testSeverType="nodejs"}window.localStorage.setItem("EOLINKER_TEST_USE_SOFTWARE_TYPE",h.unitTestObjectComponent.testSeverType)},h.fun.setTestServerType=function(e){var t=window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE");h.unitTestObjectComponent.testSeverType="nodejs"!==t&&e?"plugin":"nodejs"},I.initVar=function(){h.unitTestObjectComponentOutput=h.cacheObject.vmUnitTestObjectComponentOutput=h.cacheObject.vmUnitTestObjectComponentOutput||{},h.unitTestObjectComponent=h.cacheObject.vmUitTestObjectComponent=h.cacheObject.vmUitTestObjectComponent||{injectScript:{}},h.data=h.cacheObject.vmData=h.cacheObject.vmData||{queryHistory:!1,isQuick:m.current.name.indexOf("quickTest")>-1,menuType:"body",format:{isJson:!0,message:""},contentType:{current:{key:"Auto",value:""}},plugObject:{needVersion:!0,num:0,timer:{disable:null,num:""}},response:{httpCodeType:2,hadTest:!1,status:"0"},jsonToParamObject:{headerItem:{headerName:"",headerValue:"",checkbox:!0},requestItem:{paramKey:"",paramValue:"",checkbox:!0,childList:[],paramType:"0"}},allObject:{body:!1},bodyParam:[],href:m.href(m.current.name,m.params),plugTransferToLocal:eoSystemObj.plugTransferToLocal},h.ajaxRequest=h.cacheObject.vmAjaxRequest=h.cacheObject.vmAjaxRequest||{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:m.params.projectHashKey,groupID:m.params.groupID,apiID:m.params.apiID},h.ajaxResponse=h.cacheObject.vmAjaxResponse=h.cacheObject.vmAjaxResponse||{apiInfo:{}},h.serviceHome=y,h.cacheObject.vmServiceHome=h.cacheObject.vmServiceHome||{envObject:{object:{model:h.serviceHome.envObject.object.model}}},h.serviceHome.envObject.object.model=h.cacheObject.vmServiceHome.envObject.object.model,v=h.cacheObject.data=h.cacheObject.data||{manualChangeUrl:!1,fileList:{}},x=h.cacheObject.cache=h.cacheObject.cache||{bodyParamObject:{}}},h.fun.formToOtherType=function(e){switch(e){case"get":v.manualChangeUrl=!1,h.ajaxResponse.apiInfo.urlParam=angular.copy(h.serviceHome.envObject.object.model.params),h.data.menuType="url";break;case"body":try{h.ajaxResponse.apiInfo.restfulParam.map(function(e,t){e.paramType="0"})}catch(t){}h.fun.changeBodyType("0",angular.copy(h.ajaxResponse.apiInfo.restfulParam,!0)),h.data.menuType="body";break;default:var a={paramType:"3",paramObject:c("paramLevelFilter")(h.serviceHome.envObject.object.model.params,{munalFilter:!0,munalReplaceKey:!0})};switch(e){case"json":a.paramType="2";break;case"xml":a.paramObject=[a.paramObject[0]]}h.fun.changeBodyType(a.paramType,a.paramObject,!0)}},h.fun.changeVarType=function(e){var t=e.item;if("0"!=h.serviceHome.envObject.object.model.requestType)switch(t.paramType.toString()){case"12":case"13":if(!t.templateChildList)return;h.serviceHome.envObject.object.model.params=h.serviceHome.envObject.object.model.params.slice(0,e.$index+1).concat(t.templateChildList||[]).concat(h.serviceHome.envObject.object.model.params.slice(e.$index+1,h.serviceHome.envObject.object.model.params.length)),t.templateChildList=null;break;default:if(t.templateChildList)return;for(var a=e.$index+1;a<h.serviceHome.envObject.object.model.params.length&&!(h.serviceHome.envObject.object.model.params[a].listDepth<=h.serviceHome.envObject.object.model.params[e.$index].listDepth);)a++;t.templateChildList=h.serviceHome.envObject.object.model.params.splice(e.$index+1,a-e.$index-1)}},h.fun.saveDemo=function(){var e={request:{spaceKey:h.ajaxRequest.spaceKey,projectHashKey:h.ajaxRequest.projectHashKey,apiID:h.ajaxRequest.apiID,mockData:O.cache.get("UNIT_TEST_RESULT"),statusCode:h.data.response.testHttpCode},tipMaxLengthFun:null,fun:function(){p.Api.AddMock(e.request).$promise.then(function(e){switch(e.statusCode){case"000000":l.InfoModal("操作成功","success");break;default:l.InfoModal("操作失败，请稍候再试或提交工单反馈","error")}})}};e.tipMaxLengthFun=function(){e.request.mockData.length>C.API_DEMO_MAX_SIZE?l.EnsureModal("温馨提示",!1,"当前返回结果超出返回示例的长度限制，保存时会对数据进行截断处理，可能影响数据的正常格式。请问是否继续保存？",{btnMessage:"继续",btnType:1},function(t){t&&(e.request.mockData=e.request.mockData.slice(0,C.API_DEMO_MAX_SIZE),e.fun())}):e.fun()},l.EnsureModal("保存测试结果",!1,"是否使用当前的测试结果替换API文档中的返回示例",{btnType:1,btnMessage:"作为成功示例",btnGroup:[{btnType:1,btnMessage:"作为失败示例",confirm:function(){e.request.mockType=1,e.tipMaxLengthFun()}}]},function(t){t&&(e.request.mockType=0,e.tipMaxLengthFun())})},I.changeApiMethodType=function(){if("1"==h.serviceHome.envObject.object.model.apiRequestType&&"nodejs"!==h.unitTestObjectComponent.testSeverType){"body"==h.data.menuType&&(h.data.menuType="headers");try{if(!v.isAlreadyInit)switch(v.isAlreadyInit=!0,h.serviceHome.envObject.object.model.requestType.toString()){case"0":v.manualChangeUrl=!1,h.ajaxResponse.apiInfo.urlParam=h.ajaxResponse.apiInfo.urlParam.slice(0,h.ajaxResponse.apiInfo.urlParam.length-1).concat(angular.copy(h.serviceHome.envObject.object.model.params))}}catch(e){}}else h.serviceHome.envObject.object.model.hasOwnProperty("apiRequestType")&&(v.isAlreadyInit=!0)},h.fun.filterTestType=function(){if(h.serviceHome.envObject.object&&h.serviceHome.envObject.object.total)return!(!h.data.plugObject.validToSwitchTestMethod||!h.data.plugObject.useStatus||"nodejs"===h.unitTestObjectComponent.testSeverType&&!new RegExp(n,"i").test(new RegExp(C.DOMAIN_REGEX).test(h.serviceHome.envObject.object.model.URL)?h.serviceHome.envObject.object.model.URL:(h.serviceHome.envObject.object.total.frontURI||"")+h.serviceHome.envObject.object.model.URL))},h.fun.downloadResponseText=function(){"nodejs"!==h.unitTestObjectComponent.testSeverType&&h.data.plugObject.useStatus&&!eoSystemObj.plugTransferToLocal||r.$broadcast("$DownloadResponseText_UnitTestComponent")},h.fun.newTabResponseText=function(){"nodejs"!==h.unitTestObjectComponent.testSeverType&&h.data.plugObject.useStatus&&!eoSystemObj.plugTransferToLocal||r.$broadcast("$NewTabResponseText_UnitTestComponent",'<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><iframe style="border: none;width: 100%;height: 100%;" src="'+h.unitTestObjectComponentOutput.blobUrl+'"></iframe></body></html>')},h.fun.changeMenuType=function(e){switch(e){case"body":(h.data.plugTransferToLocal||"1"!==h.serviceHome.envObject.object.model.apiRequestType||"nodejs"===h.unitTestObjectComponent.testSeverType)&&(h.data.menuType="body")}},h.fun.quickSelectContentType=function(e,t){t&&t.stopPropagation(),e?/content-type/i.test(h.serviceHome.envObject.object.model.headers[0].headerName)?h.serviceHome.envObject.object.model.headers.splice(0,1,{headerName:"Content-Type",headerValue:e,checkbox:!0,isStaticTop:!0}):h.serviceHome.envObject.object.model.headers.splice(0,0,{headerName:"Content-Type",headerValue:e,checkbox:!0,isStaticTop:!0}):/content-type/i.test(h.serviceHome.envObject.object.model.headers[0].headerName)&&h.serviceHome.envObject.object.model.headers.splice(0,1)},I.checkHeaderValue=function(){if(h.serviceHome.envObject.object.model.headers&&/^content-type$/i.test(h.serviceHome.envObject.object.model.headers[0].headerName))switch(h.serviceHome.envObject.object.model.headers[0].headerValue.toLowerCase()){case"text/plain":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[1];break;case"application/json":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[2];break;case"application/javascript":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[3];break;case"application/xml":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[4];break;case"text/xml":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[5];break;case"text/html":h.data.contentType.current=h.CONST.RAW_CONTENT_TYPE_ARR[6];break;case"application/x-www-form-urlencoded":h.data.contentType.current=h.CONST.FORM_DATA_CONTENT_TYPE_ARR[1];break;case"multipart/form-data":h.data.contentType.current=h.CONST.FORM_DATA_CONTENT_TYPE_ARR[2];break;default:h.data.contentType.current={key:"Auto",value:""}}else h.data.contentType.current={key:"Auto",value:""}},l.global.$watch.push(r.$watch('$ctrl.serviceHome.envObject.object.model.headers[0]["headerValue"]',I.checkHeaderValue)),I.loadPartCtrl=function(e){return e.promise},h.fun.changeBodyType=function(e,t,a){x.bodyParamObject[h.serviceHome.envObject.object.model.requestType]=angular.copy(h.serviceHome.envObject.object.model.params),h.serviceHome.envObject.object.model.requestType=e;var o=["application/x-www-form-urlencoded",h.data.contentType.current.value,"application/json","application/xml"];switch(e){case"0":case"2":case"3":"0"==e?h.component.blockListObject.body.tdList[2].selectQuery=[{name:"[text]",value:"0"},{name:"[file]",value:"1"}]:h.component.blockListObject.body.tdList[2].selectQuery=[{name:"[string]",value:"0"},{name:"[boolean]",value:"8"},{name:"[array]",value:"12"},{name:"[object]",value:"13"},{name:"[number]",value:"14"},{name:"[null]",value:"15"}],h.component.blockListObject.body.setting.munalHideOperateColumn="3"==e,h.serviceHome.envObject.object.model.params=angular.copy(t||x.bodyParamObject[e]||[{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[],childList:[],listDepth:0}]),"3"===e?(h.serviceHome.envObject.object.model.params[0].paramType=13,h.component.blockListObject.body.setting.isStaticFirstIndex=!0):delete h.component.blockListObject.body.setting.isStaticFirstIndex;break;case"4":h.serviceHome.envObject.object.model.params=t||x.bodyParamObject[e]||{name:"",uuid:"",path:""}}a||h.fun.quickSelectContentType(o[e])},h.fun.changeUri=function(){v.manualChangeUrl=!0,h.ajaxResponse.apiInfo.urlParam=s.initEditTableList(h.serviceHome.urlParamObject.fun.reset(h.serviceHome.envObject.object.model.URL,h.ajaxResponse.apiInfo.urlParam)||[],{itemStructure:h.component.blockListObject.queryParam.itemStructure})},h.fun.window=function(){var e=O.cache.get("UNIT_TEST_RESULT");e&&r.$broadcast("$NewTabResponseText_UnitTestComponent",e)},h.fun.test=function(){r.$broadcast("$UnitTestClick")},h.fun.testListClear=function(e){var t={request:{spaceKey:h.ajaxRequest.spaceKey,projectHashKey:h.ajaxRequest.projectHashKey,apiID:h.ajaxRequest.apiID}};l.EnsureModal("清空历史记录",!1,"确认清空",{},function(e){e&&R.Test.DeleteAllHistory(t.request).$promise.then(function(e){switch(e.statusCode){case u.COMMON.SUCCESS:l.InfoModal("记录清空成功","success"),h.ajaxResponse.apiInfo.testHistory=[]}})})},h.fun.testListDelete=function(e){e=e||{},e.$event&&e.$event.stopPropagation();var t={request:{spaceKey:h.ajaxRequest.spaceKey,projectHashKey:h.ajaxRequest.projectHashKey,testID:e.item.testID}};l.EnsureModal("删除此项历史记录",!1,i.DELETE,{},function(a){a&&(e.item.testID?R.Test.DeleteHistory(t.request).$promise.then(function(t){switch(t.statusCode){case u.COMMON.SUCCESS:l.InfoModal("记录删除成功!","success"),h.ajaxResponse.apiInfo.testHistory.splice(e.$index,1)}}):h.ajaxResponse.apiInfo.testHistory.splice(e.$index,1))})},h.fun.testListEnter=function(e){switch(e=e||{},h.serviceHome.envObject.object.model.URL=e.item.requestInfo.URL,h.serviceHome.envObject.object.model.headers=[],h.serviceHome.envObject.object.model.params=[],h.serviceHome.envObject.object.model.raw="",delete h.serviceHome.envObject.object.model.requestType,h.ajaxResponse.apiInfo.urlParam=s.initEditTableList(h.serviceHome.urlParamObject.fun.reset(e.item.requestInfo.URL)||[],{itemStructure:h.component.blockListObject.queryParam.itemStructure}),h.ajaxResponse.apiInfo.restfulParam=s.initEditTableList([],{itemStructure:h.component.blockListObject.requestHeader.itemStructure}),h.data.response={status:"0",testHttpCode:e.item.resultInfo.httpCode,testDeny:e.item.resultInfo.testDeny,testResult:{headers:e.item.resultInfo.headers},responseLength:e.item.resultInfo.responseLength,httpCodeType:e.item.resultInfo.httpCode>=100&&e.item.resultInfo.httpCode<200?1:e.item.resultInfo.httpCode>=200&&e.item.resultInfo.httpCode<300?2:e.item.resultInfo.httpCode>=300&&e.item.resultInfo.httpCode<400?3:4,hadTest:!0,reportList:e.item.resultInfo.reportList||[]},e.item.resultInfo.responseType){case"longText":case"stream":break;default:h.data.response.responseType="text"}switch(h.unitTestObjectComponent.injectScript={type:"0",before:e.item.beforeInject,after:e.item.afterInject},r.$broadcast("$Maunal_AceEditorAms_Code_Ace_Editor_Js",e.item.beforeInject),h.serviceHome.envObject.object.model.headers=s.initEditTableList(e.item.requestInfo.headers,{fun:function(e){return{headerName:e.name,headerValue:e.value,checkbox:!0}},itemStructure:h.component.blockListObject.requestHeader.itemStructure}),e.item.requestInfo.requestType){case"1":case 1:h.serviceHome.envObject.object.model.raw=e.item.requestInfo.params,r.$broadcast("$Maunal_AceEditorAms",e.item.requestInfo.params),h.serviceHome.envObject.object.model.requestType="1";break;case"2":case 2:h.fun.changeBodyType("4",{},!0);break;default:for(var t=0;t<e.item.requestInfo.params.length;t++){var a=e.item.requestInfo.params[t];if(!a.key)break;h.serviceHome.envObject.object.model.params.push({checkbox:!0,paramKey:a.key,paramInfo:a.value,paramValueQuery:[],paramType:"0"})}h.serviceHome.envObject.object.model.params.push(angular.copy(h.component.blockListObject.body.itemStructure)),h.fun.changeBodyType("0",h.serviceHome.envObject.object.model.params,!0)}h.serviceHome.envObject.object.model.apiRequestType=""+e.item.requestInfo.methodType,O.cache.set(e.item.resultInfo.body,"UNIT_TEST_RESULT"),h.data.format.message=!h.data.format.message,h.data.header={type:"0"},h.serviceHome.envObject.object.model.auth={status:"0",basicAuth:{username:"",password:""}}},h.fun.expressionBuilder=function(e){switch(e.item.expressionBuilderObject=e.item.expressionBuilderObject||{request:{},response:{}},e.$index){case 0:e.item.expressionBuilderObject.request.constant=e.item.URL;break;case 1:e.item.expressionBuilderObject.request.constant=e.item.headerValue;break;case 2:e.item.expressionBuilderObject.request.constant=e.item.paramInfo}l.ExpressionBuilderModal(e.item.expressionBuilderObject,function(t){if(t){switch(e.$index){case 0:e.item.URL=t.response.result||e.item.URL;break;case 1:e.item.headerValue=t.response.result||e.item.headerValue;break;case 2:e.item.paramInfo=t.response.result||e.item.paramInfo}e.item.expressionBuilderObject=t}})},h.fun.resetForm=function(e){h.serviceHome.envObject.object.model=e;var t=null;"1"!==e.requestType&&(t=s.initEditTableList(e.params||[],{munalHideOperateColumn:"3"==e.requestType&&e.params.length>0,itemStructure:h.component.blockListObject.body.itemStructure,fun:function(e){e.paramType=e.paramType||"0"}}),h.fun.changeBodyType(e.requestType,t,!0))},h.fun.generateCode=function(){var e={message:h.serviceHome.envObject.object.model,restfulParam:h.ajaxResponse.apiInfo.restfulParam,env:h.serviceHome.envObject.object.total,input:{generateCodeLang:v.generateCodeLang}};l.Product_CodeGenerateModal(e,function(e){v.generateCodeLang=e.generateCodeLang})},r.importFile=function(e){if(0!==e.length){var t=void 0;h.serviceHome.envObject.object.model.params={};var a=!0,o=!1,n=void 0;try{for(var s,c=e[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var i=s.value;i.size<=2097152||"sass_web"!==eoSystemObj.PLATFORM?(h.serviceHome.envObject.object.model.params.name=i.name,t=new FileReader,t.readAsDataURL(i),t.onload=function(e){h.serviceHome.envObject.object.model.params.dataUrl=this.result}):l.InfoModal("文件大小均需小于2M","error")}}catch(p){o=!0,n=p}finally{try{!a&&c["return"]&&c["return"]()}finally{if(o)throw n}}r.$root&&r.$root.$$phase||r.$apply()}},h.fun["import"]=function(e){if(0!==e.file.length){var t=e.$index,a=void 0;h.serviceHome.envObject.object.model.params[t].paramInfo="",v.fileList[t]=[];for(var o=function(){s=e.file[n];var o=s.name;return s.size>2097152&&"sass_web"===eoSystemObj.PLATFORM?(h.serviceHome.envObject.object.model.params[t].paramInfo="",l.InfoModal("文件大小均需小于2M","error"),"break"):(h.serviceHome.envObject.object.model.params[t].paramInfo=s.name+","+h.serviceHome.envObject.object.model.params[t].paramInfo,a=new FileReader,a.readAsDataURL(s),a.onload=function(e){h.data.plugObject.useStatus?v.fileList[t].splice(0,0,this.result):v.fileList[t].splice(0,0,{name:o,dataUrl:this.result}),O.cache.set(v.fileList,"fileList")},void 0)},n=0;n<e.file.length;n++){var s,c=o();if("break"===c)break}h.serviceHome.envObject.object.model.params[t].paramInfo=h.serviceHome.envObject.object.model.params[t].paramInfo.slice(0,h.serviceHome.envObject.object.model.params[t].paramInfo.length-1),r.$root&&r.$root.$$phase||r.$apply()}},h.fun.newApi=function(){if(!h.serviceHome.envObject.object.model.URL)return void l.InfoModal("请先填写测试地址！","error");var e={uri:{status:"add"},cache:{request:h.serviceHome.envObject.object.model,testResultCache:"UNIT_TEST_RESULT",apiID:h.ajaxRequest.apiID,advancedSetting:h.unitTestObjectComponent.advancedSetting,urlParam:h.ajaxResponse.apiInfo.urlParam,testHttpCode:h.data.response.testHttpCode||"200",restfulParam:h.ajaxResponse.apiInfo.restfulParam}};O["default"].menu("add",e.uri,e.cache)},I.parseBodyParamItem=function(e){switch(h.serviceHome.envObject.object.model.requestType){case"0":e.paramType=["0","1"].indexOf(e.paramType)>-1?e.paramType:"0";break;case"2":case"3":var t={str:["1","6","7","9"],num:["3","4","5","10","11"],exist:["0","8","12","13","14","15"]};t.str.indexOf(e.paramType)>-1?e.paramType="0":t.num.indexOf(e.paramType)>-1?e.paramType="14":"2"===e.paramType?e.paramType="13":t.exist.indexOf(e.paramType)===-1&&(e.paramType="0")}},I.filterParamItemApiInfoToTestForm=function(e){delete e.paramNotNull,delete e.paramValueList,delete e["default"]},I.init=function(e){var t={fun:{}};r.$emit("$WindowTitleSet",{list:["[基础测试]"+h.ajaxResponse.apiInfo.baseInfo.apiName,"API","API管理"]}),"reset"==e?(O.cache.clear("UNIT_TEST_RESULT"),h.ajaxResponse.apiInfo={baseInfo:{apiName:"",apiURI:"",apiRequestRaw:"",apiProtocol:0,apiRequestType:0,apiRequestParamType:0},headerInfo:[],requestInfo:[],authInfo:{status:"0"},testHistory:h.ajaxResponse.apiInfo.testHistory},h.data.response={httpCodeType:2,hadTest:!1,status:"0"},h.data.format={isJson:!0,message:""}):h.data.response={httpCodeType:2,hadTest:!1,status:"0"},h.serviceHome.envObject.object.model.apiRequestParamJsonType=(h.ajaxResponse.apiInfo.baseInfo.apiRequestParamJsonType||0).toString(),h.serviceHome.envObject.object.model.headers=s.initEditTableList(h.ajaxResponse.apiInfo.headerInfo||[],{fun:function(e){e.checkbox=!parseInt(e.paramNotNull||"0"),e.paramValueQuery=[],angular.forEach(e.paramValueList,function(t,a){e.paramValueQuery.push(t.value)}),e.headerValue=e.headerValue||e.paramValueQuery[e["default"]]||"",I.filterParamItemApiInfoToTestForm(e)},itemStructure:h.component.blockListObject.requestHeader.itemStructure}),I.checkHeaderValue(),h.serviceHome.envObject.object.model.requestType=h.ajaxResponse.apiInfo.baseInfo.apiRequestParamType.toString(),h.serviceHome.envObject.object.model.raw=h.ajaxResponse.apiInfo.baseInfo.apiRequestRaw||"",h.serviceHome.envObject.object.model.apiRequestType=h.ajaxResponse.apiInfo.baseInfo.apiRequestType.toString(),h.serviceHome.envObject.object.model.auth=h.ajaxResponse.apiInfo.authInfo,h.serviceHome.envObject.object.model.httpHeader=h.ajaxResponse.apiInfo.baseInfo.apiProtocol.toString(),h.unitTestObjectComponent.injectScript={type:"0",before:h.ajaxResponse.apiInfo.baseInfo.beforeInject,after:h.ajaxResponse.apiInfo.baseInfo.afterInject},h.unitTestObjectComponent.advancedSetting=h.ajaxResponse.apiInfo.baseInfo.advancedSetting||{requestRedirect:1},r.$broadcast("$Maunal_AceEditorAms",h.serviceHome.envObject.object.model.raw),t.fun.handleParam=function(e,t){return e.paramValueQuery=[],e.checkbox=!parseInt(e.paramNotNull||"0"),angular.forEach(e.paramValueList,function(t,a){e.paramValueQuery.push(t.value)}),e.paramInfo=e.paramValue||e.paramValueQuery[e["default"]]||"",I.filterParamItemApiInfoToTestForm(e),e},h.fun.changeBodyType(h.serviceHome.envObject.object.model.requestType,s.initEditTableList(h.ajaxResponse.apiInfo.requestInfo||[],{fun:function(e,a){if(e.structureID){var o=[],n=angular.copy(h.ajaxResponse.apiInfo.dataStructureList)[e.structureID].structureData;for(var s in n){var r=n[s],c=e.updateData[r.paramID];if(!c||!c.structureIsHide){r.listDepth=a+r.listDepth||0;var i=t.fun.handleParam(Object.assign({},r,c));I.parseBodyParamItem(i),o.push(i)}}return o}I.parseBodyParamItem(e),t.fun.handleParam(e)},munalHideOperateColumn:"3"==h.serviceHome.envObject.object.model.requestType&&h.ajaxResponse.apiInfo.requestInfo.length>0,itemStructure:h.component.blockListObject.body.itemStructure})),h.ajaxResponse.apiInfo.urlParam=s.initEditTableList(h.ajaxResponse.apiInfo.urlParam||[],{fun:t.fun.handleParam,itemStructure:h.component.blockListObject.queryParam.itemStructure}),h.ajaxResponse.apiInfo.restfulParam=s.initEditTableList(h.ajaxResponse.apiInfo.restfulParam||[],{fun:t.fun.handleParam,itemStructure:h.component.blockListObject.restful.itemStructure}),h.ajaxResponse.apiInfo.urlParam=h.serviceHome.urlParamObject.fun.reset(h.ajaxResponse.apiInfo.baseInfo.apiURI,h.ajaxResponse.apiInfo.urlParam||[],!0).concat([angular.copy(h.component.blockListObject.queryParam.itemStructure)]),h.serviceHome.envObject.object.model.URL=h.serviceHome.urlParamObject.fun.$watch({params:h.ajaxResponse.apiInfo.urlParam||[],url:h.ajaxResponse.apiInfo.baseInfo.apiURI}),v.manualChangeUrl=!0,r.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:2,header:"headers",additionalParams:"params",initFilterEnvData:"mockPreview"===e}})},I.initHistory=function(){var e={spaceKey:h.ajaxRequest.spaceKey,projectHashKey:h.ajaxRequest.projectHashKey,apiID:h.ajaxRequest.apiID};return l.global.ajax.TestHistoryList_UnitTest=R.Test.TestHistoryList(e),l.global.ajax.TestHistoryList_UnitTest.$promise.then(function(e){h.data.queryHistory=!0,h.ajaxResponse.apiInfo.testHistory=e.testHistoryList||[],angular.forEach(h.ajaxResponse.apiInfo.testHistory,function(e,t){try{e.requestInfo.constructor!=Object&&(e.requestInfo={apiProtocol:"0",method:"error",URL:"此历史记录错误",requestType:"0"}),null==e.resultInfo&&(e.resultInfo={body:"error",headers:[],httpCode:500,testDeny:0}),"DEL"===e.requestInfo.method&&(e.requestInfo.method="DELETE"),e.requestInfo.methodType=o.METHOD_ARR.indexOf(e.requestInfo.method),e.requestInfo.methodClass="eo-color-"+o.METHOD_SHOW_QUERY[e.requestInfo.methodType]["class"],e.httpCodeType=e.resultInfo.httpCode>=100&&e.resultInfo.httpCode<200?1:e.resultInfo.httpCode>=200&&e.resultInfo.httpCode<300?2:e.resultInfo.httpCode>=300&&e.resultInfo.httpCode<400?3:4}catch(a){}})}),r.$broadcast("$TransferStation",{state:"$Init_LoadingPartCommonComponent",data:{promise:l.global.ajax.TestHistoryList_UnitTest.$promise}}),l.global.ajax.TestHistoryList_UnitTest.$promise},h.fun.init=function(){var e={spaceKey:h.ajaxRequest.spaceKey,projectHashKey:h.ajaxRequest.projectHashKey,groupID:h.ajaxRequest.groupID,apiID:h.ajaxRequest.apiID};h.data.isQuick&&!h.ajaxRequest.apiID?(h.ajaxResponse.apiInfo={baseInfo:{apiName:"",apiURI:"",apiProtocol:0,apiRequestType:0,apiRequestParamType:0},headerInfo:[],requestInfo:[],authInfo:{status:"0"}},I.init()):(l.global.ajax.Detail_Api=p.Api.Detail(e),l.global.ajax.Detail_Api.$promise.then(function(e){switch(e.statusCode){case u.COMMON.SUCCESS:e.apiInfo.authInfo.status=e.apiInfo.authInfo.status||"0",h.ajaxResponse.apiInfo=e.apiInfo,r.$broadcast("$Maunal_AceEditorAms"),I.init();break;default:h.ajaxResponse.apiInfo={}}}))},I.initTestHistoryTable=function(){h.component.blockListObject.testHistory={setting:{munalHideOperateColumn:!0,trClass:"cp"},baseFun:{trClick:h.fun.testListEnter},tdList:[{thKey:"测试时间",type:"text",modelKey:"testTime","class":"pl20 w_200"},{thKey:"请求地址",type:"html",html:'<span class="history-type {{item.requestInfo.methodClass}}">{{item.requestInfo.method}}</span>{{item.requestInfo.URL}}'},{thKey:"返回状态",type:"html","class":"w_200",html:"<span ng-class=\"{'test-default-color':item.httpCodeType===1,'test-success-color':item.httpCodeType===2,'test-warning-color':item.httpCodeType===3,'test-error-color':item.httpCodeType===4||item.httpCodeType===5}\">{{item.resultInfo.httpCode}}</span>"},{thKey:"请求时长",type:"html",html:"{{item.resultInfo.testDeny}}ms","class":"w_200"},{type:"btn","class":"w_100",btnList:[{key:"删除",operateName:"delete",fun:h.fun.testListDelete}]}]}},I.reduceItemWhenIsOprDepth=function(e,t,a){return e.indexOf(a.paramType)===-1&&(a.paramType=t),!0},I.initCommonParamTable=function(){return{itemStructure:{paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox"},{thKey:"参数名",type:"input",modelKey:"paramKey",placeholder:"参数名","class":"w_20percent"},{thKey:"参数值",type:"autoComplete",selectQuery:"item.paramValueQuery",modelKey:"paramInfo",placeholder:"{{item.paramName||'参数值'}}"},{type:"btn","class":"w_150",btnList:[{key:"构造器",operateName:"construct",fun:h.fun.expressionBuilder,param:{$index:2}},{key:"删除",operateName:"delete"}]}]}},I.initBodyTable=function(){h.component.blockListObject.body={setting:{},baseFun:{reduceItemWhenAddChildItem:function(e){I.reduceItemWhenIsOprDepth(["2","12","13"],"13",e)},importFile:h.fun["import"]},itemStructure:{paramType:"0",paramKey:"",paramInfo:"",checkbox:!0,paramValueQuery:[]},tdList:[{type:"checkbox",modelKey:"checkbox",itemDisabledExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?'':'input-checkbox'"},{thKey:"参数名",type:"depthInput",modelKey:"paramKey",placeholder:"参数名","class":"w_20percent"},{thKey:"类型",type:"select",key:"name",value:"value",initialData:"item.paramType",selectQuery:[],modelKey:"paramType","class":"w_80",fun:h.fun.changeVarType,selectQueryExpression:"$first&&$ctrl.otherObject.bodyParamType==='3'?[{name:'object',value:'13'}]:$ctrl.mainObject.tdList[2].selectQuery"},{thKey:"参数值",type:"autoCompleteAndFile",switchVar:"paramType",swicthFile:"1",selectQuery:"item.paramValueQuery",modelKey:"paramInfo",placeholder:"{{item.paramName||'参数值'}}"},{type:"btn","class":"w_200",btnList:[{key:"添加子字段",operateName:"addChild",itemExpression:"ng-if=\"item.listDepth<4&&$ctrl.otherObject.bodyParamType!=='0'\""},{key:"构造器",operateName:"construct",fun:h.fun.expressionBuilder,param:{$index:2},itemExpression:'eo-attr-tip-placeholder="constructor_btn" ng-disabled="item.paramType==\'1\'"'},{key:"删除",operateName:"delete",itemExpression:'ng-if="!($ctrl.mainObject.setting.munalHideOperateColumn&&$first)"'}]}]}},I.initRequestHeaderTable=function(){h.component.blockListObject.requestHeader={itemStructure:{headerName:"",headerValue:"",checkbox:!0},tdList:[{type:"checkbox",modelKey:"checkbox"},{thKey:"标签",type:"autoComplete",selectQuery:d.REQUEST_HEADER,modelKey:"headerName","class":"w_20percent",placeholder:"头部标签"},{thKey:"内容",type:"autoComplete",selectQuery:"item.paramValueQuery",modelKey:"headerValue",placeholder:"头部内容"},{type:"btn","class":"w_150",btnList:[{key:"构造器",operateName:"construct",fun:h.fun.expressionBuilder,param:{$index:1}},{key:"删除",operateName:"delete"}]}]}},I.parseMockDataForm=function(e){h.ajaxResponse.apiInfo={baseInfo:{apiName:"",apiURI:e.mockURI,apiRequestRaw:"",apiProtocol:0,apiRequestParamJsonType:e.apiRequestParamJsonType||"0",apiRequestType:e.apiRequestType||"0",apiRequestParamType:e.requestParamType||"0"},headerInfo:e.requestHeader,requestInfo:e.requestBody,urlParam:e.urlParam,authInfo:{status:"0"}},I.init("mockPreview")},I.checkIsMockPreviewData=function(){var e=window.localStorage.getItem("MOCK_PREVIEW_TO_TEST_DATA");if(window.localStorage.removeItem("MOCK_PREVIEW_TO_TEST_DATA"),!e)return null;try{return JSON.parse(e)}catch(t){return null}},I.parseMultiTabComponent=function(){h.multiTabComponent={requestData:t.REQUEST_DATA_ARR,responseData:[].concat(_toConsumableArray(t.RESPONSE_DATA_ARR),[{key:"测试历史",value:"4",fun:I.initHistory}])},h.multiTabComponent.requestData[1].checkIsValid=function(){return"1"!=h.serviceHome.envObject.object.model.apiRequestType||"nodejs"===h.unitTestObjectComponent.testSeverType}},h.$onInit=function(){var e=h.cacheObject;if(h.cacheObject=h.cacheObject||{},I.initVar(),I.initTestHistoryTable(),I.initBodyTable(),I.initRequestHeaderTable(),I.parseMultiTabComponent(),h.serviceHome.testCommonFun.downloadPcModal(),h.component.blockListObject.queryParam=I.initCommonParamTable(),h.component.blockListObject.restful=I.initCommonParamTable(),O.cache.clear("UNIT_TEST_RESULT"),e&&h.data.isQuick&&e.isAreadyInit)O.cache.set(e.UNIT_TEST_RESULT,"UNIT_TEST_RESULT"),h.fun.changeBodyType(h.serviceHome.envObject.object.model.requestType,null,!0),r.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:2,header:"headers",additionalParams:"params"}}),h.data.format.message=!h.data.format.message;else{v.isAlreadyInit=!1;var t="mock"===m.params.from?I.checkIsMockPreviewData():null;t?I.parseMockDataForm(t):h.fun.init()}l.global.$watch.push(r.$watch("$ctrl.ajaxResponse.apiInfo.urlParam",function(){if(v.manualChangeUrl)return void(v.manualChangeUrl=!1);try{h.serviceHome.envObject.object.model.URL=h.serviceHome.urlParamObject.fun.$watch({
params:h.ajaxResponse.apiInfo.urlParam||[],url:h.serviceHome.envObject.object.model.URL})}catch(e){}},!0)),l.global.$watch.push(r.$watch("$ctrl.serviceHome.envObject.object.model.params",function(){if(h.serviceHome.envObject.object.model.headers&&/^content-type$/i.test(h.serviceHome.envObject.object.model.headers[0].headerName)&&"0"===h.serviceHome.envObject.object.model.requestType){var e=JSON.stringify(h.serviceHome.envObject.object.model.params),t=void 0;t=e.indexOf('"paramType":"1"')===-1?"application/x-www-form-urlencoded":"multipart/form-data",h.fun.quickSelectContentType(t)}},!0)),h.data.isQuick||(h.component.menuObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回API列表",icon:"chexiao",fun:{"default":O["default"].menu,params:"'list',"+JSON.stringify(h.ajaxRequest)}}]},{type:"navigation","class":"menu-navigation",fun:O["default"].menu,value:"test",tabList:[{key:"API",value:"detail"},{key:"测试",authority:"test",value:"test"},{key:"测试用例",value:"case"},{key:"Mock API",authority:"mockApi",value:"mock"}]},{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"btn-group-li pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":O["default"].menu,params:"'edit',"+JSON.stringify(h.ajaxRequest)}},{name:"复制",icon:"fuzhi",fun:{"default":function(){O["default"].copyApi(Object.assign({},h.ajaxRequest,{apiName:h.ajaxResponse.apiInfo.baseInfo.apiName,apiURI:h.ajaxResponse.apiInfo.baseInfo.apiURI,apiRequestType:h.ajaxResponse.apiInfo.baseInfo.apiRequestType,isPopupModalToWarning:!0}))}}},{name:"删除",icon:"shanchu",fun:{"default":O["default"]["delete"],params:JSON.stringify(h.ajaxRequest)}}]}],setting:{"class":"common-menu-fixed-seperate common-menu-md inside_page_menu_mcc"}});var a=JSON.stringify(h.data.jsonToParamObject.requestItem);h.CONST.INSERT_TYPE_ARR=[{key:'<div set-to-params="paramKey" item=\''+a+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.requestType =='2'\""},{key:'<div  import-method="3" set-to-params="paramKey" item=\''+a+'\' reset-result="item" set-value="paramInfo" level-status="nest"></div>',expression:" ng-if=\"$ctrl.otherObj.requestType =='3'\""}],eoSystemObj.validToSwitchTestMethod&&l.global.$watch.push(r.$watch("$ctrl.unitTestObjectComponent.testSeverType + $ctrl.serviceHome.envObject.object.model.apiRequestType",I.changeApiMethodType))}}angular.module("eolinker").component("homeProjectInsideApiTest",{templateUrl:"module/ams/ui/project/inside/content/api/test/index.html",controller:e,bindings:{cacheObject:"="}}),e.$inject=["AMS_MAX_API_DEMO_SIZE","API_DATA_CONST","DOMAIN_CONSTANT","API_AMS_CONSTANT","LOCAL_REGEXP_CONST","ListBlock_CommonComponentService","$scope","$filter","ENSURE_WARNIMG","ApiManagementResource","$state","CODE","$rootScope","HTTP_CONSTANT","Cache_CommonService","HomeProjectApi_Service","Authority_CommonService","Operate_CommonService","GeneralFunResource"]}();
"use strict";!function(){function e(e,t,o,a,n,i,s,u,r,c,p){var l=this;l.data={},l.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,pageID:s.params.pageID,projectHashKey:s.params.projectHashKey,groupID:s.params.groupID},l.ajaxResponse={pageInfo:{}},l.fun={init:null,"delete":null},l.service={authority:p},l.component={menuObject:{list:null},noticeMemberObj:{resouceModule:i.Notification,ajaxRequest:{spaceKey:l.ajaxRequest.spaceKey,id:l.ajaxRequest.pageID,projectHashKey:l.ajaxRequest.projectHashKey,module:3},eventArr:a.DOC}};var m={},d={groupCommon:n};m.initGroupInfo=function(){l.ajaxResponse.pageInfo.groupPath=d.groupCommon.fun.getGroupPath({currentGroupID:l.ajaxResponse.pageInfo.groupID,groupInfo:d.groupCommon.fun.generalGroupInfo({list:o.get()}),resultType:"string"})},l.fun.init=function(){var t={request:{spaceKey:l.ajaxRequest.spaceKey,projectHashKey:l.ajaxRequest.projectHashKey,groupID:l.ajaxRequest.groupID,pageID:l.ajaxRequest.pageID}};return r.global.ajax.Detail_Doc=i.Doc.Detail(t.request),r.global.ajax.Detail_Doc.$promise.then(function(t){switch(t.statusCode){case u.COMMON.SUCCESS:e.$emit("$WindowTitleSet",{list:["[详情]"+t.pageInfo.title,"项目文档","API管理"]}),t.pageInfo.docNoteHtml=c("XssFilter")(t.pageInfo.content,{onIgnoreTagAttr:function(e,t,o,a){if(/(style)|(class)|(id)|(name)/.test(t))return t+'="'+o+'"'}}),l.ajaxResponse.pageInfo=t.pageInfo,m.initGroupInfo()}}),r.global.ajax.Detail_Doc.$promise},l.fun.showModal=function(e){return"free"==l.service.authority.product.ams&&"notice"==e?void r.Common_UpgradeNoticeModal({mark:"AMS",module:"doc_"+e}):void(l.data.modal=e)},l.fun.closeModal=function(){l.data.modal=null},l.fun["delete"]=function(e){var o={request:{spaceKey:l.ajaxRequest.spaceKey,projectHashKey:l.ajaxRequest.projectHashKey,pageID:"["+l.ajaxRequest.pageID+"]"},uri:{groupID:l.ajaxRequest.groupID}};r.EnsureModal("删除项目文档",!1,t.DELETE,{},function(e){e&&i.Doc.Delete(o.request).$promise.then(function(e){switch(e.statusCode){case u.COMMON.SUCCESS:s.go("home.ams.project.inside.doc.list",o.uri),r.InfoModal("项目文档删除成功！","success")}})})},l.fun.menu=function(e){var t={uri:angular.copy(l.ajaxRequest)};switch(t.uri.status=e,e){case"list":s.go("home.ams.project.inside.doc.list",t.uri);break;case"history":s.go("home.ams.project.inside.doc.history",t.uri);break;case"notice":s.go("home.ams.project.inside.doc.notice",t.uri);break;case"edit":s.go("home.ams.project.inside.doc.edit",t.uri);break;case"copy":t.uri.type=2,s.go("home.ams.project.inside.doc.edit",t.uri)}},l.$onInit=function(){l.component.menuObject.mainObject={list:[{type:"btn","class":"pull-left",btnList:[{name:"返回文档列表",icon:"chexiao",fun:{"default":l.fun.menu,params:"'list'"}}]},{type:"divide","class":"pull-left",authority:"edit"},{type:"btn","class":"pull-left",authority:"edit",btnList:[{name:"编辑",icon:"bianji",fun:{"default":l.fun.menu,params:"'edit'"}},{name:"复制",icon:"fuzhi",fun:{"default":l.fun.menu,params:"'copy'"}},{name:"删除",icon:"shanchu",fun:{"default":l.fun["delete"]}}]}],setting:{"class":"common-menu-fixed-seperate inside_page_menu_mcc"}}},e.$on("$SidebarFinish",function(){m.initGroupInfo()})}angular.module("eolinker.ams").component("homeProjectInsideDocDetail",{templateUrl:"module/ams/ui/project/inside/content/doc/detail/index.html",controller:e}),e.$inject=["$scope","ENSURE_WARNIMG","GroupService","NOTICE_MEMBER_OBJ","Group_MultistageService","ApiManagementResource","$state","CODE","$rootScope","$filter","Authority_CommonService"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var o=0,t=Array(e.length);o<e.length;o++)t[o]=e[o];return t}return Array.from(e)}!function(){function e(e,o,t,n,a,s,c,i){var r=this;r.data={docGroup:null,isSendNotice:!0,submitted:!1},r.CONST={lazyload:i.LAZY_EDITOR,noteTypeQuery:[{key:"Markdown",value:"1"},{key:"富文本编辑器",value:"0"}]},r.ajaxResponse={docInfo:{projectHashKey:t.params.projectHashKey,groupID:t.params.groupID||-1,pageID:t.params.pageID,title:"",docRichNote:"",docMarkdownNote:"",contentRaw:"",contentType:"1",fileList:[]}},r.fun={},r.service={authority:c};var p={munalSave:!1,docInfo:null,spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:t.params.projectHashKey,groupID:t.params.groupID,pageID:t.params.pageID,status:t.params.status},u={};r.component={menuObject:{list:[]},selectMultistageCommonComponentObject:{"new":{},original:{}},packageAdminObj:{setting:{editable:!0,isWantToExposeFunConstructIdArr:!0},requestBody:{spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,type:1},uploadResource:o.Package.Upload},packageAdminExposeObj:{}},r.fun.init=function(){var e,t=s.get();t&&("add"!==p.status?e=o.Doc.Detail({spaceKey:p.spaceKey,pageID:p.pageID,groupID:p.groupID,projectHashKey:p.projectHashKey}).$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:switch(r.ajaxResponse.docInfo=e.pageInfo,r.ajaxResponse.docInfo.contentType=""+r.ajaxResponse.docInfo.contentType,r.ajaxResponse.docInfo.contentType){case"0":r.ajaxResponse.docInfo.docRichNote=r.ajaxResponse.docInfo.content;break;case"1":r.ajaxResponse.docInfo.docMarkdownNote=r.ajaxResponse.docInfo.content}r.ajaxResponse.docInfo.groupID=e.pageInfo.groupID,p.docInfo=angular.copy(r.ajaxResponse.docInfo)}}):(r.ajaxResponse.docInfo.contentType="1",r.ajaxResponse.docInfo.title=""),e?e["finally"](function(){r.data.docGroup=t}):(r.data.docGroup=t,p.docInfo=angular.copy(r.ajaxResponse.docInfo)))},r.fun.init(),r.fun.back=function(){"add"!==p.status?t.go("home.ams.project.inside.doc.detail",{groupID:p.groupID,pageID:p.pageID}):t.go("home.ams.project.inside.doc.list",{groupID:p.groupID})},u.confirm=function(){var e={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,groupID:r.component.selectMultistageCommonComponentObject["new"].value,pageID:p.pageID,title:r.ajaxResponse.docInfo.title,content:"1"==r.ajaxResponse.docInfo.contentType?r.ajaxResponse.docInfo.docMarkdownNote:r.ajaxResponse.docInfo.docRichNote,contentRaw:r.ajaxResponse.docInfo.contentRaw,contentType:r.ajaxResponse.docInfo.contentType};switch(p.status){case"edit":e.noticeType=r.data.isSendNotice?0:1}return e},r.fun.load=function(e){return e.promise},r.fun.requestProcessing=function(o){r.data.submitted=!0;var t,n=u.confirm(),s=r.component.packageAdminExposeObj.constructIdArr();if(s)if(e.ConfirmForm.$invalid)a.InfoModal("项目文档编辑失败，请检查信息是否填写完整！","error");else switch(n.fileID=s.join(","),o.status){case 0:t=u.keep({request:n});break;case 1:t=u.edit({request:n});break;case 2:t=u.quickEdit({request:n})}else a.InfoModal("目前有文件尚未上传完成，请等待文件上传完成！","error");return e.$broadcast("$Init_LoadingCommonComponent",{promise:t}),t},u.quickEdit=function(e){var s=o.Doc.Edit(e.request).$promise;return s.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:case n.DOC.ERROR:p.munalSave=!0,t.go("home.ams.project.inside.doc.detail",{groupID:p.groupID,pageID:p.pageID}),a.InfoModal("项目文档编辑成功","success")}}),s},u.keep=function(t){var s=o.Doc.Add(t.request).$promise;return s.then(function(o){o.statusCode==n.COMMON.SUCCESS&&(a.InfoModal("项目文档新建成功","success"),e.$broadcast("$ResetInitial_SelectMultistageCommonComponent"),r.ajaxResponse.docInfo={projectHashKey:p.projectHashKey,groupID:r.ajaxResponse.docInfo.groupID,title:"",docMarkdownNote:"",docRichNote:"",contentType:"1",contentRaw:"",fileList:[]},r.data.submitted=!1,window.scrollTo(0,0))}),s},u.edit=function(e){var s;if("edit"==p.status){var c={title:"更新描述",desc:e.request.updateDesc||"",content:'<p><span>更新描述</span><span class="c999 fs12">（选填）</span></p><p class="c999 mb10 mt5">填写更新描述有助于团队成员了解文档的变更内容</p>'};a.CommonSingleTextareaModal(c,function(s){s.check&&(e.request.updateDesc=s.desc,o.Doc.Edit(e.request).$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:p.munalSave=!0,t.go("home.ams.project.inside.doc.detail",{groupID:p.groupID,pageID:p.pageID}),a.InfoModal("项目文档编辑成功","success")}}))})}else s=o.Doc.Add(e.request).$promise,s.then(function(e){e.statusCode==n.COMMON.SUCCESS&&(p.munalSave=!0,t.go("home.ams.project.inside.doc.detail",{groupID:p.groupID,pageID:e.pageID}),a.InfoModal("项目文档新建成功","success"))});return s},u.checkIsChange=function(){var e={title:r.ajaxResponse.docInfo.title||"",content:("1"==r.ajaxResponse.docInfo.contentType?r.ajaxResponse.docInfo.docMarkdownNote:r.ajaxResponse.docInfo.docRichNote)||"",contentType:r.ajaxResponse.docInfo.contentType||"1"},o={title:p.docInfo.title||"",content:p.docInfo.content||"",contentType:p.docInfo.contentType||"1"};for(var t in e){var n=e[t],a=o[t];if(n!=a)return!0}return!1},r.$onInit=function(){e.$emit("$WindowTitleSet",{list:["[编辑]项目文档","API管理"]});var o=[],t=[];switch(p.status){case"edit":t=[{type:"customized-html","class":"pull-left",authority:"isPay",fun:function(){r.data.isSendNotice=!r.data.isSendNotice},html:'<button class="ignore-notice-checkbox-btn menu-ml15 common-btn" ng-click="item.fun({item:item})" ><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.activeObject.isSendNotice}"></span>发送文档变更通知给相关人员</button>'}];case"copy":o=[{type:"btn","class":"pull-left",btnList:[{name:"保存","class":"eo_theme_btn_success block-btn",fun:{disabled:1,"default":r.fun.requestProcessing,params:{status:1}}}]}];case"copy":case"add":o=[{type:"btn","class":"pull-left",btnList:[{name:"保存","class":"eo_theme_btn_success block-btn",fun:{disabled:1,"default":r.fun.requestProcessing,params:{status:1}}}]}]}r.component.menuObject.mainObject={list:[{type:"btn","class":"btn-group-li  pull-left",btnList:[{name:"add"==p.status?"返回文档列表":"返回详情",icon:"chexiao",fun:{"default":r.fun.back}}]}].concat(_toConsumableArray(o)).concat(t),setting:{"class":"common-menu-fixed-seperate inside_page_menu_mcc"}},window.onbeforeunload=eoSystemObj.windowOnBeforeUnload},e.$on("$SidebarFinish",function(){r.fun.init()}),e.$on("$stateChangeStart",function(e,o,n){window.onbeforeunload=null,!p.munalSave&&u.checkIsChange()&&(e.preventDefault(),a.EnsureModal("您有未保存的内容",!1,"当前页面中存在未保存的改动，离开页面将导致改动失效，请确认是否离开当前页面？",{btnMessage:"确定",btnType:1},function(e){e&&(p.munalSave=!0,t.go(o,n))}))})}angular.module("eolinker.ams").component("homeProjectInsideDocEdit",{templateUrl:"module/ams/ui/project/inside/content/doc/edit/index.html",controller:e}),e.$inject=["$scope","ApiManagementResource","$state","CODE","$rootScope","GroupService","Authority_CommonService","HTML_LAZYLOAD"]}();
"use strict";!function(){function e(e,t,o,i,s,a,n,r){var c=this;c.data={pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},c.fun={init:null,deleteHistory:null,toggleHistory:null},c.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:a.params.projectHashKey,groupID:a.params.groupID,pageID:a.params.pageID},response:{query:null}},c.service={authority:o},c.component={blockListObject:{},menuObject:{list:null},listPageCommonObject:null};var u={};c.fun.menu=function(e){var t={uri:angular.copy(c.interaction.request)};switch(t.uri.status=e,e){case"list":a.go("home.ams.project.inside.doc.list",t.uri);break;case"detail":a.go("home.ams.project.inside.doc.detail",t.uri);break;case"notice":a.go("home.ams.project.inside.doc.notice",t.uri);break;case"edit":a.go("home.ams.project.inside.doc.edit",t.uri);break;case"copy":t.uri.type=2,a.go("home.ams.project.inside.doc.edit",t.uri)}},c.fun["delete"]=function(t){var o={request:{spaceKey:c.interaction.request.spaceKey,projectHashKey:c.interaction.request.projectHashKey,pageID:"["+c.interaction.request.pageID+"]"},uri:{groupID:c.interaction.request.groupID}};r.EnsureModal("删除项目文档",!1,e.DELETE,{},function(e){e&&s.Doc.Delete(o.request).$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:a.go("home.ams.project.inside.doc.list",o.uri),r.InfoModal("项目文档删除成功！","success")}})})},c.fun.init=function(){i.$emit("$WindowTitleSet",{list:["[历史记录]项目文档","API管理"]});var e={request:{spaceKey:c.interaction.request.spaceKey,projectHashKey:c.interaction.request.projectHashKey,pageID:c.interaction.request.pageID,page:c.data.pagination.page,pageSize:c.data.pagination.pageSize}};return r.global.ajax.HistoryList_Doc=s.Doc.HistoryList(e.request),r.global.ajax.HistoryList_Doc.$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:c.interaction.response.query=e.pageHistoryList,c.data.pagination.msgCount=e.historyCount}}),r.global.ajax.HistoryList_Doc.$promise},u.deleteHistory=function(t){var o={request:{spaceKey:c.interaction.request.spaceKey,projectHashKey:c.interaction.request.projectHashKey,historyID:t.item.historyID,pageID:t.item.pageID}};r.EnsureModal("删除历史记录",!1,e.DELETE,{},function(e){e&&s.Doc.DeleteHistory(o.request).$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:c.interaction.response.query.splice(t.$index,1),r.InfoModal("历史记录删除成功","success");break;default:r.InfoModal("删除失败，此为当前版本或当前版本已被删除！","error")}})})},u.toggleHistory=function(e){var t={request:{spaceKey:c.interaction.request.spaceKey,projectHashKey:c.interaction.request.projectHashKey,historyID:e.item.historyID,pageID:e.item.pageID}};r.global.ajax.toggleHistory_Doc&&r.global.ajax.toggleHistory_Doc.$cancelRequest(),r.global.ajax.toggleHistory_Doc=s.Doc.toggleHistory(t.request),r.global.ajax.toggleHistory_Doc.$promise.then(function(t){switch(t.statusCode){case n.COMMON.SUCCESS:for(var o=0;o<c.interaction.response.query.length;o++)if(1==c.interaction.response.query[o].isNow){c.interaction.response.query[o].isNow=0;break}c.interaction.response.query[e.$index].isNow=1,r.InfoModal("切换版本成功！","success"),i.$emit("$TransferStation",{state:"$Init_LoadingCommonComponent"})}})},c.fun.changePage=function(){i.$broadcast("$Init_LoadingCommonComponent")},u.showUpdateDesc=function(e){r.MessageModal("更新描述",'<pre style="overflow:auto">'+e.item.updateDesc+"</pre>")},u.initTable=function(){c.component.blockListObject.query={mainObject:{tdList:[{thKey:"",type:"html",html:t("JsConstructHtml_CommonFilter")('<span class="eo-color-default current-icon" ng-if="item.isNow==1">{@text}</span>',{text:"当前"}),"class":"tac w_50 "},{thKey:"人员",type:"html",html:'<span class="logo-img pull-left" style="background-image:url({{userImage.userImage?(\''+eoSystemObj.PRE_URL_UPLOAD_FILE+"'+$ctrl.data.textObject.userImage):''}});\">&nbsp;</span><span>{{item.operator}}</span>"},{thKey:"操作时间",type:"text",modelKey:"updateTime"},{type:"btn","class":"w_150",btnList:[{key:"详情",fun:u.showUpdateDesc},{key:"切换",fun:u.toggleHistory,itemExpression:'ng-if="$ctrl.authorityObject.edit&&item.isNow==0"'},{key:"删除",fun:u.deleteHistory,itemExpression:'ng-if="$ctrl.authorityObject.edit&&item.isNow==0"'}]}]}}},c.$onInit=function(){u.initTable()}}angular.module("eolinker.ams").component("homeProjectInsideDocHistory",{templateUrl:"module/ams/ui/project/inside/content/doc/history/index.html",controller:e}),e.$inject=["ENSURE_WARNIMG","$filter","Authority_CommonService","$scope","ApiManagementResource","$state","CODE","$rootScope"]}();
"use strict";!function(){function e(e,t,n,i,a,r,o,c,s){var m=this;m.service={authority:r},m.data={pagination:{pages:"",maxSize:10,pageSize:15,page:1,msgCount:0,jumpPage:""}},m.interaction={request:{spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,page:o.params.page||1,conditionType:o.params.type||0,startTime:o.params.startTime,endTime:o.params.endTime,connID:o.params.connID,module:0},response:{query:null},datePickerObject:{request:{startTime:o.params.startTime?new Date(o.params.startTime):"",endTime:o.params.endTime?new Date(o.params.endTime):""},show:!1}},m.fun={init:null};var u={logAndNoticeParse:i},l={};l.getMemberQuery=function(){var n={request:{spaceKey:m.interaction.request.spaceKey,hashKey:m.interaction.request.projectHashKey,module:m.interaction.request.module}};e.global.ajax.MemberQuery_Project=t.ProjectMember.TotalMemberQuery(n.request),e.global.ajax.MemberQuery_Project.$promise.then(function(e){m.interaction.response.memberList=e.memberList||[]})}(),m.component={listPageCommonObject:null,menuObject:{list:null,otherObject:null}},m.fun.init=function(){var t={request:{spaceKey:m.interaction.request.spaceKey,projectHashKey:m.interaction.request.projectHashKey,page:m.interaction.request.page,pageSize:m.data.pagination.pageSize,conditionType:m.interaction.request.conditionType,startTime:m.interaction.request.startTime,endTime:m.interaction.request.endTime,connID:m.interaction.request.connID}};return n.$emit("$WindowTitleSet",{list:["日志","API管理"]}),e.global.ajax.GetProjectLogList_Project=a.Project.GetProjectLogList(t.request),e.global.ajax.GetProjectLogList_Project.$promise.then(function(e){m.data.pagination.page=t.request.page,m.interaction.response.query=u.logAndNoticeParse.fun.filterProject(e.logList||[]),m.data.pagination.msgCount=e.logCount||0}),e.global.ajax.GetProjectLogList_Project.$promise},m.fun.search=function(t){var n={uri:{page:null,type:3,startTime:s("currentTimeFilter")(m.interaction.datePickerObject.request.startTime,{min:"day"}),endTime:s("currentTimeFilter")(m.interaction.datePickerObject.request.endTime,{min:"day"})},templateTime:null};n.uri.startTime?n.uri.endTime?(m.interaction.datePickerObject.show=!1,m.interaction.datePickerObject.request.startTime>m.interaction.datePickerObject.request.endTime&&(n.templateTime=n.uri.startTime,n.uri.startTime=n.uri.endTime,n.uri.endTime=n.templateTime),o.go("home.ams.project.inside.account.log",n.uri)):e.InfoModal("请选择结束日期","error"):e.InfoModal("请选择开始日期","error")},m.fun.filter=function(e){o.go("home.ams.project.inside.account.log",{page:null,type:e.key,startTime:null,endTime:null})},m.fun.select=function(){var t={modal:{title:"请选择所筛选的人员",query:m.interaction.response.memberList,key:"connID",initialData:m.interaction.request.connID},fun:null};t.fun=function(){e.Product_SelectPeopleModal(t.modal,function(e){e&&o.go("home.ams.project.inside.account.log",{page:null,connID:e.value})})},m.interaction.response.memberList?t.fun():e.global.ajax.MemberQuery_Project.$promise["finally"](function(){t.fun()})},m.$onInit=function(){m.component.listPageCommonObject={mainObject:{item:{"default":[{key:"操作时间",html:"{{item.opTime}}","class":"w_200"},{key:"类型",html:"{{$ctrl.mainObject.OP_TYPE_ARR[item.opType]}}","class":"w_60"},{key:"操作对象","class":"w_150",html:"{{item.opTarget}}"},{key:"操作人","class":"w_150",html:"{{item.operator}}",isUnneccessary:!0},{key:"描述",html:"{{item.opDesc}}",title:"{{item.opDesc}}",isUnneccessary:!0}]},setting:{warning:"尚未存在任何日志",unhover:!0},OP_TYPE_ARR:["新建","更新","删除","其他"]}},m.component.menuObject.mainObject={list:[{type:"tips-tab","class":"view-btn-li menu-ml15 pull-left",activePoint:"conditionType",tabList:[{name:"今天",active:0,fun:{"default":m.fun.filter,params:{key:0}}},{name:"七天之内",active:1,fun:{"default":m.fun.filter,params:{key:1}}},{name:"过去30天",active:2,authority:"month",fun:{"default":m.fun.filter,params:{key:2}}},{active:3,type:"html",authority:"quarter",html:'{{$ctrl.activeObject.startTime?($ctrl.activeObject.startTime+" - "+$ctrl.activeObject.endTime):"自定义时间段"}}<p datepicker-times-directive="$ctrl.otherObject.datePicker.fun(arg)" interaction="$ctrl.otherObject.datePicker.object"></p>',fun:{"default":function(e){e.$event.stopPropagation(),m.interaction.datePickerObject.show=!0}}}]},{type:"btn","class":"btn-group-li menu-ml10 pull-left",btnList:[{name:"所有人",icon:"jinxianshibutong",fun:{"default":m.fun.select}}]}],setting:{"class":"common-menu-fixed-seperate"}}}}angular.module("eolinker.ams").component("homeProjectInsideLog",{templateUrl:"module/ams/ui/project/inside/content/account/log/index.html",controller:e}),e.$inject=["$rootScope","GeneralFunResource","$scope","Log_And_Notice_Parse_CommonService","ApiManagementResource","Authority_CommonService","$state","CODE","$filter"]}();
"use strict";!function(){function e(e,a,t,r,o,n,s,i,c,u){var p=this;p.data={batch:{},pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},listOrderBy:JSON.parse(window.localStorage.DOC_SORTTYPE||'{"orderBy": 2,"asc": 0}')},p.ajaxRequest={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,groupID:o.params.groupID||-1,keyword:window.sessionStorage.getItem("COMMON_SEARCH_TIP"),pageID:[]},p.ajaxResponse={query:null},p.fun={},p.service={home:u,authority:c},p.component={menuObject:{},listDefaultCommonObject:{}};var d={},g={isQuerying:!0};d.resetBatchInfo=function(){p.data.batch.isOperating=!1,p.data.batch.selectAll=!1,p.data.batch.query=[],p.data.batch.indexAddress={}},d.resetItemFromArr=function(e){var a=p.data.batch.query.length;for(var t in p.ajaxResponse.query){var r=p.ajaxResponse.query[t];if(p.data.batch.indexAddress[r.pageID]&&(p.ajaxResponse.query[t]=Object.assign({},r,e),a--,a<=0))return}},d.scrollLoading=function(){var e={hasItem:p.ajaxResponse.query&&0!==p.ajaxResponse.query.length,hasNextPage:p.data.pagination.page<p.data.pagination.msgCount/p.data.pagination.pageSize,isQuerying:g.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&(g.isQuerying=!0,d.getQuery("preload",p.data.pagination.page+1))},d.filterQuery=function(){t.$broadcast("$Init_LoadingCommonComponent"),d.resetBatchInfo()},d.getQuery=function(e,a,t){var o={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,groupID:p.ajaxRequest.groupID,pageSize:t||p.data.pagination.pageSize,orderBy:p.data.listOrderBy.orderBy,asc:p.data.listOrderBy.asc},n=[];switch(e){case"reset":n=[],o.page=1;break;default:n=p.ajaxResponse.query,o.page=a}return p.ajaxRequest.keyword?(o.keyword=p.ajaxRequest.keyword,s.global.ajax.Query_Doc=r.Doc.Search(o)):s.global.ajax.Query_Doc=r.Doc.Query(o),s.global.ajax.Query_Doc.$promise.then(function(a){"reset"===e&&(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0),g.isQuerying=!1,p.ajaxResponse.query=n.concat(a.pageList||[]),p.data.pagination.msgCount=a.itemNum||0,t||(p.data.pagination.page=o.page)}),s.global.ajax.Query_Doc.$promise},d.sort=function(e){p.data.listOrderBy=e.listOrderBy,t.$broadcast("$Init_LoadingCommonComponent",{"boolean":!0})},d.edit=function(e){var a={groupID:o.params.groupID,status:e.status},t=i.get();t&&0!=t.length?("add"!==e.status&&(a.pageID=e.item.pageID),o.go("home.ams.project.inside.doc.edit",a)):s.InfoModal("请先建立分组！","error")},d.click=function(e){var a={groupID:o.params.groupID,pageID:e.item.pageID};o.go("home.ams.project.inside.doc.detail",a)},d.batchMoveGroup=function(){var a={list:angular.copy(i.get()),title:"批量编辑文档分组",current:p.ajaxRequest},t={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,pageID:JSON.stringify(p.data.batch.query),groupID:""};return a.list?void s.SelectVisualGroupModal(a,function(a){a&&(t.groupID=a.groupID,r.Doc.Move(t).$promise.then(function(t){switch(t.statusCode){case n.COMMON.SUCCESS:"-1"!=(p.ajaxRequest.groupID||-1).toString()&&a.groupInfo.parentGroupPath[a.groupID].indexOf(Number(p.ajaxRequest.groupID))==-1&&a.groupID!=p.ajaxRequest.groupID?d.filterQuery():(d.resetItemFromArr({groupName:a.groupName}),d.resetBatchInfo()),s.InfoModal("文档批量编辑分组成功","success");break;default:s.InfoModal("操作失败"+e.FAILURE,"error")}}))}):void s.InfoModal("暂无分组，请先建立分组再操作！","error")},d["delete"]=function(t){var o=[];t?o.push(t.item.pageID):o=p.data.batch.query;var i={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,pageID:JSON.stringify(o)};s.EnsureModal("删除文档",!1,a.DELETE,{},function(a){a&&r.Doc.Delete(i).$promise.then(function(a){switch(a.statusCode){case n.COMMON.SUCCESS:t?(p.ajaxResponse.query.splice(t.$index,1),p.data.pagination.msgCount>p.data.pagination.page*p.data.pagination.pageSize&&d.getQuery("preload",p.data.pagination.page*p.data.pagination.pageSize,1),p.data.pagination.msgCount--):d.filterQuery(),s.InfoModal("文档删除成功","success");break;default:s.InfoModal("删除失败，"+e.FAILURE,"error")}})})},d.batchBtnClickFun=function(){if(p.data.pagination.page!==Math.ceil(p.data.pagination.msgCount/p.data.pagination.pageSize)){var e={spaceKey:p.ajaxRequest.spaceKey,projectHashKey:p.ajaxRequest.projectHashKey,groupID:p.ajaxRequest.groupID,orderBy:p.data.listOrderBy.orderBy,asc:p.data.listOrderBy.asc},a=null;p.ajaxRequest.keyword?(e.keyword=p.ajaxRequest.keyword,a=r.Doc.SearchIDQuery(e).$promise):a=r.Doc.IDQuery(e).$promise,a.then(function(e){p.data.allQueryID=e.pageIDList||[]})}},p.fun.init=function(){return d.getQuery("reset")},p.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[列表]项目文档","API管理"]}),p.component.menuObject={list:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"新建文档",icon:"jiahao","class":"eo_theme_btn_success block-btn",fun:{"default":d.edit,params:{status:"add"}}}]},{type:"search","class":"pull-right",keyword:p.ajaxRequest.keyword,fun:p.service.home.searchObject.fun.search}],batchList:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"编辑分组",icon:"wenjianjia",fun:{"default":d.batchMoveGroup}},{name:"删除",icon:"shanchu",fun:{"default":d["delete"],params:""}}]}],baseFun:{batchDefault:d.batchBtnClickFun},setting:{batch:!0,batchInitFun:d.resetBatchInfo,title:"项目文档"}},p.component.listDefaultCommonObject={item:{primaryKey:"pageID","default":[{key:"名称",sort:!0,sortOrderByVal:0,html:"{{item.title}}",draggableCacheMark:"name",sortAndFilterConf:{canSort:!0}},{key:"分组",html:"{{item.groupName}}",draggableCacheMark:"group"},{key:"创建时间",sort:!0,sortOrderByVal:2,isUnneccessary:!0,html:"{{item.createTime}}",draggableCacheMark:"createTime",sortAndFilterConf:{canSort:!0,"class":"eo_to_right_0"}},{key:"更新时间",sort:!0,sortOrderByVal:1,isUnneccessary:!0,html:"{{item.updateTime}}",draggableCacheMark:"updateTime",sortAndFilterConf:{canSort:!0,"class":"eo_to_right_0"}}],operate:{funArr:[{key:"编辑",fun:d.edit,params:{status:"edit"}},{key:"删除",fun:d["delete"]}],"class":"w_100"}},setting:{draggable:!0,dragCacheVar:"AMS_DOC_LIST_DRAG_VAR",dragCacheObj:{name:"400px",group:"200px",createTime:"150px",updateTime:"150px"},isFixedHeight:!0,batch:!0,warning:"尚未新建任何文档",page:!0,scroll:!0,scrollRemainRatio:7,autoSort:!0,sortStorageKey:"DOC_SORTTYPE",sortDefaultVal:{storageVal:{orderBy:2,asc:0},sortOrder:"asc"}},baseFun:{click:d.click,autoSortFun:d.sort,scrollLoading:d.scrollLoading}}}}angular.module("eolinker.ams").component("homeProjectInsideDocList",{templateUrl:"module/ams/ui/project/inside/content/doc/list/index.html",controller:e}),e.$inject=["RESPONSE_TEXT","ENSURE_WARNIMG","$scope","ApiManagementResource","$state","CODE","$rootScope","GroupService","Authority_CommonService","Operate_CommonService"]}();
"use strict";!function(){function e(e,t,n,a,o,i,c){var s=this;s.fun={},s.service={authority:t},s.component={ganttObject:{setting:{style:{height:"100%",width:"100%"},monitorClientHeight:!0},baseFun:{clickItem:null},reset:0,wheelDelta:0}},s.data={},s.ajaxResponse={query:null};var r={},l={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:n.params.projectHashKey};r.editPlan=function(t){t=t||{},t.item=t.item||{};var n={modal:{title:("edit"===t.status?"编辑":"新建")+"迭代计划",resource:c.Iteration["edit"===t.status?"Edit":"Add"],textArray:[{type:"input",title:"计划名称",key:"planName",value:t.item.planName||"",required:!0,maxlength:32}],datePickerObject:{type:"datePicker",startTime:t.item.startTime,endTime:t.item.endTime,notSameDay:!0,title:"计划持续时间"},request:Object.assign({},l,{planID:t.item.planID})}};o.MixInputModal(n.modal,function(n){n&&(e.$broadcast("$Init_LoadingCommonComponent"),o.InfoModal(("edit"===t.status?"编辑":"新建")+"迭代计划成功","success"))})},r.clickPlan=function(t){var n=!!t.componentType,a=n?t.dataIndex:t.$index;s.component.ganttObject.xIndex=parseInt(a),l.planID=s.ajaxResponse.groupQuery[a].planID,s.triggle={action:"selectPlan",param:s.ajaxResponse.groupQuery[a]},n&&(e.$root&&e.$root.$$phase||e.$apply())},r.initGroupComponent=function(){s.component.groupCommonObject={requestObject:{resource:c.Api,baseRequest:l},funObject:{btnGroupList:[{name:"新建计划","class":"eo_theme_btn_success block-btn",icon:"jiahao",fun:r.editPlan}],baseFun:{click:r.clickPlan}},mainObject:{baseInfo:{name:"planName",id:"planID",current:l,disabledDrag:!0,status:"cancelRequest",hasIcon:0,resetFlag:0,title:"分组"},itemFun:[{key:"编辑",fun:r.editPlan,params:{status:"edit"}},{params:{modal:{title:"删除计划",message:"请问是否删除该计划？"}},key:"删除",fun:function(t){o.EnsureModal("删除计划",!1,i.DELETE,{},function(n){n&&c.Iteration.Delete(Object.assign({},l,{planID:JSON.stringify([t.item.planID])})).$promise.then(function(t){switch(t.statusCode){case a.COMMON.SUCCESS:o.InfoModal("删除成功","success"),e.$broadcast("$Init_LoadingCommonComponent")}})})}}]}}},s.fun.groupScroll=function(t){s.component.ganttObject.dataZoomY=t.target.scrollTop/40,s.component.ganttObject.wheelDelta=t.target.scrollTop,e.$root&&e.$root.$$phase||e.$apply()},s.fun.init=function(){return s.ajaxResponse.groupQuery=null,s.component.ganttObject.wheelDelta=0,s.component.ganttObject.dataZoomY=0,o.global.ajax.Query_IterationPlan=c.Iteration.QueryDetailed(l),o.global.ajax.Query_IterationPlan.$promise.then(function(e){s.ajaxResponse.groupQuery=e.planList||[],s.component.groupCommonObject.mainObject.baseInfo.resetFlag++}),o.global.ajax.Query_IterationPlan.$promise},s.$onInit=function(){r.initGroupComponent(),s.component.ganttObject.baseFun.clickItem=r.clickPlan},o.global.$watch.push(e.$watch("$ctrl.accept",function(){if(s.accept)switch(s.accept.action){case"refresh":e.$broadcast("$Init_LoadingCommonComponent")}}))}angular.module("eolinker.ams").component("homeProjectInsideIterationPlanA",{templateUrl:"module/ams/ui/project/inside/content/iterationPlan/partA/index.html",controller:e,bindings:{triggle:"=",accept:"<"}}),e.$inject=["$scope","Authority_CommonService","$state","CODE","$rootScope","ENSURE_WARNIMG","ApiManagementResource"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}!function(){function e(e,t,a,r,i,s,n,o,l,c){var p=this;p.data={isSpreedConsole:!1,batch:{},pagination:{maxSize:10,pageSize:50,page:1,msgCount:0},listOrderBy:JSON.parse(window.localStorage.PROJECT_ITERATION_PLAN_SORTTYPE||'{"orderBy": 3,"asc": 0}'),filterObject:{}},p.service={authority:s},p.CONST={},p.component={menuObject:{active:{condition:0}},listDefaultCommonObject:{},dragChangeHeightCommonDirectiveObj:{setting:{clientY:51,minHeight:30,object:"height"},baseFun:{mouseDown:function(e){e[0].className=e[0].className.replace("transition_hpicpb","")},heightChange:function(){e.$emit("$TransferStation",{state:"$ResetGanttSize"})}}}},p.ajaxResponse={query:null},p.fun={};var u={},d={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,searchCondition:window.sessionStorage.getItem("COMMON_SEARCH_TIP")},m={previousPage:1,preloadData:null,operatorFilterConf:{canFilterValue:"connID",canFilter:!0,filterArr:[],"class":"w_300",filterHtml:'{{item.memberNickName||item.partnerNickName||item.userNickName}}<span class="eo-status-tips fs12">（{{item.inviteCall}}）</span>'}};u.translateApiStatus=function(e){return{apiStatusString:t.API_STATUS_QUERY[e].key,apiStatusClass:"eo-label-"+t.API_STATUS_QUERY[e]["class"]}},u.resetItemFromArr=function(e){var t=p.data.batch.query.length;for(var a in p.ajaxResponse.query){var r=p.ajaxResponse.query[a];if(p.data.batch.indexAddress[r.apiID]&&(p.ajaxResponse.query[a]=Object.assign({},r,e),t--,t<=0))return}},u.resetBatchInfo=function(){p.data.batch.isOperating=!1,p.data.batch.selectAll=!1,p.data.batch.query=[],p.data.batch.indexAddress={}},u.batchBtnClickFun=function(){if(p.data.pagination.page!==Math.ceil(p.data.pagination.msgCount/p.data.pagination.pageSize)){var e={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,planID:d.planID,orderBy:p.data.listOrderBy.orderBy,asc:p.data.listOrderBy.asc,condition:p.component.menuObject.active.condition};try{angular.merge(e,JSON.parse(d.searchCondition)),e.apiTag=JSON.parse(e.apiTag||"[]");for(var t in e.apiTag){var a=e.apiTag[t];if(""===a){e.apiTag.splice(t,1),e.tagFliter=1;break}}e.apiTag=e.apiTag.join(",")}catch(r){}n.Iteration.QueryApiID(e).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:p.data.allQueryID=e.apiIDList}})}},u.filterQuery=function(){u.queryApiList({status:"reset"}),u.resetBatchInfo()},u.filter=function(e){var a={output:[],apiStatusObject:{}};for(var r in e){var i=e[r];a.apiStatusObject=u.translateApiStatus(i.apiStatus),i.apiStatusClass=a.apiStatusObject.apiStatusClass,i.apiStatusString=a.apiStatusObject.apiStatusString,i.apiRequestMethod=t.METHOD_SHOW_QUERY[i.apiRequestType].key,i.apiRequestMethodClass="eo-label-"+t.METHOD_SHOW_QUERY[i.apiRequestType]["class"],i.tmpApiURI=i.apiURI,a.output.push(i)}return a.output},u.addApi=function(){var e=u.initCommonTable("addApi");c.Product_ImportCrossProjectModal({title:"添加 API 到迭代计划",containerClass:"apimanagement_scss_api_list",mainObject:{type:"bindApi",menuComponent:{listItemObj:m.listItemObj,initListItemData:{status:1,requestMethod:1,creator:1,updateTime:1,apiTag:0},setting:{listItemStorageName:"AMS_ITERATION_COLOUMN_FILTER_OBJECT"}},listComponent:e,baseParams:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey},impGroupInfo:{resourceName:r.Group.Query,extraParams:{module:2}},impItemInfo:{queryResouceName:n.Api.Query,searchResouceName:n.Api.Query,queryIDResouceName:n.Api.QueryApiID,searchIDResouceName:n.Api.QueryApiID,queryResponseKey:"apiList"},baseFun:{filterItemQuery:u.filter,getFilterResourceParams:function(e){try{e.apiTag=JSON.parse(e.apiTag||"[]");for(var t in e.apiTag){var a=e.apiTag[t];if(""===a){e.apiTag.splice(t,1),e.tagFliter=1;break}}e.apiTag=e.apiTag.join(",")}catch(r){}return e},initFilterIAFun:u.parseFilterIndexAddress,setFilter:function(e,t,a){switch(t){case"creatorID":case"updaterID":case"apiStatus":case"apiTag":a.selectAll?delete e[t]:e[t]=JSON.stringify(a.query)}return e}}}},function(e){if(e){p.data.isOperate=!0;var t={spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:JSON.stringify(e),planID:d.planID};n.Iteration.BatchBindApi(t).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:c.InfoModal("绑定成功","success"),u.queryApiList({status:"reset"});break;default:c.InfoModal("操作失败"+i.FAILURE,"error")}})}})},u.initColumnFilter=function(){var e={star:1,status:1,requestMethod:1,creator:1,updateTime:1,apiTag:0};try{p.data.filterObject.indexAddress=Object.assign({},e,JSON.parse(window.localStorage.AMS_ITERATION_COLOUMN_FILTER_OBJECT))}catch(t){p.data.filterObject.indexAddress=e}for(var a in p.data.filterObject.indexAddress)0===p.data.filterObject.indexAddress[a]&&delete p.data.filterObject.indexAddress[a]},u.sort=function(e){p.data.listOrderBy=e.listOrderBy,u.queryApiList({status:"reset"})},p.fun.refreshPartA=function(){p.data.isOperate=!1,p.triggle={action:"refresh"}},u.setFilter=function(e,t){var a=JSON.parse(d.searchCondition)||{keyword:"",apiRequestType:-1,starred:-1};switch(e){case"starred":t.selectAll?a.starred=-1:a.starred=t.query[0];break;case"creatorID":case"updaterID":case"apiStatus":case"apiTag":t.selectAll?delete a[e]:a[e]=JSON.stringify(t.query)}d.searchCondition=JSON.stringify(a),window.sessionStorage.setItem("COMMON_SEARCH_TIP",d.searchCondition),u.queryApiList({status:"reset"})},u.ajaxSearchCondition=function(e,t){n.Api.getSearchConditionList({spaceKey:d.spaceKey,projectHashKey:d.projectHashKey}).$promise.then(function(a){e.sortAndFilterConf.filterArr=[{apiTag:""}].concat(_toConsumableArray(a.tagList||[])),t&&(t[0].sortAndFilterConf.filterArr=t[1].sortAndFilterConf.filterArr=a.memberList||[])})},u.parseFilterIndexAddress=function(e){var t=void 0,a={starred:-1,keyword:""},r={},i=["apiStatus","apiTag","creatorID","updaterID"];try{t=JSON.parse(e)||a}catch(s){t=a}return t&&(t.starred!==-1&&(r.starred={},r.starred[t.starred]=1),i.map(function(e){if(t[e]){r[e]={};var a=JSON.parse(t[e]),i=!0,s=!1,n=void 0;try{for(var o,l=a[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var c=o.value;r[e][c]=1}}catch(p){s=!0,n=p}finally{try{!i&&l["return"]&&l["return"]()}finally{if(s)throw n}}}})),r.keyword=t.keyword,r},u.initCommonTable=function(e){u.initColumnFilter();var a=u.parseFilterIndexAddress(d.searchCondition),r=void 0,i=void 0,s={array:[],batchArr:[],conditionArray:[],langObject:{clickToChangeStatus:"点击修改API状态"}},n={key:"标签 ",showPoint:"columnFilterObject",showVariable:"apiTag",show:1,sort:!0,html:"{{item.apiTag}}",draggableCacheMark:"tag",sortAndFilterConf:{canFilterValue:"apiTag",canFilter:!0,filterArr:[],"class":"w_200",filterHtml:'<span ng-class="{\'c999\':item.apiTag===\'\'}">{{item.apiTag===""?"空白标签":item.apiTag}}</span>',filterIAKey:"apiTag",filterIndexAddress:a.apiTag,checkboxKeyIsNum:!1},filterFun:function(e){u.setFilter("apiTag",e)}};return r=[{key:"创建者",html:"{{item.creator}}",showPoint:"columnFilterObject",showVariable:"creator",show:1,draggableCacheMark:"creator",sort:!0,sortAndFilterConf:Object.assign({filterIAKey:"creatorID"},m.operatorFilterConf,{filterIndexAddress:a.creatorID}),filterFun:function(e){u.setFilter("creatorID",e)}},{key:"最近更新者",html:"{{item.updater}}",showPoint:"columnFilterObject",showVariable:"updater",show:1,draggableCacheMark:"updater",sort:!0,sortAndFilterConf:Object.assign({filterIAKey:"updaterID"},m.operatorFilterConf,{filterIndexAddress:a.updaterID}),filterFun:function(e){u.setFilter("updaterID",e)}}],u.ajaxSearchCondition(n,r),i={item:{primaryKey:"apiID","default":[{key:"状态",showPoint:"columnFilterObject",showVariable:"status",show:1,html:'<span class="btn-change-status cp api-status-label {{item.apiStatusClass}}" title="'+s.langObject.clickToChangeStatus+'" ng-if="$ctrl.authorityObject.operate">{{item.apiStatusString}}</span><span class="api-status-label {{item.apiStatusClass}}" ng-if="!$ctrl.authorityObject.operate">{{item.apiStatusString}}</span>',draggableCacheMark:"apiStatus",sortAndFilterConf:{canFilter:!0,filterHtml:"{{item.key}}","class":"w_200",filterArr:t.API_STATUS_QUERY,filterIAKey:"apiStatus",filterIndexAddress:a.apiStatus},filterFun:function(e){u.setFilter("apiStatus",e)}},{thType:"html",thHtml:"APIs",sort:!0,sortOrderByVal:0,html:'<div class="name-box" ng-class="{\'w_100percent\':!$ctrl.showObject.columnFilterObject.status}">{{item.apiName}}</div>',draggableCacheMark:"name",sortAndFilterConf:{canSort:!0},filterFun:function(e){u.setFilter("apiStatus",e)}},{key:"URL","class":"cancel-nowrap",sort:!0,sortOrderByVal:4,draggableCacheMark:"url",html:'<span class="eo-method-label {{item.apiRequestMethodClass}}" ng-if="$ctrl.showObject.columnFilterObject.requestMethod==1">{{item.apiRequestMethod}}</span><div class="url-box" ng-class="{\'w_100percent\':!$ctrl.showObject.columnFilterObject.requestMethod}"><span class="api-url-text" title="{{item.apiURI}}">{{item.apiURI}}</span></div>',sortAndFilterConf:{canSort:!0}},n]},setting:{draggable:!0,dragCacheVar:"AMS_PROJECT_ITERATION_DRAG_VAL",dragCacheObj:{name:"250px",url:"300px",tag:"150px",apiStatus:"100px",deleteTime:"150px",creator:"100px",updater:"100px",updateTime:"150px"},unhover:!0,warning:"暂无绑定API",isFixedHeight:!0,batch:!0,page:!0,autoSort:!0,sortStorageKey:"PROJECT_ITERATION_PLAN_SORTTYPE",sortDefaultVal:{storageVal:{orderBy:3,asc:0},sortOrder:"asc"},scroll:!0,scrollRemainRatio:7},baseFun:{}},"addApi"!==e?(i.baseFun={click:u.click,scrollLoading:u.scrollLoading,autoSortFun:u.sort},i.item["default"].unshift({thType:"html",showPoint:"columnFilterObject",showVariable:"star",show:1,"class":"w_30",html:'<span class="iconfont" ng-class="{\'icon-htmal5icon24\':item.starred==1}"></span>',sort:!0,sortAndFilterConf:{canFilter:!0,filterArr:[{key:"无",value:0},{key:"星标",value:1}],filterHtml:"{{item.key}}",filterIndexAddress:a.starred,filterIAKey:"starred",containerClass:"pr10 eo_to_top_10"},filterFun:function(e){u.setFilter("starred",e)}}),i.item.operate={funArr:[{key:"查看API","class":"btn-newtag"},{key:"从计划中删除","class":"btn-remove"}],"class":"w_180"}):(i.setting.batchInitStatus="open",i.item.operate=null),i.item["default"]=i.item["default"].concat([].concat(_toConsumableArray(r),[{key:"更新时间",showPoint:"columnFilterObject",showVariable:"updateTime",show:1,sort:!0,sortOrderByVal:1,html:"{{item.apiUpdateTime}}",draggableCacheMark:"updateTime",sortAndFilterConf:{canSort:!0}}])),i},u.queryApiList=function(t){p.ajaxResponse.query=null;var a={request:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,groupID:d.groupID,orderBy:p.data.listOrderBy.orderBy,asc:p.data.listOrderBy.asc,pageSize:p.data.pagination.pageSize,planID:d.planID},temApiTag:"",fun:null};switch(m.isQuerying=!0,t){case"preload":if(m.isQuerying=!1,a.request.page=p.data.pagination.page+1,m.preloadData&&a.request.page===m.preloadData.dataPage)return;m.preloadData={dataPage:a.request.page},a.fun=function(e){m.preloadData.itemNum=e.itemNum,m.preloadData.apiList=e.apiList,p.data.batch.selectAll&&p.data.allQueryID&&p.data.batch.query.length!==p.data.allQueryID.length&&(p.data.batch.selectAll=!1),p.data.pagination.msgCount=m.preloadData.itemNum,p.ajaxResponse.query=u.filter(p.ajaxResponse.query.concat(m.preloadData.apiList||[])),p.data.pagination.page++,m.preloadData=null};break;default:m.isQuerying=!1,a.request.page=p.data.pagination.page,a.fun=function(t){if(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0,p.data.pagination.msgCount=t.itemNum,p.ajaxResponse.query=u.filter(t.apiList||[]),e.$emit("$TransferStation",{state:"$EnvInitReady",data:{status:0}}),p.data.batch.isOperating){p.data.batch.selectAll=!1;for(var a=!1,r=0;r<p.ajaxResponse.query.length;r++)if(p.data.batch.query.indexOf(p.ajaxResponse.query[r][p.component.listDefaultCommonObject.mainObject.item.primaryKey])===-1){a=!0;break}p.ajaxResponse.query.length&&!a&&(p.data.batch.selectAll=!0)}m.preloadData=null}}try{angular.merge(a.request,JSON.parse(d.searchCondition)),a.request.apiTag=JSON.parse(a.request.apiTag||"[]");for(var r in a.request.apiTag){var i=a.request.apiTag[r];if(""===i){a.request.apiTag.splice(r,1),a.request.tagFliter=1;break}}a.request.apiTag=a.request.apiTag.join(",")}catch(s){}return a.resource=n.Iteration.Detail,c.global.ajax.Query_Api&&c.global.ajax.Query_Api.$cancelRequest(),c.global.ajax.Query_Api=a.resource(a.request),c.global.ajax.Query_Api.$promise.then(a.fun),c.global.ajax.Query_Api.$promise},u.scrollLoading=function(){var e={hasItem:p.ajaxResponse.query&&0!==p.ajaxResponse.query.length,hasNextPage:p.data.pagination.page<p.data.pagination.msgCount/p.data.pagination.pageSize,isQuerying:m.isQuerying};e.hasItem&&e.hasNextPage&&!e.isQuerying&&u.init("preload")},u.changeApiStatus=function(e,r){r=r||{};var s={request:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:"single"==e?"["+r.item.apiID+"]":JSON.stringify(p.data.batch.query)},apiStatusObject:{}};s.fun=function(t,r){p.data.isOperate=!0,s.request.apiStatus=r,n.Api.ChangeStatus(s.request).$promise.then(function(n){switch(n.statusCode){case l.COMMON.SUCCESS:switch(s.apiStatusObject=u.translateApiStatus(r),e){case"single":p.ajaxResponse.query[t].apiStatus=s.request.apiStatus,p.ajaxResponse.query[t].apiStatusClass=s.apiStatusObject.apiStatusClass,p.ajaxResponse.query[t].apiStatusString=s.apiStatusObject.apiStatusString,p.ajaxResponse.query[t].apiUpdateTime=a("currentTimeFilter")(),c.InfoModal("编辑状态成功","success");break;case"batch":u.resetItemFromArr({apiStatus:s.request.apiStatus,apiStatusClass:s.apiStatusObject.apiStatusClass,apiStatusString:s.apiStatusObject.apiStatusString,apiUpdateTime:a("currentTimeFilter")()}),u.resetBatchInfo(),c.InfoModal("批量编辑状态成功","success")}break;default:c.InfoModal("编辑状态，"+i.FAILURE,"error")}})},c.AMS_ChangeStatusModal({title:"编辑API状态",query:t.API_STATUS_QUERY_PANEL_ARR,status:r.item.apiStatus},function(e){e&&s.fun(r.$index,e.status)})},p.fun.spreedConsole=function(e){p.data.isSpreedConsole=e},u.actionOpr=function(e){switch(e.action){case"selectPlan":p.data.planTitle=e.param.planName+"（"+e.param.startTime+" - "+e.param.endTime+"）",d.planID=e.param.planID,u.queryApiList(),p.fun.spreedConsole(!0)}},u.deleteApi=function(e,t){p.data.isOperate=!0;var a={spaceKey:d.spaceKey,planID:d.planID,projectHashKey:d.projectHashKey};switch(e){case"single":a.apiID="["+t.item.apiID+"]";break;case"batch":a.apiID=JSON.stringify(p.data.batch.query)}n.Iteration.BatchUntiedApi(a).$promise.then(function(e){switch(e.statusCode){case l.COMMON.SUCCESS:u.filterQuery(),c.InfoModal("成功删除迭代计划内API","success");break;default:c.InfoModal("操作失败，"+i.FAILURE,"error")}})},u.newTarget=function(e){var t={uri:{groupID:null,apiID:e.item.apiID}};window.open(o.href("home.ams.project.inside.api.detail",t.uri),"_blank")},u.click=function(e){var t={};try{t.point=e.$event.target.classList[0]}catch(a){t.point="default"}switch(t.point){case"btn-newtag":u.newTarget(e);break;case"btn-remove":u.deleteApi("single",e);break;case"btn-change-status":u.changeApiStatus("single",{item:{apiID:e.item.apiID,apiStatus:e.item.apiStatus},$index:e.$index})}},u.changeApiStar=function(e){var t={request:{spaceKey:d.spaceKey,projectHashKey:d.projectHashKey,apiID:JSON.stringify(p.data.batch.query),starred:e.item.value}};n.Api.ChangeStar(t.request).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:u.resetItemFromArr({starred:e.item.value,apiUpdateTime:a("currentTimeFilter")()}),u.resetBatchInfo(),c.InfoModal("批量编辑星标成功","success");break;default:c.InfoModal("编辑失败，"+i.FAILURE,"error")}})},u.initMenuComponent=function(){m.listItemObj={type:"tab_block_list","class":"pull-right ml15",name:"列表项",icon:"shebeisousuo",blockName:"listItem",query:[{key:"API状态",value:"status"},{key:"请求方式",value:"requestMethod"},{key:"标签",value:"apiTag"},{key:"创建者",value:"creator"},{key:"最近更新者",value:"updater"},{key:"更新时间",value:"updateTime"}]};var e=angular.copy(m.listItemObj);e.query.unshift({key:"星标",value:"star"}),p.component.menuObject.mainObject={list:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"添加API",icon:"jiahao","class":"eo_theme_btn_success block-btn",fun:{"default":u.addApi}}]},e],batchList:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"设置状态",fun:{"default":u.changeApiStatus,params:'"batch",arg'}}]},{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"删除",fun:{"default":u.deleteApi,params:'"batch",arg'}}]}],baseFun:{batchDefault:u.batchBtnClickFun},setting:{listItemStorageName:"AMS_ITERATION_COLOUMN_FILTER_OBJECT",batch:!0,batchInitFun:u.resetBatchInfo,title:"迭代计划"}}},p.$onInit=function(){p.component.listDefaultCommonObject=u.initCommonTable(),u.initMenuComponent()},e.$watch("$ctrl.accept",function(){p.accept&&p.accept.action&&u.actionOpr(p.accept)})}angular.module("eolinker.ams").component("homeProjectInsideIterationPlanB",{templateUrl:"module/ams/ui/project/inside/content/iterationPlan/partB/index.html",controller:e,bindings:{triggle:"=",accept:"<"}}),e.$inject=["$scope","API_AMS_CONSTANT","$filter","GeneralFunResource","RESPONSE_TEXT","Authority_CommonService","ApiManagementResource","$state","CODE","$rootScope"]}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,a,s,r,i,o,n,c,p,l,u){var d=this;d.data={isSpreedConsole:!1,plugObject:{needVersion:!0},isTesting:!1,testSeverType:window.localStorage.getItem("EOLINKER_TEST_USE_SOFTWARE_TYPE")||"plugin",testHistory:{},testMethod:null,currentTestingApiID:null,selectCaseNum:0,ajaxQueryNum:0,tabSelectObj:{selectItem:{value:"all"}},plugTransferToLocal:eoSystemObj.plugTransferToLocal},d.service={authority:n,home:s},d.CONST={NONE_TIP_Obj:{untest:"暂无未测试用例",error:"暂无未通过用例",success:"暂无通过用例",all:"未创建测试用例"}},d.component={blockListObject:{},dragChangeHeightCommonDirectiveObj:{setting:{clientY:51,minHeight:30,object:"height"},baseFun:{mouseDown:function(e){e[0].className=e[0].className.replace("transition_hpicpb","")}}}},d.ajaxResponse={query:[]},d.fun={};var m={},y=[],f={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:p.params.projectHashKey},h={acceptApiIndexArr:[],testPointArr:[]},I={ws:null,wsLocalUrl:"ws://"+eoSystemObj.WS_TARGET_PREFIX_URL,wsServerUrl:(eoSystemObj.HOST.indexOf("https")>-1?"wss://":"ws://")+(eoSystemObj.PLATFORM.indexOf("sass")!==-1?eoSystemObj.WS_TARGET_PREFIX_URL:eoSystemObj.HOST.replace(/(http)(()|(s))(:\/\/)/,"")),wsUrl:""};d.fun.filterTabItem=function(e){return!e.isHide&&e},d.fun.test=function(e,t,a){d.data.isOperate=!0,d.data.testMethod=e;var s=d.data.plugObject.useStatus&&"nodejs"!==d.data.testSeverType,r=[];switch(e){case"all":d.data.isTesting=!d.data.isTesting,d.data.isTesting&&(r=[],d.ajaxResponse.query.map(function(e){e.selectObj.query&&e.selectObj.query.length>0&&(r.push({apiID:e.apiID,caseIDArr:e.selectObj.query}),e.selectObj.query.map(function(t){d.data.testHistory[e.apiID][t]&&(d.data.testHistory[e.apiID][t].responseType="testing")}))}));break;case"single":d.data.isTesting=d.data.testHistory[a][t.item.caseID].testing=!d.data.testHistory[a][t.item.caseID].testing,d.data.isTesting&&(r=[{apiID:a,caseIDArr:[t.item.caseID]}],d.data.testHistory[a][t.item.caseID]&&(d.data.testHistory[a][t.item.caseID].responseType="testing"))}d.data.isTesting?(h.testPointArr=r,d.data.currentTestingApiID=r[0].apiID,!eoSystemObj.plugTransferToLocal&&s?(I.ws&&(I.ws.close(),I.ws=null),window.sessionStorage.setItem("plug-batchTest-info",JSON.stringify(r))):(I.ws&&("plugin"===d.data.testSeverType&&I.wsUrl.indexOf(I.wsLocalUrl)===-1||"nodejs"===d.data.testSeverType&&I.wsUrl.indexOf(I.wsServerUrl)===-1)&&(I.ws.close(),I.ws=null),I.ws?I.ws.send(JSON.stringify({status:"ajax",env:d.service.home.envObject.object.total,query:r})):m.bindWs(JSON.stringify({status:"ajax",env:d.service.home.envObject.object.total,query:r}),!0))):(h.testPointArr.map(function(e){e.caseIDArr.map(function(t){"testing"===d.data.testHistory[e.apiID][t].responseType?delete d.data.testHistory[e.apiID][t].responseType:""})}),I.ws&&I.ws.send(JSON.stringify({status:"abort"})))},m.bindWs=function(t){I.ws||(I.wsUrl="vspex_pc"===eoSystemObj.PLATFORM?"nodejs"===d.data.testSeverType?I.wsServerUrl:I.wsLocalUrl:I.wsServerUrl,I.ws=new WebSocket(I.wsUrl+"/nodeWebsocketServer/apiCase"),I.ws.onopen=function(){eoCookie.getCookieStrByUrl(a,function(e){if(I.ws.send(JSON.stringify({spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,cookie:e,status:"init"})),t)switch("undefined"==typeof t?"undefined":_typeof(t)){case"string":I.ws.send(t);break;case"object":t.map(function(e,t){I.ws.send(e)})}})},I.ws.onmessage=function(t){var a=JSON.parse(t.data);switch(a.statusCode){case l.COMMON.SUCCESS:case"120000":d.data.isTesting=!1,d.data.currentTestingApiID=null;break;default:if(!d.data.isTesting)return;for(var s in a)d.data.currentTestingApiID=parseInt(s),d.data.testHistory[s]=Object.assign({},d.data.testHistory[s],a[s])}e.$root&&e.$root.$$phase||e.$apply()},I.ws.onclose=function(e){I.ws=null},I.ws.onerror=function(e){I.ws=null})},d.fun.changeTestSeverType=function(){if(d.data.plugObject.useStatus)switch(d.data.testSeverType){case"nodejs":d.data.testSeverType="plugin";break;default:d.data.testSeverType="nodejs"}else{var e={html_1:"<div class='lh_30'><p>",html_2:"<a href='https://www.eolinker.com/#/plug/introduce' target='_blank' class='eo-status-warning' ><b>",html_3:"</b>",html_4:"</a>",html_5:"</p></div>",operate:window.plug&&"application/eolinker"===window.plug.type?"更新":"安装"},t="";t="更新"===e.operate?"{@html_1}测试增强插件已经提供新版本V5.9.3，请您先升级安装新版本插件{@html_2}[点此获取]{@html_3}{@html_4}。</br>升级插件版本后将会支持新的功能以及特性，由此带来不便之处，敬请谅解。{@html_5}":"{@html_1}如需切换使用插件测试，请先安装我们为您免费提供的 {@html_2}测试增强插件{@html_3} [点击获取]{@html_4}！{@html_5}",u.MessageModal("温馨提示",i("JsConstructHtml_CommonFilter")(t,e),{button:{sure:{content:"下载插件离线安装包",fun:function(){window.open(eoSystemObj.ADDRESS_PLUG)}}}}),d.data.testSeverType="nodejs"}window.localStorage.setItem("EOLINKER_TEST_USE_SOFTWARE_TYPE",d.data.testSeverType)},d.fun.clearApi=function(){d.ajaxResponse.query=[],h.acceptApiIndexArr=[],d.data.selectCaseNum=0,d.data.testHistory={},d.data.ajaxQueryNum=0;for(var e=0;e<300;)e++;d.triggle={action:"clearApi"}},m.getApiDetail=function(e){var t={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,apiID:e};return u.global.ajax.Detail_Api=c.Api.Detail(t),u.global.ajax.Detail_Api.$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:try{t.apiInfo.authInfo&&!t.apiInfo.authInfo.hasOwnProperty("status")&&(t.apiInfo.authInfo.status=0)}catch(a){}h[e]=t.apiInfo}}),u.global.ajax.Detail_Api.$promise},d.fun.newTestCase=function(e,t){if("free"===d.service.authority.product.ams)return void u.Common_UpgradeNoticeModal({mark:"AMS",module:"api_case"});if(h[t])m.edit("add",e,t);else{var a=m.getApiDetail(t);a["finally"](function(){m.edit("add",e,t)})}},m.getCaseInfo=function(e){var t={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,caseID:e};return u.global.ajax.Detail_TestCase=c.TestCase.Detail(t),u.global.ajax.Detail_TestCase.$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:h[e]=t.caseInfo}}),u.global.ajax.Detail_TestCase.$promise},m["delete"]=function(e,t,a){var s={title:"删除测试用例",message:"请问是否删除该测试用例？"},r={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,apiID:a,caseID:"["+e.item.caseID+"]"};u.EnsureModal(s.title,!1,s.message,{},function(s){s&&c.TestCase.Delete(r).$promise.then(function(s){switch(s.statusCode){case l.COMMON.SUCCESS:u.InfoModal("测试用例删除成功","success"),d.ajaxResponse.query[t].caseList.splice(e.$index,1);var r=d.ajaxResponse.query[t].selectObj.query.indexOf(e.item.caseID);r!==-1&&(d.data.selectCaseNum--,d.ajaxResponse.query[t].selectObj.query.splice(r,1),delete d.data.testHistory[a][e.item.caseID],delete d.ajaxResponse.query[t].selectObj.indexAddress[e.item.caseID]),d.data.isOperate=!0}})})},m.edit=function(e,t,a,s){if("free"===d.service.authority.product.ams)return void u.Common_UpgradeNoticeModal({mark:"AMS",module:"api_case"});var r={baseInfo:Object.assign({},f,{apiID:a,caseID:"add"!==e?s.item.caseID:null}),caseInfo:{},status:e};switch(e){case"add":var o=h[a];if(o)switch(r.dataStructureList=o.dataStructureList,r.caseInfo={caseData:{headers:o.headerInfo,params:o.requestInfo,URL:o.baseInfo.apiURI,requestType:o.baseInfo.apiRequestParamType.toString(),raw:o.baseInfo.apiRequestRaw,apiRequestType:o.baseInfo.apiRequestType.toString(),httpHeader:o.baseInfo.apiProtocol.toString(),urlParam:o.urlParam,restfulParam:o.restfulParam,auth:o.authInfo,apiRequestParamJsonType:o.baseInfo.apiRequestParamJsonType,script:{before:o.baseInfo.beforeInject,after:o.baseInfo.afterInject,type:"0"}},advancedSetting:o.baseInfo.advancedSetting||{requestRedirect:1}},o.resultParamType){case 0:r.caseInfo.jsonResultVerification={resultType:o.resultParamJsonType||0},r.caseInfo.matchType=3,r.caseInfo.matchRule=angular.copy(o.resultInfo);break;case 1:r.caseInfo.matchType=4,r.caseInfo.matchRule=angular.copy(o.resultInfo);break;case 2:r.caseInfo.matchType=0,r.caseInfo.matchRule=o.resultInfo;break;case 3:r.caseInfo.matchType=2;break;default:r.caseInfo.matchType=3,r.caseInfo.matchRule=i("paramLevelToNestFilter")(o.resultInfo,{isInheritParamType:!0})}r.caseInfo.matchRule=r.caseInfo.matchRule||[],u.AMS_TestExampleModal(r,function(e){e&&(d.data.isOperate=!0,d.ajaxResponse.query[t].selectObj.query.push(e.caseID),d.ajaxResponse.query[t].selectObj.indexAddress[e.caseID]=1,d.data.selectCaseNum++,d.ajaxResponse.query[t].caseList.push({caseName:e.caseName,caseID:e.caseID,creator:e.creator}),d.data.testHistory[a][e.caseID]={})});break;case"copy":return void m.copy({id:a,index:t},s.item.caseID,s.item.caseName);default:var n=h[s.item.caseID];if(!n){var c=m.getCaseInfo(s.item.caseID);return void c["finally"](function(){r.caseInfo=Object.assign({},r.caseInfo,h[s.item.caseID]),u.AMS_TestExampleModal(r,function(e){e&&(d.data.isOperate=!0,e.output.creator=s.item.creator,e.output.createTime=s.item.createTime,h[s.item.caseID]=e.output,d.ajaxResponse.query[t].caseList[s.$index].caseName=e.output.caseName,e.output.jsonResultVerification=JSON.parse(e.output.jsonResultVerification),d.data.testHistory[a][s.item.caseID]={})})})}r.caseInfo=Object.assign({},r.caseInfo,n),u.AMS_TestExampleModal(r,function(e){e&&(d.data.isOperate=!0,e.output.creator=s.item.creator,e.output.createTime=s.item.createTime,h[s.item.caseID]=e.output,d.ajaxResponse.query[t].caseList[s.$index].caseName=e.output.caseName,e.output.jsonResultVerification=JSON.parse(e.output.jsonResultVerification),d.data.testHistory[a][s.item.caseID]={})})}},m.copy=function(e,t,a){var s={title:"复制测试用例",textArray:[{type:"input",title:"用例名称",key:"caseName",value:"副本-"+a,required:!0}],btnObject:{"class":"eo_theme_btn_info",text:"确认"}},r=Object.assign({caseID:t,apiID:e.id},f);u.MixInputModal(s,function(t){t&&(r.caseName=t.caseName,c.TestCase.Copy(r).$promise.then(function(t){switch(t.statusCode){case l.COMMON.SUCCESS:d.ajaxResponse.query[e.index].selectObj.query.push(t.caseID),d.ajaxResponse.query[e.index].selectObj.indexAddress[t.caseID]=1,d.ajaxResponse.query[e.index].caseList.push({caseName:r.caseName,caseID:t.caseID,creator:t.creator}),u.InfoModal("复制成功","success"),d.data.selectCaseNum++,d.data.isOperate=!0,d.data.testHistory[e.id][t.caseID]={};break;default:u.InfoModal("复制失败，"+o.FAILURE,"error")}}))})},m.initBlockTable=function(){d.component.blockListObject["case"]={baseFun:{showTestHistory:m.showTestHistory,checkIsValidItem:function(){return!d.data.isTesting},clickCheckbox:function(e,t){switch(e){case"plus-single":d.data.selectCaseNum++;break;case"plus-all":d.data.selectCaseNum=d.data.selectCaseNum+t.currentLenght-t.oldLength;break;case"minus-single":d.data.selectCaseNum--;break;case"minus-all":d.data.selectCaseNum=d.data.selectCaseNum-t.oldLength}}},setting:{checkboxKeyIsNum:!0,trExpression:'ng-if="!item.isHide"'},tdList:[{type:"checkbox",activeKey:"caseID",isWantedToExposeObject:!0},{thKey:"用例名称",type:"text",modelKey:"caseName"},{thKey:"最近测试结果",type:"html",html:r.get("module/ams/ui/project/inside/content/case/partB/index.tmp.html"),"class":"w_200"},{thKey:"测试时间",type:"html","class":"w_200",html:"{{$ctrl.otherObject.testHistoryObj[item.caseID].testTime}}"},{thKey:"创建者",type:"text",modelKey:"creator","class":"w_200"},{type:"btn","class":"w_250",authority:"showOperateColumn",btnList:[{html:'{{$ctrl.otherObject.testHistoryObj[item.caseID].testing?"中止":"测试"}}',authority:"test",fun:d.fun.test,param:'"single",inputArg,vm.otherObject.apiID',"class":"batch-test-btn",itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting&&!$ctrl.otherObject.testHistoryObj[item.caseID].testing" testing="{{$ctrl.otherObject.testHistoryObj[item.caseID].testing||false}}"',isUnWantToStopPropagation:!0},{key:"复制",authority:"editApiCase",fun:m.edit,param:'"copy",vm.otherObject.apiIndex,vm.otherObject.apiID,inputArg',itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'},{key:"编辑",authority:"editApiCase",fun:m.edit,param:'"edit",vm.otherObject.apiIndex,vm.otherObject.apiID,inputArg',itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'},{key:"删除",authority:"editApiCase",operateName:"delete",fun:m["delete"],param:"inputArg,vm.otherObject.apiIndex,vm.otherObject.apiID",itemExpression:'ng-disabled="$ctrl.otherObject.allIsTesting||$ctrl.otherObject.testHistoryObj[item.caseID].testing"'}]}]}},d.fun.removeApi=function(e,t){var a=d.ajaxResponse.query[e];d.ajaxResponse.query.splice(e,1),h.acceptApiIndexArr.splice(e,1),d.data.selectCaseNum=d.data.selectCaseNum-a.selectObj.query.length,d.data.testHistory[a.apiID]&&delete d.data.testHistory[a.apiID],d.triggle={action:"removeApi",param:t}},d.fun.spreedConsole=function(e){d.data.isSpreedConsole=e},m.getApiAndCaseList=function(e){d.data.ajaxQueryNum++;var t={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,apiID:JSON.stringify(e)},a=c.TestCase.BatchQuery(t);a.$promise.then(function(t){switch(d.data.ajaxQueryNum--,t.statusCode){case l.COMMON.SUCCESS:var a=t.apiList||[];a.map(function(e){e.selectObj={selectAll:!0,indexAddress:{},query:[]},d.data.testHistory[e.apiID]={},d.data.selectCaseNum+=e.caseList.length,e.caseList.map(function(t){e.selectObj.indexAddress[t.caseID]=1,e.selectObj.query.push(t.caseID),d.data.testHistory[e.apiID][t.caseID]={responseType:t.latestTestResult,testTime:t.testTime}})}),d.ajaxResponse.query=(d.ajaxResponse.query||[]).concat(a)}d.triggle={action:"ajaxEnd",param:e}}),y.push(a)},m.actionOpr=function(e){switch(e.action){case"addApi":m.getApiAndCaseList(e.param),0===h.acceptApiIndexArr.length&&(d.data.isSpreedConsole=!0),h.acceptApiIndexArr=h.acceptApiIndexArr.concat(e.param);break;case"removeApi":e.param.map(function(e){var t=h.acceptApiIndexArr.indexOf(e);d.ajaxResponse.query.splice(t,1),h.acceptApiIndexArr.splice(t,1)})}},e.$watch("$ctrl.accept",function(){d.accept&&d.accept.action&&m.actionOpr(d.accept)}),d.fun.refreshPartA=function(){d.data.isOperate=!1,d.triggle={action:"refresh"}},d.fun.initEnv=function(){e.$emit("$TransferStation",{state:"$EnvInitReady"})},m.showTestHistory=function(e,t){var a=angular.copy(d.data.testHistory[t.apiID][t.caseID]),s=function(){var t=a.general.match.type.toString();d.report.object={status:e,general:Object.assign({},{match:{rule:a.general.match.rule}},a.general),requestHeaders:"{}"===JSON.stringify(a.requestHeaders)?null:a.requestHeaders,requestBody:{requestType:"string"==typeof a.requestBody.body?"1":a.requestBody.requestType,body:"{}"===JSON.stringify(a.requestBody.body)?null:a.requestBody.body},returnResultType:a.returnResultType,responseHeaders:a.responseHeaders,response:a.response,baseInfo:{caseName:a.caseName||a.general.name,matchType:"3"===t?2:"2"===t?3:t,matchTypeMessage:"0"===t?"完全匹配":"1"===t?"正则匹配":"2"===t?"不匹配":"3"===t?"Json匹配":"4"===t?"XML匹配":"状态码校验",statusCode:a.general.match.statusCode,matchHeaderType:0,matchHeaderTypeMessage:"不校验"},errorReason:a.errorReason,reportList:a.reportList,isLocal:a.isLocal},d.report.show=!0};if(a.general)s();else{var r={spaceKey:f.spaceKey,projectHashKey:f.projectHashKey,caseID:t.caseID};c.TestCase.InfoReport(r).$promise.then(function(e){a=e.reportInfo,a.general.match?(d.data.testHistory[t.apiID][t.caseID]=angular.copy(a),s()):c.TestCase.CaseData(r).$promise.then(function(e){a.general.match={rule:e.matchRule,type:e.matchType,statusCode:e.statusCode,jsonResultVerification:e.jsonResultVerification},d.data.testHistory[t.apiID][t.caseID]=angular.copy(a),s()})})}},d.$onInit=function(){m.initBlockTable()},e.$on("$stateChangeStart",function(){I.ws&&I.ws.close()})}angular.module("eolinker.ams").component("homeProjectInsideCasePartB",{templateUrl:"module/ams/ui/project/inside/content/case/partB/index.html",controller:e,bindings:{triggle:"=",accept:"<",report:"="}}),e.$inject=["$scope","$sce","COOKIE_CONFIG","Operate_CommonService","$templateCache","$filter","RESPONSE_TEXT","Authority_CommonService","ApiManagementResource","$state","CODE","$rootScope"]}();
"use strict";!function(){function e(e,a,t,r,s,i,n,o,c,d){var l=this;l.data={apiNum:0,batch:{},filterObject:{},loadStorageQuery:{query:[],indexAddress:{}},pagination:{maxSize:10,pageSize:30,page:1,msgCount:0},listOrderBy:JSON.parse(window.localStorage.PROJECT_CASE_SORTTYPE||'{"orderBy": 1,"asc": 1}')},l.service={home:r,authority:c},l.fun={};var u={},p={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:i.params.projectHashKey,groupID:i.params.groupID||-1,searchCondition:window.sessionStorage.getItem("COMMON_SEARCH_TIP"),apiID:[],module:0},m={previousPage:1};l.ajaxResponse={query:[]},l.component={menuObject:{},groupCommonObject:{},listDefaultCommonObject:{}},l.fun.onResize=function(){window.innerWidth<=1300&&e.$emit("$TransferStation",{state:"$HomeProjectInsideSidebarShrink"})},l.fun.changePage=function(){m.previousPage+1===l.data.pagination.page&&m.preloadData?(l.data.pagination.msgCount=m.preloadData.itemNum,l.ajaxResponse.query=fun.filter(m.preloadData.apiList||[]),document.getElementsByClassName("tbody_container_ldcc")&&(document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0),m.preloadData=null):e.$broadcast("$Init_LoadingCommonComponent"),m.previousPage=l.data.pagination.page},u.resetBatchInfo=function(){l.data.batch.isOperating=!0,l.data.batch.selectAll=!1,l.data.batch.query=[],l.data.batch.indexAddress={}},u.search=function(a){if(p.searchCondition||a.item.keyword){var t=p.searchCondition?JSON.parse(p.searchCondition):{};t.keyword=a.item.keyword||"",p.searchCondition=JSON.stringify(t),window.sessionStorage.setItem("COMMON_SEARCH_TIP",p.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})}},u.translateApiStatus=function(e){return{apiStatusString:a.API_STATUS_QUERY[e].key,apiStatusClass:"eo-label-"+a.API_STATUS_QUERY[e]["class"]}},u.parseItem=function(e){var a={},t=[];for(var r in e){var s=e[r];a=u.translateApiStatus(s.apiStatus),s.apiStatusClass=a.apiStatusClass,s.apiStatusString=a.apiStatusString,t.push(s)}return t},u.initApiID=function(){var e={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,groupID:p.groupID,orderBy:l.data.listOrderBy.orderBy,asc:l.data.listOrderBy.asc};if(p.searchCondition&&'{"keyword":""}'!=p.searchCondition)try{angular.merge(e,JSON.parse(p.searchCondition))}catch(a){}s.TestCase.QueryApiID(e).$promise.then(function(e){switch(e.statusCode){case n.COMMON.SUCCESS:l.data.allQueryID=e.apiIDList}})},u.sort=function(a){l.data.listOrderBy=a.listOrderBy,e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},u.clickItem=function(e,a){var t;try{t=e.$event.target.classList[0]}catch(r){t="default"}switch(t){case"btn-jump":window.open(i.href("home.ams.project.inside.api.detail",{groupID:i.params.groupID||p.groupID,apiID:e.item.apiID}),"_blank");break;default:if(l.data.batch.indexAddress[e.item.apiID]&&!l.data.loadStorageQuery.indexAddress[e.item.apiID])return;l.data.batch.indexAddress[e.item.apiID]?(l.triggle={action:"removeApi",param:[e.item.apiID]},l.data.loadStorageQuery.query.splice(l.data.loadStorageQuery.query.indexOf(e.item.apiID),1),delete l.data.loadStorageQuery.indexAddress[e.item.apiID]):l.triggle={action:"addApi",param:[e.item.apiID]},a(e)}},u.newTarget=function(e){window.open(i.href("home.ams.project.inside.api.detail",{groupID:i.params.groupID||p.groupID,apiID:e.item.apiID}),"_blank")},u.init=function(e){var a,t={spaceKey:p.spaceKey,projectHashKey:p.projectHashKey,groupID:p.groupID,orderBy:l.data.listOrderBy.orderBy,asc:l.data.listOrderBy.asc,pageSize:l.data.pagination.pageSize};switch(m.isQuerying=!0,e){case"refresh":t.pageSize=l.data.pagination.pageSize*l.data.pagination.page,t.page=1,a=function(e){m.isQuerying=!1,l.ajaxResponse.query=u.parseItem(e.apiList||[])};break;case"preload":if(t.page=l.data.pagination.page+1,m.preloadData&&t.page===m.preloadData.dataPage)return;m.preloadData={dataPage:t.page},a=function(e){m.isQuerying=!1,m.preloadData.itemNum=e.itemNum,m.preloadData.apiList=e.apiList,l.data.batch.selectAll&&l.data.allQueryID&&l.data.batch.query.length!==l.data.allQueryID.length&&(l.data.batch.selectAll=!1),l.data.pagination.msgCount=m.preloadData.itemNum,l.ajaxResponse.query=u.parseItem(l.ajaxResponse.query.concat(m.preloadData.apiList||[])),l.data.pagination.page++,m.preloadData=null};break;default:t.page=l.data.pagination.page,a=function(e){if(m.isQuerying=!1,document.getElementsByClassName("tbody_container_ldcc")[0].scrollTop=0,l.data.pagination.msgCount=e.itemNum,l.ajaxResponse.query=u.parseItem(e.apiList||[]),l.data.batch.isOperating){l.data.batch.selectAll=!1;for(var a=!1,t=0;t<l.ajaxResponse.query.length;t++)if(l.data.batch.query.indexOf(l.ajaxResponse.query[t][l.component.listDefaultCommonObject.item.primaryKey])===-1){a=!0;break}l.ajaxResponse.query.length&&!a&&(l.data.batch.selectAll=!0)}m.preloadData=null},u.initApiID()}if(p.searchCondition&&'{"keyword":""}'!=p.searchCondition)try{angular.merge(t,JSON.parse(p.searchCondition))}catch(r){}return o.global.ajax.Query_Api&&o.global.ajax.Query_Api.$cancelRequest(),o.global.ajax.Query_Api=s.TestCase.QueryPartA(t),o.global.ajax.Query_Api.$promise.then(a),o.global.ajax.Query_Api.$promise},u.scrollLoading=function(e){var a={hasItem:l.ajaxResponse.query&&0!==l.ajaxResponse.query.length,hasNextPage:l.data.pagination.page<l.data.pagination.msgCount/l.data.pagination.pageSize,isQuerying:m.isQuerying};a.hasItem&&a.hasNextPage&&!a.isQuerying&&u.init("preload")},u.initColumnFilter=function(){var e={status:1,URL:1,caseNum:1,successRate:1,testStatus:1};try{l.data.filterObject.indexAddress=JSON.parse(window.localStorage.AMS_PROJECT_CASE_COLOUMN_FILTER_OBJECT)}catch(a){l.data.filterObject.indexAddress=e}for(var t in l.data.filterObject.indexAddress)0===l.data.filterObject.indexAddress[t]&&delete l.data.filterObject.indexAddress[t]},u.parseFilterIndexAddress=function(){var e={},a={},t=["condition"];try{e=JSON.parse(p.searchCondition)||{}}catch(r){}return e&&t.map(function(t){if(e[t]){a[t]={};var r=JSON.parse(e[t]),s=!0,i=!1,n=void 0;try{for(var o,c=r[Symbol.iterator]();!(s=(o=c.next()).done);s=!0){var d=o.value;a[t][d]=1}}catch(l){i=!0,n=l}finally{try{!s&&c["return"]&&c["return"]()}finally{if(i)throw n}}}}),a.keyword=e.keyword,a},l.fun.init=function(e){switch(e=e||{},e.status){case"reset":return l.data.pagination.page=1,u.init();case"refresh":return u.init("refresh");default:return u.init()}},u.setFilter=function(a,t){var r=void 0;try{r=JSON.parse(p.searchCondition)||{keyword:""}}catch(s){r={keyword:""}}t.selectAll?delete r[a]:r[a]=JSON.stringify(t.query),p.searchCondition=JSON.stringify(r),window.sessionStorage.setItem("COMMON_SEARCH_TIP",p.searchCondition),e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},u.clickGroupCallback=function(a){e.$broadcast("$Init_LoadingCommonComponent",{status:"reset"})},u.selectAll=function(e){var a=[];switch(e){case"selectAll":l.data.allQueryID.map(function(e,t){l.data.batch.indexAddress[e]||(l.data.batch.query.push(e),a.push(e),l.data.batch.indexAddress[e]=t+1)}),a.length&&(l.triggle={action:"addApi",param:a},l.data.batch.selectAll=!0);break;case"selectView":var t=[],r=angular.copy(l.data.batch.query);l.ajaxResponse.query.map(function(e,r){l.data.batch.indexAddress[e.apiID]||(a.push(e.apiID),l.data.batch.query.push(e.apiID),l.data.batch.indexAddress[e.apiID]=r+1),t.push(e.apiID)});var s=t.concat(r).filter(function(e){return(!t.includes(e)||!r.includes(e))&&l.data.loadStorageQuery.indexAddress[e]});a.length&&(l.triggle={action:"addApi",param:a},l.data.batch.selectAll=!0),s.length&&(angular.forEach(s,function(e,a){l.data.loadStorageQuery.indexAddress[e]&&(l.data.batch.query.splice(l.data.batch.query.indexOf(e),1),delete l.data.batch.indexAddress[e],l.data.loadStorageQuery.query.splice(l.data.loadStorageQuery.query.indexOf(e),1),delete l.data.loadStorageQuery.indexAddress[e])}),l.triggle={action:"removeApi",param:s});break;case"cancelAll":l.data.allQueryID.map(function(e,t){l.data.loadStorageQuery.indexAddress[e]&&(a.push(e),l.data.batch.query.splice(l.data.batch.query.indexOf(e),1),delete l.data.batch.indexAddress[e],l.data.loadStorageQuery.query.splice(l.data.loadStorageQuery.query.indexOf(e),1),delete l.data.loadStorageQuery.indexAddress[e])}),a.length&&(l.triggle={action:"removeApi",param:a},l.data.batch.selectAll=!l.data.batch.selectAll)}},l.$onInit=function(){u.resetBatchInfo(),l.accept=l.accept||{},e.$emit("$WindowTitleSet",{list:["[列表]API测试用例-API列表","API管理"]});var a=u.parseFilterIndexAddress();l.component.groupCommonObject={requestObject:{resource:t.Group,baseRequest:{module:2,spaceKey:p.spaceKey,projectHashKey:p.projectHashKey}},funObject:{btnGroupList:[],clickCallback:u.clickGroupCallback,callback:{querySuccess:function(e){}}},mainObject:{baseInfo:{sort:!0,name:"groupName",id:"groupID",current:p},staticQuery:[{groupID:-1,groupName:"所有API",icon:"caidan"}],itemFun:[]}},l.component.listDefaultCommonObject={item:{primaryKey:"apiID",batchItemExpression:"ng-disabled='$ctrl.otherObject.batch.indexAddress[item.apiID]&&!$ctrl.otherObject.loadStorageQuery.indexAddress[item.apiID]'","default":[{thType:"html",thHtml:"<span>APIs&nbsp;</span>",sort:!0,sortOrderByVal:0,draggableCacheMark:"name",sortAndFilterConf:{canSort:!0},html:'<span class="btn-change-status api-status-label {{item.apiStatusClass}}"  ng-if="$ctrl.authorityObject.operate&&$ctrl.showObject.columnFilterObject.status==1">{{item.apiStatusString}}</span><span class="api-status-label {{item.apiStatusClass}}" ng-if="$ctrl.showObject.columnFilterObject.status==1&&!$ctrl.authorityObject.operate">{{item.apiStatusString}}</span><div class="name-box" ng-class="{\'w_100percent\':!$ctrl.showObject.columnFilterObject.status}"><span class="api-name">{{item.apiName}}</span></div>'},{key:"URL","class":"cancel-nowrap",showPoint:"columnFilterObject",showVariable:"URL",show:1,sort:!0,sortOrderByVal:1,sortAndFilterConf:{canSort:!0},draggableCacheMark:"url",html:'<div class="url-box w_100percent"><div><span class="api-url-text" title="{{item.apiURI}}">{{item.apiURI}}</span></div></div>'},{key:"测试用例数量",html:"{{item.testCaseNum}}",draggableCacheMark:"caseNum",showPoint:"columnFilterObject",showVariable:"caseNum",show:1,sort:!0,sortOrderByVal:2,sortAndFilterConf:{canSort:!0}},{key:"通过率",html:"<span ng-class=\"{'cg':item.successRate==='100.00','cr':item.successRate&&item.successRate!=='100.00'}\">{{item.testCaseNum&&item.successRate?(item.successRate+\"%\"):\"-\"}}",draggableCacheMark:"successRate",showPoint:"columnFilterObject",showVariable:"successRate",show:1,sort:!0,sortOrderByVal:3,sortAndFilterConf:{canSort:!0}},{key:"状态",html:'<span ng-class="{\'cg\':item.testStatus===\'0\',\'cr\':item.testStatus===\'1\',\'c9\':item.testStatus===\'2\'}">{{item.testStatus==="0"?"已通过":item.testStatus==="1"?"未通过":item.testStatus==="2"?"存在未测试用例":"-"}}</span>',draggableCacheMark:"testStatus",showPoint:"columnFilterObject",showVariable:"testStatus",show:1,sortAndFilterConf:{canFilter:!0,filterHtml:"{{item.key}}","class":"w_200 eo_to_right_0",filterArr:[{key:"已通过",value:0},{key:"未通过",value:1},{key:"有未执行测试用例",value:2}],filterIndexAddress:a.condition},filterFun:function(e){u.setFilter("condition",e)}}],operate:{"class":"w_100",funArr:[{type:"more",key:"更多",funArr:[{key:"跳转到API","class":"btn-jump"}]}]}},setting:{warning:"尚未存在任何API",draggable:!0,dragCacheVar:"AMS_API_TEST_CASE_LIST_DRAG_VAR",dragCacheObj:{name:"250px",url:"250px",caseNum:"150px",successRate:"150px",testStatus:"150px"},isFixedHeight:!0,batch:!0,batchInitStatus:"open",selfControllClickBatch:!0,page:!0,autoSort:!0,sortStorageKey:"PROJECT_CASE_SORTTYPE",sortDefaultVal:{storageVal:{orderBy:1,asc:1},sortOrder:"asc"},scroll:!0},baseFun:{click:u.clickItem,selectAll:u.selectAll,scrollLoading:u.scrollLoading,autoSortFun:u.sort}},u.initColumnFilter(),l.component.menuObject={list:[{type:"tab_block_list","class":"pull-right ml15",name:"列表项",icon:"shebeisousuo",blockName:"listItem",query:[{key:"API状态",value:"status"},{key:"URL",value:"URL"},{key:"测试用例数量",value:"caseNum"},{key:"通过率",value:"successRate"},{key:"状态",value:"testStatus"}]},{type:"search","class":"pull-right",keyword:a.keyword,fun:u.search}],setting:{listItemStorageName:"AMS_PROJECT_CASE_COLOUMN_FILTER_OBJECT",batchInitFun:u.resetBatchInfo,titleAuthority:"showTitle",title:"API"}}},u.countItemSelectIsAll=function(){for(var e=!1,a=0;a<l.ajaxResponse.query.length;a++)if(l.data.batch.query.indexOf(l.ajaxResponse.query[a].apiID)===-1){e=!0;break}l.ajaxResponse.query&&!e?l.data.batch.selectAll=!0:l.data.batch.selectAll=!1},o.global.$watch.push(e.$watch("$ctrl.accept",function(){if(l.accept)switch(l.accept.action){case"refresh":e.$broadcast("$Init_LoadingCommonComponent",{status:"refresh"});break;case"removeApi":var a={indexA:l.data.batch.query.indexOf(l.accept.param),indexB:l.data.loadStorageQuery.query.indexOf(l.accept.param)};a.indexB!==-1&&(l.data.batch.query.splice(a.indexA,1),delete l.data.batch.indexAddress[l.accept.param],l.data.loadStorageQuery.query.splice(a.indexB,1),delete l.data.loadStorageQuery.indexAddress[l.accept.param]),l.data.batch.selectAll=!1;break;case"clearApi":var t=angular.copy(l.data.batch.query);angular.forEach(t,function(e,a){if(l.data.loadStorageQuery.indexAddress[e]){var t={indexA:l.data.batch.query.indexOf(e),indexB:l.data.loadStorageQuery.query.indexOf(e)};l.data.batch.query.splice(t.indexA,1),delete l.data.batch.indexAddress[e],l.data.loadStorageQuery.query.splice(t.indexB,1),delete l.data.loadStorageQuery.indexAddress[e]}}),l.data.batch.selectAll=!1;break;case"ajaxEnd":angular.forEach(l.accept.param,function(e,a){l.data.batch.indexAddress[e]&&(l.data.loadStorageQuery.indexAddress[e]=1,l.data.loadStorageQuery.query.push(e))})}}))}angular.module("eolinker.ams").component("homeProjectInsideCasePartA",{templateUrl:"module/ams/ui/project/inside/content/case/partA/index.html",controller:e,bindings:{triggle:"=",accept:"<"}}),e.$inject=["$scope","API_AMS_CONSTANT","GeneralFunResource","Operate_CommonService","ApiManagementResource","$state","CODE","$rootScope","Authority_CommonService","Cache_CommonService"]}();
"use strict";!function(){function e(e,t,a,s,n,o,i,c,u,r){var l=this;l.service={authority:u},l.data={batch:{}},l.ajaxResponse={query:null},l.fun={},l.component={listObject:null,menuObject:{list:null,otherObject:null}};var d={},m={},b={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:r.params.projectHashKey,module:1};d.resetBatchInfo=function(){l.data.batch.isOperating=!1,l.data.batch.indexAddress={},l.data.batch.query=[],l.data.batch.selectAll=!1,l.ajaxResponse.query=m.query},d.filterQuery=function(e){switch(e){case"delete":m.query=m.query.filter(function(e,t){return!l.data.batch.indexAddress[e[l.component.listObject.mainObject.item.primaryKey]]})}d.resetBatchInfo()},l.fun.init=function(){var t={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,module:b.module};return e.global.ajax.DataBaseQuery_GeneralResource=c.Database.Query(t),e.global.ajax.DataBaseQuery_GeneralResource.$promise.then(function(e){l.ajaxResponse.query=e.dbList||[],m.query=e.dbList||[]}),e.global.ajax.DataBaseQuery_GeneralResource.$promise},d["delete"]=function(t){t=t||{};var s={spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,dbID:"batch"===t.status?JSON.stringify(l.data.batch.query):"["+t.item.dbID+"]",module:b.module};e.EnsureModal("删除数据库",!1,n.DELETE,{},function(n){n&&c.Database.Delete(s).$promise.then(function(s){switch(s.statusCode){case a.COMMON.SUCCESS:switch(e.InfoModal("数据库删除成功","success"),t.status){case"batch":d.filterQuery("delete");break;case"single":l.ajaxResponse.query.splice(t.$index,1)}break;default:e.InfoModal("删除失败，"+o.FAILURE,"error")}})})},d.edit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{item:{}};r.go("home.ams.automatic.inside.public.database.operate",{dbID:e.item.dbID})},d.test=function(t){var s=Object.assign({spaceKey:b.spaceKey,projectHashKey:b.projectHashKey,module:b.module},t.item);c.Database.CheckConn(s).$promise.then(function(t){switch(t.statusCode){case a.COMMON.SUCCESS:e.InfoModal("连接数据库成功","success");break;default:e.InfoModal("连接数据库失败","error")}})},l.$onInit=function(){s.$emit("$WindowTitleSet",{list:["数据库","自动化测试"]}),l.component.listObject={mainObject:{baseFun:{showCase:d.showCase},CONST:{DB_TYPE_ARR:t},item:{primaryKey:"dbID","default":[{key:"数据库名称",html:"{{item.dbConnectName}}"},{key:"数据库类型",html:"{{$ctrl.mainObject.CONST.DB_TYPE_ARR[item.dbType]}}"},{key:"备注",html:"{{item.dbDesc}}"}],operate:{funArr:[{key:"编辑",fun:d.edit},{key:"删除",fun:d["delete"],params:{status:"single"},itemExpression:'ng-if="item.isQuoted===0"'}],"class":"w_150"}},setting:{warning:"暂无数据库",batch:!0,unhover:!0}}},l.component.menuObject.mainObject={list:[{type:"btn",authority:"edit","class":"pull-left",btnList:[{name:"新建数据库连接",icon:"jiahao","class":"eo_theme_btn_success block-btn",fun:{"default":d.edit,params:{status:"add"}}}]}],batchList:[{type:"btn","class":"pull-left",btnList:[{name:"删除",icon:"shanchu",fun:{"default":d["delete"],params:{status:"batch"}}}]}],setting:{batch:!0,batchInitFun:d.resetBatchInfo,title:"数据库连接","class":"common-menu-fixed-seperate common-menu-lg",titleAuthority:"showTitle"},baseFun:{batchDefault:function(){l.ajaxResponse.query=l.ajaxResponse.query.filter(function(e){return!e.isQuoted})}}}}}angular.module("eolinker.ams").component("homeAutomaticInsideDatabaseDefault",{templateUrl:"module/ams/ui/automatic/inside/content/public/database/default/index.html",controller:e}),e.$inject=["$rootScope","PUBLIC_RESOURCE_DB_TYPE_ARR","CODE","$scope","ENSURE_WARNIMG","RESPONSE_TEXT","$filter","GeneralFunResource","Authority_CommonService","$state"]}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,n,s,o,a,i){var r=this;r.data={submitted:!1,testObj:{}},r.component={blockListConf:{},menuObject:{list:[]}},r.ajaxResponse={dbInfoList:[{}],dbType:0},r.CONST={DABASE_TYPE:[{key:"Mysql",value:0},{key:"Oracle",value:1}]};var c={},l={spaceKey:eoSystemObj.VARIABLES.spaceKey,projectHashKey:o.params.projectHashKey,dbID:o.params.dbID,module:1},p={envIDArr:[]};r.fun={},r.fun.changeDbType=function(){r.component.blockListConf.itemStructure.port=1===r.ajaxResponse.dbType?"1521":"3306",r.ajaxResponse.dbInfoList=[{envID:0,port:r.component.blockListConf.itemStructure.port},angular.copy(r.component.blockListConf.itemStructure)],p.envIDArr=[0]},c.ajaxEnv=function(){t.Env.All({spaceKey:l.spaceKey,projectHashKey:l.projectHashKey,module:1}).$promise.then(function(e){r.component.blockListConf.tdList[0].selectQuery=[{envID:0,envName:"默认配置"}].concat(_toConsumableArray(e.envList||[])),l.dbID||r.fun.changeDbType()})},c.bindWs=function(e){return p.ws?void p.ws.send(JSON.stringify(e)):(p.ws=new WebSocket((eoSystemObj.HOST.indexOf("https")>-1?"wss://":"ws://")+eoSystemObj.WS_TARGET_PREFIX_URL+"/nodeWebsocketServer/testDbConn"),p.ws.onopen=function(){p.ws.send(JSON.stringify(e))},p.ws.onmessage=function(e){var t=JSON.parse(e.data);switch(t.statusCode){case"160000":i.InfoModal("缺少测试信息","error");break;default:r.data.testObj[t.envID]=t.status}s.$root&&s.$root.$$phase||s.$apply()},p.ws.onclose=function(e){p.ws=null},void(p.ws.onerror=function(e){p.ws=null}))},c.testConn=function(e){e.host&&e.user&&e.name&&e.port?"testing"===r.data.testObj[e.envID]?(delete r.data.testObj[e.envID],c.bindWs(Object.assign({},{status:"abort",envID:e.envID}))):(r.data.testObj[e.envID]="testing",e.database=e.name,c.bindWs({status:"ajax",data:e,envID:e.envID,type:0===r.ajaxResponse.dbType?"mysql":"oracle"})):i.InfoModal("请填写完整的测试信息","error")},c.confirmForm=function(c){if(s.ConfirmForm.$invalid)return void(r.data.submitted=!0);r.data.submitted=!1,c=c||{};var p=Object.assign({},angular.copy(r.ajaxResponse),{spaceKey:l.spaceKey,projectHashKey:l.projectHashKey,dbID:l.dbID,module:l.module}),u=null;return p.dbInfoList=JSON.stringify(p.dbInfoList.slice(0,p.dbInfoList.length-1),function(e,t){if(!/(\$\$hashKey)|(listDepth)/.test(e))return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&(t.password=n("AESEncrypt_CommonFilter")("1e42=7838a1vfc6n",CryptoJS.MD5(t.user).toString(),t.password)),t}),l.dbID?(u=t.Database.Edit(p).$promise,u.then(function(t){switch(t.statusCode){case a.COMMON.SUCCESS:i.InfoModal("编辑数据库连接成功！","success");break;default:i.InfoModal("编辑数据库连接失败，"+e.FAILURE,"error")}})):(u=t.Database.Add(p).$promise,u.then(function(t){switch(t.statusCode){case a.COMMON.SUCCESS:i.InfoModal("创建数据库连接成功！","success"),o.go("home.ams.automatic.inside.public.database.default");break;default:i.InfoModal("创建数据库连接失败，"+e.FAILURE,"error")}})),u},r.fun.init=function(){if(l.dbID){var e={spaceKey:l.spaceKey,projectHashKey:l.projectHashKey,dbID:l.dbID,module:l.module};p.envIDArr=[],i.global.ajax.Info_Database=t.Database.Info(e),i.global.ajax.Info_Database.$promise.then(function(e){var t=e.dbInfoList||[];r.component.blockListConf.itemStructure.port=1===r.ajaxResponse.dbType?"1521":"3306",t.map(function(e){p.envIDArr.push(e.envID),e.password&&(e.password=n("AESDecrypt_CommonFilter")("1e42=7838a1vfc6n",CryptoJS.MD5(e.user).toString(),e.password))}),r.ajaxResponse={dbType:e.dbType,dbInfoList:[].concat(_toConsumableArray(t),[{port:r.component.blockListConf.itemStructure.port}]),dbConnectName:e.dbConnectName,dbDesc:e.dbDesc}})}},c.getSelectableEnvArr=function(e){var t=p.envIDArr.indexOf(e);t===-1?p.envIDArr.push(e):p.envIDArr.splice(t,1)},c.initLevelTable=function(){return{itemStructure:{port:"3306"},tdList:[{thKey:"项目环境名称",type:"select",key:"envName",value:"envID",selectQuery:[],modelKey:"envID","class":"pl10",leftHtml:'<span class="c999 mr10 pull-left lh_30" ng-if="$last">添加</span>',disabled:"item.envID||item.envID==0",initialData:"item.envID",mainObj:{setting:{customizeItemLabel:'<span class="eo-label-options plr5 ptb2 mr5" ng-if="item.isGlobal">全局</span>',emptyText:"项目环境"},fnFilterArr:function(e){if(p.envIDArr.indexOf(e.envID)===-1)return e}},fun:function(e){c.getSelectableEnvArr(e.item.envID)},itemExpression:"ng-class=\"{'new_text_input_haido':$last}\""},{thKey:"数据库地址",type:"input",modelKey:"host",itemExpression:'ng-pattern="/^(localhost)|(((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})|([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+.?)$/" required',tdItemExpression:'ng-if="!$last"'},{thKey:"端口号",type:"input",modelKey:"port",itemExpression:'ng-pattern="/^\\d*$/" required',tdItemExpression:'ng-if="!$last"'},{thKey:"数据库名称",type:"input",modelKey:"name",itemExpression:"required",tdItemExpression:'ng-if="!$last"'},{thKey:"用户名",type:"input",modelKey:"user",itemExpression:"required",tdItemExpression:'ng-if="!$last"'},{thKey:"密码",type:"input",inputType:"password",modelKey:"password",tdItemExpression:'ng-if="!$last"'},{type:"btn","class":"w_150",btnList:[{type:"html","class":"f_row_ac mr10 pr5",itemExpression:'ng-class="{\'brd\':!$first}" ng-switch="$ctrl.otherObject[item.envID]"',html:'<button class="test_btn eo-operate-btn" type="button" ng-click="$ctrl.mainObject.fnTestConn(item)"><span>{{$ctrl.otherObject[item.envID]==="testing"?"中止":"测试"}}</span></button><span class="iconfont icon-jiazai_shuaxin" ng-switch-when="testing"></span><span class="eo-status-success fs12" ng-switch-when="success">连接成功</span><span class="eo-status-error fs12" ng-switch-when="error">连接失败</span>'},{key:"删除",itemExpression:'ng-if="!$first" ng-disabled="$ctrl.otherObject[item.envID]===\'testing\'"',fun:function(e){r.ajaxResponse.dbInfoList.splice(e.$index,1),c.getSelectableEnvArr(e.item.envID)}}]}],fnTestConn:c.testConn}},c.initMenu=function(){r.component.menuObject={list:[{type:"btn","class":"btn-group-li pull-left",btnList:[{name:"返回列表",icon:"chexiao",fun:{"default":function(){o.go("home.ams.automatic.inside.public.database.default")}}}]},{type:"btn","class":"pull-left",btnList:[{name:"保存","class":"eo_theme_btn_success block-btn",fun:{disabled:1,"default":c.confirmForm}}]}],setting:{"class":"common-menu-fixed-seperate"}}},r.$onInit=function(){r.component.blockListConf=c.initLevelTable(),c.initMenu(),c.ajaxEnv()},s.$on("$stateChangeStart",function(){p.ws&&p.ws.close()})}angular.module("eolinker.ams").component("homeAutomaticInsideDatabaseOperate",{templateUrl:"module/ams/ui/automatic/inside/content/public/database/operate/index.html",controller:e,bindings:{authorityObject:"<",mark:"@"}}),e.$inject=["RESPONSE_TEXT","GeneralFunResource","$filter","$scope","$state","CODE","$rootScope"]}();
"use strict";!function(){function t(t,e,n,o){var i=this;i.component={envListObject:{}},i.service={authority:o},i.$onInit=function(){e.$emit("$WindowTitleSet",{list:["[列表]项目环境","API自动化测试"]}),i.component.envListObject={mainObject:{setting:{baseRouter:"home.ams.automatic.inside.public.env"},resource:t}}}}angular.module("eolinker.ams").component("homeAutomaticInsideEnv",{template:'<env-List-Product-Component main-object="$ctrl.component.envListObject.mainObject" authority-Object="$ctrl.service.authority.permission.automatic.environment"></env-List-Product-Component>',controller:t}),t.$inject=["AutomatedTestResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function t(t,e,o,n){var i=this;i.component={funListObject:{}},i.service={authority:n},i.$onInit=function(){e.$emit("$WindowTitleSet",{list:["[列表]通用函数","API自动化测试"]}),i.component.funListObject={mainObject:{setting:{baseRouter:"home.ams.automatic.inside.public.function",product:"ams",module:"automaticTest"},resource:t}}}}angular.module("eolinker.ams").component("homeAutomaticInsideFunctionDefault",{template:'<fun-list-product-component main-object="$ctrl.component.funListObject.mainObject" authority-Object="$ctrl.service.authority.permission.automatic.commonFunction"></fun-list-product-component>',controller:t}),t.$inject=["AutomatedTestResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,o,n){var i=this;i.component={envOperateObject:{}},i.service={authority:n},i.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[编辑]项目环境","API自动化测试"]}),i.component.envOperateObject={mainObject:{setting:{baseRouter:"home.ams.automatic.inside.public.env"},resource:e}}}}angular.module("eolinker.ams").component("homeAutomaticInsideEnvOperate",{template:'<env-operate-Product-Component main-object="$ctrl.component.envOperateObject.mainObject" authority-Object="$ctrl.service.authority.permission.automatic.environment"></env-operate-Product-Component>',controller:e}),e.$inject=["AutomatedTestResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function t(t,e,o,n){var c=this;c.component={funOperateObject:{}},c.service={authority:n},c.$onInit=function(){e.$emit("$WindowTitleSet",{list:["[编辑]通用函数","API自动化测试"]}),c.component.funOperateObject={mainObject:{setting:{baseRouter:"home.ams.automatic.inside.public.function"},resource:t}}}}angular.module("eolinker.ams").component("homeAutomaticInsideFunctionOperate",{template:'<fun-operate-Product-Component main-object="$ctrl.component.funOperateObject.mainObject" authority-Object="$ctrl.service.authority.permission.automatic.commonFunction"></fun-operate-Product-Component>',controller:t}),t.$inject=["AutomatedTestResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,n,o){var i=this;i.component={envListObject:{}},i.service={authority:o},i.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[列表]项目环境","API研发管理"]}),i.component.envListObject={mainObject:{setting:{baseRouter:"home.ams.project.inside.public.env"},resource:e}}}}angular.module("eolinker.ams").component("homeProjectInsideEnv",{template:'<env-List-Product-Component main-object="$ctrl.component.envListObject.mainObject" authority-Object="$ctrl.service.authority.permission.project.environment"></env-List-Product-Component>',controller:e}),e.$inject=["ApiManagementResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function t(t,e,n,o){var i=this;i.component={funListObject:{}},i.service={authority:o},i.$onInit=function(){e.$emit("$WindowTitleSet",{list:["[列表]通用函数","API研发管理"]}),i.component.funListObject={mainObject:{setting:{baseRouter:"home.ams.project.inside.public.function",product:"ams",module:"apiManagement"},resource:t}}}}angular.module("eolinker.ams").component("homeProjectInsideFunctionDefault",{template:'<fun-list-product-component main-object="$ctrl.component.funListObject.mainObject" authority-Object="$ctrl.service.authority.permission.project.commonFunction"></fun-list-product-component>',controller:t}),t.$inject=["ApiManagementResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,n,o){var r=this;r.component={envOperateObject:{}},r.service={authority:o},r.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[编辑]项目环境","API研发管理"]}),r.component.envOperateObject={mainObject:{setting:{baseRouter:"home.ams.project.inside.public.env"},resource:e}}}}angular.module("eolinker.ams").component("homeProjectInsideEnvOperate",{template:'<env-operate-Product-Component main-object="$ctrl.component.envOperateObject.mainObject" authority-Object="$ctrl.service.authority.permission.project.environment"></env-operate-Product-Component>',controller:e}),e.$inject=["ApiManagementResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function e(e,t,n,o){var c=this;c.component={funOperateObject:{}},c.service={authority:o},c.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[编辑]通用函数","API研发管理"]}),c.component.funOperateObject={mainObject:{setting:{baseRouter:"home.ams.project.inside.public.function"},resource:e}}}}angular.module("eolinker.ams").component("homeProjectInsideFunctionOperate",{template:'<fun-operate-Product-Component main-object="$ctrl.component.funOperateObject.mainObject" authority-Object="$ctrl.service.authority.permission.project.commonFunction"></fun-operate-Product-Component>',controller:e}),e.$inject=["ApiManagementResource","$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function t(t,e,o){var c=this;c.service={authority:o},c.component={productObject:{}},c.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[列表]数据结构","API管理"]}),c.component.productObject={setting:{baseRouter:"home.ams.project.inside.public.dataStructure"}}}}angular.module("eolinker.ams").component("homeProjectInsideDataStructureDefault",{template:'<structure-list-Product-Component main-object="$ctrl.component.productObject" authority-Object="$ctrl.service.authority.permission.project.dataStructure"></structure-List-Product-Component>',controller:t}),t.$inject=["$scope","$state","Authority_CommonService"]}();
"use strict";!function(){function t(t,e,o){var r=this;r.service={authority:e},r.component={productObject:{}},r.$onInit=function(){t.$emit("$WindowTitleSet",{list:["[编辑]数据结构","API管理"]}),r.component.productObject={setting:{baseRouter:"home.ams.project.inside.public.dataStructure"}}}}angular.module("eolinker.ams").component("homeProjectInsideDataStructureOperate",{template:'<structure-operate-Product-Component main-object="$ctrl.component.productObject" authority-Object="$ctrl.service.authority.permission.project.dataStructure"></structure-operate-Product-Component>',controller:t}),t.$inject=["$scope","Authority_CommonService","$state"]}();
"use strict";angular.module("eolinker.ams").run(["$templateCache",function(t){t.put("module/ams/ui/index.html",'<eo-ams-modal></eo-ams-modal><div class="home-content"><div class="home-div" ui-view=""></div></div>'),t.put("module/ams/component/beforeAfterCaseReport/index.html",'<div ng-class="{\'divide_list_container_rac mb15 pb20\':$ctrl.type===\'tearup\',\'mt15 pt20\':$ctrl.type===\'teardown\'}" ng-if="$ctrl.model.length>0"><b class="mb10">{{$ctrl.data.caseName}}</b><div class="list_item_rac" ng-repeat="item in $ctrl.model" ng-switch="item.reportStatus||item.status"><p class="test_status_rac f_row f_js_ac cd"><span class="name_rac">{{(item.caseName || ($ctrl.data.caseName + ($index + 1))) | HtmlFilter}}</span> <span class="eo-status-success" ng-switch-when="finish">测试成功，{{ item.time }}</span> <span class="eo-status-error" ng-switch-when="error">测试失败，意外中止，{{ item.time }}</span> <span class="eo-status-error" ng-switch-when="codeError">代码错误，{{ item.time }}</span> <span class="eo-status-warning" ng-switch-when="info">测试中止，有输出信息，{{ item.time }}</span> <span class="eo-status-error" ng-switch-when="interrupt">测试失败，有抛出信息，{{ item.time }}</span> <span class="eo-status-error" ng-switch-when="timeout">测试超时，{{ item.time }}</span></p></div></div>'),t.put("module/ams/component/ddtTest/index.html",'<div class="ams_ddt_test_modal eo-modal"><header class="eo-modal-header"><span>{{$ctrl.mainObj.isReport?$ctrl.mainObj.caseName:"用例测试"}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="$ctrl.fun.opr(\'cancel\')"></button></header><article class="eo-modal-article" ng-if="!$ctrl.mainObj.isReport"><div class="f_row_ac step_container_dtac f_js_ac"><div class="default_item_dtac lh_30 fs12" ng-repeat="item in $ctrl.data.stepArr" ng-class="{\'complete_item_dtac\':$ctrl.data.current.preArr.indexOf(item.value),\'active_item_dtac\':item.value===$ctrl.data.current.value}">{{$index+1}}. {{item.key}}</div></div><div><div class="step1_dtac mt15" ng-show="$ctrl.data.current.value===\'step1\'"><tip-common-component class="mt10" input="$ctrl.component.tipComponentObject"></tip-common-component><div class="eo-block-container mt15"><list-block-common-component active-object="$ctrl.data.activeObj" list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.blockListObject" page-object="$ctrl.data.pagination"></list-block-common-component><div class="eo-none-tr tac" ng-if="$ctrl.ajaxResponse.query.length==0">暂未存在任何数据集</div></div></div><div class="step2_dtac mt15" ng-show="$ctrl.data.current.value===\'step2\'"><ul class="f_row_ac mb20 result_container_dtac"><li><span class="c999">测试状态：</span><span>{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":$ctrl.testObj.basicData.successCase===$ctrl.testObj.basicData.totalCase?"测试成功":"测试失败"}}</span></li><li><span class="c999">数据集数量：</span><span>{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":$ctrl.testObj.basicData.totalCase||"0"}}</span></li><li><span class="c999">通过数量：</span><span>{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":$ctrl.testObj.basicData.successCase||"0"}}</span></li><li><span class="c999">未通过数量：</span><span class="eo-status-error">{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":$ctrl.testObj.basicData.errorCase||"0"}}</span></li><li><span class="c999">通过率：</span><span>{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":(($ctrl.testObj.basicData.successCase||0)/($ctrl.testObj.basicData.totalCase||1)*100).toFixed(2)+"%"}}</span></li><li><span class="c999">总耗时：</span><span>{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||!$ctrl.testObj.basicData.time?"-":$ctrl.testObj.basicData.time||"0s"}}</span></li></ul><ul><li class="list_item_dtac" ng-repeat="item in $ctrl.data.ddtQuery" ng-switch="$ctrl.testObj.report[item.collectionName].responseType"><div class="test_status_dtac f_row f_js_ac title_item_dtac" ng-class="$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']||$ctrl.testObj.report[item.collectionName].responseType===\'testing\'?\'\':\'cp\'" style="border-left-color: #ccc" ng-click="$ctrl.fun.opr(\'showReport\',$ctrl.testObj.report[item.collectionName])"><div class="f_row_ac test_status_container_dtac"><span class="eo-method-label eo-label-default">数据集</span> <span class="name_dtac">{{item.collectionName}}</span> <span class="eo-status-success" ng-switch-when="finish">测试成功，{{$ctrl.testObj.report[item.collectionName].time}}</span> <span class="eo-status-error" ng-switch-when="error|timeout|matchError|codeError|interrupt|info|terminateRequest" ng-switch-when-separator="|">测试失败，{{$ctrl.testObj.report[item.collectionName].time}}</span></div><div class="c999 fs12 mw_50" ng-class="{\'testing_dtac\':$ctrl.testObj.report[item.collectionName].responseType===\'testing\'&&$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']}"><span ng-if="$ctrl.testObj.report[item.collectionName].responseType!==\'testing\'">查看详情</span><div ng-switch-when="testing"><div ng-if="$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']"><span class="iconfont icon-jiazai_shuaxin"></span> <span>测试中</span></div><div class="ta_r" ng-if="!$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']">-</div></div></div></div></li></ul></div></div></article><article class="eo-modal-article" ng-if="$ctrl.mainObj.isReport"><div><div class="step2_dtac"><ul class="f_row_ac mb20 result_container_dtac"><li><span class="c999">测试状态：</span><span>{{$ctrl.reportObj.successCase===$ctrl.reportObj.totalCase?"测试成功":"测试失败"}}</span></li><li><span class="c999">数据集数量：</span><span>{{$ctrl.reportObj.totalCase||"0"}}</span></li><li><span class="c999">通过数量：</span><span>{{$ctrl.reportObj.successCase||"0"}}</span></li><li><span class="c999">未通过数量：</span><span class="eo-status-error">{{$ctrl.reportObj.errorCase||"0"}}</span></li><li><span class="c999">通过率：</span><span>{{(($ctrl.reportObj.successCase||0)/($ctrl.reportObj.totalCase||1)*100).toFixed(2)}}%</span></li><li><span class="c999">总耗时：</span><span>{{$ctrl.reportObj.time||"0s"}}</span></li></ul><ul><li class="list_item_dtac" ng-repeat="item in $ctrl.reportObj.responseList" ng-switch="item.reportStatus||item.status"><div class="test_status_dtac f_row f_js_ac title_item_dtac cp" style="border-left-color: #ccc" ng-click="$ctrl.fun.opr(\'showHistoryReport\',item,$ctrl.reportObj)"><div class="f_row_ac test_status_container_dtac"><span class="eo-method-label eo-label-default">数据集</span> <span class="name_dtac">{{item.collectionName}}</span> <span class="eo-status-success" ng-switch-when="finish">测试成功，{{item.time}}</span> <span class="eo-status-error" ng-switch-when="error|timeout|matchError|codeError|interrupt|info|terminateRequest" ng-switch-when-separator="|">测试失败，{{item.time}}</span></div><div class="c999 fs12 mw_50">查看详情</div></div></li></ul></div></div></article><footer class="eo-modal-footer f_row_ac" ng-if="!$ctrl.mainObj.isReport" ng-switch="$ctrl.data.current.value"><button type="button" class="eo_theme_btn_default" ng-click="$ctrl.fun.opr(\'cancel\')">关闭</button> <span class="pr10 bld h_30"></span><div ng-switch-when="step1"><button type="button" class="eo_theme_btn_success plug_ddt_modal_test_btn" ng-click="$ctrl.fun.opr(\'next\')">下一步</button></div><div ng-switch-when="step2" class="f_row_ac"><button type="button" class="eo_theme_btn_default plug_ddt_modal_test_btn" ng-click="$ctrl.fun.opr(\'test\')" testing="{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']}}">{{$ctrl.testObj.status[$ctrl.mainObj.testingVar||"isTesting"]?"中止测试":"重新测试"}}</button> <button type="button" class="eo_theme_btn_default" ng-click="$ctrl.fun.opr(\'pre\')" ng-if="!$ctrl.testObj.status[$ctrl.mainObj.testingVar||\'isTesting\']">重新选择测试数据集</button></div></footer></div><div class="eo_theme_modal_mask" ng-click="$ctrl.fun.opr(\'cancel\')"></div>'),t.put("module/ams/component/caseReport/index.html",'<div class="eo-block-container"><list-block-common-component other-object="{\'productType\':$ctrl.service.authority.product.ams}" authority-object="$ctrl.service.authority.permission.project.apiManagement" list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.blockListObject.query.mainObject" page-object="$ctrl.data.pagination"></list-block-common-component><loading-part-common-component fun="$ctrl.fun.init()"></loading-part-common-component><div class="eo-none-tr tac" ng-if="$ctrl.ajaxResponse.query.length==0">暂未存在任何测试记录</div></div>'),t.put("module/ams/component/generateApiDoc/index.html",'<ng-form name="ConfirmForm" ng-class="{\'submitted_form_pac\':$ctrl.data.submitted}"><article class="eo-modal-article"><div class="f_row_ac step_container_pac f_js_ac"><div class="default_item_pac lh_30 fs12" ng-repeat="item in $ctrl.data.stepArr" ng-class="{\'complete_item_pac\':$ctrl.data.current.preArr.indexOf(item.value),\'active_item_pac\':item.value===$ctrl.data.current.value}">{{$index+1}}. {{item.key}}</div></div><div><ul class="step1_pac eo-block-container mt15" ng-show="$ctrl.data.current.value===\'step1\'"><li class="f_row f_js_ac db_item_pac cp" ng-repeat="item in $ctrl.ajaxResponse.sourceQuery" ng-click="$ctrl.input.repositoryType=item.name"><div class="f_row_ac" style="height: 70px;"><img class="logo_pac mr20" ng-src="{{item.logo}}"> <span class="fs14">{{item.title}}</span></div><span class="iconfont icon-duihao active_repositoryType_pac fs24 pr20" ng-if="$ctrl.input.repositoryType===item.name"></span></li></ul><div class="step2_pac mt15" ng-show="$ctrl.data.current.value===\'step2\'" ng-switch="$ctrl.input.repositoryType"><p class="eo_form_first_item_title">{{$ctrl.input.repositoryType===3?"Swagger.json 访问地址":"代码仓库地址"}}</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="url" ng-model="$ctrl.input.url" required=""></p><div ng-switch-when="0"><p class="eo_form_item_title">项目ID</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="projectID" ng-model="$ctrl.input.projectID" ng-pattern="/^\\d*$/" required=""></p></div><div ng-switch-when="1|2" ng-switch-when-separator="|"><p class="eo_form_item_title">{{$ctrl.input.repositoryType===1?\'用户名\':\'空间名\'}}</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="owner" ng-model="$ctrl.input.owner" required=""></p></div><div ng-switch-when="1|2" ng-switch-when-separator="|"><p class="eo_form_item_title">仓库名</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="repoName" ng-model="$ctrl.input.repoName" required=""></p></div><div ng-switch-when="0|1|2" ng-switch-when-separator="|"><p class="eo_form_item_title">访问私钥</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="privateToken" ng-model="$ctrl.input.privateToken" required=""></p><p class="eo_form_item_title">需要扫描的分支</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="ref" ng-model="$ctrl.input.ref" required=""></p><p class="eo_form_item_title">需要扫描的API目录路径</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="apiDirPath" ng-model="$ctrl.input.apiDirPath" required=""></p><p class="eo_form_item_title">需要扫描的数据结构目录路径</p><p><input class="eo-input w_100percent" autocomplete="off" type="text" name="modelDirPath" ng-model="$ctrl.input.modelDirPath" required=""></p><p class="eo_form_item_title">目标语言</p><p><select-default-common-component output="$ctrl.input" model-key="language" required="true" input="{query:$ctrl.CONST.LANG_ARR,key:\'key\',value:\'value\',initialData:$ctrl.input.language||\'0\'}"></select-default-common-component></p><p class="eo_form_item_title">注解格式</p><p><select-default-common-component output="$ctrl.input" model-key="annotationType" required="true" input="{query:$ctrl.CONST.ANNOTATION_TYPE_ARR,key:\'key\',value:\'value\',initialData:$ctrl.input.annotationType||\'0\'}"></select-default-common-component></p></div><p class="eo_form_item_title">数据同步方式</p><p><select-default-common-component output="$ctrl.input" model-key="updateType" required="true" input="{query:$ctrl.CONST.UPDATE_TYPE_ARR,key:\'key\',value:\'value\',initialData:$ctrl.input.updateType||\'0\'}"></select-default-common-component></p><p class="eo_form_item_title">生成API文档的默认状态</p><p><select-default-common-component output="$ctrl.input" model-key="apiStatus" required="true" input="{query:$ctrl.CONST.API_STATUS_ARR,key:\'key\',value:\'value\',initialData:$ctrl.input.apiStatus||0}"></select-default-common-component></p></div><div class="step3_pac mt15" ng-show="$ctrl.data.current.value===\'step3\'"><div class="complete_logo_container"><span class="iconfont icon-duihao complete_logo"></span></div><p class="lh_1point75">您已经配置好自动生成API文档，您可以 <button type="button" class="eo_link" ng-click="$ctrl.fun.opr(\'syncDoc\')">立即生成 API 文档</button> 或者通过 <a class="eo_link" href="https://www.eolinker.com/#/share/index?shareCode=2NSJV3" onclick="eoSystemObj.openLink(event)">Eolinker Open API</a> 触发该生成 API 文档操作。</p></div></div></article><footer class="eo-modal-footer" ng-switch="$ctrl.data.current.value"><div ng-switch-when="step1"><button type="button" class="eo_theme_btn_success" ng-click="$ctrl.fun.opr(\'next\')">下一步</button></div><div ng-switch-when="step2" class="f_row_ac"><button type="button" class="eo_theme_btn_success" button-set-disable-directive="$ctrl.fun.opr(\'save\')">完成</button> <button type="button" class="eo_theme_btn_default" ng-click="$ctrl.fun.opr(\'pre\')">上一步</button></div><button type="button" class="eo_theme_btn_default" ng-click="$ctrl.fun.opr(\'cancel\')">{{$ctrl.data.current.value===\'step3\'?"关闭":"取消"}}</button></footer></ng-form>'),t.put("module/ams/component/sceneBatchTest/index.html",'<div class="container_hpic f_column f_js group_and_list_container"><scene-batch-test-ams-part-a bind-tip-status="$ctrl.bindTipStatus" triggle="$ctrl.triggleA" env-status="$ctrl.envStatus" report-object="$ctrl.component.reportObject" accept="$ctrl.triggleB" class="view_hpicpa f_row fg_auto po_re"></scene-batch-test-ams-part-a><scene-batch-test-ams-part-b inherit-env-object="$ctrl.inheritEnvObject" triggle="$ctrl.triggleB" accept="$ctrl.triggleA" ddt-object="$ctrl.component.ddtModal" report-object="$ctrl.component.reportObject"></scene-batch-test-ams-part-b></div><report-ams-component input="$ctrl.component.reportObject"></report-ams-component><ddt-test-ams-component ng-if="$ctrl.component.ddtModal.showDdtModal" bind-fun="$ctrl.fun.watchUiAction(\'closeDdtModal\')" main-obj="{showReport:$ctrl.component.ddtModal.showDdtItemReport,isReport:true,caseName:$ctrl.component.ddtModal.caseName}" report-obj="$ctrl.component.ddtModal.report"></ddt-test-ams-component>'),t.put("module/ams/component/sqlStepOpr/index.html",'<menu-common-component main-object="$ctrl.component.menuObject"></menu-common-component><div class="container_ap"><ng-form name="ConfirmForm"><div class="pt15"><p class="fwb">测试步骤名称</p><p class="mt10"><input class="eo-input w_100percent" autocomplete="off" name="apiName" type="text" ng-model="$ctrl.ajaxResponse.stepInfo.apiName" maxlength="32" ng-class="{\'eo-input-error\':ConfirmForm.apiName.$invalid&&$ctrl.data.submitted}" required=""></p><p class="mt20 fwb">数据库连接</p><div class="mt10 w_300"><select-default-common-component main-object="$ctrl.component.dbSelectObj" output="$ctrl.ajaxResponse.stepInfo" model-key="dbID" required="true" input="{query:$ctrl.ajaxResponse.dbList,key:\'dbConnectName\',value:\'dbID\',initialData:$ctrl.ajaxResponse.stepInfo.dbID}" ng-class="{\'eo-had-input-error\':!$ctrl.ajaxResponse.stepInfo.dbID&&$ctrl.data.submitted}"></select-default-common-component></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 mb15" ng-click="$ctrl.data.shrinkRequestData=!$ctrl.data.shrinkRequestData"><span>请求信息</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkRequestData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkRequestData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkRequestData}"></span></div></div><div ng-if="!$ctrl.data.shrinkRequestData"><div class="mt10"><p class="f_row_ac" ng-class="{\'eo-status-error\':!$ctrl.ajaxResponse.stepInfo.caseData.sqlCode&&$ctrl.data.submitted}"><span>编写SQL</span> <button ng-click="$ctrl.fun.showSqlUseTip()" type="button" class="fs20 iconfont icon-bangzhu_o ml5"></button></p><ace-editor-ams-component class="mt10" set-model="$ctrl.ajaxResponse.stepInfo.caseData.sqlCode" min-line="15" type="sql"></ace-editor-ams-component></div><div class="mt10" ng-show="$ctrl.ajaxResponse.stepInfo.caseData.params.length"><p>请求参数</p><div class="eo-block-container mt10"><list-block-common-component list="$ctrl.ajaxResponse.stepInfo.caseData.params" main-object="$ctrl.component.blockListObject.body" other-object="{submitted:$ctrl.data.submitted}"></list-block-common-component><div class="eo-none-tr tac" ng-hide="$ctrl.ajaxResponse.stepInfo.caseData.params.length">暂无数据</div></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 mb15" ng-click="$ctrl.data.shrinkResponseData=!$ctrl.data.shrinkResponseData"><span>提取返回结果，可被后续测试步骤引用</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkResponseData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkResponseData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkResponseData}"></span></div></div><div ng-if="!$ctrl.data.shrinkResponseData"><list-block-common-component class="eo-block-container" list="$ctrl.ajaxResponse.stepInfo.resultParam" main-object="$ctrl.component.blockListObject.response" other-object="{submitted:$ctrl.data.submitted}"></list-block-common-component><ace-editor-ams-component id="_Setting_Response_Js" class="mt10" set-model="$ctrl.ajaxResponse.stepInfo.generateResponseCode" min-line="15" type="javascript"></ace-editor-ams-component></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkMatchRuleData=!$ctrl.data.shrinkMatchRuleData"><span>返回结果校验</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkMatchRuleData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkMatchRuleData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkMatchRuleData}"></span></div></div><div ng-class="{\'b_cr\':$ctrl.ajaxResponse.stepInfo.matchType===2&&!$ctrl.ajaxResponse.stepInfo.matchRule&&$ctrl.data.submitted}" ng-if="!$ctrl.data.shrinkMatchRuleData"><menu-radio-common-component class="pt15 dp_b" list="$ctrl.CONST.RESPONSE_MATCH_ARR" output="$ctrl.ajaxResponse.stepInfo" model-key="matchType" cancle-bind-fun="true"></menu-radio-common-component><div class="pt10" ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.stepInfo.matchType!==2}"><p><button type="button" class="eo_theme_btn_info" ng-click="$ctrl.fun.insertCodeByBindParam()">插入绑定的参数</button></p><ace-editor-ams-component id="_Pre_Response_Js" class="mt10" set-model="$ctrl.ajaxResponse.stepInfo.matchRule" min-line="15" type="javascript"></ace-editor-ams-component></div><p class="null_tip_span mt10 eo-block-container" ng-if="$ctrl.ajaxResponse.stepInfo.matchType!==2">{{$ctrl.CONST.RESPONSE_MATCH_MSG_OBJ[$ctrl.ajaxResponse.stepInfo.matchType]}}</p></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 mb15" ng-click="$ctrl.data.shrinkOtherConf=!$ctrl.data.shrinkOtherConf"><span>其他设置</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkOtherConf?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkOtherConf,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkOtherConf}"></span></div></div><div class="item_part regex_part" ng-init="$ctrl.fun.initAceEditor()" ng-if="!$ctrl.data.shrinkOtherConf"><p><button class="form-to-json-btn" ng-click="$ctrl.ajaxResponse.stepInfo.caseData.keepGoing=!$ctrl.ajaxResponse.stepInfo.caseData.keepGoing"><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.ajaxResponse.stepInfo.caseData.keepGoing}"></span> <span>当前步骤执行失败或判断为测试失败时，依然执行下一个步骤</span></button></p><div class="mt15"><p>延时执行下一个步骤（ms）</p><p class="eo-status-tips fs12 mt10">当前步骤执行完毕后，延迟一段时间再执行下一个步骤</p><p><input class="eo-input mt10" name="delayTime" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&!$ctrl.ajaxResponse.stepInfo.delayTime}" autocomplete="off" type="text" ng-pattern="/^(([1-9]\\d{1,4})|(([1-9]))|(0)|(10000))$/" ng-model="$ctrl.ajaxResponse.stepInfo.delayTime" required=""></p></div></div></ng-form></div>'),t.put("module/ams/component/tag/index.html",'<div class="pdt-div eo-input" ng-click="$ctrl.fun.commonClick($event)"><div class="tag-item ml10" ng-repeat="tag in $ctrl.tagQuery"><span class="text-span">{{tag}}</span> <button class="btn-delete iconfont icon-guanbi" eo-attr-tag="{{tag}}"></button></div><input class="tmp-input pl10" type="text" maxlength="55" ng-keydown="$ctrl.fun.keydown($event)" ng-model="$ctrl.data.text" ng-change="$ctrl.fun.change($event)" ng-blur="$ctrl.fun.inputBlur()"></div>'),t.put("module/ams/component/codeStepOpr/index.html",'<menu-common-component main-object="$ctrl.component.menuObject"></menu-common-component><div class="container_ap"><ng-form name="ConfirmForm"><div class="pt15"><p class="fwb">测试步骤名称</p><p class="mt10"><input class="eo-input w_100percent" autocomplete="off" name="apiName" type="text" ng-model="$ctrl.ajaxResponse.stepInfo.apiName" maxlength="32" ng-class="{\'eo-input-error\':ConfirmForm.apiName.$invalid&&$ctrl.data.submitted}" required=""></p></div><div collapse-common="$ctrl.component.courseCollapseObj" is-init-show="true"><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 di_collapse_handle"><span>脚本代码[Javascript]</span><div class="shrink_text_ept"><span class="di_switch_tips"></span> <span class="di_switch_icon iconfont"></span></div></div><div class="di_collapse_container"><div class="f_row mt15 eo-block-container code_container"><div class="left_container_eccso" ng-class="{\'w_240\':!$ctrl.data.isShrink,\'w_60\':$ctrl.data.isShrink}"><header class="header_left_eccso f_js f_row_ac"><div class="fwb fs18" ng-hide="$ctrl.data.isShrink">快捷插入代码</div><div class="f_row_ac" ng-class="{\'m_auto\':$ctrl.data.isShrink}"><span class="btn_shrink_eccso iconfont icon-zhediedaohang fs24 cp" ng-click="$ctrl.data.isShrink=!$ctrl.data.isShrink"></span> <span move-tip-directive="" parent-class-name="left_container_eccso" able-class-name="btn_shrink_eccso" tips-style=\'{"left":0,"top":0}\' tips-text="显示 / 隐藏分组"></span></div></header><div class="list_eccso plr10" ng-hide="$ctrl.data.isShrink"><div ng-repeat="item in $ctrl.CONST.SHORTCUT_ARR"><p class="c999 f_row_ac lh_40 cp fs12" ng-click="item.shrink=!item.shrink"><span class="iconfont mr5 fs18" ng-class="item.shrink?\'icon-jiantou_liebiaoxiangyou\':\'icon-jiantou_liebiaozhankai\'"></span> <span>{{item.name}}</span></p><ul ng-show="!item.shrink"><li class="h_30 item_menu_eccso f_row_ac fs12 cp" ng-repeat="childItem in item.funList" ng-click="$ctrl.fun.quickSetExpression(childItem.key,grandSonItem)">{{childItem.name}}</li></ul></div></div></div><ace-editor-ams-component class="ace-editor-container fg1" set-model="$ctrl.ajaxResponse.stepInfo.caseCode" type="automated-javascript" min-line="23" max-line="30"></ace-editor-ams-component></div></div></div><div collapse-common="$ctrl.component.courseCollapseObj" is-init-show="true"><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 di_collapse_handle"><span>传递变量，可被后续测试步骤引用</span><div class="shrink_text_ept"><span class="di_switch_tips"></span> <span class="di_switch_icon iconfont"></span></div></div><div class="di_collapse_container"><div class="eo-block-container mt15"><list-block-common-component list="$ctrl.ajaxResponse.stepInfo.resultParam" main-object="$ctrl.component.blockListObj" other-object="{submitted:$ctrl.data.submitted}"></list-block-common-component><div class="eo-none-tr tac" ng-hide="$ctrl.ajaxResponse.stepInfo.resultParam.length">暂无数据</div></div></div></div><div collapse-common="$ctrl.component.courseCollapseObj" is-init-show="true"><div class="f_row_ac eo_panel_title f_js plr10 cp mt40 mb15 di_collapse_handle"><span>其他设置</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkOtherConf?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkOtherConf,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkOtherConf}"></span></div></div><div class="item_part regex_part di_collapse_container" ng-init="$ctrl.fun.initAceEditor()"><p class="mt15"><button class="form-to-json-btn" ng-click="$ctrl.ajaxResponse.stepInfo.caseData.keepGoing=!$ctrl.ajaxResponse.stepInfo.caseData.keepGoing"><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.ajaxResponse.stepInfo.caseData.keepGoing}"></span> <span>当前步骤执行失败或判断为测试失败时，依然执行下一个步骤</span></button></p><div class="mt15"><p>延时执行下一个步骤（ms）</p><p class="eo-status-tips fs12 mt10">当前步骤执行完毕后，延迟一段时间再执行下一个步骤</p><p><input class="eo-input mt10" name="delayTime" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&!$ctrl.ajaxResponse.stepInfo.delayTime}" autocomplete="off" type="text" ng-pattern="/^(([1-9]\\d{1,4})|(([1-9]))|(0)|(10000))$/" ng-model="$ctrl.ajaxResponse.stepInfo.delayTime" required=""></p></div></div></div></ng-form></div>'),t.put("module/ams/component/plug/apiStatusStatistics/index.html",'<div class="eo_theme_iblock f_row f_js f_ae vertical-box"><span move-tip-directive="" parent-class-name="vertical-box" able-class-name="line-bar-bg" tips-style=\'{"left":-2,"top":-10}\' tips-attr-name="data-eo-api-status"></span><div class="line-bar-bg f_column f_je cp" data-eo-api-status="{{item.key+\': \'+(item.count||0)}}" ng-click="$ctrl.input.clickFun({item:item})" ng-repeat="item in $ctrl.input.array"><span class="line-bar-span eo-color-{{item.class}}" style="height:{{(item.count||0)/($ctrl.input.totalCount||1)*45}}px;"></span></div></div>'),t.put("module/ams/component/plug/sdk/index.html",'<tip-common-component class="p15" input="$ctrl.component.tipComponentObject"></tip-common-component><article class="common_inside_article"><a id="dump_directive_js" class="hidden"></a><ul class="title-ul"><li class="btn-group-li" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"><button type="button" class="eo_theme_btn_success common-btn" ng-click="$ctrl.data.fun.add()"><span class="iconfont icon-jiahao"></span>新建方案</button> <a class="eo_theme_btn_success common-btn" ng-click="$ctrl.data.fun.build()" ng-show="$ctrl.data.info.current.planID&&$ctrl.data.info.current.planID!=-1" style="margin-left:150px;"><span class="iconfont icon-jiahao"></span>生成sdk</a></li><li dump-directive="$ctrl.data.fun.build(arg)"></li></ul><div class="content-div"><ul class="group-ul sdk-sidebar-ul pull-left"><li class="title-li"><b>SDK方案</b></li><li class="background-group-li" ng-repeat="item in $ctrl.data.interaction.response.query" ng-class="{\'elem-active\':item.planID==$ctrl.data.interaction.request.planID}" ng-click="$ctrl.data.fun.click({item:item,$index:$index})"><span class="group-name pull-left" ng-class="{\'new-elem\':item.planID==-1}">{{item.planName}}</span><div class="pull-right list-fun-div" ng-mouseleave="item.isClick=false" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk&&item.planID!=-1"><a class="iconfont icon-kongzhizhongxin" ng-click="$event.stopPropagation();item.isClick=true"></a><ul class="btn-group-ul" ng-show="item.isClick"><a ng-click="$ctrl.data.fun.delete.sidebar({item:item,$event:$event,$index:$index})"><li>删除</li></a></ul></div></li></ul><form autocomplete="off" name="ConfirmForm" class="home-project-inside-sdk" ng-show="$ctrl.data.info.current.planID"><div><p class="title-p"><b>方案名称</b></p><p class="name-form"><input autocomplete="off" name="planName" ng-model="$ctrl.data.info.current.planName" class="eo-input" type="text" placeholder="方案名称" required=""></p><p class="divide-p"><b>环境设置</b></p><p class="select-p mt10" ng-if="(!$ctrl.data.info.current.planID)||$ctrl.data.info.current.planID==-1"><select style="text-indent: 0;" class="eo-input" ng-model="$ctrl.data.info.current.$index" ng-options="key as item.envName for (key , item) in $ctrl.data.interaction.response.envList" ng-change="$ctrl.data.info.current.envObject=$ctrl.data.interaction.response.envList[$ctrl.data.info.current.$index]"></select></p><div ng-show="$ctrl.data.info.current.$index==($ctrl.data.interaction.response.envList.length-1).toString()||$ctrl.data.info.current.planID>0"><p class="title-p"><b>前置URI</b></p><p class="name-form"><input autocomplete="off" name="name" ng-model="$ctrl.data.info.current.envObject.frontURI" class="eo-input" type="text" placeholder="前置URI" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></p><p class="title-p"><b>鉴权信息</b></p><div class="auth-div"><p class="select-p"><select class="eo-input" placeholder="Basic Auth" ng-model="$ctrl.data.info.current.envObject.envAuth.status"><option value="0">无</option><option value="1">Basic Auth</option></select></p><div ng-show="$ctrl.data.info.current.envObject.envAuth.status==\'1\'"><p class="common-p"><input autocomplete="off" class="eo-input" type="text" placeholder="Username" ng-model="$ctrl.data.info.current.envObject.envAuth.basicAuth.username"></p><p class="common-p"><input autocomplete="off" class="eo-input" type="password" placeholder="Password" ng-model="$ctrl.data.info.current.envObject.envAuth.basicAuth.password"></p></div></div><p class="title-p"><b>请求Header头部</b></p><div style="display: inline-block;width: 100%;"><ul class="item-ul" ng-mouseover="item.mouseLeave=false" ng-mouseleave="item.mouseLeave=true" ng-repeat="item in $ctrl.data.info.current.envObject.headerList track by $index"><li class="pull-left header-input-li" ng-class="{\'eo-had-input-error\':!item.headerName&&item.headerValue}" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"><auto-complete-ams-component model="item" key-name="headerName" array="$ctrl.data.constant.headerArray" placeholder="头部标签" input-change-fun="$ctrl.data.fun.change({$last:$last,switch:0})"></auto-complete-ams-component></li><li class="pull-left header-input-li" ng-if="!$ctrl.service.authority.permission.project.otherFunction.sdk"><input autocomplete="off" class="eo-input header-content-input" type="text" placeholder="头部标签" ng-model="item.headerName" readonly=""></li><li class="header-content-li pull-left"><input autocomplete="off" class="eo-input header-content-input" type="text" placeholder="标签内容" ng-model="item.headerValue" ng-change="$ctrl.data.fun.change({$last:$last,switch:0})" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></li><li class="operate-li"><a class="iconfont icon-shanchu number-label" ng-click="$ctrl.data.fun.delete.headerList({$index:$index})" ng-hide="$last" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"></a> &nbsp;</li></ul></div><p class="title-p"><b>额外变量</b></p><div><ul class="item-ul" ng-repeat="item in $ctrl.data.info.current.envObject.additionalParamList"><li class="pull-left header-input-li"><input autocomplete="off" class="eo-input" type="text" placeholder="变量名" ng-model="item.paramKey" ng-change="$ctrl.data.fun.change({$last:$last,switch:2})" ng-class="{\'eo-input-error\':!item.paramKey&&item.paramValue}" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></li><li class="header-content-li pull-left"><input autocomplete="off" class="eo-input header-content-input" type="text" placeholder="变量值" ng-model="item.paramValue" ng-change="$ctrl.data.fun.change({$last:$last,switch:2})" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></li><li class="operate-li"><a class="iconfont icon-shanchu number-label" ng-click="$ctrl.data.fun.delete.additionalParamList({$index:$index})" ng-hide="$last" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"></a> &nbsp;</li></ul></div><p class="title-p"><b>全局变量</b></p><div><ul class="item-ul" ng-repeat="item in $ctrl.data.info.current.envObject.paramList"><li class="pull-left header-input-li"><input autocomplete="off" class="eo-input" type="text" placeholder="变量名" ng-model="item.paramKey" ng-change="$ctrl.data.fun.change({$last:$last,switch:1})" ng-class="{\'eo-input-error\':!item.paramKey&&item.paramValue}" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></li><li class="header-content-li pull-left"><input autocomplete="off" class="eo-input header-content-input" type="text" placeholder="变量值" ng-model="item.paramValue" ng-change="$ctrl.data.fun.change({$last:$last,switch:1})" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></li><li class="operate-li"><a class="iconfont icon-shanchu number-label" ng-click="$ctrl.data.fun.delete.paramList({$index:$index})" ng-hide="$last" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"></a> &nbsp;</li></ul></div></div><p class="divide-p"><b>分组类名</b></p><div class="class-table"><div class="class-table-title-p"><div class="pull-left group-name-div">分组名称</div><label class="ml10 fs12">生成类名</label></div><div ng-repeat="item in $ctrl.data.info.current.groupInfo"><div class="class-table-common-p"><div class="pull-left group-name-div"><span class="iconfont icon-xuanzeqixiayige" ng-style="{\'padding-left\':(10*(item.groupDepth-1)+\'px\')}"></span> <span>{{item.groupName}}</span></div><input autocomplete="off" ng-model="item.className" class="class-input" type="text" placeholder="分组类名" required="" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></div><div ng-repeat="item1 in item.childGroupList"><div class="class-table-common-p"><div class="pull-left group-name-div" style="text-indent:2em;"><span class="iconfont icon-xuanzeqixiayige"></span>{{item1.groupName}}</div><input autocomplete="off" ng-model="item1.className" class="class-input" type="text" placeholder="分组类名" required="" ng-readonly="!$ctrl.service.authority.permission.project.otherFunction.sdk"></div></div></div></div><p class="divide-p"><b>其他设置</b></p><div class="tips-div"><input autocomplete="off" class="hidden" type="checkbox" id="inherit_checkbox" ng-model="$ctrl.data.info.current.isInherit" ng-disabled="!$ctrl.service.authority.permission.project.otherFunction.sdk"> <label for="inherit_checkbox" class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.data.info.current.isInherit}"></label> <span>子分组继承父分组类名</span><tip-directive margin-left="-21" input="<p>子分组的类名前将会通过下划线拼接上父分组类名，</p><p>如father_child。</p>"></tip-directive></div><p class="btn-group-p" ng-if="$ctrl.service.authority.permission.project.otherFunction.sdk"><button class="eo_theme_btn_success" button-set-disable-directive="$ctrl.data.fun.confirm()">保存</button> <button class="eo_theme_btn_success" button-set-disable-directive="$ctrl.data.fun.confirm({switch:1})" ng-if="$ctrl.data.info.current.planID==-1">继续新建</button> <button type="button" class="eo_theme_btn_default" ng-click="$ctrl.data.fun.cancle()" ng-if="$ctrl.data.info.current.planID==-1">取消</button></p></div></form><div class="unproject-mask" ng-if="!$ctrl.data.interaction.request.planID"><div><p class="pull-left"><label class="iconfont icon-baoguo_hezi"></label></p><p class="item-p first-p">请选择或新建新SDK方案</p></div></div></div></article>'),
t.put("module/ams/component/sceneBatchTest/partA/index.html",'<group-default-common-component authority-object="{\'edit\':$ctrl.service.authority.permission.automatic.sceneCase.edit,\'export\':$ctrl.service.authority.permission.automatic.exportAndShare.export}" fun-object="$ctrl.component.groupCommonObject.funObject" main-object="$ctrl.component.groupCommonObject.mainObject" request-object="$ctrl.component.groupCommonObject.requestObject"></group-default-common-component><div class="apimanagement-scss-automated-default list_div_beside_group" check-plug-directive="" input="$ctrl.data.plugObject"><menu-common-component authority-object="$ctrl.service.authority.permission.automatic.sceneCase" other-object="{executor:$ctrl.data.executor,validToSwitchTestMethod:$ctrl.data.validToSwitchTestMethod,testMethodIsPlugin:$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,batch:$ctrl.data.batchMenu,isBatchDisabled:!$ctrl.ajaxResponse.query.length,disabled:$ctrl.data.batch.query.length===0||$ctrl.ajaxResponse.query<=0}" main-object="$ctrl.component.menuObject" block-list-object="$ctrl.data.filterObject"></menu-common-component><list-default-common-component id="all_test_container" authority-object="{operate:1,edit:$ctrl.service.authority.permission.automatic.sceneCase.edit,download:$ctrl.service.authority.permission.automatic.sceneCase.download}" main-object="$ctrl.component.listDefaultCommonObject" list="$ctrl.ajaxResponse.query" show-object="{columnFilterObject:$ctrl.data.filterObject.indexAddress}" other-object="{status:$ctrl.data.testing,batchMenu:$ctrl.data.batchMenu,batch:$ctrl.data.batch,batchMenu:$ctrl.data.batchMenu,loadStorageQuery:$ctrl.data.loadStorageQuery,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><span move-tip-directive="" parent-class-name="apimanagement-scss-automated-default" tips-style=\'{"left":15,"top":10}\' able-class-name="download_btn" tips-text="跳转到测试报告下载页面"></span>'),t.put("module/ams/component/sceneBatchTest/partA/index.tmp.html",'<eo-divide-testall><div ng-mouseleave="item.isClick=false;" class="po_re f_row f_ac h_50"><button class="btn-automatic-test batch-test-btn block-btn common-btn" id="all_btn_test" ng-class="{\'eo_theme_btn_success\':$ctrl.otherObject.testMethodIsPlugin,\'eo_theme_btn_info\':!$ctrl.otherObject.testMethodIsPlugin}" eo-attr-test-type="{{$ctrl.otherObject.testMethodIsPlugin?\'plug\':\'server\'}}" testing="true" eo-attr-excute-type="{{$ctrl.otherObject.executor}}" ng-click="item.fun(\'select-test\',{item:item})" ng-disabled="$ctrl.otherObject.disabled"><span>{{$ctrl.otherObject.executor==="parallel"?"并行测试":"串行测试"}}</span></button><button ng-if="true" class="iconfont icon-xiajiantou fs12 w_40 more-a" eo-drop-elem="" text-arr="[{key:\'切换使用{{$ctrl.otherObj.testServer}}测试\',value:\'changeExecutor\',expression:\'ng-if=\\\'$ctrl.otherObj.canSwitchTestServer\\\'\'},{key:\'切换使用{{$ctrl.otherObj.executorText}}\',value:\'changeExecuteType\'}]" fn-click="item.otherFun(target)" other-obj=\'{canSwitchTestServer:$ctrl.otherObject.validToSwitchTestMethod,testServer:($ctrl.otherObject.testMethodIsPlugin)?"服务器":"插件",executorText:$ctrl.otherObject.executor==="parallel"?"串行":"并行"}\' ng-disabled="$ctrl.otherObject.disabled" ng-class="{\'eo_theme_btn_success\':$ctrl.otherObject.testMethodIsPlugin,\'eo_theme_btn_info\':!$ctrl.otherObject.testMethodIsPlugin}"></button></div></eo-divide-testall><eo-divide-testsingle><button class="eo-operate-btn batch-test-btn" ng-disabled="$ctrl.otherObject.status&&!item.testing" ng-click="$ctrl.fun.common($ctrl.mainObject.item.operate.funArr[0],{item:item,$index:$outerIndex,$event:$event})" testing="{{item.testing||false}}">{{item.testing?"中止":"测试"}}</button></eo-divide-testsingle><eo-divide-testresult><span class="eo-status-success" ng-show="item.latestTestResult==\'finish\'||item.latestTestResult==\'success\'">测试成功</span> <span class="eo-status-error" ng-show="item.latestTestResult&&!(item.latestTestResult==\'finish\'||item.latestTestResult==\'success\')">测试失败</span></eo-divide-testresult>'),t.put("module/ams/component/sceneBatchTest/partB/index.html",'<batch-test-ams-component status-object="$ctrl.testStatusObj" output="$ctrl.data.testHistory" status="automated-global" env="$ctrl.service.home.envObject.object.total" ng-if="$ctrl.data.plugObject.useStatus&&$ctrl.data.testSeverType!==\'nodejs\'"></batch-test-ams-component><div class="text_mask_hpicpb" ng-if="$ctrl.data.isOperate||($ctrl.testStatusObj.isTesting&&$ctrl.testStatusObj.testMethod!==\'singleTest\')"><div class="text_hpicpb"><span ng-if="$ctrl.testStatusObj.isTesting">测试中...</span><div class="f_row f_ac" ng-if="$ctrl.data.isOperate&&!$ctrl.testStatusObj.isTesting"><span>API列表有更新，</span><div><button type="button" class="eo-operate-btn" ng-click="$ctrl.fun.refreshPartA()">点击更新列表信息</button></div></div></div></div><fieldset class="b_none" ng-disabled="$ctrl.data.ajaxQueryNum>0"><div class="conatiner_hpicpb" id="case_test_btn" check-plug-directive="" input="$ctrl.data.plugObject"><div class="shrink_hpicpb cp" ng-click="$ctrl.fun.spreedConsole(true)" ng-hide="$ctrl.data.isSpreedConsole"><b class="fs18">测试控制台</b> <span class="iconfont icon-xuanzeqishouqi fs16"></span></div><div class="spreed_hpicpb" ng-class="{\'h_54 po_ab vis_hid\':!$ctrl.data.isSpreedConsole,\'transition_hpicpb\':$ctrl.data.isSpreedConsole}"><div class="drag_bar_hpicpb tac" drag-change-spacing-common-directive="" affect-class="spreed_hpicpb" main-object="$ctrl.component.dragChangeHeightCommonDirectiveObj"><b class="iconfont icon-iosgengduo fs16"></b></div><button type="button" class="eo_theme_btn_default shrink_btn_hpicpb mb10" ng-click="$ctrl.fun.spreedConsole(false)"><span class="iconfont icon-xuanzeqizhankai fs16 mr5"></span>收缩</button><div class="list_conatiner_hpicpb" ng-show="$ctrl.ajaxResponse.query.length||$ctrl.data.ajaxQueryNum>0"><div class="f_row p10 group_btn_hpicpb" ng-show="$ctrl.ajaxResponse.query.length"><div class="eo_more_btn_container"><button class="common-btn" id="case_btn_test" eo-attr-test-type="{{$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus?\'plug\':\'server\'}}" eo-attr-excute-type="{{$ctrl.data.executor}}" ng-class="{\'eo_theme_btn_success\':$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,\'eo_theme_btn_info\':($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)}" ng-click="$ctrl.fun.test(\'all\')" testing="{{$ctrl.testStatusObj.isTesting||false}}" ng-disabled="($ctrl.testStatusObj.isTesting&&$ctrl.testStatusObj.testMethod!==\'all\')||$ctrl.data.selectCaseNum===0"><span>{{$ctrl.testStatusObj.isTesting&&$ctrl.testStatusObj.testMethod===\'all\'?\'中止\':$ctrl.data.executor==="parallel"?"并行测试":"串行测试"}}</span></button> <button class="more-btn eo_more_btn w_40" eo-drop-elem="" text-arr="[{key:\'切换使用{{$ctrl.otherObj.testServer}}测试\',value:\'changeServerType\',expression:\'ng-if=\\\'$ctrl.otherObj.canSwitchTestServer\\\'\'},{key:\'切换使用{{$ctrl.otherObj.executorText}}\',value:\'changeExecutorType\'}]" fn-click="$ctrl.fun.watchUi(target)" other-obj=\'{canSwitchTestServer:$ctrl.data.plugObject.validToSwitchTestMethod||$ctrl.data.plugTransferToLocal,testServer:($ctrl.data.testSeverType=="nodejs"||!$ctrl.data.plugObject.useStatus)?($ctrl.data.plugTransferToLocal?"本地":"插件"):"服务器",executorText:$ctrl.data.executor==="parallel"?"串行":"并行"}\' ng-disabled="($ctrl.testStatusObj.isTesting&&$ctrl.testStatusObj.testMethod!==\'all\')||$ctrl.data.selectCaseNum===0" ng-class="{\'eo_theme_btn_success\':$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,\'eo_theme_btn_info\':($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)}"><span class="iconfont icon-xiajiantou fs12"></span></button></div><button class="eo_theme_btn_default f_row_ac ml10" ng-click="$ctrl.fun.setInheritCookieStatus()" ng-if="$ctrl.data.executor===\'serial\'&&($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus||$ctrl.data.plugTransferToLocal)"><span class="eo-checkbox iconfont inherit_cookie_btn_sbtapb" ng-class="{\'icon-duihao\':$ctrl.data.isInheritCookie}"></span> <span>用例间共享Cookies</span></button> <button type="button" class="eo_theme_btn_default mlr10" ng-click="$ctrl.fun.downloadReport()" ng-disabled="!$ctrl.testStatusObj.logID||$ctrl.testStatusObj.isWaitToDownload">{{$ctrl.testStatusObj.isWaitToDownload?\'报告生成中\':\'下载报告\'}}</button> <span class="divide_line" ng-if="$ctrl.CONST.COMPONENT_MODULE===\'sceneCase\'"></span><div class="eo_more_btn_container" ng-if="$ctrl.CONST.COMPONENT_MODULE===\'sceneCase\'" inner-html-common-directive="" html="$ctrl.data.planBtnHtml"></div><span class="divide_line"></span><env-ams-component un-init-dom="true" setting="{isWantToExposeObject:true}" expose-object="$ctrl.inheritEnvObject" env-model="$ctrl.service.home.envObject.object.model" env-param="$ctrl.service.home.envObject.object.param" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.automatic.environment" mark="automatic"></env-ams-component></div><div class="list_hpicpb btd"><div class="item_hpicpb" ng-show="$ctrl.ajaxResponse.query.length"><list-block-common-component list="$ctrl.ajaxResponse.query" active-object="$ctrl.data.batch" other-object="{testHistoryObj:$ctrl.data.testHistory,allIsTesting:$ctrl.testStatusObj.isTesting,testMethod:$ctrl.testStatusObj.testMethod,clearAllFun:$ctrl.fun.clear}" main-object="$ctrl.component.blockListObject.case"></list-block-common-component></div><div class="loading_container_hpicpd" ng-if="$ctrl.data.ajaxQueryNum>0"><div class="loading_hpicpd"><div><span class="iconfont icon-jiazai_shuaxin"></span></div><span>正在载入</span></div></div></div></div><div class="mt40 tac" ng-show="$ctrl.ajaxResponse.query.length===0&&$ctrl.data.ajaxQueryNum==0&&$ctrl.CONST.COMPONENT_MODULE===\'sceneCase\'">在流程测试用例列表中选择待测用例，或<div class="eo_more_btn_container ml10" inner-html-common-directive="" html="$ctrl.data.planBtnHtml"></div></div><div class="eo-none-tr tac" ng-show="$ctrl.ajaxResponse.query.length===0&&$ctrl.data.ajaxQueryNum==0&&$ctrl.CONST.COMPONENT_MODULE!==\'sceneCase\'">请先选择需要测试的用例</div></div></div></fieldset><div class="mask_hpicpb" ng-if="$ctrl.data.isOperate||($ctrl.testStatusObj.isTesting&&$ctrl.testStatusObj.testMethod!==\'singleTest\')"></div><div dump-directive="$ctrl.fun.downloadReport(arg)" setting=\'{switch:"TestWordFile"}\'></div><a id="dump-directive_js" class="hidden"></a>'),t.put("module/ams/component/sceneBatchTest/partB/index.tmp.html",'<div class="tested-div" ng-class="{\'testing-div\':$ctrl.otherObject.testHistoryObj[item.caseID].responseType===\'testing\'&&$ctrl.otherObject.allIsTesting}" ng-switch="$ctrl.otherObject.testHistoryObj[item.caseID].responseType"><button class="eo-status-success" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'success\',item)" ng-switch-when="finish|success" ng-switch-when-separator="|" ng-init="$ctrl.mainObject.baseFun.getTime(item)">通过，查看详情</button> <button class="eo-status-error" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'error\',item)" ng-switch-when="error|timeout|matchError|codeError|interrupt|info|terminateRequest" ng-switch-when-separator="|" ng-init="$ctrl.mainObject.baseFun.getTime(item)">未通过，查看详情</button><div ng-switch-when="testing"><span class="iconfont icon-jiazai_shuaxin"></span> <span>测试中</span></div><div ng-switch-default=""><span>尚无测试结果</span></div></div>'),t.put("module/ams/component/sceneBatchTest/partB/testplan.tmp.html",'<button class="common-btn eo_theme_btn_info" ng-if="$ctrl.service.authority.permission.automatic.sceneCase.edit" ng-click="$ctrl.fun.handleTestPlan()" ng-disabled="$ctrl.testStatusObj.isTesting" eo-attr-tip-placeholder="save_test_plan_btn"><span ng-show="$ctrl.ajaxResponse.query.length===0">载入测试方案</span> <span ng-show="$ctrl.ajaxResponse.query.length&&!$ctrl.data.selectedPlanName">保存为测试方案</span> <span class="text_omit testplan_name" ng-show="$ctrl.ajaxResponse.query.length&&$ctrl.data.selectedPlanName">保存：{{$ctrl.data.selectedPlanName}}</span></button> <button class="common-btn eo_theme_btn_info" ng-if="!$ctrl.service.authority.permission.automatic.sceneCase.edit" ng-click="$ctrl.fun.handleTestPlan(\'query\')" ng-disabled="$ctrl.testStatusObj.isTesting"><span ng-show="!$ctrl.data.selectedPlanName">载入测试方案</span> <span class="text_omit testplan_name" ng-show="$ctrl.data.selectedPlanName">载入：{{$ctrl.data.selectedPlanName}}</span></button> <button class="more-btn eo_more_btn eo_theme_btn_info" ng-disabled="$ctrl.testStatusObj.isTesting"><span class="iconfont icon-jiantou_liebiaozhankai"></span></button><div class="wrap-container right_wrap_container"><button class="w_100percent" type="button" ng-click="$ctrl.fun.handleTestPlan(\'query\')">载入测试方案</button> <button class="w_100percent" type="button" ng-if="$ctrl.service.authority.permission.automatic.sceneCase.edit" ng-click="$ctrl.fun.handleTestPlan(\'save\')">保存为测试方案</button> <button class="w_100percent" type="button" ng-click="$ctrl.fun.handleTestPlan(\'manage\')">管理测试方案</button></div>'),t.put("module/ams/ui/automatic/default/index.html",'<div ng-if="$ctrl.service.authority.productUsingPermission.ams.disabled==0"><div class="home-common-project-list" ng-if="$ctrl.service.authority.projectGroupPermission.automatic.editProject||$ctrl.ajaxResponse.query.length>0||$ctrl.ajaxResponse.groupQuery.length>0||$ctrl.ajaxRequest.groupID!=0"><menu-common-component ng-class="{\'no_authority_commom_menu\':!$ctrl.service.authority.projectGroupPermission.automatic.editProject}" authority-object="{edit:$ctrl.service.authority.projectGroupPermission.automatic.editProject,free:$ctrl.service.authority.product.ams==\'free\'&&$ctrl.service.authority.role.ams!==\'teammate\',showTitle:true}" main-object="$ctrl.component.menuObject" other-object="{batch:$ctrl.data.batch,isBatchSelected:$ctrl.data.batch.query.length>0||$ctrl.data.batch.groupQuery.length>0,isGroupAndArchiveSelected:(!$ctrl.data.batch.groupQuery.length>0)&&$ctrl.data.batch.query.length>0&&$ctrl.data.batchOprArchive.length===0,isGroupSelected:(!$ctrl.data.batch.groupQuery.length>0)&&$ctrl.data.batch.query.length>0,setTeammateDiasbledTipStatus:$ctrl.data.batch.groupQuery.length>0||$ctrl.data.batchOprArchive.length>0,archiveDiasbledTipStatus:$ctrl.data.batch.groupQuery.length>0,isBatchDisabled:!$ctrl.ajaxResponse.query.length&&!$ctrl.ajaxResponse.groupQuery.length}"></menu-common-component><list-group-common-component authority-object="{operate:$ctrl.service.authority.projectGroupPermission.automatic.editProject}" main-object="$ctrl.component.listGroupCommonObject" list="$ctrl.ajaxResponse.query" group-list="$ctrl.ajaxResponse.groupQuery" other-object="{batch:$ctrl.data.batch,request:$ctrl.ajaxRequest}"></list-group-common-component></div><mask-common-component ng-if="!$ctrl.service.authority.projectGroupPermission.automatic.editProject&&$ctrl.ajaxResponse.query.length==0&&$ctrl.ajaxResponse.groupQuery.length==0&&$ctrl.ajaxRequest.groupID==0"></mask-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><mask-expire-common-component ng-if="$ctrl.service.authority.productUsingPermission.ams.disabled" input="{mark:\'AMS\',role:$ctrl.service.authority.role.ams,productType:$ctrl.service.authority.product.ams}"></mask-expire-common-component>'),t.put("module/ams/ui/automatic/inside/index.html",'<div class="home-automatic-inside"><home-automatic-inside-navbar></home-automatic-inside-navbar><div ui-view=""></div></div>'),t.put("module/ams/ui/project/default/index.html",'<div ng-if="$ctrl.service.authority.productUsingPermission.ams.disabled==0"><div class="home-common-project-list" ng-if="$ctrl.service.authority.projectGroupPermission.project.editProject||$ctrl.ajaxResponse.query.length>0||$ctrl.ajaxResponse.groupQuery.length>0||$ctrl.ajaxRequest.groupID!=0"><menu-common-component ng-class="{\'no_authority_commom_menu\':!$ctrl.service.authority.projectGroupPermission.project.editProject}" main-object="$ctrl.component.menuObject" authority-object="{edit:$ctrl.service.authority.projectGroupPermission.project.editProject,free:$ctrl.service.authority.product.ams==\'free\'&&$ctrl.service.authority.role.ams!==\'teammate\',showTitle:true}" other-object="{batch:$ctrl.data.batch,isBatchSelected:$ctrl.data.batch.query.length>0||$ctrl.data.batch.groupQuery.length>0,isGroupAndArchiveSelected:(!$ctrl.data.batch.groupQuery.length>0)&&$ctrl.data.batch.query.length>0&&$ctrl.data.batchOprArchive.length===0,isGroupSelected:(!$ctrl.data.batch.groupQuery.length>0)&&$ctrl.data.batch.query.length>0,setTeammateDiasbledTipStatus:$ctrl.data.batch.groupQuery.length>0||$ctrl.data.batchOprArchive.length>0,archiveDiasbledTipStatus:$ctrl.data.batch.groupQuery.length>0,isBatchDisabled:!$ctrl.ajaxResponse.query.length&&!$ctrl.ajaxResponse.groupQuery.length}"></menu-common-component><list-group-common-component authority-object="{operate:$ctrl.service.authority.projectGroupPermission.project.editProject}" main-object="$ctrl.component.listGroupCommonObject" list="$ctrl.ajaxResponse.query" group-list="$ctrl.ajaxResponse.groupQuery" other-object="{batch:$ctrl.data.batch,request:$ctrl.ajaxRequest}"></list-group-common-component></div><mask-common-component ng-if="!$ctrl.service.authority.projectGroupPermission.project.editProject&&$ctrl.ajaxResponse.query.length==0&&$ctrl.ajaxResponse.groupQuery.length==0&&$ctrl.ajaxRequest.groupID==0"></mask-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><mask-expire-common-component ng-if="$ctrl.service.authority.productUsingPermission.ams.disabled" input="{mark:\'AMS\',role:$ctrl.service.authority.role.ams,productType:$ctrl.service.authority.product.ams}"></mask-expire-common-component>'),t.put("module/ams/ui/project/inside/index.html",'<home-project-inside-navbar></home-project-inside-navbar><div class="container-div" ui-view=""></div>'),t.put("module/ams/ui/automatic/inside/content/commonCase/index.html",'<div><header ng-show="$ctrl.data.status!=-1&&$ctrl.data.envStatus==\'show\'"><ul><li class="env-li pull-right {{$ctrl.data.envClass}}"><env-ams-component setting="{isWantToExposeObject:true}" mark="automatic" env-model="$ctrl.service.home.envObject.object.model" env-param="$ctrl.service.home.envObject.object.param" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.automatic.environment" expose-object="$ctrl.data.inheritEnvObj"></env-ams-component></li></ul></header><div ui-view=""></div></div>'),t.put("module/ams/ui/automatic/inside/content/overview/index.html",'<tip-common-component input="$ctrl.component.tipComponentObject" ng-if="$ctrl.service.authority.projectGroupPermission.automatic.isArchive"></tip-common-component><overview-product-component class="overview_product_component" main-object="$ctrl.component.overviewObject.mainObject" authority-object="{edit:$ctrl.service.authority.projectGroupPermission.automatic.editProject,export:$ctrl.service.authority.permission.automatic.exportAndShare.export,lookScene:$ctrl.service.authority.permission.automatic.sceneCase.look}" other-object="{projectInfo:$ctrl.ajaxResponse.projectInfo,timerChart:$ctrl.component.timerChart}"></overview-product-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component><div move-tip-directive="" parent-class-name="overview_product_component" able-class-name="name_span" tips-style=\'{"top":-5}\' tips-text="创建流程测试用例数量 / 测试通过率"></div><div dump-directive="$ctrl.fun.downloadReport(arg)" setting=\'{switch:"TimeTaskFile"}\'></div><a id="dump_directive_js" class="hidden"></a>'),t.put("module/ams/ui/automatic/inside/content/report/index.html",'<div class="apimanagement-scss-account-log"><menu-common-component authority-object="{case:$ctrl.service.authority.permission.automatic.sceneCase.look,task:$ctrl.service.authority.permission.automatic.timedTask.look}" main-object="$ctrl.component.menuObject.mainObject" active-object="$ctrl.ajaxRequest" other-object="{datePicker:{object:$ctrl.component.datePickerObject,fun:$ctrl.fun.search}}"></menu-common-component><list-page-common-component show-object="$ctrl.ajaxRequest" main-object="$ctrl.component.listPageCommonObject.mainObject" list="$ctrl.ajaxResponse.query" page-object="{pageInfo:$ctrl.data.pagination}" authority-object="{operate:($ctrl.ajaxRequest.reportType===0&&$ctrl.service.authority.permission.automatic.sceneCase.download)||($ctrl.ajaxRequest.reportType===1&&$ctrl.service.authority.permission.automatic.timedTask.download)}"></list-page-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><div dump-directive="$ctrl.fun.downloadReport(arg)" setting=\'{switch:"TestWordFile"}\'></div><a id="dump_directive_js" class="hidden"></a>'),t.put("module/ams/ui/automatic/inside/content/scene/index.html",'<div ng-class="{\'had_tip_automatic_scene\':$ctrl.data.isShowTip}"><header ng-show="$ctrl.data.status!=-1&&$ctrl.data.envStatus==\'show\'"><ul><li class="env-li pull-right {{$ctrl.data.envClass}}"><env-ams-component setting="{isWantToExposeObject:true}" mark="automatic" env-model="$ctrl.service.home.envObject.object.model" env-param="$ctrl.service.home.envObject.object.param" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.automatic.environment" expose-object="$ctrl.data.inheritEnvObj"></env-ams-component></li></ul></header><div ui-view=""></div></div>'),t.put("module/ams/ui/automatic/inside/content/timer/index.html",'<div ng-class="{\'group_and_list_container\':$ctrl.data.sidebarShow}"><home-automatic-inside-timer-sidebar ng-show="$ctrl.data.sidebarShow"></home-automatic-inside-timer-sidebar><div class="list_div_beside_group" ui-view=""></div></div>'),t.put("module/ams/ui/project/inside/component/comment/index.html",'<div class="gosc_session_box f_column"><div class="session_content fg1 p20 fg1" scroll-to-bottom="" stay-scroll="$ctrl.data.stayScroll"><loading-part-common-component ng-show="!$ctrl.ajaxResponse.historyList" fun="$ctrl.fun.init()"></loading-part-common-component><button type="button" class="btn_see_history mb10 f_row f_ac cp" ng-if="$ctrl.data.hasMoreComment" ng-click="$ctrl.fun.seeHistory()"><span class="iconfont icon-lishijilu cb fs18"></span><span class="eo_link btn_hover">查看更多消息</span></button><div class="session_item clear_b" ng-show="$ctrl.ajaxResponse.historyList.length" ng-repeat="item in $ctrl.ajaxResponse.historyList" ng-init="$outerIndex = $index"><div class="divide_tips mb10 tac">API 发布新版本：{{item.updateTime}}</div><div class="message_item_container" ng-repeat="messageItem in item.commentList"><div class="message_item" ng-class="{\'user_message\':messageItem.isNow,\'service_message\':!messageItem.isNow}"><div class="fs12 message_item_header f_row"><span class="message_logo" ng-if="!messageItem.isNow" ng-style="{\'background-image\':\'url(\'+(messageItem.userImage?($ctrl.CONST.PRE_URL_UPLOAD_FILE+messageItem.userImage):($ctrl.CONST.DEFAULT_IMG[messageItem.userSex||0])+\')\')}"></span><div class="message_title" ng-class="{\'ml10 ta_l\':!messageItem.isNow,\'mr10 ta_r\':messageItem.isNow}"><p>{{messageItem.memberNickName}}<span ng-if="!item.isNow">（{{messageItem.inviteCall}}）</span></p><div class="message_title_operate f_row f_ac"><span class="c9 mt5 message_time">{{messageItem.updateTime}}</span> <span class="c9 mlr5 operate_divide operate_hide">|</span> <button type="button" class="eo_link operate_hide" ng-if="!messageItem.isNow" ng-click="$ctrl.fun.reply({item:messageItem})">回复该评论</button> <button type="button" class="eo_link operate_hide mr5" ng-if="messageItem.isNow" ng-click="$ctrl.fun.edit({item:messageItem})">编辑</button> <button type="button" class="eo_link operate_hide" ng-if="messageItem.isNow" ng-click="$ctrl.fun.delete({item:messageItem,$index:$index,$outerIndex:$outerIndex})">删除</button></div></div><span class="message_logo" ng-if="messageItem.isNow" ng-style="{\'background-image\':\'url(\'+(messageItem.userImage?($ctrl.CONST.PRE_URL_UPLOAD_FILE+messageItem.userImage):$ctrl.CONST.DEFAULT_IMG[messageItem.userSex||0])+\')\'}"></span></div><div class="message_content mt5" ng-click="$ctrl.fun.clickMessage({$event:$event})" ng-init="$ctrl.fun.handleMessage({item:messageItem})"><div ng-if="messageItem.beReplyHtml" class="reply_message mb10 f_row"><span class="iconfont icon-chexiao fs20 mr10"></span><div class="reply_message_content" ng-class="{\'reply_message_placeholder text_omit\':!messageItem.showOriginReply}" ng-bind-html="messageItem.beReplyHtml"></div><button class="eo_link" ng-if="!messageItem.showOriginReply" ng-click="messageItem.showOriginReply=true;$ctrl.data.stayScroll=\'cancel\'">查看原文</button></div><div class="content_message" ng-bind-html="messageItem.contentHtml"></div></div></div></div></div></div><div class="plr10 divide_tips reply_tips f_row" ng-if="$ctrl.ajaxData.beReplyMsg.content"><span class="cb">正在回复：</span><span class="fg1 text_omit">{{$ctrl.ajaxData.beReplyMsg.contentRaw}}</span><span class="iconfont icon-guanbi fs20 cp" ng-click="$ctrl.ajaxData.beReplyMsg=null"></span></div><div class="session_editor_box po_re"><span class="c9 fs12 md_tips">支持Markdown语法，支持直接粘贴图片</span><div class="session_editor_wrap"><markdown-editor-ams-component result-html="$ctrl.ajaxData.content" id="editormd_comment" origin="$ctrl.ajaxData.contentRaw" type="apiComment" export-fun-object="$ctrl.amsEditorComponent.exportFun"></markdown-editor-ams-component></div><div class="session_editor_btn_box plr20"><button ng-disabled="!$ctrl.ajaxData.content" ng-if="!$ctrl.data.editID" ng-click="$ctrl.fun.sendMessage()" type="button" class="eo_theme_btn_success btn_send pull-right mb10">发送({{$ctrl.data.isMac?\'Command\':\'Ctrl\'}}+Enter)</button> <button ng-if="$ctrl.data.editID" ng-click="$ctrl.data.editID=0;$ctrl.ajaxData.contentRaw=\'\';" type="button" class="eo_theme_btn_default btn_send pull-right mb10">取消</button> <button ng-disabled="!$ctrl.ajaxData.content" ng-if="$ctrl.data.editID" ng-click="$ctrl.fun.sendMessage()" type="button" class="mr10 eo_theme_btn_success btn_send pull-right mb10">保存</button></div></div><select-person-common-component type="open" input-change-fun="$ctrl.fun.selectMember(arg)" class="float_member_list" output="data.selecter" input="{query:$ctrl.ajaxResponse.memberList,keyword:$ctrl.data.personKeyword,loginCall:\'inviteCall\',nickName:\'userNickName\',noteName:\'memberNickName\',value:\'connID\'}"></select-person-common-component></div>'),t.put("module/ams/ui/project/inside/component/noticeMember/index.html",'<button type="button" class="eo_theme_btn_success mb20" ng-click="$ctrl.fun.batchAddPeople()" ng-if="$ctrl.authorityObject.edit"><span class="iconfont icon-jiahao"></span> <span>添加通知事件</span></button><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.blockListObject.query.mainObject" page-object="$ctrl.data.pagination" authority-object="$ctrl.authorityObject"></list-block-common-component><loading-part-common-component ng-if="$ctrl.service.authority.product.ams !== \'free\'" fun="$ctrl.fun.init()"></loading-part-common-component><div class="eo-none-tr tac" ng-if="$ctrl.ajaxResponse.query.length==0||$ctrl.service.authority.product.ams === \'free\'">暂未设定变更通知事件</div></div>'),t.put("module/ams/ui/project/inside/component/testExample/index.html",'<div ng-class="{\'readonly-container-div\':$ctrl.readOnly}"><div class="f_row_ac"><button id="show-panel-a" type="button" ng-click="$ctrl.fun.previewList($event)" eo-attr-tip-placeholder="testcase_list">测试用例</button> <button type="button" ng-blur="$ctrl.fun.blur()" class="iconfont icon-xiajiantou fs12 more-a" ng-click="$ctrl.fun.previewList($event)"></button></div><div class="po_ab"><div class="container_tec eo_theme_iblock" ng-show="$ctrl.data.isClick"><ul class="query-ul"><li ng-repeat="item in $ctrl.ajaxResponse.caseList" ng-mousedown="$ctrl.fun.click({item:item,$event:$event})" class="item-li cp">{{item.caseName}}</li><loading-part-common-component interaction="{request:{delay:true}}" fun="$ctrl.fun.loadPartCtrl(arg)"></loading-part-common-component></ul><ul class="operate-query-ul" ng-class="{\'divide-ul\':$ctrl.ajaxResponse.caseList.length}"><li class="cp" ng-mousedown="$ctrl.fun.add()" ng-if="$ctrl.service.authority.permission.project.apiManagement.editApiCase&&$ctrl.service.authority.product.ams!=\'free\'">新建用例 <span class="iconfont icon-jiahao pull-right"></span></li><li class="cp" ng-mousedown="$ctrl.fun.admin()">管理用例 <span class="iconfont icon-setting pull-right"></span></li></ul></div></div></div>'),t.put("module/ams/ui/project/inside/content/case/index.html",'<div class="container_hpic f_column f_js group_and_list_container"><home-project-inside-case-part-a triggle="$ctrl.triggleA" accept="$ctrl.triggleB" class="view_hpicpa fg_auto f_row po_re"></home-project-inside-case-part-a><home-project-inside-case-part-b triggle="$ctrl.triggleB" accept="$ctrl.triggleA" report="$ctrl.component.reportObject"></home-project-inside-case-part-b></div><report-ams-component input="$ctrl.component.reportObject"></report-ams-component>'),t.put("module/ams/ui/project/inside/content/code/index.html",'<menu-common-component authority-object="{edit:$ctrl.service.authority.permission.project.statusCode.edit,export:$ctrl.service.authority.permission.project.exportAndShare.export,showTitle:!$ctrl.service.authority.permission.project.statusCode.edit&&!$ctrl.service.authority.permission.project.exportAndShare.export,showBatch:$ctrl.service.authority.permission.project.statusCode.edit||$ctrl.service.authority.permission.project.exportAndShare.export}" other-object="{batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length}" main-object="$ctrl.component.menuObject"></menu-common-component><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.project.statusCode.edit}" main-object="$ctrl.component.listDefaultCommonObject" list="$ctrl.ajaxResponse.query" other-object="{batch:$ctrl.data.batch,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/doc/index.html",'<home-project-inside-doc-sidebar></home-project-inside-doc-sidebar><div class="list_div_beside_group" ui-view=""></div>'),t.put("module/ams/ui/project/inside/content/iterationPlan/index.html",'<div class="container_hpic f_column f_js group_and_list_container"><home-project-inside-iteration-plan-a triggle="$ctrl.triggleA" accept="$ctrl.triggleB" class="view_hpicpa fg_auto f_row po_re"></home-project-inside-iteration-plan-a><home-project-inside-iteration-plan-b triggle="$ctrl.triggleB" accept="$ctrl.triggleA"></home-project-inside-iteration-plan-b></div>'),t.put("module/ams/ui/project/inside/content/overview/index.html",'<tip-common-component input="$ctrl.component.tipComponentObject" ng-if="$ctrl.service.authority.projectGroupPermission.project.isArchive"></tip-common-component><overview-product-component main-object="$ctrl.component.overviewObject.mainObject" authority-object="{edit:$ctrl.service.authority.projectGroupPermission.project.editProject,pro:$ctrl.service.authority.product.ams!=\'free\',lookApi:$ctrl.service.authority.permission.project.apiManagement.look,lookCode:$ctrl.service.authority.permission.project.statusCode.look,lookPage:$ctrl.service.authority.permission.project.projectPage.look,export:$ctrl.service.authority.permission.project.exportAndShare.export,share:$ctrl.service.authority.permission.project.exportAndShare.share,isShareOpen:$ctrl.interaction.response.projectInfo.isShared,sync:$ctrl.service.authority.permission.project.apiManagement.edit&&$ctrl.service.authority.product.ams!=\'free\'&&$ctrl.service.authority.permission.project.apiManagement.synchronize}" other-object="{ganttObject:$ctrl.component.ganttObject,planList:$ctrl.interaction.response.projectInfo.planList,projectInfo:$ctrl.interaction.response.projectInfo,plugApiStatusStatisticsObject:$ctrl.component.plugApiStatusStatisticsObject,contributionChart:$ctrl.component.contributionChart}"></overview-product-component><loading-common-component fun="$ctrl.fun.initPromise(arg)"></loading-common-component>'),
t.put("module/ams/ui/project/inside/content/quickTest/index.html",'<div class="apimanagement-scss-quickTest"><header><div class="tab-container-mask"></div><div class="tab-container"><div class="f_row" get-dom-length-common-directive="" bind-class="item-tc" model="$ctrl.data.itemLength"><div class="item-tc" ng-click="$ctrl.fun.click(key)" ng-class="{\'active-item-tc\':key==$ctrl.component.testObject.target}" ng-repeat="(key,item) in $ctrl.component.testObject.object"><span>{{item.vmAjaxResponse.apiInfo.baseInfo.apiName||item.vmServiceHome.envObject.object.model.URL||"新标签"}}</span> <span class="iconfont icon-guanbi pull-right cp" ng-click="$ctrl.fun.close($event,key)"></span></div><div class="group-btn-container f_row pr20"><button class="btn-add iconfont icon-jiahao" type="button" ng-click="$ctrl.fun.add()" ng-if="$ctrl.data.itemLength<10"></button><div class="more-btn-container"><button type="button" class="btn-more iconfont icon-iosgengduo eo_more_btn" eo-drop-elem="" text-arr="[{key:\'关闭所有标签（当前标签除外）\',value:\'all-expect-current\'},{key:\'关闭所有标签\',value:\'all\'},{key:\'关闭左侧所有标签\',value:\'left\'},{key:\'关闭右侧所有标签\',value:\'right\'}]" fn-click="$ctrl.fun.moreClose(target)" ng-class="{\'br_0330\':$ctrl.data.itemLength<10,\'br_3\':$ctrl.data.itemLength>=10}"></button></div></div></div></div><env-ams-component class="env-li" mark="project" env-model="$ctrl.service.home.envObject.object.model" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.project.environment"></env-ams-component></header><home-project-inside-api-test cache-object="$ctrl.component.testObject.object[$ctrl.component.testObject.target]"></home-project-inside-api-test></div>'),t.put("module/ams/ui/project/inside/content/api/index.html",'<home-project-inside-api-sidebar ng-show="$ctrl.data.sidebarShow"></home-project-inside-api-sidebar><div class="env-li {{$ctrl.data.envClass}}" ng-show="$ctrl.data.status!=-1&&$ctrl.data.envStatus==\'show\'"><env-ams-component mark="project" env-model="$ctrl.service.home.envObject.object.model" env-param="$ctrl.service.home.envObject.object.param" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.project.environment"></env-ams-component></div><div ui-view="" class="list_div_beside_group"></div>'),t.put("module/ams/ui/automatic/inside/content/account/default/index.html",'<div class="common_setting_form_list"><h1 class="csl_title"><span class="title_icon iconfont icon-quanjushezhi"></span> <span>项目设置</span></h1><multi-tab-component class="mt20" list="$ctrl.multiTabComponent.list" model="$ctrl.data.tabValue" change-fun="$ctrl.fun.changeTab()"></multi-tab-component><article class="eo-tab-container csl_list_container" ng-show="$ctrl.data.tabValue===0"><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">基本信息</h2></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu" name="BasicForm"><div class="form_item"><label class="form_label" for="projectName">自动化测试名称</label> <input autocomplete="off" name="projectName" id="projectName" class="eo-input" type="text" maxlength="255" ng-model="$ctrl.ajaxResponse.projectInfo.projectName" ng-disabled="!$ctrl.service.authority.projectGroupPermission.automatic.editProject" required=""></div><div class="form_item"><label class="form_label" for="projectVersion">版本号</label> <input autocomplete="off" name="projectVersion" class="eo-input" type="text" placeholder="版本号" maxlength="20" ng-model="$ctrl.ajaxResponse.projectInfo.projectVersion" ng-disabled="!$ctrl.service.authority.projectGroupPermission.automatic.editProject" ng-pattern="/^[0-9.]{1,20}$/" ng-class="{\'eo-input-error\':(BasicForm.projectVersion.$dirty&&BasicForm.projectVersion.$invalid)}" required=""><p class="eo-error-tips">请填写正确的版本号</p></div><button class="eo_theme_btn_success form_btn_submit" type="submit" button-set-disable-directive="$ctrl.fun.confirm()" ng-if="$ctrl.service.authority.projectGroupPermission.automatic.editProject">保存</button></form></div><div class="csl_item" collapse-common="" will-change-size="true"><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">可引用的API项目</h2><p class="secondary_title">默认允许引用所有的API管理项目。只有当某个API管理项目被设置为可引用之后，创建测试用例时才能够从该项目中导入API信息。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu" name="BindForm"><div class="form_item"><label class="form_label" for="spaceName">可引用的项目</label><div class="f_row"><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.settingInfo" model-key="settingType" required="true" input="{query:$ctrl.data.settingTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.settingInfo.settingType}"></select-default-common-component><button class="eo_theme_btn_success ml10 plr10" ng-click="$ctrl.fun.addProject()" ng-show="$ctrl.ajaxResponse.settingInfo.settingType==1"><span class="iconfont icon-jiahao"></span>&nbsp;添加项目</button></div><div class="eo-block-container mt20" ng-show="$ctrl.ajaxResponse.settingInfo.settingType==1"><list-block-common-component list="$ctrl.ajaxResponse.settingInfo.projectList" main-object="$ctrl.component.blockListObject.referProject"></list-block-common-component><div class="eo-none-tr tac" ng-show="$ctrl.ajaxResponse.settingInfo.projectList.length==0">暂未选择任何可引用的项目</div></div></div><button class="eo_theme_btn_success plr10 form_btn_submit" type="submit" button-set-disable-directive="$ctrl.fun.confirmBind()" ng-disabled="BindForm.$invalid">保存</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">归档项目</h2><p class="secondary_title">当项目已经停止维护时，您可以将项目设置为归档状态。已归档的项目不允许编辑，如需编辑项目内容需要先取消归档。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu"><button class="eo_theme_btn_info form_btn_submit" ng-click="$ctrl.fun.file()">{{$ctrl.ajaxResponse.projectInfo.isArchive===0?"归档项目":"取消归档"}}</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">删除项目</h2><p class="secondary_title">自动化测试删除后，所有自动化测试内数据均会被删除，并且无法恢复数据，请谨慎操作！</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu"><button class="eo_theme_btn_danger form_btn_submit" ng-click="$ctrl.fun.delete()">删除自动化测试</button></form></div></article><article class="eo-tab-container csl_list_container" ng-show="$ctrl.data.tabValue===3"><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">测试步骤默认超时时间</h2></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu" name="TimeoutForm"><p class="first-form-item-title-p">超时限制（ms）</p><p class="eo-status-tips fs12 mt10">测试超时将会自动判断为测试失败</p><tip-common-component class="mt10" input="$ctrl.component.tipComponentObject" ng-if="$ctrl.data.validToSwitchTestMethod"></tip-common-component><div class="f_row f_ac mt10"><select-default-common-component class="w_250 mr15" output="$ctrl.ajaxResponse.timeoutSetting" model-key="timeoutLimitType" required="true" input="{query:$ctrl.CONST.TIMELIMIT_TYPE_ARR,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.timeoutSetting.timeoutLimitType||0}"></select-default-common-component><input class="eo-input w_250" name="timeoutLimit" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&TimeoutForm.timeoutLimit.$invalid}" autocomplete="off" type="text" ng-pattern="/^[0-9]\\d*$/" ng-model="$ctrl.ajaxResponse.timeoutSetting.timeoutLimit" required=""><span class="ml5">ms</span></div><button class="eo_theme_btn_success form_btn_submit mt20" type="submit" ng-click="$ctrl.fun.saveGlobalTimeout()">保存</button></form></div></article></div><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/automatic/inside/content/account/log/index.html",'<div class="apimanagement-scss-account-log"><menu-common-component authority-object="{month:$ctrl.service.authority.productUsingPermission.automaticTest.log>=30,quarter:$ctrl.service.authority.productUsingPermission.automaticTest.log==180}" main-object="$ctrl.component.menuObject.mainObject" active-object="$ctrl.ajaxRequest" other-object="{datePicker:{object:$ctrl.component.datePickerObject,fun:$ctrl.fun.search}}"></menu-common-component><list-page-common-component main-object="$ctrl.component.listPageCommonObject.mainObject" list="$ctrl.ajaxResponse.query" page-object="{pageInfo:$ctrl.data.pagination}"></list-page-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div>'),t.put("module/ams/ui/automatic/inside/content/scene/api/index.html",'<div class="ams-css-automated-ui-mode-list" ng-class="{\'unauthority-container-acauml\':!$ctrl.service.authority.permission.automatic.sceneCase.edit}"><div class="common-table-div" check-plug-directive="" input="$ctrl.data.plugObject"><menu-common-component authority-object="$ctrl.service.authority.permission.automatic.sceneCase" main-object="$ctrl.component.topMenuObject"></menu-common-component><article class="first_level_article"><div class="case_detail_part pt20 bbd po_re"><div class="f_row_ac f_js"><span class="fs24">{{$ctrl.ajaxResponse.caseInfo.caseName}}</span><div class="f_row_ac"><button class="f_row_ac mr20" ng-click="$ctrl.fun.watchUiAction(\'showReportModal\')"><span class="iconfont icon-lishijilu mr5 fs18"></span><span>测试历史</span></button><div ng-switch="$ctrl.data.plugObject.validToSwitchTestMethod||$ctrl.data.plugTransferToLocal"><div class="eo_more_btn_container" ng-switch-when="true"><button class="block-btn common-btn batch-test-btn eo_theme_btn_success" id="ui_btn_test" ng-click="$ctrl.fun.watchUiAction(\'test\')" eo-attr-test-type="{{$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus?\'plug\':\'server\'}}" testing="{{($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod===\'all\')||false}}" ng-disabled="($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod!==\'all\')||($ctrl.data.selectStepNum==0||$ctrl.data.selectStepNum<=$ctrl.data.emptyStepNum)"><span class="iconfont icon-shanguangdeng pull-left"></span> <span class="btn-name">{{($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod===\'all\')?"中止测试":("执行测试 [通过"+(($ctrl.data.testSeverType==="nodejs"||!$ctrl.data.plugObject.useStatus)?"服务器":($ctrl.data.plugTransferToLocal?"本地":"插件"))+"测试]")}}</span></button> <button class="more-btn eo_more_btn fs12 w_40 eo_theme_btn_success" eo-drop-elem="" text-arr="[{key:\'切换使用{{$ctrl.otherObj.testServer}}测试\'}]" other-obj=\'{"testServer":($ctrl.data.testSeverType!=="nodejs"&&$ctrl.data.plugObject.useStatus)?"服务器":($ctrl.data.plugTransferToLocal?"本地":"插件")}\' fn-click="$ctrl.fun.watchUiAction(\'changeTestMethod\')" ng-disabled="($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod!==\'all\')||($ctrl.data.selectStepNum==0||$ctrl.data.selectStepNum<=$ctrl.data.emptyStepNum)"><span class="iconfont icon-xiajiantou"></span></button></div><div ng-switch-when="false"><button class="block-btn common-btn batch-test-btn" id="ui_btn_test" ng-class="$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus?\'eo_theme_btn_success\':\'eo_theme_btn_info\'" ng-click="$ctrl.fun.watchUiAction(\'test\')" ng-disabled="($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod!==\'all\')||($ctrl.data.selectStepNum==0||$ctrl.data.selectStepNum<=$ctrl.data.emptyStepNum)"><span class="iconfont icon-shanguangdeng pull-left"></span> <span class="btn-name">{{($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod===\'all\')?"中止测试":"测试全部"}}</span></button></div></div></div></div><div><div class="tag_item" ng-repeat="tag in $ctrl.ajaxResponse.caseInfo.caseTag">{{tag}}</div></div><p class="lh_50 c999 fs12"><span class="mr30">分组:&nbsp;{{$ctrl.ajaxResponse.caseInfo.groupName}}</span> <span class="mr30">创建者:&nbsp;{{$ctrl.ajaxResponse.caseInfo.creator||\'无\'}}</span> <span class="mr30">更新时间：{{$ctrl.ajaxResponse.caseInfo.updateTime}}</span></p></div><tip-common-component ng-if="$ctrl.ajaxResponse.caseInfo.oldCaseType===0" input="{btnClose:1,value:\'EO_AUTOMATIC_OLD_UI_CASE_TIPS_WARNING\',type:\'text\',status: \'success\',text:\'升级提示：测试用例已全面升级，现在您可以直接在测试步骤中添加脚本 [Javascript] 类型的步骤。\'}"></tip-common-component><tip-common-component ng-if="$ctrl.ajaxResponse.caseInfo.oldCaseType===1" input="{btnClose:1,value:\'EO_AUTOMATIC_OLD_CODE_CASE_TIPS_WARNING\',type:\'text\',status: \'warning\',text:\'升级提示：脚本模式测试用例已全面升级，旧的脚本测试用例的代码部分已经整体自动转换为以下列表中的脚本步骤。现在您可以在脚本代码中引用前置用例以及后置用例的变量，并且可以自由拖动排列执行顺序。\'}"></tip-common-component><div class="mt15 eo-block-container"><menu-common-component class="second_menu_haisa bbd" ng-if="$ctrl.service.authority.permission.automatic.sceneCase.edit" authority-object="{edit:$ctrl.service.authority.permission.automatic.sceneCase.edit}" other-object="{disableBindApiShowTips:$ctrl.data.selectedCommonCase,disableBindApi:$ctrl.data.selectedCommonCase||!$ctrl.ajaxResponse.query.length||!$ctrl.data.batch.query.length,batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length}" main-object="$ctrl.component.menuObject" show-object="{batch:$ctrl.data.batch}"></menu-common-component><list-block-common-component active-object="$ctrl.data.batch" other-object="{hasDataCollection:$ctrl.ajaxResponse.caseInfo.hasDataCollection,nowIsBatchOperate:$ctrl.data.batch.isOperating,testHistoryObj:$ctrl.data.testHistory,allIsTesting:$ctrl.testStatusObj.isTesting,testMethod:$ctrl.data.testMethod,hoverBindCaseID:$ctrl.data.hoverBindCaseID}" authority-object="$ctrl.service.authority.permission.automatic.sceneCase" list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.blockListObject.api"></list-block-common-component><div class="eo-none-tr tac" ng-show="(!$ctrl.ajaxResponse.beforeCaseList.length)&&(!$ctrl.ajaxResponse.afterCaseList.length)&&(!$ctrl.ajaxResponse.query.length)">暂无任何数据</div><div class="w_100precent pl20 tfooter-div">共{{$ctrl.ajaxResponse.query.length||0}}条记录</div></div></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div></div><div class="float_case_inside_report eo_theme_iblock" ng-class="{\'eo_to_right_750\':!$ctrl.data.modal,\'eo_to_right_0\':$ctrl.data.modal}"><div ng-if="$ctrl.data.modal"><div class="p20 ptb15 bbd"><span class="fwb fs18">测试历史</span> <button class="eo_theme_btn_default plr15 pull-right" ng-click="$ctrl.fun.watchUiAction(\'closeReportModal\')">关闭</button><br clear="both"></div><div class="p20 mb50"><ams-automatic-case-inside-report show-report="$ctrl.fun.showDdtReport(arg)"></ams-automatic-case-inside-report></div></div></div><report-ams-component input="$ctrl.component.reportObject" status="{{\'automated-common-\'+$ctrl.data.reportClickStatus}}"></report-ams-component><batch-test-ams-component output="$ctrl.data.testHistory" status-object="$ctrl.testStatusObj" env="$ctrl.service.home.envObject.object.total" status="automatic-unit" ng-if="$ctrl.data.plugObject.useStatus&&$ctrl.data.testSeverType!==\'nodejs\'"></batch-test-ams-component><ddt-test-ams-component ng-if="$ctrl.data.showDdtModal" bind-fun="$ctrl.fun.watchUiAction(\'closeDdtModal\')" main-obj="{ajaxRequest:$ctrl.ajaxRequest,sendTestMsg:$ctrl.component.ddtModal.sendTestMsg,showReport:$ctrl.component.ddtModal.showReport,isReport:$ctrl.data.isDdtReport,caseName:$ctrl.ajaxResponse.caseInfo.caseName}" test-obj="$ctrl.component.ddtModal.testObj" report-obj="$ctrl.component.ddtModal.reportObj"></ddt-test-ams-component>'),t.put("module/ams/ui/automatic/inside/content/scene/api/testResult.tmp.html",'<div class="tested-div" ng-class="{\'testing-div\':$ctrl.otherObject.testHistoryObj[item.tempID].responseType===\'testing\'&&$ctrl.otherObject.allIsTesting}" ng-switch="$ctrl.otherObject.testHistoryObj[item.tempID].responseType"><button class="eo-status-success" ng-disabled="$ctrl.otherObject.nowIsBatchOperate" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'success\',item)" ng-switch-when="success|finish" ng-switch-when-separator="|">通过，查看详情</button> <button class="eo-status-error" ng-disabled="$ctrl.otherObject.nowIsBatchOperate" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'error\',item)" ng-switch-when="error|timeout|matchError|interrupt|codeError|terminateRequest" ng-switch-when-separator="|">未通过，查看详情</button><div ng-switch-when="testing"><span class="iconfont icon-jiazai_shuaxin"></span> <span>测试中</span></div><div ng-switch-default=""><span>{{item.isEmpty?"-":"尚无测试结果"}}</span></div></div>'),t.put("module/ams/ui/automatic/inside/content/scene/editSingle/index.html",'<div form-check-is-invalid-common-directive="" model="$ctrl.data.isInvalidForm" bind-class-name="btn-save-mdcc"><menu-common-component main-object="$ctrl.component.menuObject.mainObject"></menu-common-component><form autocomplete="off" class="basic-part item_part eo-tab-container" name="ConfirmForm"><div class="first_level_article"><p class="title-p"><b>测试步骤名称</b></p><p class="case-name-p mt10"><input autocomplete="off" type="text" name="apiName" class="eo-input" ng-model="$ctrl.ajaxResponse.apiName" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&ConfirmForm.apiName.$invalid}" required=""></p><p class="title-p mt20 mb10"><b>API Path</b></p><div class="f_row_ac"><select-default-common-component class="w_80 request_protocol_select_haises" output="$ctrl.ajaxResponse.caseData" model-key="httpHeader" required="true" input="{query:$ctrl.CONST.requestProtocolQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.caseData.httpHeader}"></select-default-common-component><select-default-common-component class="w_80 request_type_select_haises" output="$ctrl.ajaxResponse.caseData" model-key="apiRequestType" required="true" input="{query:$ctrl.CONST.requestMethodQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.caseData.apiRequestType||\'0\'}"></select-default-common-component><input autocomplete="off" name="uri" type="text" class="w_100percent eo-input" ng-model="$ctrl.ajaxResponse.caseData.URL" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&ConfirmForm.uri.$invalid}" ng-change="$ctrl.fun.changeUri()" required=""></div><p class="title-p mt20"><b>绑定的API文档 (选填)</b></p><div class="f_row f_ac mt10"><input class="eo-input" ng-class="{\'eo-input-error\':$ctrl.ajaxResponse.apiID&&!$ctrl.ajaxResponse.apiPath}" placeholder="尚未绑定API文档" ng-model="$ctrl.ajaxResponse.apiPath"> <button type="button" class="eo_theme_btn_info ml10" ng-click="$ctrl.fun.bindApi()">{{$ctrl.ajaxResponse.apiID&&!$ctrl.ajaxResponse.apiPath?"重新绑定":"绑定"}}</button> <button type="button" class="eo_theme_btn_info ml10" ng-if="$ctrl.ajaxResponse.apiID" ng-click="$ctrl.fun.unbindApi()">解除绑定</button><div class="f_row f_ac" ng-if="$ctrl.ajaxResponse.apiID&&$ctrl.ajaxResponse.apiPath"><span class="divide_line"></span> <button type="button" class="eo_theme_btn_info" ng-click="$ctrl.fun.pullApi()">同步</button></div></div><p class="cr fs12 mt10" ng-if="$ctrl.ajaxResponse.apiID&&!$ctrl.ajaxResponse.apiPath">此API已失效，请重新绑定</p><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkRequestData=!$ctrl.data.shrinkRequestData"><span>请求参数</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkRequestData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkRequestData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkRequestData}"></span></div></div><div class="mt20" ng-if="!$ctrl.data.shrinkRequestData"><multi-tab-component class="dp_b" other-obj="{advancedSetting:$ctrl.ajaxResponse.advancedSetting,injectScript:$ctrl.ajaxResponse.caseData.script,auth:$ctrl.ajaxResponse.caseData.auth,restfulParam:$ctrl.ajaxResponse.caseData.restfulParam.length,urlParam:$ctrl.ajaxResponse.caseData.urlParam.length,raw:$ctrl.ajaxResponse.caseData.raw,params:$ctrl.ajaxResponse.caseData.params,requestType:$ctrl.ajaxResponse.caseData.requestType,headers:$ctrl.ajaxResponse.caseData.headers.length}" list="$ctrl.CONST.REQUEST_DATA_MENU_ARR" model="$ctrl.data.menuType"></multi-tab-component><div class="bbd bld brd"><div ng-show="$ctrl.data.menuType==\'advancedSetting\'"><test-setting-ams-component bind-object="$ctrl.ajaxResponse.advancedSetting"></test-setting-ams-component></div><div class="item_part" ng-if="$ctrl.data.menuType==\'headers\'"><header><div class="eo-more-btn-container" set-to-params="headerName" item="{{$ctrl.CONST.jsonToParamObject.headerItem}}" un-parse-type="true" reset-result="$ctrl.ajaxResponse.caseData.headers" set-value="headerValue" import-method="2"></div></header><list-block-common-component list="$ctrl.ajaxResponse.caseData.headers" main-object="$ctrl.component.blockListObject.requestHeader.mainObject"></list-block-common-component></div><div ng-show="$ctrl.data.menuType==\'auth\'"><auth-ams-component auth-object="$ctrl.ajaxResponse.caseData.auth"></auth-ams-component></div><div class="item_part" ng-if="$ctrl.data.menuType==\'body\'"><header><div class="dp_ib w_100percent"><menu-radio-common-component class="pull-left mr5" list="$ctrl.CONST.REQUEST_BODY_TYPE_ARR" output="$ctrl.ajaxResponse.caseData" model-key="requestType" bind-fun="$ctrl.fun.changeBodyType(arg)"></menu-radio-common-component><div ng-if="[\'0\',\'2\',\'3\'].indexOf($ctrl.ajaxResponse.caseData.requestType)>-1"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container mr15" ng-show="$ctrl.ajaxResponse.caseData.requestType!==\'0\'"><button class="eo_more_btn f_row_ac" type="button" other-obj="{requestType:$ctrl.ajaxResponse.caseData.requestType,target:$ctrl.ajaxResponse.caseData.params}" eo-drop-elem="" text-arr="$ctrl.CONST.INSERT_BODY_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-show="$ctrl.ajaxResponse.caseData.requestType==\'0\'"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="$ctrl.fun.formToOtherType(target)" text-arr="[{key:\'Json\',value:\'json\'},{key:\'XML\',value:\'xml\'}]"><span class="iconfont icon-huopinfenliu"></span> <span>转换为</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div></div></div><div class="pt10" ng-show="$ctrl.ajaxResponse.caseData.requestType == \'2\'"><p class="fs12 c999">JSON&nbsp;根类型：</p><p class="mt10"><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.caseData" model-key="apiRequestParamJsonType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.caseData.apiRequestParamJsonType}"></select-default-common-component></p></div></header><article><list-block-common-component ng-if="[\'0\',\'2\',\'3\'].indexOf($ctrl.ajaxResponse.caseData.requestType)>-1" list="$ctrl.ajaxResponse.caseData.params" main-object="$ctrl.component.blockListObject.body" other-object="{\'bodyParamType\':$ctrl.ajaxResponse.caseData.requestType,fileObj:$ctrl.data.fileObj}"></list-block-common-component><div class="dp_f" ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.caseData.requestType!=\'1\'}"><ace-editor-ams-component class="ace-editor-container w_100percent" set-model="$ctrl.ajaxResponse.caseData.raw"></ace-editor-ams-component></div><div class="dp_f po_re p10" ng-if="$ctrl.ajaxResponse.caseData.requestType===\'4\'"><div class="eo-input disabled_input_haises text_omit">{{$ctrl.data.fileObj[$ctrl.ajaxResponse.caseData.params.uuid].fileName||$ctrl.ajaxResponse.caseData.params.name||"请选择文件"}}</div><button type="button" class="file_binary_btn_haises ml10" ng-click="$ctrl.fun.importBinaryFile()">选择文件</button> <button type="button" class="file_binary_btn_haises ml10" ng-click="$ctrl.fun.bindBinaryFile()">绑定参数</button></div></article></div><div class="item_part" ng-if="$ctrl.data.menuType==\'restful\'"><list-block-common-component list="$ctrl.ajaxResponse.caseData.restfulParam" main-object="$ctrl.component.blockListObject.restful.mainObject"></list-block-common-component></div><div class="item_part" ng-if="$ctrl.data.menuType==\'url\'"><header><div class="eo-more-btn-container" set-to-params="paramKey" item="{{$ctrl.CONST.jsonToParamObject.urlItem}}" reset-result="$ctrl.ajaxResponse.caseData.urlParam" set-value="paramInfo" import-method="1"></div></header><list-block-common-component list="$ctrl.ajaxResponse.caseData.urlParam" main-object="$ctrl.component.blockListObject.queryParam.mainObject"></list-block-common-component></div><div class="item_part" ng-if="$ctrl.data.menuType==\'inject\'"><header><menu-radio-common-component list="$ctrl.CONST.scriptTypeQuery" output="$ctrl.ajaxResponse.caseData.script" model-key="type" cancle-bind-fun="true"></menu-radio-common-component></header><ace-menu-editor-ams-component class="dp_f" mark="automatic" set-model="$ctrl.ajaxResponse.caseData.script" set-variable="$ctrl.ajaxResponse.caseData.script.type==\'0\'?\'before\':\'after\'" watch-model="$ctrl.ajaxResponse.caseData.script.type"></ace-menu-editor-ams-component></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkResponseData=!$ctrl.data.shrinkResponseData"><span>提取返回结果，可被后续测试步骤引用</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkResponseData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkResponseData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkResponseData}"></span></div></div><div class="mt20" ng-if="!$ctrl.data.shrinkResponseData"><multi-tab-component class="dp_b" other-obj="{responseHeader:$ctrl.ajaxResponse.responseHeader.length,resultParam:$ctrl.ajaxResponse.resultParam,resultParamType:$ctrl.ajaxResponse.resultParamType}" list="$ctrl.CONST.RESPONSE_DATA_MENU_ARR" model="$ctrl.data.responseMenuType"></multi-tab-component><div class="bbd bld brd"><div class="item_part" ng-show="$ctrl.data.responseMenuType==\'responseHeader\'"><header><div class="eo-more-btn-container" set-to-params="headerName" item="{{$ctrl.CONST.jsonToParamObject.responseHeaderItem}}" un-parse-type="true" reset-result="$ctrl.ajaxResponse.responseHeader" set-value="headerValue" import-method="2"></div></header><list-block-common-component list="$ctrl.ajaxResponse.responseHeader" main-object="$ctrl.component.blockListObject.responseHeader.mainObject"></list-block-common-component></div><div class="item_part regex_part" ng-show="$ctrl.data.responseMenuType==\'response\'"><header><div class="f_row_ac"><menu-radio-common-component class="mr5" list="$ctrl.CONST.RESPONSE_TYPE_ARR" output="$ctrl.ajaxResponse" model-key="resultParamType" bind-fun="$ctrl.fun.changeResponseType(arg)"></menu-radio-common-component><div ng-show="[\'0\',\'1\'].indexOf($ctrl.ajaxResponse.resultParamType)>-1"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container"><button type="button" class="eo_more_btn f_row_ac" other-obj="{resultParamType:$ctrl.ajaxResponse.resultParamType,target:$ctrl.ajaxResponse.resultParam}" eo-drop-elem="" text-arr="$ctrl.CONST.INSERT_RESPONSE_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div></div></div><div class="mt10" ng-show="$ctrl.ajaxResponse.resultParamType == \'0\'"><p class="fs12 c999">JSON&nbsp;根类型：</p><p class="mt10"><select-default-common-component class="w_250" output="$ctrl.ajaxResponse" model-key="resultParamJsonType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.resultParamJsonType}"></select-default-common-component></p></div></header><list-block-common-component list="$ctrl.ajaxResponse.resultParam" main-object="$ctrl.component.blockListObject.response.mainObject" other-object="{resultParamType:$ctrl.ajaxResponse.resultParamType}" ng-if="[\'0\',\'1\'].indexOf($ctrl.ajaxResponse.resultParamType)>-1"></list-block-common-component><div class="p10" ng-if="[\'0\',\'1\'].indexOf($ctrl.ajaxResponse.resultParamType)===-1"></div></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkMatchRuleData=!$ctrl.data.shrinkMatchRuleData"><span>校验规则</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkMatchRuleData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkMatchRuleData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkMatchRuleData}"></span></div></div><div class="mt20" ng-if="!$ctrl.data.shrinkMatchRuleData"><multi-tab-component class="dp_b" list="$ctrl.CONST.MATCH_RULE_DATA_MENU_ARR" model="$ctrl.data.matchRuleMenuType"></multi-tab-component><div ng-switch="$ctrl.data.matchRuleMenuType"><div class="bbd bld brd" ng-switch-when="responseHeader"><header><menu-radio-common-component list="$ctrl.CONST.MATCH_HEADER_TYPE_ARR" output="$ctrl.ajaxResponse.responseHeaderVerification" model-key="matchType" cancle-bind-fun="true"></menu-radio-common-component></header><list-block-common-component list="$ctrl.ajaxResponse.responseHeaderVerification.matchRule" main-object="$ctrl.component.blockListObject.headerCheck.mainObject" ng-show="$ctrl.ajaxResponse.responseHeaderVerification.matchType==1"></list-block-common-component><p class="null_tip_span" ng-show="$ctrl.ajaxResponse.responseHeaderVerification.matchType==0">不校验返回头部，任意返回头部均判断为正确</p></div><div class="bbd bld brd regex_part" ng-switch-when="response"><header><menu-radio-common-component list="$ctrl.CONST.MATCH_TYPE_ARR" output="$ctrl.ajaxResponse" model-key="matchType" bind-fun="$ctrl.fun.changeResponseMatchType(arg)"></menu-radio-common-component></header><div class="p10"><p class="regex-p mb10" ng-if="($ctrl.ajaxResponse.matchType == 2&&$ctrl.ajaxResponse.resultParamType==\'0\')||$ctrl.ajaxResponse.matchType == 4&&$ctrl.ajaxResponse.resultParamType==\'1\'"><button class="blue_bg_btn_haises" ng-click="$ctrl.fun.merge()" ng-hide="$ctrl.ajaxResponse.matchType == 2&&$ctrl.ajaxResponse.resultParamType==\'0\'&&$ctrl.ajaxResponse.jsonResultVerification.positionType==1">同步返回参数</button></p><div ng-hide="$ctrl.ajaxResponse.matchType == 3"><p class="match-title-p ptb10">HTTP Status Code 校验：</p><p class="dp_ib w_100percent"><select-default-common-component class="pull-left mr10 w_250" ng-if="$ctrl.data.operate!=\'edit\'" output="$ctrl.ajaxResponse" model-key="statusCode" required="true" input="{query:$ctrl.CONST.statusCodeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.statusCode||\'200\'}"></select-default-common-component><input autocomplete="off" type="text" class="eo-input" ng-show="$ctrl.ajaxResponse.statusCode==\'0\'||$ctrl.data.operate==\'edit\'" ng-model="$ctrl.ajaxResponse.code"></p></div><div ng-show="$ctrl.ajaxResponse.matchType == 2"><p class="match-title-p pb10 pt20">JSON 参数定位方式：</p><div class="f_row"><select-default-common-component class="mr10 w_250" output="$ctrl.ajaxResponse.jsonResultVerification" model-key="positionType" required="true" input="{query:$ctrl.CONST.JSON_MATCH_POSITION_TYPE_ARR,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.jsonResultVerification.positionType||0}" input-change-fun="$ctrl.fun.changeJsonMatchPositionType()"></select-default-common-component></div><p class="match-title-p pb10 pt20" ng-hide="$ctrl.ajaxResponse.matchType == 2&&$ctrl.ajaxResponse.resultParamType==\'0\'&&$ctrl.ajaxResponse.jsonResultVerification.positionType==1">JSON 根类型：</p><div class="f_row" ng-hide="$ctrl.ajaxResponse.matchType == 2&&$ctrl.ajaxResponse.resultParamType==\'0\'&&$ctrl.ajaxResponse.jsonResultVerification.positionType==1"><select-default-common-component class="pull-left mr10 w_250" output="$ctrl.ajaxResponse.jsonResultVerification" model-key="resultType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.jsonResultVerification.resultType||\'0\'}"></select-default-common-component><select-default-common-component class="w_250" ng-show="$ctrl.ajaxResponse.jsonResultVerification.resultType==1" output="$ctrl.ajaxResponse.jsonResultVerification" model-key="matchRule" required="true" input="{query:$ctrl.CONST.matchLoopQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.jsonResultVerification.matchRule||\'0\'}"></select-default-common-component></div></div></div><div class="mt10" ng-hide="$ctrl.ajaxResponse.matchType == 3||$ctrl.ajaxResponse.matchType == 5"><p class="match-title-p mtb10 plr10">返回结果校验规则：</p><textarea class="m10" ng-model="$ctrl.ajaxResponse.matchRule" ng-hide="$ctrl.ajaxResponse.matchType>1"></textarea><div ng-if="$ctrl.ajaxResponse.matchType==2||$ctrl.ajaxResponse.matchType==4"><list-block-common-component list="$ctrl.ajaxResponse.matchRule" main-object="$ctrl.component.blockListObject.responseCheck" other-object="{\'matchRule\':$ctrl.CONST.matchRule,matchType:$ctrl.ajaxResponse.matchType,positionType:$ctrl.ajaxResponse.jsonResultVerification.positionType}"></list-block-common-component></div></div><p class="null_tip_span" ng-if="$ctrl.ajaxResponse.matchType==3">不校验返回结果，任意结果均判断为正确</p></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkOtherConf=!$ctrl.data.shrinkOtherConf"><span>其他设置</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkOtherConf?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkOtherConf,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkOtherConf}"></span></div></div><div class="item_part regex_part mt15" ng-if="!$ctrl.data.shrinkOtherConf"><tab-select-common-component main-object="$ctrl.component.keepGoingTabSelect" interaction="$ctrl.ajaxResponse.caseData"></tab-select-common-component><div class="mt15"></div><tab-select-common-component main-object="$ctrl.component.judgeSettingTabSelect" interaction="$ctrl.ajaxResponse"></tab-select-common-component><div class="mt15"><p>超时限制（ms）</p><p class="eo-status-tips fs12 mt10">测试超时将会自动判断为测试失败</p><tip-common-component class="mt10" input="$ctrl.component.tipComponentObject" ng-if="$ctrl.data.validToSwitchTestMethod"></tip-common-component><div class="f_row mt10"><select-default-common-component class="w_250 mr15" output="$ctrl.ajaxResponse" model-key="projectTimeoutSetting" required="true" input-change-fun="$ctrl.fun.changeTimeoutSetting()" input="{query:$ctrl.CONST.TIMELIMIT_IS_GLOABL_ARR,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.projectTimeoutSetting}"></select-default-common-component><select-default-common-component class="w_250 mr15" disabled="$ctrl.ajaxResponse.projectTimeoutSetting===0" output="$ctrl.ajaxResponse" model-key="timeoutLimitType" required="true" input="{query:$ctrl.CONST.TIMELIMIT_TYPE_ARR,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.timeoutLimitType||0}"></select-default-common-component><input class="eo-input" name="timeoutLimit" ng-disabled="$ctrl.ajaxResponse.projectTimeoutSetting===0" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&ConfirmForm.timeoutLimit.$invalid}" autocomplete="off" type="text" ng-pattern="/^[0-9]\\d*$/" ng-model="$ctrl.ajaxResponse.timeoutLimit"></div></div><div class="mt15"><p>延时执行下一个步骤（ms）</p><p class="eo-status-tips fs12 mt10">当前步骤执行完毕后，延迟一段时间再执行下一个步骤</p><p><input class="eo-input mt10" name="delayTime" ng-class="{\'eo-input-error\':$ctrl.data.submitted&&ConfirmForm.delayTime.$invalid}" autocomplete="off" type="text" ng-pattern="/^(([1-9]\\d{1,4})|(([1-9]))|(0)|(10000))$/" ng-model="$ctrl.ajaxResponse.delayTime" required=""></p></div></div></div></form></div>'),
t.put("module/ams/ui/automatic/inside/content/scene/testData/index.html",'<div><menu-common-component authority-object="$ctrl.service.authority.permission.automatic.sceneCase" main-object="$ctrl.component.topMenuObject"></menu-common-component><article class="td_wrap only_fixed_list_container" form-disable-common-directive="" dir-disable="$ctrl.service.authority.permission.automatic.sceneCase.edit==0"><menu-common-component authority-object="{edit:$ctrl.service.authority.permission.automatic.sceneCase.edit,canSave:$ctrl.data.canSave}" main-object="$ctrl.component.menuObject"></menu-common-component><tip-common-component input="{btnClose:1,value:\'EO_AUTOMATIC_DDT_TIPS_WARNING\',type:\'text\',status: \'success\',text:\'您可以创建多个测试数据集，每个数据集中可以包含多个变量值。您可以在测试步骤中使用数据集中定义好的变量，比如通过数据集为用户登录接口传递多组用户帐号和密码。您可以通过这种方式来使用一个测试用例执行多组测试数据，并且得到每组数据的测试报告。\'}"></tip-common-component><div class="eo-block-container mt10"><list-block-common-component active-object="$ctrl.data.batch" other-object="{}" authority-object="$ctrl.service.authority.permission.automatic.sceneCase" list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.listBlockComponent"></list-block-common-component></div></article></div><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/automatic/inside/content/timer/edit/index.html",'<div class="apimanagement-scss-automated-timer-edit"><menu-common-component authority-object="$ctrl.service.authority.permission.automatic.timedTask" main-object="$ctrl.component.menuObject.mainObject"></menu-common-component><article class="first_level_article" form-disable-common-directive="" dir-disable="$ctrl.service.authority.permission.automatic.timedTask.edit==0"><div class="first_part eo-tab-container"><ng-form autocomplete="off" name="editForm"><ul><li><ul><li class="pull-left first-select-li"><b>分组：</b></li><li class="pull-left"><select-multistage-common-component disabled="!$ctrl.service.authority.permission.automatic.timedTask.edit" output="$ctrl.component.selectMultistageCommonComponentObject" input="{query:$ctrl.data.timerGroup,key:\'groupName\',value:\'groupID\',groupID:$ctrl.ajaxResponse.taskInfo.groupID}"></select-multistage-common-component></li></ul></li><li><ul class="common-ul"><li class="pull-left first-select-li"><b>名称</b> <span class="eo-status-error">*</span></li><li class="common-li"><input autocomplete="off" class="eo-input" type="text" name="name" ng-model="$ctrl.ajaxResponse.taskInfo.taskName" ng-class="{\'eo-input-error\':($ctrl.data.submitted&&editForm.name.$invalid)}" maxlength="255" required=""><p class="eo-error-tips">请填写名称</p></li></ul></li><li><ul class="common-ul"><li class="pull-left first-select-li"><b>备注</b></li><li class="common-li"><input autocomplete="off" class="eo-input" type="text" name="remark" ng-model="$ctrl.ajaxResponse.taskInfo.taskRemark" maxlength="255"></li></ul></li></ul></ng-form></div><div class="item_part eo-tab-container"><div class="eo-tab-menu mt20"><div class="pull-left item-tab active-item">测试设置</div></div><div class="time-part p15"><p class="item_tp_haite"><label class="title-label">循环 <span class="eo-status-error">*</span></label><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.taskInfo" model-key="taskLoop" required="true" input="{query:$ctrl.data.loopList,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.taskInfo.taskLoop}"></select-default-common-component></p><p class="item_tp_haite"><label class="title-label">周期 <span class="eo-status-error">*</span></label><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.taskInfo" model-key="taskCycle" required="true" input="{query:$ctrl.data.cycleList,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.taskInfo.taskCycle}"></select-default-common-component></p><p class="item_tp_haite" ng-show="$ctrl.ajaxResponse.taskInfo.taskCycle==1" ng-class="{\'eo-status-error\':$ctrl.data.current.dateIllegal}"><label class="title-label">日期 <span class="eo-status-error">*</span></label> <span class="item-span" ng-repeat="item in $ctrl.data.dateList" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==0"><input autocomplete="off" class="hidden" type="checkbox" id="date-checkbox-{{$index}}-js" ng-model="item.checkbox" name="date-checkbox" ng-change="$ctrl.data.current.dateIllegal=false;"> <label for="date-checkbox-{{$index}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':item.checkbox}">{{item.checkbox?\'\':\'&nbsp;\'}}</label> <label for="date-checkbox-{{$index}}-js">{{item.key}}</label></span> <span class="item-span" ng-repeat="item in $ctrl.data.dateList" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==1"><input autocomplete="off" class="hidden" type="radio" id="date-radio-{{$index}}-js" ng-model="$ctrl.data.current.dateRadio" name="date-radio" ng-change="$ctrl.data.current.dateIllegal=false;" value="{{$index}}"> <label for="date-radio-{{$index}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':$ctrl.data.current.dateRadio==$index}">{{$ctrl.data.current.dateRadio==$index?\'\':\'&nbsp;\'}}</label> <label for="time-radio-{{$index}}-js">{{item.key}}</label></span></p><p class="item_tp_haite" ng-class="{\'eo-status-error\':$ctrl.data.current.timeIllegal}"><label class="title-label">时间 <span class="eo-status-error">*</span></label> <span class="item-span" ng-repeat="item in $ctrl.data.timeList.slice(0,12)" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==0"><input autocomplete="off" class="hidden" type="checkbox" id="time-checkbox-{{$index}}-js" ng-model="item.checkbox" name="time-checkbox" ng-change="$ctrl.data.current.timeIllegal=false;"> <label for="time-checkbox-{{$index}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':item.checkbox}">{{item.checkbox?\'\':\'&nbsp;\'}}</label> <label for="time-checkbox-{{$index}}-js">{{item.key}}</label></span> <span class="item-span" ng-repeat="item in $ctrl.data.timeList.slice(0,12)" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==1"><input autocomplete="off" class="hidden" type="radio" id="time-radio-{{$index}}-js" ng-model="$ctrl.data.current.timeRadio" name="time-radio" ng-change="$ctrl.data.current.timeIllegal=false;" value="{{$index}}"> <label for="time-radio-{{$index}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':$ctrl.data.current.timeRadio==$index}">{{$ctrl.data.current.timeRadio==$index?\'\':\'&nbsp;\'}}</label> <label for="time-radio-{{$index}}-js">{{item.key}}</label></span><br><span class="item-span" ng-repeat="item in $ctrl.data.timeList.slice(12)" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==0"><input autocomplete="off" class="hidden" type="checkbox" id="time-checkbox-{{$index+12}}-js" ng-model="item.checkbox" name="time-checkbox" ng-change="$ctrl.data.current.timeIllegal=false;"> <label for="time-checkbox-{{$index+12}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':item.checkbox}">{{item.checkbox?\'\':\'&nbsp;\'}}</label> <label for="time-checkbox-{{$index+12}}-js">{{item.key}}</label></span> <span class="item-span" ng-repeat="item in $ctrl.data.timeList.slice(12)" ng-show="$ctrl.ajaxResponse.taskInfo.taskLoop==1"><input autocomplete="off" class="hidden" type="radio" id="time-radio-{{$index+12}}-js" ng-model="$ctrl.data.current.timeRadio" name="time-radio" ng-change="$ctrl.data.current.timeIllegal=false;" value="{{$index+12}}"> <label for="time-radio-{{$index+12}}-js" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':$ctrl.data.current.timeRadio==($index+12)}">{{$ctrl.data.current.timeRadio==($index+12)?\'\':\'&nbsp;\'}}</label> <label for="time-radio-{{$index+12}}-js">{{item.key}}</label></span></p><div class="item_tp_haite"><label class="title-label">执行方式<span class="eo-status-error">*</span></label><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.taskInfo" model-key="executeWay" required="true" input="{query:$ctrl.data.executeWayList,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.taskInfo.executeWay}"></select-default-common-component></div><p class="item_tp_haite" ng-if="$ctrl.ajaxResponse.taskInfo.executeWay===1"><label class="title-label">用例间继承Cookies<span class="eo-status-error">*</span></label> <button class="f_row_ac" ng-click="$ctrl.ajaxResponse.taskInfo.cookieInheritStatus=!$ctrl.ajaxResponse.taskInfo.cookieInheritStatus"><span class="eo-checkbox iconfont mr10" ng-class="{\'icon-duihao\':$ctrl.ajaxResponse.taskInfo.cookieInheritStatus}">{{$ctrl.ajaxResponse.taskInfo.cookieInheritStatus?"":"&nbsp;"}}</span> <span>是</span></button></p></div></div><div class="item_part eo-tab-container response-param-part"><div class="eo-tab-menu mt20"><div class="pull-left item-tab active-item">用例列表</div></div><div><header class="plr15 ptb10"><button class="eo_theme_btn_success change-type-btn send-format" ng-click="$ctrl.fun.importCase()" ng-disabled="!$ctrl.service.authority.permission.automatic.timedTask.edit"><span class="iconfont icon-jiahao"></span>添加用例</button></header><list-block-common-component list="$ctrl.ajaxResponse.taskInfo.caseList" main-object="$ctrl.component.blockListObject.case" authority-object="$ctrl.service.authority.permission.automatic.timedTask"></list-block-common-component><div class="eo-none-tr tac" ng-hide="$ctrl.ajaxResponse.taskInfo.caseList.length>0">暂未添加任何用例</div></div></div><div class="item_part eo-tab-container"><div class="eo-tab-menu mt20"><div class="pull-left item-tab active-item">环境设置</div></div><div class="env-part"><div><p class="select-p"><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.taskInfo" main-object="$ctrl.component.envSelectObj" model-key="envID" required="true" input="{query:$ctrl.ajaxResponse.envList,key:\'envName\',value:\'envID\',initialData:$ctrl.ajaxResponse.taskInfo.envID}" input-change-fun="$ctrl.fun.changeEnv()"></select-default-common-component></p><div class="env-form-div" ng-if="$ctrl.ajaxResponse.taskInfo.envID<0"><p class="second-title-p">前置URI</p><p class="name-form"><input autocomplete="off" name="name" ng-model="$ctrl.ajaxResponse.taskInfo.taskEnv.frontURI" class="eo-input" type="text" placeholder="前置URI"></p><p class="second-title-p">鉴权信息</p><div class="auth-div"><auth-ams-component auth-object="$ctrl.ajaxResponse.taskInfo.taskEnv.envAuth"></auth-ams-component></div><p class="second-title-p">请求头部</p><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.taskInfo.taskEnv.headerList" main-object="$ctrl.component.blockListObject.header.mainObject" authority-object="$ctrl.service.authority.permission.automatic.timedTask"></list-block-common-component></div><p class="second-title-p">额外参数</p><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.taskInfo.taskEnv.additionalParamList" main-object="$ctrl.component.blockListObject.extraParam.mainObject" authority-object="$ctrl.service.authority.permission.automatic.timedTask"></list-block-common-component></div><p class="second-title-p">全局变量</p><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.taskInfo.taskEnv.paramList" main-object="$ctrl.component.blockListObject.globalParam.mainObject" authority-object="$ctrl.service.authority.permission.automatic.timedTask"></list-block-common-component></div></div></div></div></div><div class="item_part eo-tab-container"><div class="eo-tab-menu mt10" ng-if="$ctrl.ajaxResponse.taskInfo.taskStatus"><div class="pull-left item-tab active-item">通知设置</div></div><div ng-if="$ctrl.ajaxResponse.taskInfo.taskStatus" class="notify-part"><div><p class="select-p"><select-default-common-component class="w_250" output="$ctrl.ajaxResponse.taskInfo" model-key="noticeSetting" required="true" input="{query:$ctrl.data.noticeList,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.taskInfo.noticeSetting}"></select-default-common-component></p><div class="mt10 eo-block-container"><list-block-common-component list="$ctrl.data.userEmail" main-object="$ctrl.component.blockListObject.emial.mainObject" authority-object="$ctrl.service.authority.permission.automatic.timedTask" other-object="{submitted:$ctrl.data.submitted}"></list-block-common-component></div></div></div></div></article></div><loading-common-component fun="$ctrl.fun.load(arg)" interaction="{request:{delay:true}}"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/account/default/index.html",'<div class="common_setting_form_list" ng-switch="$ctrl.data.menuType"><h1 class="csl_title"><span class="title_icon iconfont icon-quanjushezhi"></span> <span>项目设置</span></h1><multi-tab-component class="mt20" list="$ctrl.multiTabComponent.list" model="$ctrl.data.menuType"></multi-tab-component><article class="eo-tab-container csl_list_container" ng-show="$ctrl.data.menuType===0"><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">基本信息</h2><p class="secondary_title">修改项目名称、类型、版本号等。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu" name="BasicForm"><div class="form_item"><label class="form_label" for="projectName">项目名称</label> <input autocomplete="off" class="eo-input" type="text" placeholder="项目名称" maxlength="255" ng-model="$ctrl.ajaxData.projectInfo.projectName" ng-disabled="!$ctrl.service.authority.projectGroupPermission.project.editProject" required=""></div><div class="form_item"><label class="form_label" for="projectVersion">版本号</label> <input autocomplete="off" name="projectVersion" class="eo-input" type="text" placeholder="版本号" maxlength="20" ng-model="$ctrl.ajaxData.projectInfo.projectVersion" ng-disabled="!$ctrl.service.authority.projectGroupPermission.project.editProject" ng-pattern="/^[0-9.]{1,20}$/" ng-class="{\'eo-input-error\':(BasicForm.projectVersion.$dirty&&BasicForm.projectVersion.$invalid)}" required=""><p class="eo-error-tips">请填写正确的版本号</p></div><div class="form_item"><label class="form_label" for="projectVersion">项目类型</label><select-default-common-component class="w_250" output="$ctrl.ajaxData.projectInfo" model-key="projectType" required="true" input="{query:$ctrl.CONST.PROJECT_TYPE_QUERY,key:\'key\',value:\'value\',initialData:$ctrl.ajaxData.projectInfo.projectType}"></select-default-common-component></div><button class="eo_theme_btn_success form_btn_submit" button-set-disable-directive="$ctrl.fun.confirm()" ng-disabled="BasicForm.$invalid" ng-if="$ctrl.service.authority.projectGroupPermission.project.editProject">保存</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">归档项目</h2><p class="secondary_title">当项目已经停止维护时，您可以将项目设置为归档状态。已归档的项目不允许编辑，如需编辑项目内容需要先取消归档。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu"><button class="eo_theme_btn_info form_btn_submit" ng-click="$ctrl.fun.file()">{{$ctrl.ajaxData.projectInfo.isArchive===0?"归档项目":"取消归档"}}</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">复制项目</h2><p class="secondary_title">复制项目会创建一个一模一样的项目，包括相同的项目数据、人员权限等。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu"><button class="eo_theme_btn_success form_btn_submit" ng-click="$ctrl.fun.copyProject()">复制</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">删除项目</h2></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu"><button class="eo_theme_btn_danger form_btn_submit" ng-click="$ctrl.fun.delete()">删除项目</button></form></div></article><article class="eo-tab-container csl_list_container" ng-switch-when="1"><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">API 查重</h2><p class="secondary_title">设置 API 查重规则，防止创建相同的 API。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu common_content"><div class="form_item"><select-switch-common-component setting-object="{type:\'text\',text:\'不允许创建相同URL及请求方式的API\',class:\'plr20\'}" switch-model="$ctrl.ajaxData.duplicateCheckSetting.apiURIDuplicateCheck" fun-object="{fun:$ctrl.fun.switchStatus,params:{key:\'apiURIDuplicateCheck\',type:\'duplicateCheckSetting\'}}"></select-switch-common-component></div><div class="form_item"><select-switch-common-component setting-object="{type:\'text\',text:\'不允许创建相同名称的API\',class:\'plr20\'}" switch-model="$ctrl.ajaxData.duplicateCheckSetting.apiNameDuplicateCheck" fun-object="{fun:$ctrl.fun.switchStatus,params:{key:\'apiNameDuplicateCheck\',type:\'duplicateCheckSetting\'}}"></select-switch-common-component></div><button class="eo_theme_btn_success form_btn_submit" type="submit" ng-click="$ctrl.fun.saveSwitchSetting(\'api\')">保存</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">状态码查重</h2><p class="secondary_title">设置状态码查重规则，防止创建相同的状态码。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu common_content"><div class="form_item"><select-switch-common-component setting-object="{type:\'text\',text:\'不允许创建相同的状态码\',class:\'plr20\'}" switch-model="$ctrl.ajaxData.duplicateCheckSetting.statusCodeDuplicateCheck" fun-object="{fun:$ctrl.fun.switchStatus,params:{key:\'statusCodeDuplicateCheck\',type:\'duplicateCheckSetting\'}}"></select-switch-common-component></div><button class="eo_theme_btn_success form_btn_submit" type="submit" ng-click="$ctrl.fun.saveSwitchSetting(\'statusCode\')">保存</button></form></div></article><article class="eo-tab-container csl_list_container" ng-switch-when="2"><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">校验请求内容</h2><p class="secondary_title">设置 Mock API 的请求校验规则，只有当符合校验规则时才会返回相应的结果。</p></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu common_content"><div class="form_item" ng-repeat="item in $ctrl.CONST.MOCK_SETTING"><select-switch-common-component setting-object="{type:\'text\',text:item.name,class:\'plr20\'}" switch-model="$ctrl.ajaxData.mockApiSetting[item.key]" fun-object="{fun:$ctrl.fun.switchStatus,params:{key:item.key,type:\'mockApiSetting\'}}"></select-switch-common-component></div><button class="eo_theme_btn_success form_btn_submit" type="submit" ng-click="$ctrl.fun.saveSwitchSetting(\'mock\')">保存</button></form></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">设置 Mock JS</h2></div><span class="di_switch_icon iconfont"></span></div><form class="di_collapse_container csl_item_sub_menu common_content"><div class="form_item"><select-switch-common-component setting-object="{type:\'text\',text:\'每次请求都根据Mock规则返回随机数据\',class:\'plr20\'}" switch-model="$ctrl.ajaxData.mockApiSetting.mockAutoRefresh" fun-object="{fun:$ctrl.fun.switchStatus,params:{key:\'mockAutoRefresh\',type:\'mockApiSetting\'}}"></select-switch-common-component></div><button class="eo_theme_btn_success form_btn_submit" type="submit" ng-click="$ctrl.fun.saveSwitchSetting(\'mock\')">保存</button></form></div></article><article class="eo-tab-container csl_list_container" ng-switch-when="3"><div class="csl_item" collapse-common="" will-change-size="true"><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">API 变更通知</h2><p class="secondary_title">当 API 发生变化时，通过站内信及邮件通知相关人员。该选项对当前项目内所有 API 生效。</p></div><span class="di_switch_icon iconfont"></span></div><div class="di_collapse_container csl_item_sub_menu"><notice-member-ams-component main-object="$ctrl.component.noticeMemberApiObj" authority-object="{isGlobal:1,edit:$ctrl.service.authority.permission.project.apiManagement.edit}"></notice-member-ams-component><div class="form_pb"></div></div></div><div class="csl_item" collapse-common=""><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">API 负责人自动收到 API 文档变更通知</h2><p class="secondary_title">当API发生变化时（状态、内容改变时），API 负责人会自动收到站内信或邮件通知。</p></div><span class="di_switch_icon iconfont"></span></div><div class="di_collapse_container csl_item_sub_menu"><div class="form_item"><select-switch-common-component setting-object="{type:\'text\',text:\'发送 站内信/邮件 通知相关 API 负责人\',class:\'plr20\'}" switch-model="$ctrl.ajaxData.noticeApiManagerSetting"></select-switch-common-component></div><button class="eo_theme_btn_success form_btn_submit" type="submit" ng-click="$ctrl.fun.saveSwitchSetting(\'noticeSetting\')">保存</button></div></div><div class="csl_item" collapse-common="" will-change-size="true"><div class="di_collapse_handle csl_item_handle f_row f_ac"><div class="label_wrapper fg1"><h2 class="setting_title">项目文档变更通知</h2><p class="secondary_title">当项目文档发生变化时，通过站内信及邮件通知相关人员。该选项对当前项目内所有项目文档生效。</p></div><span class="di_switch_icon iconfont"></span></div><div class="di_collapse_container csl_item_sub_menu"><notice-member-ams-component main-object="$ctrl.component.noticeMemberDocObj" authority-object="{isGlobal:1,edit:$ctrl.service.authority.permission.project.projectPage.edit}"></notice-member-ams-component><div class="form_pb"></div></div></div></article></div><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/account/log/index.html",'<div class="apimanagement-scss-account-log"><menu-common-component authority-object="{month:$ctrl.service.authority.productUsingPermission.apiManagement.log>=30,quarter:$ctrl.service.authority.productUsingPermission.apiManagement.log==180}" main-object="$ctrl.component.menuObject.mainObject" active-object="$ctrl.interaction.request" other-object="{datePicker:{object:$ctrl.interaction.datePickerObject,fun:$ctrl.fun.search}}"></menu-common-component><list-page-common-component main-object="$ctrl.component.listPageCommonObject.mainObject" list="$ctrl.interaction.response.query" page-object="{pageInfo:$ctrl.data.pagination}"></list-page-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div>'),t.put("module/ams/ui/project/inside/content/case/partA/index.html",'<group-default-common-component authority-object="{edit:0}" fun-object="$ctrl.component.groupCommonObject.funObject" request-object="$ctrl.component.groupCommonObject.requestObject" main-object="$ctrl.component.groupCommonObject.mainObject"></group-default-common-component><div on-resize-directive="" change-fun="$ctrl.fun.onResize()" class="apimanagement_scss_api_list list_div_beside_group"><menu-common-component authority-object="{edit:0,showTitle:1,showBatch:0}" main-object="$ctrl.component.menuObject" other-object="{batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length}" block-list-object="$ctrl.data.filterObject"></menu-common-component><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.project.apiManagement.edit}" main-object="$ctrl.component.listDefaultCommonObject" list="$ctrl.ajaxResponse.query" show-object="{columnFilterObject:$ctrl.data.filterObject.indexAddress}" other-object="{batch:$ctrl.data.batch,batchMenu:{isOperating:false},loadStorageQuery:$ctrl.data.loadStorageQuery}" page-object="{pageInfo:$ctrl.data.pagination,changeFun:$ctrl.fun.changePage}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div>'),t.put("module/ams/ui/project/inside/content/case/partB/index.html",'<batch-test-ams-component status-object="$ctrl.data" output="$ctrl.data.testHistory" status="apiGlobalCase" env="$ctrl.service.home.envObject.object.total" ng-if="$ctrl.data.plugObject.useStatus&&$ctrl.service.authority.permission.project.apiManagement.test&&$ctrl.data.testSeverType!==\'nodejs\'"></batch-test-ams-component><div class="text_mask_hpicpb" ng-if="$ctrl.data.isOperate||$ctrl.data.isTesting"><div class="text_hpicpb"><span ng-if="$ctrl.data.isTesting">测试中...</span><div class="f_row f_ac" ng-if="$ctrl.data.isOperate&&!$ctrl.data.isTesting"><span>API列表有更新，</span><div><button type="button" class="eo-operate-btn" ng-click="$ctrl.fun.refreshPartA()">点击更新列表信息</button></div></div></div></div><fieldset class="b_none" ng-disabled="$ctrl.data.ajaxQueryNum>0"><div class="conatiner_hpicpb" id="case_test_btn" check-plug-directive="" input="$ctrl.data.plugObject"><div class="shrink_hpicpb cp" ng-click="$ctrl.fun.spreedConsole(true)" ng-hide="$ctrl.data.isSpreedConsole"><b class="fs18">测试控制台</b> <span class="iconfont icon-xuanzeqishouqi fs16"></span></div><div class="spreed_hpicpb" ng-class="{\'h_54 po_ab vis_hid\':!$ctrl.data.isSpreedConsole,\'transition_hpicpb\':$ctrl.data.isSpreedConsole}"><div class="drag_bar_hpicpb tac" drag-change-spacing-common-directive="" affect-class="spreed_hpicpb" main-object="$ctrl.component.dragChangeHeightCommonDirectiveObj"><b class="iconfont icon-iosgengduo fs16"></b></div><button type="button" class="iconfont icon-guanbi fs18 shrink_btn_hpicpb" ng-click="$ctrl.fun.spreedConsole(false)"></button><div class="list_conatiner_hpicpb" ng-show="$ctrl.ajaxResponse.query.length||$ctrl.data.ajaxQueryNum>0"><div class="f_row p10 group_btn_hpicpb" ng-show="$ctrl.ajaxResponse.query.length" ng-switch="$ctrl.data.plugObject.validToSwitchTestMethod||$ctrl.data.plugTransferToLocal"><div class="eo_more_btn_container" ng-switch-when="true"><button class="common-btn" id="case_btn_test" eo-attr-test-type="{{$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus?\'plug\':\'server\'}}" ng-class="{\'eo_theme_btn_success\':$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,\'eo_theme_btn_info\':($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)}" ng-click="$ctrl.fun.test(\'all\')" testing="{{$ctrl.data.isTesting||false}}" ng-disabled="(!$ctrl.service.authority.permission.project.apiManagement.test)||$ctrl.service.authority.product.ams === \'free\'||($ctrl.data.isTesting&&$ctrl.data.testMethod!==\'all\')||$ctrl.data.selectCaseNum===0"><span class="iconfont icon-shanguangdeng"></span> <span>{{$ctrl.data.isTesting&&$ctrl.data.testMethod===\'all\'?\'中止\':\'测试\'}}</span></button> <button class="more-btn w_40" eo-drop-elem="" text-arr="[{key:\'切换使用{{$ctrl.otherObj.testServer}}测试\',value:\'changeServerType\'}]" fn-click="$ctrl.fun.changeTestSeverType()" other-obj=\'{testServer:($ctrl.data.testSeverType=="nodejs"||!$ctrl.data.plugObject.useStatus)?($ctrl.data.plugTransferToLocal?"本地":"插件"):"服务器"}\' ng-disabled="(!$ctrl.service.authority.permission.project.apiManagement.test)||$ctrl.service.authority.product.ams === \'free\'||($ctrl.data.isTesting&&$ctrl.data.testMethod!==\'all\')||$ctrl.data.selectCaseNum===0" ng-class="{\'eo_theme_btn_success\':$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,\'eo_theme_btn_info\':($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)}"><span class="iconfont icon-xiajiantou fs12"></span></button></div><div ng-switch-when="false"><button class="common-btn" id="case_btn_test" eo-attr-test-type="{{$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus?\'plug\':\'server\'}}" ng-class="{\'eo_theme_btn_success\':$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,\'eo_theme_btn_info\':($ctrl.data.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)}" ng-click="$ctrl.fun.test(\'all\')" testing="{{$ctrl.data.isTesting||false}}" ng-disabled="(!$ctrl.service.authority.permission.project.apiManagement.test)||$ctrl.service.authority.product.ams === \'free\'||($ctrl.data.isTesting&&$ctrl.data.testMethod!==\'all\')||$ctrl.data.selectCaseNum===0"><span class="iconfont icon-shanguangdeng"></span> <span>{{$ctrl.data.isTesting&&$ctrl.data.testMethod===\'all\'?\'中止\':\'测试\'}}</span></button></div><env-ams-component class="plr10" mark="project" env-model="$ctrl.service.home.envObject.object.model" env-param="$ctrl.service.home.envObject.object.param" total-env="$ctrl.service.home.envObject.object.total" authority-object="$ctrl.service.authority.permission.project.environment" ng-init="$ctrl.fun.initEnv()"></env-ams-component><button type="button" class="eo_theme_btn_default mr10" ng-click="$ctrl.fun.clearApi()" ng-disabled="$ctrl.data.isTesting">清空测试列表</button></div><div class="list_hpicpb"><div class="item_hpicpb" ng-repeat="apiItem in $ctrl.ajaxResponse.query"><div class="plr10 item_title_hpicpb f_row f_ac"><b class="mr20 text_omit">{{apiItem.apiName}}</b><div><button class="eo-operate-btn mw_55" type="button" ng-disabled="$ctrl.data.isTesting" ng-click="$ctrl.fun.newTestCase($index,apiItem.apiID)" ng-if="$ctrl.service.authority.permission.project.apiManagement.editApiCase">新建用例</button></div><span class="pr10 c999" ng-if="$ctrl.service.authority.permission.project.apiManagement.editApiCase">|</span><div><button class="eo-operate-btn mw_110" type="button" ng-disabled="$ctrl.data.isTesting" ng-click="$ctrl.fun.removeApi($index,apiItem.apiID)">从测试列表中移除</button></div></div><list-block-common-component list="apiItem.caseList" active-object="apiItem.selectObj" other-object="{currentTestingApiID:$ctrl.data.currentTestingApiID,testHistoryObj:$ctrl.data.testHistory[apiItem.apiID],allIsTesting:$ctrl.data.isTesting,apiID:apiItem.apiID,apiIndex:$index,testMethod:$ctrl.data.testMethod}" main-object="$ctrl.component.blockListObject.case" authority-object="{\'showOperateColumn\':($ctrl.service.authority.permission.project.apiManagement.editApiCase||$ctrl.service.authority.permission.project.apiManagement.test)&&$ctrl.service.authority.product.ams !== \'free\',editApiCase:$ctrl.service.authority.permission.project.apiManagement.editApiCase,test:$ctrl.service.authority.permission.project.apiManagement.test,amt:$ctrl.service.authority.spacePermission.amt.look&&$ctrl.service.authority.permission.project.apiManagement.editApiCase}"></list-block-common-component><table class="none_table_hpicpb" ng-if="apiItem.caseList.length===0"><tr><td class="checkbox_placeholder_hpicpb"></td><td class="c999 plr5">{{$ctrl.CONST.NONE_TIP_Obj[$ctrl.data.tabSelectObj.selectItem.value]}}</td><td class="w_200 plr5">-</td><td class="w_200 plr5">-</td><td class="w_200 plr5">-</td><td class="w_250 plr5"></td></tr></table></div><div class="loading_container_hpicpd" ng-if="$ctrl.data.ajaxQueryNum>0"><div class="loading_hpicpd"><div><span class="iconfont icon-jiazai_shuaxin"></span></div><span>正在载入</span></div></div></div></div><div class="eo-none-tr tac" ng-show="$ctrl.ajaxResponse.query.length===0&&$ctrl.data.ajaxQueryNum==0">请先选择需要测试的API</div></div></div></fieldset><div class="mask_hpicpb" ng-if="$ctrl.data.isOperate||$ctrl.data.isTesting"></div>'),t.put("module/ams/ui/project/inside/content/case/partB/index.tmp.html",'<div class="tested-div" ng-class="{\'testing-div\':($ctrl.otherObject.testHistoryObj[item.caseID].testing||($ctrl.otherObject.allIsTesting&&$ctrl.otherObject.testMethod===\'all\'))&&$ctrl.otherObject.apiID===$ctrl.otherObject.currentTestingApiID}" ng-switch="$ctrl.otherObject.testHistoryObj[item.caseID].responseType"><button class="eo-status-success" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'success\',{apiID:$ctrl.otherObject.apiID,caseID:item.caseID})" ng-switch-when="success" ng-init="$ctrl.mainObject.baseFun.getTime(item)">通过，查看详情</button> <button class="eo-status-error" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'error\',{apiID:$ctrl.otherObject.apiID,caseID:item.caseID})" ng-switch-when="error|timeout|matchError|terminateRequest|codeError" ng-switch-when-separator="|" ng-init="$ctrl.mainObject.baseFun.getTime(item)">未通过，查看详情</button><div ng-switch-when="testing"><span class="iconfont icon-jiazai_shuaxin"></span> <span>{{($ctrl.otherObject.apiID===$ctrl.otherObject.currentTestingApiID?"测试中":"排队中...")}}</span></div><div ng-switch-default=""><span>尚无测试结果</span></div></div>'),
t.put("module/ams/ui/project/inside/content/doc/detail/index.html",'<div class="apimanagement-scss-doc-detail"><menu-common-component authority-object="$ctrl.service.authority.permission.project.projectPage" main-object="$ctrl.component.menuObject.mainObject"></menu-common-component><article class="first_level_article"><div class="first_part plr40 pt30"><ul><li class="dp_ib w_100percent"><div class="doc-theme pull-left">{{$ctrl.ajaxResponse.pageInfo.title}}</div><div class="f_row more-btn-group-div pull-right"><button ng-if="$ctrl.service.authority.permission.project.projectPage.edit" class="common-fun" ui-sref="home.ams.project.inside.doc.edit({status:\'edit\',pageID:$ctrl.ajaxRequest.pageID,groupID:$ctrl.ajaxRequest.groupID})"><span class="iconfont icon-bianji mr5 pull-left"></span><span>编辑</span></button> <button class="common-fun" ng-click="$ctrl.fun.showModal(\'notice\')"><div class="f_row"><span class="iconfont icon-tongzhizhongxin mr5"></span> <span>变更通知</span><tip-directive input="<p>当API改变时通知相关成员</p>"></tip-directive></div></button> <button ng-if="$ctrl.service.authority.permission.project.projectPage.versionManagement" class="common-fun" ng-click="$ctrl.fun.showModal(\'log\')"><span class="iconfont icon-lishijilu mr5 pull-left"></span><span>版本管理</span></button></div></li><li class="detail-container"><ul><li class="others-li"><span class="group-span">分组:&nbsp;{{$ctrl.ajaxResponse.pageInfo.groupPath}}</span> <span class="update-span">更新时间：{{$ctrl.ajaxResponse.pageInfo.updateTime}}</span></li></ul></li></ul></div><article class="plr40" ng-class="{\'wangEditor-container\':$ctrl.ajaxResponse.pageInfo.contentType==\'0\'}"><div ng-class="{\'markdown-body editormd-preview-container\':$ctrl.ajaxResponse.pageInfo.contentType==\'1\',\'wangEditor-txt\':$ctrl.ajaxResponse.pageInfo.contentType==\'0\'}" inner-html-common-directive="" html="$ctrl.ajaxResponse.pageInfo.docNoteHtml" default-html="<div class=\'c999\'>内容为空</div>" remove="true" status="unbind-angular"></div><package-admin-component class="mt20 pt20 bte" ng-if="$ctrl.ajaxResponse.pageInfo.fileList.length" list="$ctrl.ajaxResponse.pageInfo.fileList"></package-admin-component></article></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><div class="float-container" ng-class="{\'eo_to_right_750\':!$ctrl.data.modal,\'eo_to_right_0\':$ctrl.data.modal}"><div ng-if="$ctrl.data.modal"><div class="p20 ptb15 bbd"><span class="fwb fs18">{{$ctrl.data.modal=="notice"?"变更通知":"版本管理"}}</span> <button class="eo_theme_btn_default plr15 pull-right" ng-click="$ctrl.fun.closeModal()">关闭</button><br clear="both"></div><div class="p20 mb50"><notice-member-ams-component main-object="$ctrl.component.noticeMemberObj" authority-object="{edit:$ctrl.service.authority.permission.project.projectPage.edit,isGlobal:0}" ng-if=\'$ctrl.data.modal=="notice"\'></notice-member-ams-component><home-project-inside-doc-history ng-if=\'$ctrl.data.modal=="log"\'></home-project-inside-doc-history></div></div></div><div class="mask-asad"></div>'),t.put("module/ams/ui/project/inside/content/doc/edit/index.html",'<menu-common-component main-object="$ctrl.component.menuObject.mainObject" authority-object="{isPay:$ctrl.service.authority.product.ams!==\'free\'}" active-object="$ctrl.data"></menu-common-component><article class="first_level_article eo_theme_iblock"><ng-form class="dp_b pb20 bbd" autocomplete="off" name="ConfirmForm"><p class="fwb mb10">标题</p><div><input autocomplete="off" class="eo-input w_100percent" type="text" name="title" ng-model="$ctrl.ajaxResponse.docInfo.title" ng-class="{\'eo-input-error\':($ctrl.data.submitted&&ConfirmForm.title.$invalid)}" maxlength="255" required=""><p class="eo-error-tips">请填写标题</p></div><p class="fwb mt20 mb10">分组</p><div><select-multistage-common-component output="$ctrl.component.selectMultistageCommonComponentObject" input="{query:$ctrl.data.docGroup,key:\'groupName\',value:\'groupID\',groupID:$ctrl.ajaxResponse.docInfo.groupID}"></select-multistage-common-component></div></ng-form><div class="po_re"><package-admin-component class="mt5" list="$ctrl.ajaxResponse.docInfo.fileList" main-object="$ctrl.component.packageAdminObj" expose-object="$ctrl.component.packageAdminExposeObj"></package-admin-component><select-default-common-component class="mt20 po_ab eo_to_right_0 eo_to_top_0 w_200 z_index4" output="$ctrl.ajaxResponse.docInfo" model-key="contentType" required="true" input="{query:$ctrl.CONST.noteTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.docInfo.contentType}"></select-default-common-component></div><div class="remark-part"><article ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.docInfo.contentType!=1}"><markdown-editor-ams-component result-html="$ctrl.ajaxResponse.docInfo.docMarkdownNote" id="editormd-js" origin="$ctrl.ajaxResponse.docInfo.contentRaw"></markdown-editor-ams-component></article><article ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.docInfo.contentType==1}"><rich-editor-ams-component result-html="$ctrl.ajaxResponse.docInfo.docRichNote"></rich-editor-ams-component></article></div></article><loading-common-component fun="$ctrl.fun.load(arg)" interaction="{request:{delay:true}}"></loading-common-component><div oc-lazy-load="$ctrl.CONST.lazyload"></div>'),t.put("module/ams/ui/project/inside/content/doc/history/index.html",'<div class="eo-block-container"><list-block-common-component authority-object="$ctrl.service.authority.permission.project.projectPage" list="$ctrl.interaction.response.query" main-object="$ctrl.component.blockListObject.query.mainObject" page-object="$ctrl.data.pagination"></list-block-common-component><loading-part-common-component fun="$ctrl.fun.init()"></loading-part-common-component><div class="eo-none-tr tac" ng-if="$ctrl.interaction.response.query.length==0">暂未存在任何历史记录</div></div>'),t.put("module/ams/ui/project/inside/content/doc/list/index.html",'<menu-common-component authority-object="{edit:$ctrl.service.authority.permission.project.projectPage.edit}" main-object="$ctrl.component.menuObject" other-object="{batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length}"></menu-common-component><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.project.projectPage.edit}" main-object="$ctrl.component.listDefaultCommonObject" list="$ctrl.ajaxResponse.query" other-object="{batch:$ctrl.data.batch,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/iterationPlan/partA/index.html",'<div class="f_row" bind-class="sort-container-gdcc" repaint-scroll-top-common-directive="" count="$ctrl.component.ganttObject.wheelDelta" min="0" l-height="1"><div dom-common-directive="" operate="scroll" bind-class="sort-container-gdcc" bind-fun="$ctrl.fun.groupScroll(arg)"><group-default-common-component authority-object="{edit:$ctrl.service.authority.permission.project.iterationPlan.edit}" list="$ctrl.ajaxResponse.groupQuery" request-object="$ctrl.component.groupCommonObject.requestObject" fun-object="$ctrl.component.groupCommonObject.funObject" main-object="$ctrl.component.groupCommonObject.mainObject"></group-default-common-component></div></div><div class="list_div_beside_group chart-container"><div class="divide-div"></div><gantt-echart-common-component list="$ctrl.ajaxResponse.groupQuery" main-object="$ctrl.component.ganttObject"></gantt-echart-common-component></div><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/iterationPlan/partB/index.html",'<div class="text_mask_hpicpb" ng-if="$ctrl.data.isOperate"><div class="text_hpicpb" ng-if="$ctrl.data.isOperate"><button type="button" class="eo-operate-btn" ng-click="$ctrl.fun.refreshPartA()">迭代计划图表有更新，点击更新图表信息</button></div></div><fieldset class="b_none" ng-disabled="$ctrl.data.ajaxQueryNum>0"><div class="conatiner_hpicpb"><div class="shrink_hpicpb cp" ng-click="$ctrl.fun.spreedConsole(true)" ng-hide="$ctrl.data.isSpreedConsole"><b class="fs18">控制台</b> <span class="iconfont icon-xuanzeqishouqi fs16"></span></div><div class="spreed_hpicpb" ng-class="{\'h_54 po_ab vis_hid\':!$ctrl.data.isSpreedConsole,\'transition_hpicpb\':$ctrl.data.isSpreedConsole}"><div class="drag_bar_hpicpb tac" drag-change-spacing-common-directive="" affect-class="spreed_hpicpb" main-object="$ctrl.component.dragChangeHeightCommonDirectiveObj"><b class="iconfont icon-iosgengduo fs16"></b></div><div class="spreed_hpicpb_header f_row_ac f_js"><b>{{$ctrl.data.planTitle}}</b> <button type="button" class="iconfont icon-guanbi fs18 shrink_btn_hpicpb" ng-click="$ctrl.fun.spreedConsole(false)"></button></div><div class="spreed_hpicpb_container" ng-if="$ctrl.data.planTitle"><menu-common-component authority-object="{edit:$ctrl.service.authority.permission.project.iterationPlan.edit}" active-object="$ctrl.component.menuObject.active" main-object="$ctrl.component.menuObject.mainObject" other-object="{batch:$ctrl.data.batch, isBatchDisabled:!$ctrl.ajaxResponse.query.length}" block-list-object="$ctrl.data.filterObject"></menu-common-component><div class="apimanagement_scss_api_list" ng-show="$ctrl.ajaxResponse.query"><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.project.iterationPlan.edit}" main-object="$ctrl.component.listDefaultCommonObject" list="$ctrl.ajaxResponse.query" show-object="{columnFilterObject:$ctrl.data.filterObject.indexAddress}" other-object="{batch:$ctrl.data.batch,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component></div><div class="loading_container_hpicpd" ng-show="!$ctrl.ajaxResponse.query"><div class="loading_hpicpd"><div><span class="iconfont icon-jiazai_shuaxin"></span></div><span>正在载入</span></div></div></div><div class="eo-none-tr tac" ng-if="!$ctrl.data.planTitle">请先选择迭代计划</div></div></div></fieldset><div class="mask_hpicpb" ng-if="$ctrl.data.isOperate"></div>'),t.put("module/ams/ui/project/inside/content/iterationPlan/partB/index.tmp.html",'<div class="tested-div" ng-class="{\'testing-div\':($ctrl.otherObject.testHistoryObj[item.caseID].testing||($ctrl.otherObject.allIsTesting&&$ctrl.otherObject.testMethod===\'all\'))&&$ctrl.otherObject.apiID===$ctrl.otherObject.currentTestingApiID}" ng-switch="$ctrl.otherObject.testHistoryObj[item.caseID].responseType"><button class="eo-status-success" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'success\',{apiID:$ctrl.otherObject.apiID,caseID:item.caseID})" ng-switch-when="success" ng-init="$ctrl.mainObject.baseFun.getTime(item)">通过，查看详情</button> <button class="eo-status-error" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'error\',{apiID:$ctrl.otherObject.apiID,caseID:item.caseID})" ng-switch-when="error|timeout|matchError|terminateRequest|codeError" ng-switch-when-separator="|" ng-init="$ctrl.mainObject.baseFun.getTime(item)">未通过，查看详情</button><div ng-switch-when="testing"><span class="iconfont icon-jiazai_shuaxin"></span> <span>{{($ctrl.otherObject.apiID===$ctrl.otherObject.currentTestingApiID?"测试中":"排队中...")}}</span></div><div ng-switch-default=""><span>尚无测试结果</span></div></div>'),t.put("module/ams/ui/project/inside/content/api/case/index.html",'<batch-test-ams-component status-object="$ctrl.testStatusObj" output="$ctrl.data.testHistory" status="apiCase" env="$ctrl.service.home.envObject.object.total" ng-if="$ctrl.data.plugObject.useStatus&&$ctrl.service.authority.permission.project.apiManagement.test&&$ctrl.data.testSeverType!==\'nodejs\'"></batch-test-ams-component><div check-plug-directive="" input="$ctrl.data.plugObject"><menu-common-component authority-object="$ctrl.service.authority.permission.project.apiManagement" main-object="$ctrl.component.menuObject.mainObject"></menu-common-component><article class="container_hpiac"><menu-common-component authority-object="{edit:$ctrl.service.authority.permission.project.apiManagement.editApiCase}" main-object="$ctrl.component.listMenuObject" show-object="{batch:$ctrl.data.batch}" other-object="{validToSwitchTestMethod:$ctrl.data.plugObject.validToSwitchTestMethod,testMethod:$ctrl.data.testMethod,plugTransferToLocal:$ctrl.data.plugTransferToLocal,testMethodIsPlugin:$ctrl.data.testSeverType!==\'nodejs\'&&$ctrl.data.plugObject.useStatus,batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.ajaxResponse.query.length,allIsTesting:$ctrl.testStatusObj.isTesting,disabledTest:(!$ctrl.service.authority.permission.project.apiManagement.test)||$ctrl.service.authority.product.ams === \'free\'||($ctrl.testStatusObj.isTesting&&$ctrl.data.testMethod!==\'all\')}"></menu-common-component><div class="item_part eo-tab-container case-part"><list-block-common-component list="$ctrl.ajaxResponse.query" active-object="$ctrl.data.batch" other-object="{nowIsBatchOperate:$ctrl.data.batch.isOperating,testHistoryObj:$ctrl.data.testHistory,allIsTesting:$ctrl.testStatusObj.isTesting,testMethod:$ctrl.data.testMethod}" main-object="$ctrl.component.blockListObject.testList" authority-object="{\'showOperateColumn\':($ctrl.service.authority.permission.project.apiManagement.editApiCase||$ctrl.service.authority.permission.project.apiManagement.test)&&$ctrl.service.authority.product.ams !== \'free\',editApiCase:$ctrl.service.authority.permission.project.apiManagement.editApiCase,test:$ctrl.service.authority.permission.project.apiManagement.test,amt:$ctrl.service.authority.spacePermission.amt.look&&$ctrl.service.authority.permission.project.apiManagement.editApiCase}"></list-block-common-component><div class="eo-none-tr tac" ng-if="!$ctrl.ajaxResponse.query.length">暂未创建测试用例</div></div></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><report-ams-component input="$ctrl.component.reportObject"></report-ams-component>'),t.put("module/ams/ui/project/inside/content/api/case/index.tmp.html",'<div class="tested-div" ng-class="{\'testing-div\':$ctrl.otherObject.testHistoryObj[item.caseID].responseType===\'testing\'&&$ctrl.otherObject.allIsTesting}" ng-switch="$ctrl.otherObject.testHistoryObj[item.caseID].responseType"><button class="eo-status-success" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'success\',item)" ng-switch-when="success" ng-init="$ctrl.mainObject.baseFun.getTime(item)">通过，查看详情</button> <button class="eo-status-error" ng-click="$ctrl.mainObject.baseFun.showTestHistory(\'error\',item)" ng-switch-when="error|timeout|matchError|codeError|interrupt|info|terminateRequest" ng-switch-when-separator="|" ng-init="$ctrl.mainObject.baseFun.getTime(item)">未通过，查看详情</button><div ng-switch-when="testing"><span class="iconfont icon-jiazai_shuaxin"></span> <span>测试中</span></div><div ng-switch-default=""><span>尚无测试结果</span></div></div>'),t.put("module/ams/ui/project/inside/content/api/case/testBtn.tmp.html",'<div class="test_btn" ng-switch="$ctrl.otherObject.validToSwitchTestMethod||$ctrl.otherObject.plugTransferToLocal"><div class="eo_more_btn_container f_row f_ac" ng-switch-when="true"><button class="block-btn common-btn" id="case_btn_test" ng-class="{\'eo_theme_btn_success\':$ctrl.otherObject.testMethodIsPlugin,\'eo_theme_btn_info\':!$ctrl.otherObject.testMethodIsPlugin}" ng-click="item.fun(\'all\')" eo-attr-test-type="{{$ctrl.otherObject.testMethodIsPlugin?\'plug\':\'server\'}}" testing="{{($ctrl.otherObject.allIsTesting&&$ctrl.otherObject.testMethod===\'all\')||false}}" ng-disabled="$ctrl.otherObject.disabledTest"><span class="iconfont icon-shanguangdeng pull-left"></span> <span class="btn-name">{{($ctrl.otherObject.allIsTesting&&$ctrl.otherObject.testMethod===\'all\')?"中止测试":"批量测试"}}</span></button> <button class="more-btn eo_more_btn w_40" ng-disabled="$ctrl.otherObject.disabledTest" eo-drop-elem="" other-obj="{testServer:($ctrl.otherObject.testMethodIsPlugin)?\'服务器\':($ctrl.otherObject.plugTransferToLocal?\'本地\':\'插件\')}" fn-click="item.otherFun()" text-arr="[{key:\'切换使用{{$ctrl.otherObj.testServer}}测试\'}]" ng-class="{\'eo_theme_btn_success\':$ctrl.otherObject.testMethodIsPlugin,\'eo_theme_btn_info\':!$ctrl.otherObject.testMethodIsPlugin}"><span class="iconfont icon-xiajiantou fs12"></span></button></div><div ng-switch-when="false"><button id="case_btn_test" ng-class="{\'eo_theme_btn_success\':$ctrl.otherObject.testMethodIsPlugin,\'eo_theme_btn_info\':!$ctrl.otherObject.testMethodIsPlugin}" ng-click="item.fun(\'all\')" ng-disabled="$ctrl.otherObject.disabledTest"><span class="iconfont icon-shanguangdeng pull-left"></span> <span class="btn-name">{{($ctrl.otherObject.allIsTesting&&$ctrl.otherObject.testMethod===\'all\')?"中止测试":"测试全部"}}</span></button></div></div>'),t.put("module/ams/ui/project/inside/content/api/detail/index.html",'<div class="apimanagement-scss-api-detail"><menu-common-component authority-object="$ctrl.service.authority.permission.project.apiManagement" main-object="$ctrl.component.menuObject"></menu-common-component><article class="first_level_article"><div class="first_part plr40 pt30"><ul ng-switch="$ctrl.ajaxRequest.groupID!=\'-2\'&&!!$ctrl.service.authority.permission.project.apiManagement.edit"><li class="common-style-li api-protocol">{{$ctrl.ajaxResponse.baseInfo.protocol}}</li><li class="common-style-li api-method"><label class="send-function">{{$ctrl.CONST.METHOD_ARR[$ctrl.ajaxResponse.baseInfo.apiRequestType]}}</label></li><a ng-switch-default=""><li class="api-status" ng-click="$ctrl.fun.changeApiStatus()"><span class="triangle-bottom"></span> <span class="eo_popover_tip">点击修改API状态</span> <span class="iconfont icon-circle eo-status-{{$ctrl.CONST.API_STATUS_SHOW_QUERY[$ctrl.ajaxResponse.baseInfo.apiStatus].class}}"></span> <span class="api-status-span">{{$ctrl.CONST.API_STATUS_SHOW_QUERY[$ctrl.ajaxResponse.baseInfo.apiStatus].key}}</span> <span class="iconfont icon-jiantou_liebiaozhankai" ng-if="$ctrl.ajaxResponse.baseInfo.status"></span></li></a><li ng-switch-when="false" class="api-status un-hover-li"><span class="iconfont icon-circle" ng-class="{\'eo-status-purple\':$ctrl.ajaxResponse.baseInfo.apiStatus==8,\'eo-status-success\':$ctrl.ajaxResponse.baseInfo.apiStatus==0,\'eo-status-warning\':$ctrl.ajaxResponse.baseInfo.apiStatus==1,\'eo-status-tips\':$ctrl.ajaxResponse.baseInfo.apiStatus==2,\'eo-status-danger\':$ctrl.ajaxResponse.baseInfo.apiStatus==7,\'eo-status-yellow\':$ctrl.ajaxResponse.baseInfo.apiStatus==3,\'eo-status-default\':$ctrl.ajaxResponse.baseInfo.apiStatus==4||$ctrl.ajaxResponse.baseInfo.apiStatus==5||$ctrl.ajaxResponse.baseInfo.apiStatus==6}"></span> <span class="api-status-span">{{$ctrl.ajaxResponse.baseInfo.status}}</span></li><a ng-click="$ctrl.fun.storage()" ng-switch-default=""><li class="api-starred"><span class="triangle-bottom"></span> <span class="eo_popover_tip">点击修改星标状态</span> <span class="iconfont mr5" ng-class="{\'icon-shoucang star-unlike\':!$ctrl.ajaxResponse.baseInfo.starred,\'icon-htmal5icon24 star-like\':$ctrl.ajaxResponse.baseInfo.starred==1}"></span>{{$ctrl.ajaxResponse.baseInfo.starred==1?\'已关注\':\'未关注\'}}</li></a><li ng-switch-when="false" class="api-starred"><span class="iconfont mr5" ng-class="{\'icon-shoucang star-unlike\':!$ctrl.ajaxResponse.baseInfo.starred,\'icon-htmal5icon24 star-like\':$ctrl.ajaxResponse.baseInfo.starred==1}"></span>{{$ctrl.ajaxResponse.baseInfo.starred==1?\'已关注\':\'未关注\'}}</li><li class="pull-right"><div class="f_row more-btn-group-div"><button ng-if="$ctrl.service.authority.permission.project.apiManagement.edit&&$ctrl.ajaxRequest.groupID!==\'-2\'" class="common-fun" ui-sref="home.ams.project.inside.api.edit({status:\'edit\',apiID:$ctrl.ajaxRequest.apiID,groupID:$ctrl.ajaxRequest.groupID})"><span class="iconfont icon-bianji mr5"></span><span>编辑</span></button> <button ng-if="$ctrl.ajaxRequest.groupID!==\'-2\'" class="common-fun" ng-click="$ctrl.fun.showModal(\'notice\')"><div class="f_row f_jc_ac"><span class="iconfont icon-tongzhizhongxin mr5"></span> <span>变更通知</span><tip-directive input="<p>当API改变时通知相关成员</p>"></tip-directive></div></button> <button type="button" ng-if="$ctrl.service.authority.permission.project.apiManagement.versionManagement&&$ctrl.ajaxRequest.groupID!==\'-2\'" class="common-fun" ng-click="$ctrl.fun.showModal(\'log\')"><span class="iconfont icon-lishijilu mr5"></span><span>编辑历史</span><tip-directive input="查看、对比API的修改历史"></tip-directive></button> <button ng-if="$ctrl.ajaxRequest.groupID!==\'-2\'" type="button" class="common-fun" ng-click="$ctrl.fun.showModal(\'comment\')"><span class="iconfont icon-duanxin mr5" ng-class="{\'unread_num_tip\':$ctrl.ajaxResponse.hasUnreadComment===1}"></span><span>评论</span><tip-directive input="对API文档发表评论并通知相关成员"></tip-directive></button><div ng-if="$ctrl.service.authority.permission.project.apiManagement.test&&$ctrl.ajaxRequest.groupID!==\'-2\'"><div class="f_row more-test-container"><button class="eo_theme_btn_success test-btn" ui-sref="home.ams.project.inside.api.test({apiID:$ctrl.ajaxRequest.apiID,groupID:$ctrl.ajaxRequest.groupID})"><div><span class="iconfont icon-shanguangdeng"></span> <span>测试</span></div></button> <button class="eo_theme_btn_success eo_more_btn test_more_btn w_40" eo-drop-elem="" fn-click="$ctrl.fun.watchUi(target)" text-arr="[{key:\'打开新标签页\',value:\'newTab\'},{key:\'管理测试用例\',value:\'adminCase\'}]"><span class="iconfont icon-xiajiantou fs12"></span></button></div></div></div></li><li class="api-detail"><ul><li class="api-url">{{$ctrl.service.home.envObject.object.model.baseInfo.apiURI}}</li><li class="api-name">{{$ctrl.ajaxResponse.baseInfo.apiName}}</li><li><div class="tag-item" ng-repeat="tag in $ctrl.ajaxResponse.baseInfo.apiTag">{{tag}}</div></li><li class="others-li"><span class="group-span">分组:&nbsp;{{$ctrl.ajaxResponse.baseInfo.groupPath}}</span> <span>负责人:&nbsp;{{$ctrl.ajaxResponse.baseInfo.apiManager||\'无\'}}</span> <span>创建者:&nbsp;{{$ctrl.ajaxResponse.baseInfo.creator||\'无\'}}</span> <span>最后编辑人:&nbsp;{{$ctrl.ajaxResponse.baseInfo.updater}}</span> <span class="update-span">更新时间：{{$ctrl.ajaxResponse.baseInfo.apiUpdateTime}}</span></li></ul></li></ul></div><div class="item_part plr40" ng-if="$ctrl.service.home.envObject.object.model.headerInfo.length>0"><p class="f_row_ac"><span class="mr5">请求头部</span> <button class="eo_theme_btn_info h_20 fs12 plr5 ptb2 lh_14 ti0" type="button" ng-click="$ctrl.fun.generatePreviewData(\'requestHeader\')">生成预览数据</button></p><div class="eo-block-container"><list-block-common-component list="$ctrl.service.home.envObject.object.model.headerInfo" main-object="$ctrl.component.blockListObject.requestHeader"></list-block-common-component></div></div><div class="item_part plr40" ng-if="$ctrl.service.home.envObject.object.model.urlParam.length>0"><p class="f_row_ac"><span class="mr5">Query参数</span> <button class="eo_theme_btn_info h_20 fs12 plr5 ptb2 lh_14 ti0" type="button" ng-click="$ctrl.fun.generatePreviewData(\'urlParam\')">生成预览数据</button></p><div class="eo-block-container"><list-block-common-component list="$ctrl.service.home.envObject.object.model.urlParam" main-object="$ctrl.component.blockListObject.queryParam"></list-block-common-component></div></div><div class="item_part plr40" ng-if="$ctrl.service.home.envObject.object.model.restfulParam.length>0"><p>REST参数</p><div class="eo-block-container"><list-block-common-component list="$ctrl.service.home.envObject.object.model.restfulParam" main-object="$ctrl.component.blockListObject.restful"></list-block-common-component></div></div><div class="item_part plr40" ng-if="($ctrl.service.home.envObject.object.model.requestInfo.length>0&&$ctrl.ajaxResponse.baseInfo.apiRequestParamType!=1)||($ctrl.service.home.envObject.object.model.baseInfo.apiRequestBinary||$ctrl.service.home.envObject.object.model.baseInfo.apiRequestRaw)"><p class="f_row_ac"><span class="mr5">Body&nbsp;请求参数</span> <span class="eo-color-back fs12 plr5 ptb2 mr5">{{$ctrl.ajaxResponse.baseInfo.apiRequestParamTypeString}}</span> <span class="eo-color-back fs12 plr5 ptb2 mr5" ng-if="$ctrl.ajaxResponse.baseInfo.apiRequestParamType==2">最外层结构为：{{$ctrl.ajaxResponse.baseInfo.apiRequestParamJsonType==1?\'Array\':\'Object\'}}</span> <button class="eo_theme_btn_info h_20 fs12 plr5 ptb2 lh_14 ti0" type="button" ng-click="$ctrl.fun.generatePreviewData(\'body\')" ng-if="[0,2,3].indexOf($ctrl.ajaxResponse.baseInfo.apiRequestParamType)>-1">生成预览数据</button></p><div class="eo-block-container" ng-switch="$ctrl.ajaxResponse.baseInfo.apiRequestParamType"><list-block-common-component ng-switch-default="" list="$ctrl.service.home.envObject.object.model.requestInfo" main-object="$ctrl.component.blockListObject.body"></list-block-common-component><article class="raw-article"><div class="p10" ng-switch-when="1" format-status="" arrange-format="request-param-div-js" interaction="{request:{onlyOneTime:true}}" ng-model="$ctrl.service.home.envObject.object.model.baseInfo.apiRequestRaw"><pre class="wb_all ws_initial" id="request-param-div-js"></pre></div><pre class="wb_all ws_initial p10" ng-switch-when="4">{{$ctrl.service.home.envObject.object.model.baseInfo.apiRequestBinary}}</pre></article></div></div><div class="item_part plr40" ng-if="$ctrl.ajaxResponse.responseHeader.length>0"><p class="f_row_ac"><span class="mr5">返回头部</span> <button class="eo_theme_btn_info h_20 fs12 plr5 ptb2 lh_14 ti0" type="button" ng-click="$ctrl.fun.generatePreviewData(\'responseHeader\')">生成预览数据</button></p><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.responseHeader" main-object="$ctrl.component.blockListObject.responseHeader"></list-block-common-component></div></div><div class="item_part plr40" ng-if="$ctrl.ajaxResponse.resultInfo.length>0"><p class="dp_ib f_row_ac"><span class="mr5">返回参数</span> <span class="eo-color-back fs12 plr5 ptb2 mr5" ng-if="$ctrl.ajaxResponse.resultParamTypeString">{{$ctrl.ajaxResponse.resultParamTypeString}}</span> <span class="eo-color-back fs12 plr5 ptb2 mr5" ng-if="$ctrl.ajaxResponse.resultParamType==0">最外层结构为：{{$ctrl.ajaxResponse.resultParamJsonType==1?\'Array\':\'Object\'}}</span> <button class="eo_theme_btn_info h_20 fs12 plr5 ptb2 lh_14 ti0" type="button" ng-click="$ctrl.fun.generatePreviewData(\'response\')" ng-if="[0,1].indexOf($ctrl.ajaxResponse.resultParamType)>-1">生成预览数据</button></p><div class="eo-block-container" ng-switch="$ctrl.ajaxResponse.resultParamType"><list-block-common-component ng-switch-default="" list="$ctrl.ajaxResponse.resultInfo" main-object="$ctrl.component.blockListObject.response"></list-block-common-component><article class="raw-article"><div class="p10" ng-switch-when="2" format-status="" arrange-format="response-js" interaction="{request:{onlyOneTime:true}}" ng-model="$ctrl.ajaxResponse.resultInfo"><pre class="wb_all ws_initial" id="response-js"></pre></div><pre class="wb_all ws_initial p10" ng-switch-when="3">{{$ctrl.ajaxResponse.resultInfo}}</pre></article></div></div><div class="item_part plr40" ng-if="$ctrl.ajaxResponse.baseInfo.apiSuccessMock||$ctrl.ajaxResponse.baseInfo.apiFailureMock"><p>返回示例</p><div class="eo-block-container mt20 mb20"><div class="eo-tab-menu"><div class="pull-left item-tab" ng-class="{\'active-item\':!$ctrl.data.isFailedDemo}" ng-click="$ctrl.data.isFailedDemo = false;">成功示例</div><div class="pull-left item-tab" ng-class="{\'active-item\':$ctrl.data.isFailedDemo}" ng-click="$ctrl.data.isFailedDemo = true;">失败示例</div></div><div class="response-example-part" ng-switch="$ctrl.data.isFailedDemo"><article><div class="copy-url-box" ng-if="$ctrl.ajaxRequest.groupID!=\'-2\'" ng-switch-when="false"><ul><li><span class="input-icon-span">示例调用地址：</span><copy-default-common-component is-popup="true" copy-model="$ctrl.ajaxResponse.baseInfo.successMockCode"></copy-default-common-component></li></ul></div><div class="po_re" ng-hide="$ctrl.data.isFailedDemo"><p class="demo-setting-p"><span class="code-span">HTTP Status Code:{{$ctrl.ajaxResponse.baseInfo.apiSuccessStatusCode||\'200\'}}<tip-directive input="<p>访问Mock URL时返回的HTTP状态码</p>"></tip-directive></span> <span class="code-span">Content-Type:{{$ctrl.ajaxResponse.baseInfo.apiSuccessContentType||\'text/html;charset=UTF-8\'}}</span> <button class="checkbox-btn send-format" ng-if="$ctrl.ajaxResponse.baseInfo.apiSuccessMock" arrange-format="apiResult_js" format-status="$ctrl.ajaxResponse.baseInfo.successStatus" ng-model="$ctrl.ajaxResponse.baseInfo.apiSuccessMock"><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.ajaxResponse.baseInfo.successStatus==2}">{{$ctrl.ajaxResponse.baseInfo.successStatus==2?\'\':\'&nbsp;\'}}</span>格式整理</button></p><pre class="back-result-content" id="apiResult_js"><span class="null_tip_span fs14">暂未填写成功示例</span></pre><div class="result-forward" ng-if="$ctrl.ajaxRequest.groupID!=\'-2\'&&!$ctrl.ajaxResponse.baseInfo.apiSuccessMock&&$ctrl.service.authority.permission.project.apiManagement.edit" ng-click="$ctrl.fun.set(\'Success_Example\')"><span class="c9">，</span><a class="eo_link">前往设置</a></div></div></article><article><div class="copy-url-box" ng-if="$ctrl.ajaxRequest.groupID!=\'-2\'" ng-switch-when="true"><ul><li><span class="input-icon-span">示例调用地址：</span><copy-default-common-component is-popup="true" copy-model="$ctrl.ajaxResponse.baseInfo.failureMockCode"></copy-default-common-component></li></ul></div><div class="po_re" ng-show="$ctrl.data.isFailedDemo"><p class="demo-setting-p"><span class="code-span">HTTP Status Code:{{$ctrl.ajaxResponse.baseInfo.apiFailureStatusCode||\'200\'}}<tip-directive input="<p>访问Mock URL时返回的HTTP状态码</p>"></tip-directive></span> <span class="code-span">Content-Type:{{$ctrl.ajaxResponse.baseInfo.apiFailureContentType||\'text/html;charset=UTF-8\'}}</span> <button class="checkbox-btn send-format" arrange-format="apiResult_js_1" format-status="$ctrl.ajaxResponse.baseInfo.failureStatus" ng-model="$ctrl.ajaxResponse.baseInfo.apiFailureMock" ng-if="$ctrl.ajaxResponse.baseInfo.apiFailureMock"><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':$ctrl.ajaxResponse.baseInfo.failureStatus==2}">{{$ctrl.ajaxResponse.baseInfo.failureStatus==2?\'\':\'&nbsp;\'}}</span> <span>格式整理</span></button></p><pre class="back-result-content" id="apiResult_js_1">\n                                                    <span class="null_tip_span fs14">暂未填写失败结果</span>\n                                                    </pre><div class="result-forward" ng-if="$ctrl.ajaxRequest.groupID!=\'-2\'&&!$ctrl.ajaxResponse.baseInfo.apiFailureMock&&$ctrl.service.authority.permission.project.apiManagement.edit" ng-click="$ctrl.fun.set(\'Failure_Example\')"><span class="c9">，</span><a class="eo_link">前往设置</a></div></div></article></div></div></div><div class="item_part plr40 note-part" ng-if="$ctrl.ajaxResponse.baseInfo.apiNoteHtml||$ctrl.ajaxResponse.fileList.length"><p>额外说明文档</p><article class="common-container mb20" ng-class="{\'wangEditor-container\':$ctrl.ajaxResponse.baseInfo.apiNoteType==\'0\'}"><div class="eo-block-container" ng-class="{\'markdown-body editormd-preview-container\':$ctrl.ajaxResponse.baseInfo.apiNoteType==\'1\',\'wangEditor-txt\':$ctrl.ajaxResponse.baseInfo.apiNoteType==\'0\'}" inner-html-common-directive="" html="$ctrl.ajaxResponse.baseInfo.apiNoteHtml" status="unbind-angular"><div class="c999" ng-if="!$ctrl.ajaxResponse.baseInfo.apiNoteHtml">详细说明为空</div></div><package-admin-component class="mt5 bte" ng-if="$ctrl.ajaxResponse.fileList.length" list="$ctrl.ajaxResponse.fileList"></package-admin-component></article></div><div class="none_container_asad plr20 ptb10 mlr40 mt20" ng-if="!(($ctrl.service.home.envObject.object.model.requestInfo.length>0&&$ctrl.ajaxResponse.baseInfo.apiRequestParamType!=1)||($ctrl.service.home.envObject.object.model.baseInfo.apiRequestBinary||$ctrl.service.home.envObject.object.model.baseInfo.apiRequestRaw))&&!$ctrl.ajaxResponse.baseInfo.apiSuccessMock&&!$ctrl.ajaxResponse.baseInfo.apiFailureMock&&!$ctrl.ajaxResponse.baseInfo.apiNoteHtml&&!$ctrl.ajaxResponse.fileList.length&&$ctrl.ajaxResponse.resultInfo.length===0&&$ctrl.ajaxResponse.responseHeader.length===0&&$ctrl.service.home.envObject.object.model.headerInfo.length===0&&$ctrl.service.home.envObject.object.model.urlParam.length===0&&$ctrl.service.home.envObject.object.model.restfulParam.length===0">该API暂无详细的参数信息</div></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div><div class="float-container" ng-if="$ctrl.data.modal" ng-class="{\'eo_to_right_750\':!$ctrl.data.modal,\'eo_to_right_0\':$ctrl.data.modal}"><div class="container_header"><span class="fwb fs18">{{$ctrl.CONST.OPERATE_TITLE[$ctrl.data.modal]}}</span> <button class="eo_theme_btn_default plr15 pull-right" ng-click="$ctrl.fun.closeModal()">关闭</button><br clear="both"></div><div class="float_content" ng-switch="$ctrl.data.modal" ng-class="{\'mb50 p20\':$ctrl.data.modal!==\'comment\'}"><comment-ams-component main-object="$ctrl.commentComponent.mainObject" export-fun-object="$ctrl.commentComponent.exportFunObject" ng-switch-when="comment"></comment-ams-component><notice-member-ams-component main-object="$ctrl.component.noticeMemberObj" authority-object="{isGlobal:0,edit:$ctrl.service.authority.permission.project.apiManagement.edit}" ng-switch-when="notice"></notice-member-ams-component><home-project-inside-api-history ng-switch-when="log"></home-project-inside-api-history></div></div><div class="mask-asad"></div>'),
t.put("module/ams/ui/project/inside/content/api/history/index.html",'<div class="eo-block-container"><list-block-common-component other-object="{\'productType\':$ctrl.service.authority.product.ams}" authority-object="$ctrl.service.authority.permission.project.apiManagement" list="$ctrl.interaction.response.query" main-object="$ctrl.component.blockListObject.query.mainObject" page-object="$ctrl.data.pagination"></list-block-common-component><loading-part-common-component fun="$ctrl.fun.init()"></loading-part-common-component><div class="eo-none-tr tac" ng-if="$ctrl.interaction.response.query.length==0">暂未存在任何历史记录</div></div>'),t.put("module/ams/ui/project/inside/content/api/list/index.html",'<div on-resize-directive="" change-fun="$ctrl.fun.onResize()" class="apimanagement_scss_api_list h_100percent"><menu-common-component authority-object="{edit:$ctrl.service.authority.permission.project.apiManagement.edit,amt:$ctrl.service.authority.spacePermission.amt.look&&$ctrl.service.authority.permission.project.apiManagement.edit,export:$ctrl.service.authority.permission.project.exportAndShare.export,editPlan:$ctrl.service.authority.product.ams!==\'free\'&&$ctrl.service.authority.permission.project.iterationPlan.edit,pro:$ctrl.service.authority.product.ams!=\'free\',showTitle:((!$ctrl.service.authority.permission.project.iterationPlan.edit&&$ctrl.service.authority.product.ams!==\'free\')||$ctrl.service.authority.product.ams==\'free\')&&!$ctrl.service.authority.permission.project.apiManagement.edit&&!$ctrl.service.authority.permission.project.exportAndShare.export,showBatch:$ctrl.service.authority.permission.project.apiManagement.edit||$ctrl.service.authority.permission.project.exportAndShare.export||($ctrl.service.authority.permission.project.iterationPlan.edit&&$ctrl.service.authority.product.ams!=\'free\')}" main-object="$ctrl.component.menuObject" other-object="{batch:$ctrl.data.batch,isBatchDisabled:!$ctrl.service.home.envObject.object.model.length}" block-list-object="$ctrl.data.filterObject"></menu-common-component><list-default-common-component authority-object="{operate:$ctrl.service.authority.permission.project.apiManagement.edit}" main-object="$ctrl.component.listDefaultCommonObject.mainObject" list="$ctrl.service.home.envObject.object.model" show-object="{columnFilterObject:$ctrl.data.filterObject.indexAddress}" other-object="{batch:$ctrl.data.batch,allQueryID:$ctrl.data.allQueryID}" page-object="{pageInfo:$ctrl.data.pagination}"></list-default-common-component><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component></div>'),t.put("module/ams/ui/project/inside/content/api/mock/index.html",'<menu-common-component authority-object="$ctrl.service.authority.permission.project.apiManagement" main-object="$ctrl.component.menuObject"></menu-common-component><article class="first_level_article"><div class="item_part eo-tab-container"><header class="header-ip"><button class="eo_theme_btn_success" ng-click="$ctrl.fun.edit(\'add\')" ng-disabled="!($ctrl.service.authority.permission.project.apiManagement.edit&&$ctrl.service.authority.permission.project.apiManagement.mockApi)"><span class="iconfont icon-jiahao"></span> <span>新建Mock API</span></button></header><div class="copy-url-box f_row" eo-attr-tip-placeholder="mock_url_text" eo-attr-tip-left="20"><span class="input-icon-span">调用地址：</span><copy-default-common-component class="w_100percent" is-popup="true" copy-model="$ctrl.ajaxResponse.mockURI"></copy-default-common-component></div><list-block-common-component class="list-container" list="$ctrl.ajaxResponse.query" main-object="$ctrl.component.blockListObject.mock" authority-object="{mockApi:$ctrl.service.authority.permission.project.apiManagement.edit&&$ctrl.service.authority.permission.project.apiManagement.mockApi}"></list-block-common-component><div class="eo-none-tr tac" ng-if="$ctrl.ajaxResponse.query.length<=0">暂未创建任何期望</div></div></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/project/inside/content/api/test/index.html",'<div class="apimanagement-scss-api-test" check-plug-directive="" input="$ctrl.data.plugObject" bind-fun="$ctrl.fun.setTestServerType"><menu-common-component ng-if="!$ctrl.data.isQuick" authority-object="$ctrl.service.authority.permission.project.apiManagement" other-object="{request:$ctrl.serviceHome.envObject.object.model,testResultCache:\'UNIT_TEST_RESULT\',apiID:$ctrl.ajaxRequest.apiID,advancedSetting:$ctrl.unitTestObjectComponent.advancedSetting}" main-object="$ctrl.component.menuObject"></menu-common-component><div class="static-div"><form class="first_part" autocomplete="off" name="testForm"><table><tr><td class="method-td"><select-default-common-component class="center-sdcc" output="$ctrl.serviceHome.envObject.object.model" model-key="apiRequestType" required="true" input="{query:$ctrl.CONST.requestMethodQuery,key:\'key\',value:\'value\',initialData:$ctrl.serviceHome.envObject.object.model.apiRequestType}"></select-default-common-component></td><td class="front-uri-td" ng-show="$ctrl.serviceHome.envObject.object.total.frontURI"><span class="similar-input-span">{{$ctrl.serviceHome.envObject.object.total.frontURI}}</span> <span class="triangle-bottom"></span> <span class="eo_popover_tip">{{$ctrl.serviceHome.envObject.object.total.frontURI}}</span></td><td class="uri-td"><input autocomplete="off" class="eo-input pull-left" type="text" placeholder="请输入测试地址" ng-model="$ctrl.serviceHome.envObject.object.model.URL" name="uri" ng-change="$ctrl.fun.changeUri()" required=""></td><td class="test-example-td"><pro-inside-test-example input="{request:$ctrl.ajaxRequest,response:{statusCode:$ctrl.data.response.testHttpCode}}" history="$ctrl.serviceHome.envObject.object.model" reset="$ctrl.data" script="$ctrl.unitTestObjectComponent.injectScript" advanced-setting="$ctrl.unitTestObjectComponent.advancedSetting" url-param="$ctrl.ajaxResponse.apiInfo.urlParam" restful-param="$ctrl.ajaxResponse.apiInfo.restfulParam" cache-variable="UNIT_TEST_RESULT" read-only="$ctrl.data.isQuick&&!$ctrl.ajaxRequest.apiID" bind-fun="$ctrl.fun.resetForm(arg)"></pro-inside-test-example></td><td class="test-td"><unit-test-ams-component interaction="$ctrl.data.plugObject" message="$ctrl.serviceHome.envObject.object.model" result="$ctrl.data.response" format="$ctrl.data.format" test-form="testForm" env="$ctrl.serviceHome.envObject.object.total" output="$ctrl.unitTestObjectComponentOutput" input="$ctrl.unitTestObjectComponent" url-param="$ctrl.ajaxResponse.apiInfo.urlParam" restful-param="$ctrl.ajaxResponse.apiInfo.restfulParam" change-test-type-fun="$ctrl.fun.changeTestSeverType()"></unit-test-ams-component></td><td class="quick-save-td" ng-if="$ctrl.data.isQuick&&$ctrl.service.authority.permission.project.apiManagement.edit"><button class="save-btn-qstd eo_more_btn" type="button" eo-drop-elem="" fn-click="$ctrl.fun.newApi()" text-arr="[{key:\'新的API文档\'}]"><span class="save-text">保存</span> <span class="iconfont icon-xiajiantou fs12 w_40"></span></button></td></tr></table></form></div><article class="first_level_article mb20"><div class="po_re" ng-class="{\'disabled_get_asat\':$ctrl.serviceHome.envObject.object.model.apiRequestType == \'1\' && $ctrl.unitTestObjectComponent.testSeverType !== \'nodejs\'}"><multi-tab-component class="pt20 dp_b" other-obj="{advancedSetting:$ctrl.unitTestObjectComponent.advancedSetting,injectScript:$ctrl.unitTestObjectComponent.injectScript,auth:$ctrl.serviceHome.envObject.object.model.auth,restfulParam:$ctrl.ajaxResponse.apiInfo.restfulParam.length,urlParam:$ctrl.ajaxResponse.apiInfo.urlParam.length,raw:$ctrl.serviceHome.envObject.object.model.raw,params:$ctrl.serviceHome.envObject.object.model.params,requestType:$ctrl.serviceHome.envObject.object.model.requestType,headers:$ctrl.serviceHome.envObject.object.model.headers.length}" list="$ctrl.multiTabComponent.requestData" model="$ctrl.data.menuType"></multi-tab-component><div class="ab_r0 eo_to_top_20 lh_30"><button type="button" class="eo-operate-btn" ng-click="$ctrl.fun.adminCookie()">Cookie管理</button> <button class="eo-operate-btn" type="button" ng-click="$ctrl.fun.generateCode()" eo-attr-tip-placeholder="generate_code_btn">生成测试代码</button></div></div><div class="eo_theme_iblock bbd bld brd"><div ng-show="$ctrl.data.menuType==\'advancedSetting\'"><test-setting-ams-component bind-object="$ctrl.unitTestObjectComponent.advancedSetting"></test-setting-ams-component></div><div class="item_part" ng-show="$ctrl.data.menuType==\'headers\'"><header class="dp_b"><div class="eo-more-btn-container" set-to-params="headerName" item="{{$ctrl.data.jsonToParamObject.headerItem}}" reset-result="$ctrl.serviceHome.envObject.object.model.headers" set-value="headerValue" import-method="2"></div></header><list-block-common-component list="$ctrl.serviceHome.envObject.object.model.headers" main-object="$ctrl.component.blockListObject.requestHeader"></list-block-common-component></div><div ng-show="$ctrl.data.menuType==\'auth\'"><auth-ams-component auth-object="$ctrl.serviceHome.envObject.object.model.auth"></auth-ams-component></div><div class="item_part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'body\'}"><header><div class="dp_ib w_100percent"><menu-radio-common-component class="pull-left mr5" list="$ctrl.CONST.requestTypeQuery" output="$ctrl.serviceHome.envObject.object.model" model-key="requestType" bind-fun="$ctrl.fun.changeBodyType(arg)"></menu-radio-common-component><div class="f_row_ac" ng-if="$ctrl.serviceHome.envObject.object.model.requestType!=\'4\'"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container mr15" ng-show="[\'2\',\'3\'].indexOf($ctrl.serviceHome.envObject.object.model.requestType)>-1"><button class="eo_more_btn f_row_ac" type="button" other-obj="{requestType:$ctrl.serviceHome.envObject.object.model.requestType,target:$ctrl.serviceHome.envObject.object.model.params}" eo-drop-elem="" text-arr="$ctrl.CONST.INSERT_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container mr10" ng-if="$ctrl.serviceHome.envObject.object.model.requestType==\'0\'"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="$ctrl.fun.quickSelectContentType(target,itemEvent)" text-arr="$ctrl.CONST.FORM_DATA_CONTENT_TYPE_ARR"><span>{{$ctrl.data.contentType.current.key}}</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-show="$ctrl.serviceHome.envObject.object.model.requestType==\'0\'"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="$ctrl.fun.formToOtherType(target)" text-arr="[{key:\'Json\',value:\'json\'},{key:\'XML\',value:\'xml\'},{key:\'Query参数\',value:\'get\'}]"><span class="iconfont icon-huopinfenliu"></span> <span>转换为</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-if="$ctrl.serviceHome.envObject.object.model.requestType==\'1\'"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="$ctrl.fun.quickSelectContentType(target,itemEvent)" text-arr="$ctrl.CONST.RAW_CONTENT_TYPE_ARR"><span>{{$ctrl.data.contentType.current.key}}</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div></div></div><div class="pt10" ng-show="$ctrl.serviceHome.envObject.object.model.requestType == \'2\'"><p class="fs12 c999">JSON&nbsp;根类型：</p><p class="mt10"><select-default-common-component class="w_250" output="$ctrl.serviceHome.envObject.object.model" model-key="apiRequestParamJsonType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.serviceHome.envObject.object.model.apiRequestParamJsonType||\'0\'}"></select-default-common-component></p></div></header><article><div ng-if="[\'0\',\'2\',\'3\'].indexOf($ctrl.serviceHome.envObject.object.model.requestType)>-1"><list-block-common-component list="$ctrl.serviceHome.envObject.object.model.params" main-object="$ctrl.component.blockListObject.body" other-object="{\'bodyParamType\':$ctrl.serviceHome.envObject.object.model.requestType}"></list-block-common-component></div><div class="dp_f" ng-class="{\'eo-static-hidden\':$ctrl.serviceHome.envObject.object.model.requestType!=\'1\'}"><ace-editor-ams-component class="ace-editor-container w_100percent" set-model="$ctrl.serviceHome.envObject.object.model.raw"></ace-editor-ams-component></div><div class="dp_f po_re p20" ng-if="$ctrl.serviceHome.envObject.object.model.requestType===\'4\'"><input autocomplete="off" class="eo-input text_binary_input_asat" type="text" ng-model="$ctrl.serviceHome.envObject.object.model.params.name" disabled="true" placeholder="请选择文件"> <input autocomplete="off" type="file" class="file_binary_input_asat" onchange="angular.element(this).scope().importFile(this.files)"> <button type="button" class="file_binary_btn_asat">选择文件</button></div></article></div><div class="item_part" ng-show="$ctrl.data.menuType==\'restful\'"><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.restfulParam" main-object="$ctrl.component.blockListObject.restful"></list-block-common-component></div><div class="item_part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'url\'}"><header><div class="eo-more-btn-container" set-to-params="paramKey" item="{{$ctrl.data.jsonToParamObject.requestItem}}" reset-result="$ctrl.ajaxResponse.apiInfo.urlParam" set-value="paramInfo" import-method="1"></div></header><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.urlParam" main-object="$ctrl.component.blockListObject.queryParam"></list-block-common-component></div><div class="item_part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'inject\'}"><div><header><menu-radio-common-component list="$ctrl.CONST.scriptTypeQuery" output="$ctrl.unitTestObjectComponent.injectScript" model-key="type" cancle-bind-fun="true"></menu-radio-common-component></header><ace-menu-editor-ams-component class="dp_f" mark="project" set-model="$ctrl.unitTestObjectComponent.injectScript" set-variable="$ctrl.unitTestObjectComponent.injectScript.type==\'0\'?\'before\':\'after\'" watch-model="$ctrl.unitTestObjectComponent.injectScript.type"></ace-menu-editor-ams-component></div></div></div><multi-tab-component class="pt20 dp_b" list="$ctrl.multiTabComponent.responseData" other-obj="{hadTest:$ctrl.data.response.hadTest}" model="$ctrl.data.response.status"></multi-tab-component><div class="eo_theme_iblock bbd bld brd"><div class="item_part response-example-part" ng-if="$ctrl.data.response.hadTest&&$ctrl.data.response.status==\'0\'"><header class="f_row" ng-if="$ctrl.data.response.responseType===\'text\'"><button class="change-type-btn send-format" ng-disabled="!$ctrl.data.response.testHttpCode||$ctrl.data.format.resultIsNull" format-status="" arrange-format="apiResult_js" ng-model="$ctrl.data.format.message" cache-variable="UNIT_TEST_RESULT"><span class="iconfont icon-mofabang"></span>格式整理</button> <button class="change-type-btn send-format" ng-disabled="!$ctrl.data.response.testHttpCode||$ctrl.data.format.resultIsNull" ng-click="$ctrl.fun.window()"><span class="iconfont icon-daochu"></span>在新窗口中显示测试结果</button> <button class="change-type-btn send-format" ng-disabled="!$ctrl.data.response.testHttpCode||$ctrl.data.format.resultIsNull" ng-click="$ctrl.fun.saveDemo()" ng-if="!$ctrl.data.isQuick&&$ctrl.service.authority.permission.project.apiManagement.edit"><span class="iconfont icon-daochu"></span>将结果保存到API文档中</button> <button class="change-type-btn send-format" ng-disabled="!$ctrl.data.response.testHttpCode||$ctrl.data.format.resultIsNull" copy-common-directive="" cache-variable="UNIT_TEST_RESULT"><span class="iconfont icon-tuwen"></span>复制测试结果</button></header><article class="plr20 ptb20"><p class="title_rac" ng-show="$ctrl.data.response.reportList.length>0">预处理输出信息(output&nbsp;info)：</p><div class="response_bg_rac" ng-show="$ctrl.data.response.reportList.length>0"><p class="child_list_item_rac" ng-repeat="childItem in $ctrl.data.response.reportList"><span ng-class="{\'eo-status-error\':childItem.type!=\'throw\'}">{{childItem.content}}</span></p></div><div class="test-httpHeader-content" ng-class="{\'test-default\':$ctrl.data.response.httpCodeType===1,\'test-success\':$ctrl.data.response.httpCodeType===2,\'test-warning\':$ctrl.data.response.httpCodeType===3,\'test-error\':$ctrl.data.response.httpCodeType===4||$ctrl.data.response.httpCodeType===5}">{{$ctrl.data.response.httpCodeType!=5?$ctrl.data.response.testHttpCode:\'No&nbsp;response\'}} <span class="pull-right">{{!($ctrl.data.response.httpCodeType===5)?\'Time：\'+$ctrl.data.response.testDeny+\'ms\':\'\'}}</span> <span class="pull-right mr5">{{!($ctrl.data.response.httpCodeType===5)?\'Size：\'+($ctrl.data.response.responseLength|ChangeIntToStr_Filter):\'\'}}</span></div><pre class="back-result-content" id="apiResult_js" ng-show="$ctrl.data.response.responseType===\'text\'"></pre><div class="download_btn_asat tac" ng-if="[\'longText\',\'stream\'].indexOf($ctrl.data.response.responseType)>-1"><span ng-if="$ctrl.data.response.responseType===\'stream\'">无法预览非文本类型的数据，您可以</span> <span ng-if="$ctrl.data.response.responseType===\'longText\'">响应结果超出可预览的大小，您可以</span> <button id="eo_plug_download_file" class="eo_theme_btn_default mlr5" type="button" ng-click="$ctrl.fun.downloadResponseText()">下载返回结果</button> <span class="mr5" ng-if="$ctrl.data.response.responseType===\'longText\'">或者</span> <button id="eo_plug_preview_new_tab" class="eo_theme_btn_default" type="button" ng-click="$ctrl.fun.newTabResponseText()" ng-if="$ctrl.data.response.responseType===\'longText\'">在新标签页中显示返回结果</button> <span ng-if="$ctrl.data.response.responseType===\'stream\'">，并用其他程序打开。</span></div></article></div><div class="test-bar-container-div" ng-show="(!$ctrl.data.response.hadTest&&$ctrl.data.response.status!=\'4\')||(!$ctrl.data.response.responseType&&$ctrl.data.response.status==\'0\')"><div class="tac"><p>点击发送按钮获取测试报告</p><div class="mt15 dp_ib" ng-switch="$ctrl.data.plugObject.validToSwitchTestMethod||$ctrl.data.plugTransferToLocal"><div class="eo_more_btn_container" ng-switch-when="true"><button class="send-btn po_ab btn_static_test_utac" ng-click="$ctrl.fun.test()" ng-class="{\'eo_theme_btn_success\':$ctrl.fun.filterTestType()}"></button> <button class="btn_test_utac" type="button" ng-class="{\'eo_theme_btn_success\':($ctrl.data.plugObject.useStatus&&$ctrl.unitTestObjectComponent.testSeverType!==\'nodejs\')||$ctrl.from===\'share\',\'eo_theme_btn_info\':($ctrl.unitTestObjectComponent.testSeverType==\'nodejs\'||!$ctrl.data.plugObject.useStatus)&&$ctrl.from!==\'share\'}" ng-disabled="!$ctrl.serviceHome.envObject.object.model.URL"><span>{{$ctrl.data.plugObject.timer.disable?"中止&nbsp;"+($ctrl.data.plugObject.timer.num>0?$ctrl.data.plugObject.timer.num:""):\'发送\'}}</span></button></div><div ng-switch-when="false"><button class="common-btn eo_theme_btn_info btn_test_utac" type="button" ng-disabled="!$ctrl.serviceHome.envObject.object.model.URL" ng-click="$ctrl.fun.test()"><span>{{$ctrl.data.plugObject.timer.disable?"中止&nbsp;"+($ctrl.data.plugObject.timer.num>0?$ctrl.data.plugObject.timer.num:""):\'发送\'}}</span></button></div></div></div></div><div class="item_part response-example-part p20" ng-show="$ctrl.data.response.status==\'1\'&&$ctrl.data.response.hadTest"><ul class="test-header-ul" ng-switch="$ctrl.data.response.testResult.headers.length>0"><li class="result-item-li" ng-repeat="item in $ctrl.data.response.testResult.headers" ng-switch-when="true"><span class="test-header-key">{{item.key}}&nbsp;:&nbsp;</span> <span class="common-value-span">{{item.value}}</span></li><li class="eo-none-tr tac" ng-switch-when="false">暂无任何返回头部</li></ul></div><div class="item_part response-example-part p20" ng-show="$ctrl.data.response.status==\'2\'&&$ctrl.data.response.hadTest"><div class="request-body-div mh_40" ng-show="[\'1\',\'2\'].indexOf($ctrl.data.response.requestBody.params.requestType)>-1">{{$ctrl.data.response.requestBody.params.body}}</div><ul class="test-header-ul mh_40"><li class="result-item-li" ng-repeat="(key,value) in $ctrl.data.response.requestBody.params.body track by $index" ng-if="$ctrl.data.response.requestBody.params.requestType==\'0\'"><span class="test-header-key">{{key}}&nbsp;:&nbsp;</span> <span class="common-value-span">{{value}}</span></li><li class="eo-none-tr tac" ng-hide="$ctrl.data.response.requestBody.params.requestType">暂无任何请求信息</li></ul></div><div class="item_part response-example-part p20" ng-show="$ctrl.data.response.status==\'3\'&&$ctrl.data.response.hadTest"><ul class="test-header-ul" ng-switch="$ctrl.data.response.requestBody.headers.length>0"><li class="result-item-li" ng-repeat="item in $ctrl.data.response.requestBody.headers" ng-switch-when="true"><span class="test-header-key">{{item.key}}&nbsp;:&nbsp;</span> <span class="common-value-span">{{item.value}}</span></li><li class="eo-none-tr tac" ng-switch-when="false">暂无任何请求头部</li></ul></div><div class="item_part part test-history-part" ng-show="$ctrl.data.response.status==\'4\'"><loading-part-common-component interaction="{request:{delay:true}}" fun="$ctrl.fun.loadPartCtrl(arg)"></loading-part-common-component><header><button class="eo_theme_btn_danger" ng-disabled="!$ctrl.ajaxResponse.apiInfo.testHistory.length" ng-click="$ctrl.fun.testListClear()">清空历史记录</button></header><div class="history_container_hpiat"><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.testHistory" main-object="$ctrl.component.blockListObject.testHistory"></list-block-common-component><div class="eo-none-tr tac" ng-hide="$ctrl.ajaxResponse.apiInfo.testHistory.length>0||!$ctrl.data.queryHistory">当前历史记录为空</div></div></div></div></article></div>'),t.put("module/ams/ui/project/inside/content/api/edit/index.html",'<menu-common-component main-object="$ctrl.component.menuObject" authority-object="{isPay:$ctrl.service.authority.product.ams!==\'free\'}" active-object="$ctrl.data"></menu-common-component><div class="container_hpiae eo_theme_iblock"><article class="first_level_article" ng-show="$ctrl.data.menu==0"><ng-form class="first_part" autocomplete="off" name="ConfirmForm"><p><b>API状态</b></p><div class="mt10 f_row_ac"><menu-radio-common-component class="api_staus_panel1_hpiae pr10 pl5" cancle-bind-fun="true" list="$ctrl.CONST.API_STATUS_QUERY_PANEL_ARR[0]" output="$ctrl.ajaxResponse.apiInfo" model-key="apiStatus"></menu-radio-common-component><menu-radio-common-component class="pl5 api_staus_panel2_hpiae pr10 bld" cancle-bind-fun="true" list="$ctrl.CONST.API_STATUS_QUERY_PANEL_ARR[1]" output="$ctrl.ajaxResponse.apiInfo" model-key="apiStatus"></menu-radio-common-component><menu-radio-common-component class="pl5 api_staus_panel3_hpiae bld pr10" cancle-bind-fun="true" list="$ctrl.CONST.API_STATUS_QUERY_PANEL_ARR[2]" output="$ctrl.ajaxResponse.apiInfo" model-key="apiStatus"></menu-radio-common-component></div><p class="mt15 mb10"><b>API Path</b></p><div class="f_row_ac"><select-default-common-component output="$ctrl.ajaxResponse.apiInfo" model-key="apiProtocol" required="true" input="{attrPlaceholder:\'protocol_select\',query:$ctrl.CONST.requestProtocolQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.apiInfo.apiProtocol}"></select-default-common-component><select-default-common-component class="center-sdcc" output="$ctrl.ajaxResponse.apiInfo" model-key="apiRequestType" required="true" input="{attrPlaceholder:\'request_type_select\',query:$ctrl.CONST.requestMethodQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.apiInfo.apiRequestType}"></select-default-common-component><input ng-focus="$ctrl.fun.oprUri(\'focus\')" ng-blur="$ctrl.fun.oprUri(\'blur\')" autocomplete="off" class="eo-input w_100percent" type="text" name="uri" ng-model="$ctrl.ajaxResponse.apiInfo.apiURI" ng-class="{\'eo-input-error\':($ctrl.data.inputSubmited&&ConfirmForm.uri.$invalid)}" autofocus="true" eo-attr-tip-placeholder="api_path_input" required=""></div><p class="mt20 mb10"><b>API 名称</b></p><div class="f_row_ac"><select-multistage-common-component output="$ctrl.component.selectMultistageCommonComponentObject" input="{attrPlaceholder:\'api_group_select\',query:$ctrl.data.apiGroup,key:\'groupName\',value:\'groupID\',groupID:$ctrl.ajaxResponse.apiInfo.groupID}"></select-multistage-common-component><input autocomplete="off" class="eo-input w_100percent" type="text" name="name" ng-model="$ctrl.ajaxResponse.apiInfo.apiName" ng-class="{\'eo-input-error\':($ctrl.data.inputSubmited&&ConfirmForm.name.$invalid)}" maxlength="255" required=""></div><p class="mt20 mb10"><b>标签 [Tags]</b><span class="ml5 iconfont icon-guanyu_o" eo-attr-tip-left="-5" eo-attr-tip-placeholder="api_tag"></span><span class="c999 fs12 ml5">(选填)</span></p><div><tag-ams-component tag-query="$ctrl.component.tagObject.query" tag-flag="$ctrl.component.tagObject.flag" tag-string="$ctrl.ajaxResponse.apiInfo.apiTag"></tag-ams-component></div><p class="mt20 mb10"><b>负责人</b><span class="ml5 iconfont icon-guanyu_o" eo-attr-tip-left="-5" eo-attr-tip-placeholder="api_manager"></span><span class="c999 fs12 ml5">(选填)</span></p><div><select-person-common-component class="dp_ib" output="$ctrl.component.selectPersonCommonComponentObject" input="{query:$ctrl.ajaxResponse.memberList,loginCall:\'inviteCall\',nickName:\'userNickName\',noteName:\'memberNickName\',value:\'connID\',initialData:$ctrl.ajaxResponse.apiInfo.apiManagerConnID}"></select-person-common-component></div></ng-form><div class="f_row_ac eo_panel_title f_js plr10 cp mt20" ng-click="$ctrl.data.shrinkRequestData=!$ctrl.data.shrinkRequestData"><span>请求参数</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkRequestData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkRequestData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkRequestData}"></span></div></div><div ng-if="!$ctrl.data.shrinkRequestData"><multi-tab-component class="pt20 dp_b" other-obj="{advancedSetting:$ctrl.ajaxResponse.apiInfo.advancedSetting,injectScript:{before:$ctrl.ajaxResponse.apiInfo.beforeInject,after:$ctrl.ajaxResponse.apiInfo.afterInject},auth:$ctrl.ajaxResponse.apiInfo.apiAuth,restfulParam:$ctrl.ajaxResponse.apiInfo.apiRestfulParam.length,urlParam:$ctrl.ajaxResponse.apiInfo.apiUrlParam.length,raw:$ctrl.ajaxResponse.apiInfo.apiRequestRaw,params:$ctrl.data.bodyParamType==4?$ctrl.ajaxResponse.apiInfo.apiRequestBinary:$ctrl.data.bodyParam,requestType:$ctrl.data.bodyParamType,headers:$ctrl.ajaxResponse.apiInfo.apiHeader.length}" list="$ctrl.CONST.REQUEST_DATA_MENU_ARR" model="$ctrl.data.menuType"></multi-tab-component><div class="eo_theme_iblock bbd bld brd"><div class="item_part" ng-show="$ctrl.data.menuType==\'headers\'"><header><div class="eo-more-btn-container" set-to-params="headerName" item="{{$ctrl.data.jsonToParamObject.headerItem}}" reset-result="$ctrl.ajaxResponse.apiInfo.apiHeader" set-value="headerValue" un-parse-type="true" import-method="2"></div></header><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.apiHeader" main-object="$ctrl.component.blockListObject.requestHeader"></list-block-common-component></div><div class="item_part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'body\'}"><header><div class="f_row_ac"><menu-radio-common-component class="pull-left mr5" list="$ctrl.CONST.requestTypeQuery" output="$ctrl.data" model-key="bodyParamType" bind-fun="$ctrl.fun.changeBodyType(arg)"></menu-radio-common-component><div class="f_row_ac" ng-if="$ctrl.data.bodyParamType!=4"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container mr15" ng-show="[2,3].indexOf($ctrl.data.bodyParamType)>-1"><button type="button" class="eo_more_btn f_row_ac" other-obj="{requestType:$ctrl.data.bodyParamType,target:$ctrl.data.bodyParam}" eo-drop-elem="" text-arr="$ctrl.CONST.INSERT_BODY_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-show="$ctrl.data.bodyParamType ==0"><button type="button" class="eo_more_btn f_row_ac" eo-drop-elem="" fn-click="$ctrl.fun.formToOtherType(target)" text-arr="[{key:\'Json\',value:\'json\'},{key:\'XML\',value:\'xml\'},{key:\'Query参数\',value:\'get\'}]"><span class="iconfont icon-huopinfenliu"></span> <span>转换为</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-show="$ctrl.data.bodyParamType ==1"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="$ctrl.fun.quickSelectContentType(target,itemEvent)" text-arr="$ctrl.data.contentType.array"><span>{{$ctrl.data.contentType.current.key}}</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="po_ab tab_list_container_hpiae" ng-show="$ctrl.data.bodyParamType !=1"><button type="button" class="f_row_ac eo_more_btn" eo-attr-tip-placeholder="tab_list" other-obj="{list:$ctrl.CONST.TAB_BLOCK_LIST_ARR,active:$ctrl.data.bodyTabBlockObj,conf:$ctrl.component.bodyTabBlockListObj}" eo-drop-elem="" text-arr="$ctrl.data.tabBlockListHtml"><span class="iconfont icon-shebeisousuo pull-left fs24 mr5"></span> <span>列表项</span></button></div></div></div><div class="pt10" ng-show="$ctrl.data.bodyParamType == 2"><p class="fs12 c999">JSON&nbsp;根类型：</p><p class="mt10"><select-default-common-component output="$ctrl.data" model-key="bodyJsonRootType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.data.bodyJsonRootType||0}"></select-default-common-component></p></div></header><list-block-common-component list="$ctrl.data.bodyParam" main-object="$ctrl.component.blockListObject.body" other-object="{tabBlockActiveObj:$ctrl.data.bodyTabBlockObj.indexAddress,\'bodyParamType\':$ctrl.data.bodyParamType,dbmAuthority:$ctrl.service.authority.spacePermission.dbm}" ng-show="[0,2,3].indexOf($ctrl.data.bodyParamType)>-1"></list-block-common-component><textarea class="raw-rp" ng-model="$ctrl.ajaxResponse.apiInfo.apiRequestBinary" ng-if="$ctrl.data.bodyParamType===4" placeholder="binary参数描述"></textarea><div class="dp_f" ng-class="{\'eo-static-hidden\':$ctrl.data.bodyParamType!==1}"><ace-editor-ams-component class="ace-editor-container w_100percent" set-model="$ctrl.ajaxResponse.apiInfo.apiRequestRaw" id="_Raw_Ace_Editor_Js"></ace-editor-ams-component></div></div><div class="item_part request-param-part" ng-show="$ctrl.data.menuType==\'restful\'"><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.apiRestfulParam" main-object="$ctrl.component.blockListObject.restful" other-object="{dbmAuthority:$ctrl.service.authority.spacePermission.dbm}"></list-block-common-component></div><div class="item_part request-param-part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'url\'}"><header><div class="eo-more-btn-container" set-to-params="paramKey" item="{{$ctrl.data.jsonToParamObject.requestItem}}" value-item="{{$ctrl.data.jsonToParamObject.urlValueItem}}" reset-result="$ctrl.ajaxResponse.apiInfo.apiUrlParam" set-value="paramValueList" set-value-key="value" import-method="1"></div></header><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.apiUrlParam" main-object="$ctrl.component.blockListObject.queryParam" other-object="{dbmAuthority:$ctrl.service.authority.spacePermission.dbm}"></list-block-common-component></div><div ng-show="$ctrl.data.menuType==\'auth\'"><auth-ams-component auth-object="$ctrl.ajaxResponse.apiInfo.apiAuth"></auth-ams-component></div><div ng-show="$ctrl.data.menuType==\'advancedSetting\'"><test-setting-ams-component bind-object="$ctrl.ajaxResponse.apiInfo.advancedSetting"></test-setting-ams-component></div><div class="item_part request-param-part" ng-class="{\'eo-static-hidden\':$ctrl.data.menuType!=\'inject\'}"><header class="f_row_ac"><menu-radio-common-component list="$ctrl.CONST.scriptTypeQuery" output="$ctrl.data.script" model-key="type" cancle-bind-fun="true"></menu-radio-common-component></header><ace-menu-editor-ams-component class="dp_b" mark="project" set-model="$ctrl.ajaxResponse.apiInfo" set-variable="$ctrl.data.script.type==\'0\'?\'beforeInject\':\'afterInject\'" watch-model="$ctrl.data.script.type"></ace-menu-editor-ams-component></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="$ctrl.data.shrinkResponseData=!$ctrl.data.shrinkResponseData"><span>响应内容</span><div class="shrink_text_ept"><span>{{$ctrl.data.shrinkResponseData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':$ctrl.data.shrinkResponseData,\'icon-xuanzeqishouqi\':!$ctrl.data.shrinkResponseData}"></span></div></div><div ng-if="!$ctrl.data.shrinkResponseData"><multi-tab-component class="pt20 dp_b" other-obj="{responseHeader:$ctrl.ajaxResponse.apiInfo.responseHeader.length,apiResultParam:$ctrl.ajaxResponse.apiInfo.apiResultParam.length}" list="$ctrl.CONST.RESPONSE_MENU_ARR" model="$ctrl.data.responseMenuType"></multi-tab-component><div class="eo_theme_iblock bbd bld brd"><div class="item_part request-header-part" ng-show="$ctrl.data.responseMenuType==\'responseHeader\'"><header><div class="eo-more-btn-container" set-to-params="headerName" item="{{$ctrl.data.jsonToParamObject.headerItem}}" reset-result="$ctrl.ajaxResponse.apiInfo.responseHeader" set-value="headerValue" un-parse-type="true" import-method="2"></div></header><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.responseHeader" main-object="$ctrl.component.blockListObject.responseHeader"></list-block-common-component></div><div class="item_part response-part" ng-show="$ctrl.data.responseMenuType==\'response\'"><header><div class="f_row_ac"><menu-radio-common-component class="mr5" list="$ctrl.CONST.responseTypeQuery" output="$ctrl.ajaxResponse.apiInfo" model-key="resultParamType" bind-fun="$ctrl.fun.changeResponseType(arg)"></menu-radio-common-component><div class="f_row_ac" ng-show="[0,1].indexOf($ctrl.ajaxResponse.apiInfo.resultParamType)>-1"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container"><button type="button" class="eo_more_btn f_row_ac" other-obj="{resultParamType:$ctrl.ajaxResponse.apiInfo.resultParamType,target:$ctrl.ajaxResponse.apiInfo.apiResultParam}" eo-drop-elem="" text-arr="$ctrl.CONST.INSERT_RESPONSE_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container ml15"><button type="button" class="eo_more_btn f_row_ac" eo-drop-elem="" other-obj="{target:$ctrl.ajaxResponse.apiInfo.resultParamType}" fn-click="$ctrl.fun.formToOtherType(target)" text-arr="$ctrl.CONST.CONVERT_TYPE_ARR"><span class="iconfont icon-huopinfenliu"></span> <span>转换为</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="po_ab tab_list_container_hpiae"><button type="button" class="f_row_ac eo_more_btn" eo-attr-tip-placeholder="tab_list" other-obj="{list:$ctrl.CONST.TAB_BLOCK_LIST_ARR,active:$ctrl.data.responseTabBlockObj,conf:$ctrl.component.responseTabBlockListObj}" eo-drop-elem="" text-arr="$ctrl.data.tabBlockListHtml"><span class="iconfont icon-shebeisousuo pull-left fs24 mr5"></span> <span>列表项</span></button></div></div></div><div class="mt10" ng-show="$ctrl.ajaxResponse.apiInfo.resultParamType == 0"><p class="fs12 c999"><span>JSON&nbsp;根类型</span> <span class="iconfont icon-guanyu_o" eo-attr-tip-left="-5" eo-attr-tip-placeholder="json_root_type"></span> <span>：</span></p><p class="mt10"><select-default-common-component output="$ctrl.ajaxResponse.apiInfo" model-key="resultParamJsonType" required="true" input="{query:$ctrl.CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.apiInfo.resultParamJsonType}"></select-default-common-component></p></div></header><textarea class="raw-rp" ng-model="$ctrl.ajaxResponse.apiInfo.apiResultParam" ng-if="[2,3].indexOf($ctrl.ajaxResponse.apiInfo.resultParamType)>-1" placeholder="参数描述"></textarea><div class="json-match-div" ng-if="[0,1].indexOf($ctrl.ajaxResponse.apiInfo.resultParamType)>-1"><list-block-common-component list="$ctrl.ajaxResponse.apiInfo.apiResultParam" main-object="$ctrl.component.blockListObject.response" other-object="{tabBlockActiveObj:$ctrl.data.responseTabBlockObj.indexAddress,\'resultParamType\':$ctrl.ajaxResponse.apiInfo.resultParamType,dbmAuthority:$ctrl.service.authority.spacePermission.dbm}"></list-block-common-component></div></div></div></div></article><article class="first_level-article" ng-if="$ctrl.data.menu==1"><div class="f_row_ac f_js h_50 eo-block-container plr15 w_600 m_auto cp" ng-click="$ctrl.fun.clickResponseDemo(\'success\')"><span>成功示例</span><div><button type="button"><span class="iconfont icon-bianji"></span> <span>编辑</span></button></div></div><div class="f_row_ac f_js h_50 eo-block-container plr15 mt10 w_600 m_auto cp" ng-click="$ctrl.fun.clickResponseDemo(\'failure\')"><span>失败示例</span><div><button type="button"><span class="iconfont icon-bianji"></span> <span>编辑</span></button></div></div></article><article class="first_level_article note-article po_re" ng-if="$ctrl.data.menu==2"><package-admin-component list="$ctrl.ajaxResponse.apiInfo.fileList" main-object="$ctrl.component.packageAdminObj" expose-object="$ctrl.component.packageAdminExposeObj"></package-admin-component><select-default-common-component class="po_ab eo_to_right_0 eo_to_top_0 w_200 z_index4" output="$ctrl.ajaxResponse.apiInfo" model-key="apiNoteType" required="true" input="{query:$ctrl.CONST.noteTypeQuery,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.apiInfo.apiNoteType}"></select-default-common-component><div class="item_part remark-part" ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.apiInfo.apiNoteType==\'1\'}"><article><rich-editor-ams-component result-html="$ctrl.ajaxResponse.apiInfo.apiRichNote"></rich-editor-ams-component></article></div><div class="item_part remark-part" ng-class="{\'eo-static-hidden\':$ctrl.ajaxResponse.apiInfo.apiNoteType!=\'1\'}"><article><markdown-editor-ams-component result-html="$ctrl.ajaxResponse.apiInfo.apiMarkdownNote" id="editormd-js" origin="$ctrl.ajaxResponse.apiInfo.apiNoteRaw"></markdown-editor-ams-component></article></div></article></div><loading-common-component fun="$ctrl.fun.load(arg)" interaction="{request:{delay:true}}"></loading-common-component><div oc-lazy-load="$ctrl.CONST.lazyload"></div>'),
t.put("module/ams/ui/project/inside/content/api/edit/index.tmp.html",'<div class="f_row text_omit"><span class="eo-status-tips mlr5">或者</span> <button class="eo-operate-btn" type="button" ng-mousedown="$ctrl.mainObject.baseFun.importStructureData($index,item)">引用现有的数据结构</button><div ng-if="$ctrl.otherObject.dbmAuthority.look"><span class="eo-status-tips mr5">或者</span> <button class="eo-operate-btn" type="button" ng-mousedown="$ctrl.mainObject.baseFun.importFieldData($index,item)">引用 Database Builder 数据库中的字段</button></div></div><eo-divide></eo-divide><div ng-if="$ctrl.otherObject.dbmAuthority.look"><span class="eo-status-tips mlr5">或者</span> <button class="eo-operate-btn" type="button" ng-mousedown="$ctrl.mainObject.baseFun.importFieldData($index,item)">引用 Database Builder 数据库中的字段</button></div>'),t.put("module/ams/ui/automatic/inside/content/public/database/default/index.html",'<div class="public-resource-list"><menu-common-component authority-object="{showTitle:1,edit:$ctrl.service.authority.permission.automatic.database.edit}" main-object="$ctrl.component.menuObject.mainObject" other-object="{batch:$ctrl.data.batch,isBatchDisabled:$ctrl.ajaxResponse.query.length===0}"></menu-common-component><list-default-common-component class="dp_b p15" main-object="$ctrl.component.listObject.mainObject" list="$ctrl.ajaxResponse.query" authority-object="{operate:$ctrl.service.authority.permission.automatic.database.edit}" other-object="{batch:$ctrl.data.batch}"></list-default-common-component></div><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>'),t.put("module/ams/ui/automatic/inside/content/public/database/operate/index.html",'<menu-common-component main-object="$ctrl.component.menuObject" authority-object="$ctrl.authorityObject"></menu-common-component><article class="env-operate-container" form-disable-common-directive="" dir-disable="$ctrl.authorityObject.edit==0" ng-class="{\'submitted_form_haido\':$ctrl.data.submitted}"><form autocomplete="off" class="form-ac" name="ConfirmForm"><p class="mb10 pt20"><b>数据库连接名称</b></p><div><input autocomplete="off" name="dbConnectName" ng-model="$ctrl.ajaxResponse.dbConnectName" class="eo-input" type="text" maxlength="255" ng-class="{\'eo-input-error\':ConfirmForm.dbConnectName.$invalid&&$ctrl.data.submitted}" required=""><p class="eo-error-tips">请填写数据库连接名称</p></div><p class="mt20 mb10"><b>备注</b></p><p><input autocomplete="off" name="dbDesc" ng-model="$ctrl.ajaxResponse.dbDesc" class="eo-input" type="text"></p><p class="mt20 mb10"><b>数据库类型</b></p><select-default-common-component class="w_250 mb20" output="$ctrl.ajaxResponse" model-key="dbType" required="true" input="{query:$ctrl.CONST.DABASE_TYPE,key:\'key\',value:\'value\',initialData:$ctrl.ajaxResponse.dbType}" input-change-fun="$ctrl.fun.changeDbType()"></select-default-common-component><div class="mt20 mb10"><p><b>数据库连接配置</b></p><p class="c999 mt10">可以设置每个项目环境下使用不同的数据库连接信息，当系统找不到某个环境下的数据库连接信息时会自动使用默认的连接配置。</p></div><div class="eo-block-container"><list-block-common-component list="$ctrl.ajaxResponse.dbInfoList" other-object="$ctrl.data.testObj" main-object="$ctrl.component.blockListConf" authority-object="$ctrl.authorityObject"></list-block-common-component></div></form></article><loading-common-component fun="$ctrl.fun.init(arg)"></loading-common-component>')}]);
"use strict";angular.module("eolinker.ams").run(["$templateCache",function(e){e.put("Ams_GenerateApiModal",'<div class="generate_api_modal eo-modal common-modal"><form autocomplete="off" name="Form"><header class="eo-modal-header"><span ng-bind="::input.title"></span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.closeModal()"></button></header><generate-api-doc-component bind-fun="fun.closeModal(arg)" input="input.ajaxRequest"></generate-api-doc-component></form></div><div class="eo_theme_modal_mask" ng-click="cancel()"></div>'),e.put("Ams_ResponseDemoModal",'<div class="ams-modal-response-demo eo-modal common-modal"><form name="ConfirmForm"><header class="eo-modal-header"><span>返回示例</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><div><p>示例名称</p><p class="mt10"><input class="eo-input w_100percent" autocomplete="off" name="name" type="text" ng-model="output.name" disabled="" maxlength="32" ng-class="{\'eo-input-error\':ConfirmForm.name.$invalid&&data.submitted}" required=""></p><p class="mt20 mb10">HTTP Status Code</p><div class="mt10 w_100percent"><p><select-default-common-component output="output" model-key="code" required="true" input="{query:CONST.STATUS_CODE_QUERY,key:\'key\',value:\'value\',initialData:output.code||\'200\'}"></select-default-common-component></p><div class="mt10"><input autocomplete="off" type="text" class="eo-input w_100percent" ng-if="output.code==\'0\'" placeholder="Http Code(默认200)" ng-model="output.customCode" ng-pattern="/^[1-9]\\d{2}$/" ng-class="{\'eo-input-error\':data.submitted&&!output.customCode}"><p class="eo-error-tips">请填写正确的状态码</p></div></div><p class="mt20 mb10">Content-Type</p><div class="w_100percent"><auto-complete-ams-component model="output" key-name="contentType" array="CONST.CONTENT_TYPE_ARR" placeholder="默认text/html; charset=UTF-8"></auto-complete-ams-component></div></div><div class="mt20 mb10"><span>示例内容</span> <span class="ml5" ng-class="{\'cr\':output.text.length>CONST.demoMaxLen}">({{(output.text.length||0)+\' / \'+CONST.demoMaxLen}})</span> <span class="cr ml5" ng-if="output.text.length>CONST.demoMaxLen">Mock API返回内容过长，超出部分在保存时将会被自动截断!</span><p></p></div><ace-editor-ams-component class="w_100percent" ng-class="{\'b_cr\':output.text.length>CONST.demoMaxLen}" set-model="output.text" id="_Mock_Ace_Editor_Js"></ace-editor-ams-component></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" ng-click="fun.confirm()">确定</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("Ams_PullApiSettingModal",'<div class="pull_api_setting_modal modal-sure eo-modal common-modal"><header class="eo-modal-header"><span>同步设置</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article po_re"><h4 class="mb10">基础信息</h4><tab-select-common-component main-object="component.basicInfoTabSelect" interaction="output.baseInfo"></tab-select-common-component><h4 class="mt20 mb10">请求参数</h4><tab-select-common-component main-object="component.requestInfoTabSelect" interaction="output.requestParam"></tab-select-common-component><h4 class="mt20 mb10" ng-if="input.type!==\'apiCase\'">返回参数</h4><tab-select-common-component ng-if="input.type!==\'apiCase\'" main-object="component.responseInfoTabSelect" interaction="output.responseParam"></tab-select-common-component><h4 class="mt20 mb10">增量更新设置</h4><tab-select-common-component main-object="component.settingTabSelect" interaction="output"></tab-select-common-component></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" type="submit" ng-click="fun.confirm()">确定</button> <button class="eo_theme_btn_default" type="button" ng-click="fun.cancel()">取消</button></footer><form></form></div><div class="eo_theme_modal_mask"></div>'),e.put("Ams_TestPlanModal",'<div class="modal_test_template eo-modal common-modal"><header class="eo-modal-header"><span>{{CONST.TITLE_OBJ[input.type]}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article po_re"><menu-common-component main-object="component.menuObject"></menu-common-component><list-default-common-component ng-hide="!ajaxResponse.query" main-object="component.listDefaultCommonObject.mainObject" list="ajaxResponse.query" page-object="{pageInfo:data.pagination}" authority-object="{operate:input.type===\'manage\',\'edit\':service.authority.permission.automatic.sceneCase.edit}" other-object="{selectedPlanID:data.selectedPlanID}"></list-default-common-component><loading-part-common-component fun="fun.init(arg)"></loading-part-common-component></article><form name="ConfirmForm"><div class="eo-modal-footer f_row f_ac" ng-if="input.type===\'save\'||input.type===\'edit\'"><span>测试方案名称：</span><input type="text" class="eo-input fg1" ng-change="fun.planNameChange()" ng-model="data.planName" name="planName" ng-class="{\'eo-input-error\':data.submitted&&ConfirmForm.planName.$invalid}" required=""></div><footer class="eo-modal-footer"><button class="eo_theme_btn_success" ng-if="input.type!==\'manage\'" type="submit" ng-click="fun.confirm()">确定</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">关闭</button></footer><form></form></form></div><div class="eo_theme_modal_mask"></div>'),e.put("Ams_Plug_TipsModal",'<div class="modal-sure eo-modal"><form autocomplete="off" name="sureForm"><header class="eo-modal-header"><span>浏览器插件测试须知</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><p>您正在使用插件进行测试，无法执行数据库操作。</p><br><p>建议您下载桌面客户端进行测试，桌面端支持对本地进行测试、支持执行数据库操作，并且不需要安装浏览器测试插件。</p><br><p>您也可以切换到服务器测试，但服务器无法对本地进行测试。</p><br><p>或者继续使用插件进行测试，但插件会自动跳过数据库操作的步骤。</p></article><footer class="eo-modal-footer f_row f_js_ac"><div><button class="eo_theme_btn_success" ng-click="fun.confirm({excutor:\'pc\'})">下载桌面端进行测试</button> <button class="eo_theme_btn_info" ng-click="fun.confirm({excutor:\'server\'})">使用服务器进行测试</button> <button class="eo_theme_btn_success batch-test-btn" id="plug_tips_modal_test_btn" testing="true" eo-attr-excute-type="{{input.excuteType}}" ng-click="fun.confirm({excutor:\'plug\'})">使用插件进行测试</button></div><div class="f_row f_ac"><label class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':data.hideTips}" ng-click="fun.hideTip()"></label><span class="ml5">不再提示</span></div></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("Ams_InsertSqlCodeModal",'<div class="ams-modal-insert-sql-code eo-modal common-modal"><form name="ConfirmForm"><header class="eo-modal-header"><span>插入数据库操作</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><div><p>测试步骤名称</p><p class="mt10"><input class="eo-input w_100percent" autocomplete="off" name="oprName" type="text" ng-model="output.name" maxlength="32" ng-class="{\'eo-input-error\':ConfirmForm.oprName.$invalid&&data.submitted}" required=""></p><p class="mt10">数据库连接</p><div class="mt10 w_300"><select-default-common-component main-object="component.dbSelectObj" output="output" model-key="dbID" required="true" input="{query:input.dbList,key:\'dbConnectName\',value:\'dbID\',initialData:output.dbID}"></select-default-common-component></div></div><p class="mt10" ng-class="{\'eo-status-error\':!output.sqlCode&&data.submitted}">编写SQL</p><ace-editor-ams-component class="mt10" set-model="output.sqlCode" min-line="15" type="sql"></ace-editor-ams-component></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" ng-click="fun.insert()">插入</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("Ams_SqlUseTipModal",'<div class="ams-modal-sql-use-tip eo-modal common-modal"><form name="ConfirmForm"><header class="eo-modal-header"><span>SQL编写提示</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><div><p><b>SQL示例：</b></p><div class="lh_30 mt10 container_demo_dmsut"><p>SELECT</p><p><span class="color1_dmsut plr20 fs12 ptb5 c333">name</span></p><p>FROM</p><p><span class="color2_dmsut plr20 fs12 ptb5 c333">table_name</span></p><p>WHERE</p><p><span class="color3_dmsut plr20 fs12 ptb5 c333">user_id = ${uid};</span><span class="pl10 c999">可以在SQL语句中使用${参数名}可以作为变量。</span></p></div></div><div class="mt30 ta_j lh_1point75"><p><b>小贴士：</b></p><p>1.请先选择数据源，再编写SQL语句。</p><p>2.如果想要在SQL语句中将"${}"作为普通字符串使用，需要在前面加上反斜杠"\\"进行转义。如"\\${hello}"</p></div></article><footer class="eo-modal-footer"><button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">关闭</button></footer></form></div><loading-common-component fun="fun.generateApi(arg)" interaction="{request:{delay:true}}"></loading-common-component><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ShowDbFieldModal",'<div class="ams_show_db_field eo-modal common-modal"><header class="eo-modal-header"><span>预览数据库字段信息</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><div class="eo-modal-article"><div class="p20 bbd"><p class="title mb15">字段名&nbsp;[Name]</p><p class="fwb fs16 wb_all">{{input.fieldName}}</p><p class="eo-error-tips">请填写字段名</p><div class="mt15"><span class="btn" ng-class="{\'btn-yellowfill\':input.isPrimaryKey}">主键</span> <span class="btn" ng-class="{\'btn-bluefill\':input.isNotNull}">必填</span> <span class="btn" ng-class="{\'btn-greenfill\':input.autoIncrement}">自增</span></div></div><div class="p20 bbd"><p class="title mb15">描述&nbsp;[Comment]&nbsp;(选填)</p><p class="wb_all">{{input.fieldDesc||\'暂无描述\'}}</p></div><div class="p20 bbd"><p class="title mb15">类型&nbsp;[Type]&nbsp;</p><p class="mb15">{{input.fieldType||\'暂无\'}}</p><p class="eo-error-tips">请填写类型</p><p class="title mtb15">长度&nbsp;[Length]&nbsp;(选填)</p><p class="mb15">{{input.fieldLength||\'暂无\'}}</p><p class="eo-error-tips">请填写正确的长度</p><p class="title mb15">进制&nbsp;[Decimals]&nbsp;(选填)</p><p>{{input.fieldDecimals.toString()||\'暂无\'}}</p></div><div class="p20 bbd"><p class="title mtb15">默认值&nbsp;[Default]&nbsp;(选填)</p><p class="mb15 wb_all">{{input.defaultValue||\'暂无\'}}</p></div><div class="p20 bbd"><p class="title mb15">值可能性&nbsp;[Value List]&nbsp;(选填)</p><div class="eo-block-container"><list-block-common-component list="input.valueList" main-object="component.blockListObject.value"></list-block-common-component><div class="eo-none-tr tac" ng-if="!input.valueList.length">暂无值可能性</div></div></div><div class="p20 pb70"><p class="title mb15">备注&nbsp;[Note]&nbsp;(选填)</p><p class="wb_all">{{input.fieldNote||\'暂无\'}}</p></div></div><footer class="eo-modal-footer"><button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button></footer></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_SelectDbFieldModal",'<div class="ams_select_db_field eo-modal common-modal"><header class="eo-modal-header"><span>引用数据库字段</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><div class="eo-modal-article"><p class="eo_form_first_item_title">请选择字段</p><div class="f_row"><list-block-common-component class="eo-block-container" other-object="{submitted:data.submitted}" main-object="component.blockListObject.db" list="ajaxRequest.dbArr"></list-block-common-component></div></div><footer class="eo-modal-footer"><button type="submit" class="eo_theme_btn_success" ng-click="fun.confirm()">确定</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.close()">取消</button></footer></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_GlobalSearchModal",'<div class="ams_global_search eo-modal"><header class="eo-modal-header"><span>全局搜索</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><div class="eo-modal-article"><form autocomplete="off" name="ConfirmForm"><div class="search_bar_div ptb10"><a class="iconfont icon-sousuo fs16" ng-click="fun.search()"></a> <input autocomplete="off" type="text" name="keyword" ng-model="data.keyword" placeholder="搜索" class="eo-input" ng-class="{\'eo-input-error\':(data.submitted&&ConfirmForm.keyword.$invalid)}" required=""> <button class="hidden" ng-click="fun.search()"></button></div><div class="search_content_div f_row"><div class="search_result_wrap"><loading-part-common-component fun="fun.search()"></loading-part-common-component><div class="spac_search_result_box" ng-if="ajaxResponse.searchResult.caseList.length" ng-click="fun.clickResult({$event:$event,module:\'amsCase\'})"><div class="spac_search_result_title spac_search_result_first_title" ng-if="data.searchType===-1"><span class="w_100">流程测试用例</span></div><div class="spac_search_result_item f_row f_js_ac" ng-repeat="item in ajaxResponse.searchResult.caseList" eo-attr-index="{{$index}}"><div class="f_column lh_20 w_80percent"><p class="text_omit" ng-bind-html="item.caseNameHtml"></p><p class="fs12 c9 text_omit" ng-if="item.caseTagHtml"><span>Tag：</span> <span ng-bind-html="item.caseTagHtml"></span></p></div><span class="text_omit">{{item.projectName}}</span></div><div class="divide_div" ng-if="ajaxResponse.searchResult.projectList.length"></div></div><div class="spac_search_result_box" ng-if="ajaxResponse.searchResult.apiList.length" ng-click="fun.clickResult({$event:$event,module:\'api\'})"><div class="spac_search_result_title spac_search_result_first_title" ng-if="data.searchType===-1"><span class="w_100">API</span></div><div class="spac_search_result_item f_row f_js_ac" ng-repeat="item in ajaxResponse.searchResult.apiList" eo-attr-index="{{$index}}"><div class="f_row f_ac w_80percent"><span class="api_status fs12 mr10 eo-label-{{CONST.API_STATUS_QUERY[item.apiStatus].class}}">{{CONST.API_STATUS_QUERY[item.apiStatus].key}}</span><div class="f_column lh_20 w_80percent"><p class="text_omit" ng-bind-html="item.apiURIHtml"></p><p class="text_omit" ng-bind-html="item.apiNameHtml"></p></div></div><span class="text_omit">{{item.projectName}}</span></div><div class="divide_div" ng-if="ajaxResponse.searchResult.projectList.length||ajaxResponse.searchResult.statusCodeList.length||ajaxResponse.searchResult.documentList.length"></div></div><div class="spac_search_result_box" ng-if="ajaxResponse.searchResult.projectList.length" ng-click="fun.clickResult({$event:$event,module:\'project\'})"><div class="spac_search_result_title" ng-if="data.searchType===-1"><span class="w_100">项目</span></div><div class="spac_search_result_item f_row f_js_ac" ng-repeat="item in ajaxResponse.searchResult.projectList" eo-attr-index="{{$index}}"><div class="f_column lh_20 w_80percent"><p class="text_omit" ng-bind-html="item.projectNameHtml"></p><span class="fs12 c9 text_omit">{{item.projectUpdateTime}}</span></div><span ng-if="item.isArchive" class="p5 fs12 eo-color-tips-shallow">归档</span></div><div class="divide_div" ng-if="ajaxResponse.searchResult.statusCodeList.length||ajaxResponse.searchResult.documentList.length"></div></div><div class="spac_search_result_box" ng-if="ajaxResponse.searchResult.statusCodeList.length" ng-click="fun.clickResult({$event:$event,module:\'code\'})"><div class="spac_search_result_title" ng-if="data.searchType===-1"><span class="w_100">状态码</span></div><div class="spac_search_result_item f_row f_js_ac" ng-repeat="item in ajaxResponse.searchResult.statusCodeList" eo-attr-index="{{$index}}"><div class="f_column lh_20 w_80percent"><p class="text_omit" ng-bind-html="item.codeHtml"></p><p class="text_omit" ng-bind-html="item.codeDescriptionHtml"></p></div><span class="text_omit">{{item.projectName}}</span></div><div class="divide_div" ng-if="ajaxResponse.searchResult.documentList.length"></div></div><div class="spac_search_result_box" ng-if="ajaxResponse.searchResult.documentList.length" ng-click="fun.clickResult({$event:$event,module:\'doc\'})"><div class="spac_search_result_title" ng-if="data.searchType===-1"><span class="w_100">项目文档</span></div><div class="spac_search_result_item f_row f_js_ac" ng-repeat="item in ajaxResponse.searchResult.documentList" eo-attr-index="{{$index}}"><div class="f_column lh_20 w_80percent"><p class="text_omit" ng-bind-html="item.titleHtml"></p><span class="fs12 c9 text_omit">{{item.updateTime}}</span></div><span class="text_omit">{{item.projectName}}</span></div></div><div class="spac_no_search_result_box" ng-if="data.isEmpty===true">暂无搜索结果</div></div><div class="search_result_sidebar ptb10 plr20"><b>搜索内容</b><ul class="search_result_sidebar_ul mt10" ng-click="fun.clickSidebar({$event:$event})"><li class="sidebar_item cp" eo-attr-index="{{$index}}" ng-repeat="item in CONST.SEARCH_SIDEBAR_ITEM" ng-class="{\'cb\':item.value===data.searchType}">{{item.name}}</li></ul></div></div></form></div><footer class="eo-modal-footer"><button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button></footer></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_MockPreviewModal",'<div class="ams-modal-mock-preview eo-modal"><form name="ConfirmForm"><header class="eo-modal-header"><span>预览Mock API：{{ajaxResponse.expectationName}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><loading-part-common-component fun="fun.init()"></loading-part-common-component><div class="eo-modal-article"><p class="eo_form_first_item_title" ng-if="ajaxResponse.triggerCondition.urlParam.length&&ajaxResponse.triggerCondition.headerParam.length&&ajaxResponse.triggerCondition.bodyParam.length">当请求中包含以下信息时：</p><div class="mt10" ng-repeat="item in CONST.MOCK_POSITION_MENU" ng-if="ajaxResponse.triggerCondition[item.value].length"><p class="mtb15 title_ammp"><span>{{item.key}}</span> <span class="eo-color-back fs12 plr5 ptb2 mr5" ng-if="item.value===\'bodyParam\'">{{CONST.BODY_PARAM_MENU[ajaxResponse.triggerCondition.bodyParamType]}}</span> <span class="eo-color-back fs12 plr5 ptb2 mr5" ng-if="ajaxResponse.triggerCondition.bodyParamType==\'1\'">最外层结构为：{{ajaxResponse.triggerCondition.bodyParamJsonType===\'1\'?\'Array\':\'Object\'}}</span></p><list-block-common-component class="eo-block-container" ng-hide="item.value===\'bodyParam\'&&ajaxResponse.triggerCondition.bodyParamType!==\'0\'" list="ajaxResponse.triggerCondition[item.value]" main-object="component.blockListObject.triggerCondition"></list-block-common-component><list-block-common-component class="eo-block-container" ng-show="item.value===\'bodyParam\'&&ajaxResponse.triggerCondition.bodyParamType!==\'0\'" list="ajaxResponse.triggerCondition.jsonBodyParam" main-object="component.blockListObject.jsonTriggerCondition" other-object="{bodyParamType:ajaxResponse.triggerCondition.bodyParamType}"></list-block-common-component></div><div><p class="eo_form_item_title">返回以下结果</p><div class="f_row"><span class="label_ammp mr10">Response HTTP Code：{{ajaxResponse.responseHttpCode}}</span> <span class="label_ammp">Response Delay：{{ajaxResponse.responseDelay}}ms</span></div><div ng-if="ajaxResponse.responseHeader.length"><p class="fs12 mt10 mb5">返回头部（Response Header）</p><list-block-common-component main-object="component.blockListObject.responseHeader" class="eo-block-container" list="ajaxResponse.responseHeader"></list-block-common-component></div><p class="fs12 mt10 mb5">返回数据（Response Body）</p><div class="eo-block-container p10"><button class="checkbox-btn send-format" arrange-format="mock_js_1" format-status="data.formatStatus" ng-model="ajaxResponse.mockResult"><span class="eo-checkbox pull-left iconfont" ng-class="{\'icon-duihao\':data.formatStatus==2}">{{data.formatStatus==2?\'\':\'&nbsp;\'}}</span> <span>格式整理</span></button><pre class="mt10 mock_result_ammp" id="mock_js_1"></pre></div></div></div><footer class="eo-modal-footer"><button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button> <button type="button" ng-class="{\'eo_theme_btn_disabled\':ajaxResponse.triggerCondition.bodyParamType===\'2\'}" class="eo_theme_btn_info" ng-click="fun.goToTestPreviewMockData()" ng-if="input.authority.test">在测试界面中预览</button></footer></form><div move-tip-directive="" parent-class-name="eo-modal-footer" able-class-name="eo_theme_btn_disabled" tips-style=\'{"top":-5}\' tips-text="当使用JSON Path方式校验参数时，不支持在测试界面预览Mock API"></div></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_MockSettingModal",'<div class="ams-modal-mock-setting eo-modal"><form name="ConfirmForm"><header class="eo-modal-header"><span>{{data.title}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><loading-part-common-component fun="fun.init()"></loading-part-common-component><div class="eo-modal-article"><div><p class="eo_form_first_item_title">Mock API期望名称</p><input class="eo-input w_100percent" name="mockName" ng-model="ajaxResponse.expectationName" autocomplete="off" type="text" maxlength="32" ng-class="{\'eo-input-error\':ConfirmForm.mockName.$invalid&&(ConfirmForm.mockName.$dirty||data.submitted)}" required=""><p class="eo-error-tips">请填写Mock API期望名称</p></div><p class="eo_form_item_title">请求触发条件（当请求信息中包含以下信息时返回指定内容）</p><div class="eo-block-container mt10"><div class="eo-tab-menu f_row_ac"><div class="item-tab" ng-repeat="item in CONST.MOCK_POSITION_MENU" ng-class="{\'active-item\':data.menuType==item.value}" ng-click="data.menuType=item.value"><span class="iconfont icon-circle" ng-show="ajaxResponse.triggerCondition[item.value].length>1"></span> <span>{{item.key}}</span></div></div><div class="plr10" ng-if="data.menuType===\'bodyParam\'"><menu-radio-common-component list="CONST.BODY_PARAM_MENU" output="ajaxResponse.triggerCondition" model-key="bodyParamType" bind-fun="fun.changeBodyType(arg)"></menu-radio-common-component><div ng-show="ajaxResponse.triggerCondition.bodyParamType != 0"><p class="c9 fs12 ptb10">JSON 参数定位方式：</p><select-default-common-component class="mr10 w_250" output="data" model-key="positionType" required="true" input="{query:CONST.JSON_MATCH_POSITION_TYPE_ARR,key:\'key\',value:\'value\',initialData:data.positionType||0}" input-change-fun="fun.changeJsonMatchPositionType()"></select-default-common-component><p class="c9 fs12 ptb10" ng-hide="data.positionType===1">JSON 根类型：</p><div class="f_row" ng-hide="data.positionType===1"><select-default-common-component class="pull-left mr10 w_250" output="ajaxResponse.triggerCondition" model-key="bodyParamJsonType" required="true" input="{query:CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:ajaxResponse.triggerCondition.bodyParamJsonType||\'0\'}"></select-default-common-component><select-default-common-component class="w_250" ng-show="ajaxResponse.jsonResultVerification.resultType==1" output="ajaxResponse.jsonResultVerification" model-key="matchRule" required="true" input="{query:CONST.matchLoopQuery,key:\'key\',value:\'value\',initialData:ajaxResponse.jsonResultVerification.matchRule||\'0\'}"></select-default-common-component></div></div></div><div class="plr10 mtb10" ng-show="data.menuType===\'bodyParam\'&&ajaxResponse.triggerCondition.bodyParamType!==\'0\'"><list-block-common-component class="eo-block-container" list="ajaxResponse.triggerCondition.bodyParam" main-object="component.blockListObject.jsonTriggerCondition" other-object="{\'matchRule\':CONST.matchRule,positionType:data.positionType,submitted:data.submitted}"></list-block-common-component></div><list-block-common-component ng-hide="data.menuType===\'bodyParam\'&&ajaxResponse.triggerCondition.bodyParamType!==\'0\'" list="ajaxResponse.triggerCondition[data.menuType]" main-object="component.blockListObject.triggerCondition" other-object="{submitted:data.submitted}"></list-block-common-component></div><div ng-show="data.isMore"><div><p class="eo_form_item_title">响应状态码（Response HTTP Status Code）</p><input class="eo-input" name="responseHttpCode" ng-model="ajaxResponse.responseHttpCode" autocomplete="off" type="text" ng-pattern="/^[1-9]\\d{2}$/" ng-class="{\'eo-input-error\':!ajaxResponse.responseHttpCode}" required=""><p class="eo-error-tips">请填写预期响应状态码</p></div><div><p class="eo_form_item_title">响应头部（Response Header）</p><list-block-common-component main-object="component.blockListObject.responseHeader" list="ajaxResponse.responseHeader" class="eo-block-container"></list-block-common-component></div><div><p class="eo_form_item_title">响应延迟时间（Response Delay Time）</p><div><input class="eo-input" name="responseDelay" ng-model="ajaxResponse.responseDelay" autocomplete="off" type="number" min="0" max="3000" ng-class="{\'eo-input-error\':ConfirmForm.responseDelay.$invalid}" required=""> <span class="c999 ml5" ng-class="{\'eo-input-error\':ConfirmForm.responseDelay.$invalid}">ms</span><p class="eo-error-tips">请填写正确的响应延迟时间</p></div></div></div><div class="mt20"><button type="button" class="eo-operate-btn" ng-click="data.isMore=!data.isMore"><span>更多设置</span> <span class="iconfont" ng-class="{\'icon-xuanzeqishouqi_o\':data.isMore,\'icon-xuanzeqizhankai_o\':!data.isMore}"></span></button></div><div><p class="eo_form_item_title">响应内容</p><div><menu-radio-common-component class="pull-left mr5" list="CONST.MOCK_TYPE_ARR" output="ajaxResponse" model-key="responseBodySettingType" bind-fun="fun.changeMockRuleType(arg)"></menu-radio-common-component><div ng-show="ajaxResponse.responseBodySettingType===0"><span class="plr10 menu-divide-span">|</span><div class="eo-more-btn-container"><button class="eo_more_btn f_row_ac" type="button" other-obj="{target:ajaxResponse.mockRule}" eo-drop-elem="" fn-click="fun.syncApiDoc()" text-arr="CONST.INSERT_TYPE_ARR"><span class="iconfont icon-daoru"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div></div></div><div class="json-root-type-div" ng-switch="ajaxResponse.responseBodySettingType"><div ng-switch-when="0"><p class="fs12 c999 mt10">JSON 根类型：</p><p class="mt10"><select-default-common-component class="w_250" output="ajaxResponse.mockConfig" model-key="type" required="true" input="{query:CONST.MOCK_JSON_TYPE_ARR,key:\'key\',value:\'value\',initialData:ajaxResponse.mockConfig.type||\'object\'}"></select-default-common-component></p><p class="fs12 c999 mt10">根数据生成规则：</p><p class="mtb10"><input autocomplete="off" class="eo-input" type="text" placeholder="请输入mock生成规则" ng-model="ajaxResponse.mockConfig.rule"></p><list-block-common-component class="eo-block-container" list="ajaxResponse.mockRule" main-object="component.blockListObject.mockRule"></list-block-common-component></div><div class="mt10" ng-switch-when="1"><textarea class="eo-textarea" ng-model="ajaxResponse.mockRule"></textarea></div><div class="mt10" ng-switch-when="2"><ace-editor-ams-component class="ace-editor-container" set-model="ajaxResponse.mockRule" type="automated-javascript" min-line="25"></ace-editor-ams-component></div></div></div></div><footer class="eo-modal-footer" ng-switch="info.btnType"><button type="submit" class="eo_theme_btn_success" button-set-disable-directive="fun.submitForm()">确定</button> <button type="button" class="eo_theme_btn_info" ng-click="fun.previewMockData()">预览</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ChartAndTableModal",'<div class="ams-modal-chart-and-table eo-modal"><form autocomplete="off" name="sureForm"><header class="eo-modal-header"><span>{{input.title}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><article class="eo-modal-article"><div ng-if="data.pagination.msgCount" echart-common-directive="" style="height:120px;width:560px;" class="echart mb30" ng-model="component.chart"></div><list-block-common-component main-object="component.blockListObject.mainObject" page-object="data.pagination" list="data.query"></list-block-common-component><div class="eo-none-tr tac" ng-if="!data.query.length">暂无数据</div></article><footer class="eo-modal-footer" ng-switch="info.btnType"><button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_PlugApiStatusModal",'<div class="ams-modal-plug-api-status eo-modal"><form autocomplete="off" name="sureForm"><header class="eo-modal-header"><span>{{input.title}}</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.close()"></button></header><article class="eo-modal-article"><div><ul class="f_row f_wrap"><li class="status-tab f_row f_jc_ac cp mb10" ng-click="fun.changeApiStatus({item:item})" ng-class="{\'elem-active\':input.item.value==item.value}" ng-repeat="item in input.array"><span class="iconfont icon-circle eo-status-{{item.class}}"></span>{{item.key}}({{item.count||0}})</li></ul><list-block-common-component ng-show="interaction.response.query" list="interaction.response.query" main-object="component.blockListObject.mainObject" page-object="data.pagination"></list-block-common-component><div class="eo-none-tr tac" ng-if="interaction.response.query.length==0">暂无任何API</div><loading-part-common-component fun="fun.init()"></loading-part-common-component></div></article><footer class="eo-modal-footer" ng-switch="info.btnType"><button type="button" class="eo_theme_btn_default" ng-click="fun.close()">关闭</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ExportModal",'<a id="dump_directive_js" class="hidden"></a><div class="ams-modal-export eo-modal" ng-class="{\'ams-modal-export-common\':input.mark==\'common\',\'ams-modal-export-except-html\':input.mark==\'exceptHtml\',\'ams-modal-export-two\':input.mark==\'eolinkerAndExcel\'}"><form autocomplete="off" name="Form"><header class="eo-modal-header"><span ng-bind="::input.title"></span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><ul><li ng-if="input.mark==\'common\'"><ul class="modal-btn-group-ul"><li class="pull-left first-li"><a class="eo-export" ng-click="data.exportType=0" ng-class="{\'active-a\':data.exportType==0}"><p>EOLINKER</p></a></li></ul></li><li ng-if="input.mark==\'eolinkerAndExcel\'"><ul class="modal-btn-group-ul"><li class="pull-left first-li"><a class="eo-export" ng-click="data.exportType=0" ng-class="{\'active-a\':data.exportType==0}"><p>EOLINKER</p></a></li><li class="pull-left excel-li"><a class="eo-export" ng-click="data.exportType=5" ng-class="{\'active-a\':data.exportType==5}"><p>EXCEL</p></a></li></ul></li><li ng-if="input.mark==\'exceptHtml\'"><ul class="modal-btn-group-ul"><li class="pull-left first-li"><a class="eo-export" ng-click="data.exportType=0" ng-class="{\'active-a\':data.exportType==0}"><p>EOLINKER</p></a></li><li class="pull-left disable-li pdf-li" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>PDF</p></a></li><li class="word-li disable-li pull-left" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>WORD</p></a></li><li class="markdown-li disable-li pull-right" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>MARKDOWN</p></a></li><li class="pull-left pdf-li" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=2" ng-class="{\'active-a\':data.exportType==2}"><p>PDF</p></a></li><li class="word-li pull-left" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=3" ng-class="{\'active-a\':data.exportType==3}"><p>WORD</p></a></li><li class="markdown-li pull-right" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=4" ng-class="{\'active-a\':data.exportType==4}"><p>MARKDOWN</p></a></li></ul><p class="article-title-p" ng-hide="data.exportType==0">请选择需要导出的环境</p><p class="article-select-p" ng-hide="data.exportType==0"><select-default-common-component class="w_250" output="data" model-key="envID" required="true" input="{query:input.envList,key:\'envName\',value:\'envID\',initialData:data.envID}"></select-default-common-component></p></li><li ng-if="input.mark==\'full\'"><ul class="modal-btn-group-ul"><li class="pull-left first-li"><a class="eo-export" ng-click="data.exportType=0" ng-class="{\'active-a\':data.exportType==0}"><p>EOLINKER</p></a></li><li class="pull-left center-li"><a class="eo-export" ng-click="data.exportType=1" ng-class="{\'active-a\':data.exportType==1}"><p>离线网页</p></a></li><li class="pull-left disable-li pdf-li" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>PDF</p></a></li><li class="word-li disable-li pull-left" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>WORD</p></a></li><li class="markdown-li disable-li pull-left" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>MARKDOWN</p></a></li><li class="openapi-li disable-li pull-right" ng-if="input.version==\'free\'" ng-click="fun.noticeUpgrade()"><a><p>Swagger</p></a></li><li class="pull-left pdf-li" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=2" ng-class="{\'active-a\':data.exportType==2}"><p>PDF</p></a></li><li class="word-li pull-left" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=3" ng-class="{\'active-a\':data.exportType==3}"><p>WORD</p></a></li><li class="markdown-li pull-left" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=4" ng-class="{\'active-a\':data.exportType==4}"><p>MARKDOWN</p></a></li><li class="openapi-li pull-right" ng-if="input.version!=\'free\'"><a class="eo-export" ng-click="data.exportType=\'openApi\'" ng-class="{\'active-a\':data.exportType==\'openApi\'}"><p>Swagger</p></a></li></ul><p class="article-title-p" ng-if="data.exportType==\'openApi\'">请选择需要导出的格式</p><p class="article-select-p" ng-if="data.exportType==\'openApi\'"><select-default-common-component class="w_250" output="data" model-key="type" required="true" input="{query:component.openApiExportFormatObj,key:\'key\',value:\'value\',initialData:data.type}"></select-default-common-component></p><p class="article-title-p" ng-hide="data.exportType==0">请选择需要导出的环境</p><p class="article-select-p" ng-hide="data.exportType==0"><select-default-common-component class="w_250" output="data" model-key="envID" required="true" input="{query:input.envList,key:\'envName\',value:\'envID\',initialData:data.envID}"></select-default-common-component></p></li></ul></article><footer class="eo-modal-footer"><div class="eo_theme_btn_success btn-style-div" dump-directive="fun.dumpDirective(arg)" setting=\'{text:"导出",switch:data.exportType,broadcast:"export-by-one-key"}\'></div><button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">关闭</button></footer></form></div><div class="eo_theme_modal_mask" ng-click="cancel()"></div>'),
e.put("AMS_AutomatedTest_EditCaseModal",'<div class="ams-modal-automated-test-edit eo-modal"><form autocomplete="off" name="ConfirmForm"><header class="eo-modal-header" ng-switch="input.status"><span ng-switch-default="">新建用例</span> <span ng-switch-when="edit">编辑用例</span> <span ng-switch-when="copy">复制用例</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><ul><li class="eo_form_first_item_title">用例名称</li><li class="common-li"><input autocomplete="off" type="text" name="caseName" ng-model="input.caseInfo.caseName" placeholder="用例名称" class="eo-input" ng-class="{\'eo-input-error\':(submitted&&ConfirmForm.caseName.$invalid)}" autofocus="true" required=""></li><li ng-if="input.status==\'add\'"><tip-common-component input="{btnClose:1,value:\'EO_MERGE_UI_AND_CODE_CASE_TIPS_WARNING\',type:\'text\',status: \'warning\',text:\'新版本中已经将 UI 类型测试用例与脚本类型合并，如需创建测试脚本，您可在用例中添加“脚本 [Javascript]”。\'}"></tip-common-component></li><li class="container-li common-li"><ul class="group-select group-ul"><li class="eo_form_item_title">分组</li><li><select-multistage-common-component output="component.selectMultistageCommonComponentObject" input="{query:input.group.parent,key:\'groupName\',value:\'groupID\',groupID:output.groupID}"></select-multistage-common-component></li></ul></li><li class="eo_form_item_title"><span>用例Tag</span> <span class="iconfont icon-guanyu_o fw_initial" eo-attr-tip-left="-5" eo-attr-tip-placeholder="case_tag"></span> <span class="ml5 c9 fs12">(选填)</span></li><li class="common-li"><input autocomplete="off" type="text" name="caseTag" ng-model="input.caseInfo.caseTag" placeholder="可以填写多个并且用逗号隔开" class="eo-input" ng-class="{\'eo-input-error\':(submitted&&ConfirmForm.caseName.$invalid)}" autofocus="true"></li></ul></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" ng-click="fun.confirm()">确认</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_CodeModal",'<div class="ams-modal-code eo-modal"><form autocomplete="off" name="ConfirmForm"><header class="eo-modal-header"><span ng-bind="::title"></span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="cancel()"></button></header><article class="eo-modal-article"><ul><li class="eo_form_first_item_title">状态码分组</li><li class="code-group"><select-multistage-common-component output="component.selectMultistageCommonComponentObject" input="{query:query,key:\'groupName\',value:\'groupID\',groupID:info.groupID}"></select-multistage-common-component></li></ul><p class="eo_form_item_title">状态码列表</p><div class="eo-block-container"><list-block-common-component other-object="{submitted:submitted}" list="interaction.request.statusCode" main-object="component.blockListObject.query.mainObject"></list-block-common-component></div></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" button-set-disable-directive="ok()">确定</button> <button type="button" class="eo_theme_btn_success" ng-if="info.isAdd" button-set-disable-directive="keep()">继续新建</button> <button type="button" class="eo_theme_btn_default" ng-click="cancel()">取消</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_AutomatedTest_BeforeCaseModal",'<div class="ams-modal-automated-before-case eo-modal"><header class="eo-modal-header"><span>选择插入的{{data.title}}置用例</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><div class="first_level_article"><table><thead><tr><th>用例名</th><th class="person-field">创建者</th><th class="time-field">更新时间</th></tr></thead><tbody><tr ng-repeat="item in interaction.response.caseList" ng-click="fun.click({item:item})" ng-class="{\'elem-active\':item.isClick}"><td>{{item.caseName}}</td><td class="person-field">{{item.creator}}</td><td class="time-field">{{item.updateTime}}</td></tr><tr class="none-tr" ng-hide="interaction.response.caseList.length>0"><td colspan="3">没有可插入的{{data.title}}置用例</td></tr></tbody></table></div></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" button-set-disable-directive="fun.confirm()">确认</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">关闭</button></footer></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ReportModal",'<a id="dump_directive_js" class="hidden"></a><div class="hidden" dump-directive="fun.download(arg)" setting=\'{switch:"TestWordFile"}\'></div><div class="ams-modal-report eo-modal"><header class="eo-modal-header"><span>下载测试报告</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><list-block-common-component ng-if="interaction.response.query.length" list="interaction.response.query" main-object="component.blockListObject.mainObject"></list-block-common-component><div ng-if="interaction.response.query.length==0" class="eo-none-tr tac">暂无测试报告</div></article><footer class="eo-modal-footer"><button class="eo_theme_btn_danger" ng-if="data.authority" ng-click="fun.clear()">清空测试报告</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">关闭</button></footer></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_AutomatedTest_AddCaseModal",'<div class="ams-modal-automated-select-case eo-modal"><header class="eo-modal-header"><span>选择插入的用例</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><div class="eo-block-container f_row"><group-default-common-component class="brd" fun-object="component.groupCommonObject.funObject" main-object="component.groupCommonObject.mainObject" list="interaction.response.caseGroup"></group-default-common-component><div class="first_level_article"><div class="thead-div"><table class="thead-table"><thead><tr><th class="required-td"><input autocomplete="off" class="hidden" type="checkbox" id="case_checkbox_all" ng-model="data.allObject.case" ng-change="fun.all()"> <label for="case_checkbox_all" class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':data.allObject.case}">{{data.allObject.case?\'\':\'&nbsp;\'}}</label></th><th class="second-th">用例名</th><th class="third-th">创建者</th><th class="forth-th">更新时间</th></tr></thead></table></div><div class="tbody-div"><table class="tbody-table"><tbody><tr ng-repeat="item in interaction.response.caseList | filter:fun.filter" ng-class="{\'elem-active\':item.isClick}" ng-click="fun.select({item:item})"><td class="required-td"><label class="eo-checkbox iconfont" ng-class="{\'icon-duihao\':item.isClick}">{{item.isClick?\'\':\'&nbsp;\'}}</label></td><td class="second-th">{{item.caseName}}</td><td class="third-th">{{item.creator}}</td><td class="forth-th">{{item.updateTime}}</td></tr></tbody></table></div></div></div></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" button-set-disable-directive="fun.confirm()">确认</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer><div class="eo_theme_modal_mask"></div></div>'),e.put("AMS_TestExampleModal",'<div class="ams-modal-test-example-admin eo-modal"><div class="second-level-div"><header class="eo-modal-header"><span>测试用例</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><button type="button" ng-if="data.isEdit" class="eo_theme_btn_info mb20" ng-click="fun.pullApi()">同步API文档</button><p class="eo_form_first_item_title fwb">用例名称</p><form autocomplete="off" name="baseForm"><p class="case-name-p"><input autocomplete="off" type="text" name="caseName" class="eo-input" ng-model="input.caseInfo.caseName" ng-class="{\'eo-input-error\':data.submitted&&baseForm.caseName.$invalid}" required=""></p><p class="eo_form_item_title fwb">API Path</p><div class="f_row_ac"><select-default-common-component class="w_80 request_protocol_select_amtea" output="input.caseInfo.caseData" model-key="httpHeader" required="true" input="{query:CONST.requestProtocolQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.caseData.httpHeader}"></select-default-common-component><select-default-common-component class="w_80 request_type_select_amtea" output="input.caseInfo.caseData" model-key="apiRequestType" required="true" input="{query:CONST.requestMethodQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.caseData.apiRequestType||\'0\'}"></select-default-common-component><input autocomplete="off" name="uri" type="text" class="eo-input w_100percent" ng-model="input.caseInfo.caseData.URL" ng-class="{\'eo-input-error\':data.submitted&&baseForm.uri.$invalid}" ng-change="fun.changeUri()" required=""></div></form><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="data.shrinkRequestData=!data.shrinkRequestData"><span>请求参数</span><div class="shrink_text_ept"><span>{{data.shrinkRequestData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':data.shrinkRequestData,\'icon-xuanzeqishouqi\':!data.shrinkRequestData}"></span></div></div><div class="item_part mt20" ng-if="!data.shrinkRequestData"><multi-tab-component class="dp_b" other-obj="{advancedSetting:input.caseInfo.advancedSetting,injectScript:input.caseInfo.caseData.script,auth:input.caseInfo.caseData.auth,restfulParam:input.caseInfo.caseData.restfulParam.length,urlParam:input.caseInfo.caseData.urlParam.length,raw:input.caseInfo.caseData.raw,params:input.caseInfo.caseData.params,requestType:input.caseInfo.caseData.requestType,headers:input.caseInfo.caseData.headers.length}" list="CONST.REQUEST_DATA_MENU_ARR" model="data.menuType"></multi-tab-component><div class="bbd bld brd"><div ng-if="data.menuType==\'advancedSetting\'"><test-setting-ams-component bind-object="input.caseInfo.advancedSetting"></test-setting-ams-component></div><div ng-if="data.menuType==\'headers\'"><header><div class="eo-more-btn-container" set-to-params="headerName" item="{{CONST.jsonToParamObject.headerItem}}" reset-result="input.caseInfo.caseData.headers" set-value="headerValue" un-parse-type="true" import-method="2"></div></header><list-block-common-component list="input.caseInfo.caseData.headers" main-object="component.blockListObject.requestHeader.mainObject"></list-block-common-component></div><div ng-if="data.menuType==\'auth\'"><auth-ams-component auth-object="input.caseInfo.caseData.auth"></auth-ams-component></div><div ng-if="data.menuType==\'body\'"><header><div class="f_row_ac"><menu-radio-common-component list="CONST.requestTypeQuery" output="input.caseInfo.caseData" model-key="requestType" bind-fun="fun.changeBodyType(arg)"></menu-radio-common-component><span class="plr10 menu-divide-span" ng-if="input.caseInfo.caseData.requestType !=1">|</span><div class="eo-more-btn-container mr15" ng-show="input.caseInfo.caseData.requestType !=1&&input.caseInfo.caseData.requestType !=0"><button type="button" class="eo_more_btn f_row_ac" text-arr="CONST.INSERT_TYPE_ARR" other-obj="{requestType:input.caseInfo.caseData.requestType,params:input.caseInfo.caseData.params}" eo-drop-elem=""><span class="iconfont icon-daoru mr5"></span> <span>导入</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div><div class="eo-more-btn-container" ng-show="input.caseInfo.caseData.requestType==\'0\'"><button class="eo_more_btn f_row_ac" type="button" eo-drop-elem="" fn-click="fun.formToOtherType(target)" text-arr="[{key:\'Json\',value:\'json\'},{key:\'XML\',value:\'xml\'}]"><span class="iconfont icon-huopinfenliu mr5"></span> <span>转换为</span> <span class="iconfont icon-jiantou_liebiaozhankai"></span></button></div></div><div class="pt10" ng-show="input.caseInfo.caseData.requestType == \'2\'"><p class="fs12 c999">JSON&nbsp;根类型：</p><p class="mt10"><select-default-common-component class="w_250" output="input.caseInfo.caseData" model-key="apiRequestParamJsonType" required="true" input="{query:CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.caseData.apiRequestParamJsonType||\'0\'}"></select-default-common-component></p></div></header><article><div ng-if="input.caseInfo.caseData.requestType!=\'1\'"><list-block-common-component list="input.caseInfo.caseData.params" main-object="component.blockListObject.body.mainObject" other-object="{\'bodyParamType\':input.caseInfo.caseData.requestType}"></list-block-common-component></div><div class="dp_f ml20" ng-class="{\'eo-static-hidden\':input.caseInfo.caseData.requestType!=\'1\',\'mb20\':input.caseInfo.caseData.requestType==\'1\'}"><ace-editor-ams-component class="ace-editor-container" set-model="input.caseInfo.caseData.raw" id="_Raw_Ace_Editor_Js"></ace-editor-ams-component></div></article></div><div ng-if="data.menuType==\'restful\'"><list-block-common-component list="input.caseInfo.caseData.restfulParam" main-object="component.blockListObject.restful.mainObject"></list-block-common-component></div><div ng-if="data.menuType==\'url\'"><header><div class="eo-more-btn-container" set-to-params="paramKey" item="{{CONST.jsonToParamObject.requestItem}}" reset-result="input.caseInfo.caseData.urlParam" set-value="paramInfo" import-method="1"></div></header><list-block-common-component list="input.caseInfo.caseData.urlParam" main-object="component.blockListObject.queryParam.mainObject"></list-block-common-component></div><div ng-if="data.menuType==\'inject\'"><header><menu-radio-common-component list="CONST.scriptTypeQuery" output="input.caseInfo.caseData.script" model-key="type" cancle-bind-fun="true"></menu-radio-common-component></header><ace-menu-editor-ams-component class="dp_f" mark="project" set-model="input.caseInfo.caseData.script" set-variable="input.caseInfo.caseData.script.type==\'0\'?\'before\':\'after\'" watch-model="input.caseInfo.caseData.script.type"></ace-menu-editor-ams-component></div></div></div><div class="f_row_ac eo_panel_title f_js plr10 cp mt40" ng-click="data.shrinkResponseData=!data.shrinkResponseData"><span>响应内容</span><div class="shrink_text_ept"><span>{{data.shrinkResponseData?"展开":"收缩"}}</span> <span class="iconfont" ng-class="{\'icon-xuanzeqizhankai\':data.shrinkResponseData,\'icon-xuanzeqishouqi\':!data.shrinkResponseData}"></span></div></div><div class="item_part eo-block-container mt20" ng-if="!data.shrinkResponseData"><header ng-init="input.caseInfo.matchType=input.caseInfo.matchType||\'2\'"><menu-radio-common-component list="CONST.MATCH_TYPE_ARR" output="input.caseInfo" model-key="matchType" bind-fun="fun.changeResponseMatchType(arg)"></menu-radio-common-component></header><div class="regex_part"><div class="regex_part"><div ng-hide="input.caseInfo.matchType == \'2\'"><p class="match-title-p">HTTP&nbsp;Status&nbsp;Code：&nbsp;校验</p><p class="http-code-p dp_ib w_100percent" ng-class="{\'pb10\':input.caseInfo.matchType == \'5\'}"><select-default-common-component class="pull-left mr10 w_250" ng-if="input.status==\'add\'" output="input.caseInfo" model-key="statusCode" required="true" input="{query:CONST.statusCodeQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.statusCode||\'200\'}"></select-default-common-component><input autocomplete="off" type="text" class="eo-input" ng-show="input.caseInfo.statusCode==\'0\'||input.status!=\'add\'" ng-model="input.caseInfo.code"></p><div class="pb10" ng-show="input.caseInfo.matchType == 3"><p class="match-title-p pb10 pt20">JSON 参数定位方式：</p><div class="http-code-p"><select-default-common-component class="w_250" output="input.caseInfo.jsonResultVerification" model-key="positionType" required="true" input="{query:CONST.JSON_MATCH_POSITION_TYPE_ARR,key:\'key\',value:\'value\',initialData:input.caseInfo.jsonResultVerification.positionType||0}" input-change-fun="fun.changeJsonMatchPositionType()"></select-default-common-component></div><div ng-if="input.caseInfo.jsonResultVerification.positionType==0"><p class="match-title-p">JSON&nbsp;根类型：</p><p class="http-code-p dp_ib w_100percent f_row"><select-default-common-component class="mr10 w_250" output="input.caseInfo.jsonResultVerification" model-key="resultType" required="true" input="{query:CONST.jsonTypeQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.jsonResultVerification.resultType||\'0\'}"></select-default-common-component><select-default-common-component class="w_250" ng-show="input.caseInfo.jsonResultVerification.resultType==1" output="input.caseInfo.jsonResultVerification" model-key="matchRule" required="true" input="{query:CONST.matchLoopQuery,key:\'key\',value:\'value\',initialData:input.caseInfo.jsonResultVerification.matchRule||\'0\'}"></select-default-common-component></p></div></div><p class="match-title-p" ng-hide="input.caseInfo.matchType == \'5\'">返回结果校验规则</p><textarea ng-model="input.caseInfo.matchRule" ng-if="input.caseInfo.matchType==\'0\'||input.caseInfo.matchType==\'1\'"></textarea><div class="json-match-div" ng-if="input.caseInfo.matchType==\'3\'||input.caseInfo.matchType==\'4\'"><list-block-common-component list="input.caseInfo.matchRule" main-object="component.blockListObject.responseCheck" other-object="{\'matchRule\':CONST.matchRule,matchType:input.caseInfo.matchType,positionType:input.caseInfo.jsonResultVerification.positionType}"></list-block-common-component></div></div><p class="null_tip_span" ng-show="input.caseInfo.matchType==\'2\'">不校验返回结果，任意结果均判断为正确</p></div></div></div></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success" ng-hide="data.isAjaxQuerying" button-set-disable-directive="fun.confirm()">确认</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer></div></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ShareProjectModal",'<div class="ams-modal-share-project eo-modal"><form autocomplete="off" name="editForm"><header class="eo-modal-header"><span ng-bind="::input.title"></span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="cancel()"></button></header><article class="eo-modal-article"><select-switch-common-component setting-object="{type:\'text\',text:\'开启项目分享\',class:\'plr20 \'}" switch-model="isShare" fun-object="{fun:share}"></select-switch-common-component><ul class="container-ul" ng-show="isShare" ng-switch="data.showMore" ng-class="{\'lock-container-ul\':islock}"><li class="encrypt-switch-button"><select-switch-common-component setting-object="{type:\'text\',text:\'访问时需要输入密码\',class:\'plr20 mt20\'}" switch-model="islock" fun-object="{fun:lock}"></select-switch-common-component></li><li class="ensure-encrypt"><input class="eo-input" autocomplete="off" type="text" name="name" ng-model="info.projectSharePassword" placeholder="请输入访问密码" ng-pattern="/^.{1,32}$/" maxlength="32" required=""></li><li class="eo_form_item_title">分享链接</li><li><ul class="get-link"><li><copy-default-common-component copy-model="info.link"></copy-default-common-component></li></ul></li><li class="eo_form_item_title eo_link cp" ng-click="data.showMore=!data.showMore">更多设置<span class="iconfont" ng-class="{\'icon-xuanzeqishouqi_o\':data.showMore,\'icon-xuanzeqizhankai_o\':!data.showMore}"></span></li><li class="eo_form_item_title" ng-switch-when="true">访客可执行的操作</li><li class="checkbox-li" ng-switch-when="true" ng-class="{\'eo-had-content-error\':data.isUnCheck}"><span class="item-span" ng-repeat="item in data.shareContentQuery"><input autocomplete="off" class="hidden" type="checkbox" id="share-checkbox-{{$index}}-js" ng-model="item.checkbox" name="share-checkbox" ng-change="fun.changeShareContent({$index:$index,item:item})"> <label for="share-checkbox-{{$index}}-js" class="eo-checkbox iconfont" ng-class="{ \'icon-duihao\':item.checkbox}">{{item.checkbox?\'\':\'&nbsp;\'}}</label> <label for="share-checkbox-{{$index}}-js">{{item.key}}</label></span></li><li class="eo_form_item_title" ng-switch-when="true">访客可查看的项目环境信息</li><li ng-switch-when="true"><select-default-common-component main-object="component.envSelectObj" output="data.env" model-key="templateEnvID" required="true" input="{query:data.env.envList,key:\'envName\',value:\'envID\',initialData:data.env.templateEnvID}"></select-default-common-component></li></ul></article><footer class="eo-modal-footer"><button class="eo_theme_btn_success save-change-btn" ng-click="ok()">保存设置</button> <button type="button" class="eo_theme_btn_default" ng-click="cancel()">取消修改</button></footer></form></div><div class="eo_theme_modal_mask"></div>'),e.put("AMS_ApiSearchModal",'<div class="ams-modal-search-api eo-modal"><header class="eo-modal-header"><span>搜索API</span> <button class="iconfont icon-guanbi pull-right mt15 ab_r20" type="button" ng-click="fun.cancel()"></button></header><article class="eo-modal-article"><form autocomplete="off" name="ConfirmForm"><div><p class="eo_form_first_item_title">关键字<span class="eo-modal-tip">（选填）</span></p><p><input autocomplete="off" type="text" name="keyword" ng-model="output.keyword" class="eo-input" ng-class="{\'eo-input-error\':(data.submitted&&ConfirmForm.keyword.$invalid)}"></p></div><div class="f_row"><div class="w_50percent mr10"><p class="eo_form_item_title">请求方式</p><div><select-default-common-component output="output" model-key="requestMethod" required="true" input="{query:const.requestMethodQuery,key:\'key\',value:\'value\',initialData:output.requestMethod}"></select-default-common-component></div></div><div class="w_50percent"><p class="eo_form_item_title">API 状态</p><div><select-default-common-component output="output" model-key="apiStatus" required="true" input="{query:const.apiStatusQuery,key:\'key\',value:\'value\',initialData:output.apiStatus}"></select-default-common-component></div></div></div><button class="hidden" button-set-disable-directive="fun.confirm()"></button></form><div class="f_row"><div class="w_50percent mr10"><p class="eo_form_item_title">星标</p><div><select-default-common-component output="output" model-key="apiStarStatus" required="true" input="{query:const.apiStarStatusQuery,key:\'key\',value:\'value\',initialData:output.apiStarStatus}"></select-default-common-component></div></div><div class="w_50percent"><p class="eo_form_item_title">标签<span class="eo-modal-tip">（选填）</span></p><p><select-default-common-component output="output" model-key="apiTag" multiple="true" input="{query:data.apiTagQuery,key:\'apiTag\',value:\'apiTag\',initialData:output.apiTag}"></select-default-common-component></p></div></div><div class="f_row"><div class="w_50percent mr10"><p class="eo_form_item_title">创建者<span class="eo-modal-tip">（选填）</span></p><p><select-person-common-component output="component.selectPersonCommonComponentObject.creator" input="{query:data.memberQuery,loginCall:\'inviteCall\',nickName:\'userNickName\',noteName:\'memberNickName\',value:\'connID\',initialData:output.creator}"></select-person-common-component></p></div><div class="w_50percent"><p class="eo_form_item_title">更新者<span class="eo-modal-tip">（选填）</span></p><p><select-person-common-component output="component.selectPersonCommonComponentObject.updater" input="{query:data.memberQuery,loginCall:\'inviteCall\',nickName:\'userNickName\',noteName:\'memberNickName\',value:\'connID\',initialData:output.updater}"></select-person-common-component></p></div></div></article><footer class="eo-modal-footer"><button class="{{input.btnObject.class||\'eo_theme_btn_success\'}}" button-set-disable-directive="fun.confirm()">搜索</button> <button type="button" class="eo_theme_btn_default" ng-click="fun.cancel()">取消</button></footer></div><div class="eo_theme_modal_mask"></div>')}]);